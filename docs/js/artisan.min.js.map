{"version":3,"sources":["docs/js/artisan.js"],"names":["angular","module","service","$promise","$once","environment","Facebook","promise","undefined","window","FB","resolve","FacebookInit","then","success","error","reject","FacebookStatus","response","init","authResponse","status","FacebookGetMe","fields","config","FacebookLogin","facebook","console","log","api","FacebookGetMyPicture","size","width","height","type","login","scope","FacebookLogout","logout","script","language","culture","appId","app_id","cookie","xfbml","version","this","statics","getMe","getMyPicture","extend","addons","trhow","directive","$timeout","$compile","Http","GoogleMaps","GooglemapsLink","element","attributes","Googlemaps","maps","GooglemapsOptions","options","map","google","Map","info","GooglemapsInfo","copy","styles","get","GooglemapsMarkersRemove","forEach","markers","marker","setMap","GooglemapsMarkersSet","items","bounds","LatLngBounds","filter","item","has","filters","month","id","category","categories","indexOf","key","GooglemapsMarker","clusterer","GooglemapsClusterer","GooglemapsSetType","typeId","setMapTypeId","InfoWindow","maxWidth","pixelOffset","Size","event","addListener","outer","$","background","prev","children","css","display","parent","left","attr","i","s","find","close","next","overflow","position","right","top","z-index","cursor","opacity","transform","mouseout","latLng","LatLng","latitude","longitude","Marker","icon","url","scaledSize","origin","Point","anchor","contentString","onClick","selectedBlog","html","setContent","open","MarkerClusterer","cssClass","imagePath","arguments","publics","setMarkers","setType","connector","restrict","link","googlemaps","apiKey","data","GoogleMapsGeocoder","geocoder","Geocoder","GoogleMapsType","types","street","number","locality","postalCode","city","province","region","country","label","address_components","c","t","long_name","GoogleMapsParse","results","length","name","formatted_address","lng","geometry","location","lat","parse","app","$http","MapBox","MapboxLink","model","MapboxMap","mapboxgl","container","style","interactive","logoPosition","canvas","getCanvasContainer","jumpTo","MapboxFly","flyTo","MapboxFlyPosition","getOptions","center","zoom","MapboxJump","MapboxJumpPosition","MapboxMarkersRemove","remove","MapboxMarkersSet","MapboxClusterer","MapboxMarkerAdd","push","$scope","$new","node","document","createElement","className","area","code","setAttribute","offset","setLngLat","addTo","markerElement","on","e","$emit","MapboxCoordinatesGet","coordinates","altitude","MapboxFeaturesGet","collection","crs","properties","features","addSource","cluster","clusterMaxZoom","clusterRadius","addLayer","source","paint","circle-color","property","stops","circle-radius","layout","text-field","text-font","text-size","circle-stroke-width","circle-stroke-color","MapboxBoundsFit","fitBounds","speed","curve","padding","linear","maxZoom","fly","flyPosition","jump","jumpPosition","mapbox","template","$q","MapBoxGet","all","accessToken","provider","$locationProvider","$httpProvider","EnvironmentSetHttp","defaults","headers","common","withCredentials","http","interceptors","apply","EnvironmentSetLocation","html5Mode","html5","hashPrefix","hash","EnvironmentAdd","merge","EnvironmentSet","value","EnvironmentGet","global","EnvironmentUse","paths","href","add","use","disableDefaultUI","mapTypeId","scrollwheel","bearing","pitch","iso","$get","factory","Animate","callback","ticks","pause","animate","cancelAnimationFrame","play","loop","time","requestAnimationFrame","toggle","prototype","lastTime","vendors","x","currTime","Date","getTime","timeToCall","Math","max","setTimeout","clearTimeout","Rect","getBoundRect","getNode","getDocumentNode","getBoundingClientRect","getClosest","selector","matchesFn","some","fn","body","parentElement","getClosestNode","target","getDelta","original","originalEvent","delta","deltaX","wheelDeltaX","deltaY","wheelDeltaY","abs","dir","documentElement","parentNode","getElement","isArray","getNodeOffset","nodeType","offsetLeft","y","offsetTop","getPageScroll","scroll","documentNode","pageXOffset","scrollLeft","pageYOffset","scrollTop","getParents","topParentNode","parents","each","getView","view","innerWidth","innerHeight","clientWidth","clientHeight","getPointInView","point","TOUCH_EVENTS","touch","touches","changedTouches","pageX","pageY","MOUSE_EVENTS","compileController","contents","controller","$controller","controllerAs","downloadFile","content","download","createEvent","base64","downloadName","substring","lastIndexOf","initEvent","dispatchEvent","blob","Blob","reader","FileReader","readAsDataURL","onloadend","result","ua","agent","navigator","userAgent","toLowerCase","safari","msie","chrome","mobile","mac","getElementsByTagName","addClass","EventsService","Dom","Event","rect","absolute","relative","timestamp","stop","stopPropagation","preventDefault","Events","setTimestamp","interval","min","events","listeners","click","onMouseDown","down","removeTouchEvents","onMouseMove","move","onMouseUp","up","onMouseWheel","wheel","removeScrollEvents","onMouseScroll","removeWheelEvents","onResize","resize","onTouchStart","removeStandardEvents","onTouchMove","onTouchEnd","standardEvents","touchEvents","wheelEvents","scrollEvents","standard","windowElement","listener","$on","off","mouseEvents","getTouch","previous","difference","getRelativeTouch","hasPassiveEvents","supported","addEventListener","Object","defineProperty","passive","capture","EventTarget","modified","call","onScroll","scrollWidth","firefox","$filter","array","PointDifference","a","b","PointMultiply","clone","mult","setPos","setX","setY","toString","multiply","w","h","RectMultiply","bottom","bottomLeft","bottomRight","expand","expandRect","intersect","reduce","reduceRect","offsetRect","setH","setSize","setW","topLeft","topRight","Vector","VectorCross","VectorDifference","VectorDistance","sqrt","VectorIncidence","atan2","VectorMake","VectorNormalize","l","VectorPower","VectorSize","cross","distance","friction","incidence","normalize","power","towards","make","Hash","pool","HashGet","defineProperties","enumerable","writable","pools","getId","set","newItem","p","keys","oldItem","index","splice","addMany","removeMany","removeAll","shift","forward","reverse","sort","d","backward","differs","updatePool","Array","deferred","defer","$promiseAll","promises","State","errors","isReady","idle","busy","state","isBusy","isError","isErroring","isSuccess","isSuccessing","classes","ready","successing","errorring","enabled","DELAY","errorMessage","button","labels","submitClass","transformProperty","div","every","prefix","Style","props","scale","hoverScale","currentScale","cssText","join","transformOrigin","round","format","string","prepend","expression","splitted","split","formatted","object","reducer","o","reducerAdder","slice","reducerSetter","removeValue","reverseSortOn","throttle","func","wait","context","args","timeout","later","leading","getNow","now","remaining","trailing","toMd5","where","query","found","TypeError","len","k","Api","Doc","$location","$route","$routeParams","Router","Route","current","route","$$route","params","path","pathParams","originalPath","templateUrl","loadedTemplateUrl","RouteCurrent","View","doc","ViewCurrent","docs","HttpPath","HttpPromise","method","HttpGet","HttpPost","HttpPut","HttpPatch","HttpDelete","HttpFake","msec","post","put","patch","delete","fake","Preload","preload","loaded","total","progress","PreloadAll","update","preloads","percent","setInterval","start","clearInterval","PreloadStart","xhr","XMLHttpRequest","responseType","onloadstart","onprogress","onload","buffer","onerror","send","PreloadImage","image","Image","src","URL","createObjectURL","OnceLoad","OnceScript","OnceLink","uid","getElementById","scripts","insertBefore","nextSibling","links","rel","load","$rootScope","RouterSetControllers","$previousController","$previous","$currentController","$current","$nextController","$next","RouterOnChangeStart","RouterOnChangeSuccess","RouterOnChangeError","rejection","RouterOnUpdate","RouterIsController","RouterRedirectTo","$$lastRequestedPath","RouterRetryLastRequestedPath","RouterRedirect","msecs","RouterPath","RouterApply","isController","redirect","SilentUnlink","$$listeners","$locationChangeSuccess","relink","SilentListener","$path","SilentSilent","replace","SilentPath","silent","unshift","CookieDelete","CookieSetter","CookieExists","CookieGet","cookieName","ca","charAt","JSON","decodeURIComponent","atob","CookieOn","checkCookie","elapsed","Cookie","TIMEOUT","CookieSet","days","cache","json","stringify","btoa","encodeURIComponent","expires","date","setTime","toGMTString","exist","LocalExists","localStorage","LocalGet","LocalSet","setItem","LocalDelete","removeItem","LocalOn","storageEvent","newValue","sessionStorage","$sce","TrustGetValue","values","trustedValues","TrustSetValue","trustedValue","TrustGetOrSet","TrustHtml","trustAsHtml","TrustResource","trustAsResourceUrl","TrustUrl","resource","Color","r","g","uint","parseInt","componentToHex","hex","luma","color","dot","contrast","darker","pow","floor","lighter","toUint","toHex","toRgba","toFixed","alpha","makeSet","foreground","border","light","Shape","shapeCircle","cx","cy","sa","ea","PI","ctx","arc","shapeStar","or","ir","steps","angle","step","moveTo","cos","sin","lineTo","shapeRoundRect","tl","tr","br","bl","defaultRadius","quadraticCurveTo","circle","beginPath","closePath","star","roundRect","constant","black","white","blue","red","lightBlue","lightYellow","greyLighter","greyLight","greyMedium","grey","Painter","Palette","painter","rows","getRect","row","setCanvas","drawImage","palette","isString","img","addShape","save","clip","translate","restore","draw","pre","drawRect","tint","setFill","fillRect","globalCompositeOperation","pattern","drawPattern","fillStyle","createPattern","toDataURL","PainterColors","drawingRect","setColors","colors","offsetWidth","offsetHeight","getContext","lineCap","clear","setText","font","align","verticalAlign","textAlign","textBaseline","setStroke","strokeStyle","lineWidth","fillText","text","maxLength","substr","trim","strokeRect","fill","stroke","begin","rotate","xy","flip","$parse","ExpandableLink","getStyle","getComputedStyle","getPropertyValue","margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left","background-color","getTextStyle","setStyle","styleObj","placeholder","originalCssText","targetElement","removeClass","removeChild","setRects","boundingClientRect","hasClass","from","to","absoluteRight","absoluteLeft","absoluteBottom","absoluteTop","expanded","dynamics","easeInOut","duration","complete","change","contract","expandableRelative","expandableAbsolute","querySelector","expandable","onDown","onUp","onKeyDown","tagName","removeListeners","transclude","message","formatLabel","uniqueId","control","ngModel","required","form","title","require","optionLabel","field","precision","validate","minLength","Number","POSITIVE_INFINITY","focus","visible","onChange","$parent","onFilter","getType","getClasses","control-focus","control-success","$valid","control-error","$invalid","$submitted","$touched","control-empty","$viewValue","getMessages","$error","toggleVisibility","$templateCache","compile","onRemove","getter","numberPicker","setter","assign","onAdd","nodeRemove","nodeAdd","querySelectorAll","onFocus","$modelValue","$setViewValue","doBlur","onBlur","$formatters","$parsers","valid","String","$setValidity","tap","ngBind","appendChild","priority","$templateRequest","modal","modalView","when","routes","modals","popModal","m","active","closeModal","addModal","back","Nav","NavLink","$watch","onPath","onNav","nav","setItems","NavItemLink","itemOpen","immediate","$nav","closed","closing","opening","opened","itemClose","itemToggle","trigger","output","resolved","rejected","navItem","NavToLink","navTo","Silent","setNav","NavSilent","NavPath","setNavs","level","addItems","getPath","itemOrItems","addItem","ondragstart","Scrollable","Utils","render","scrollable","setContainer","containerNode","contentNode","setEnabled","isEnabled","renderX","getCurrent","contentStyle","dragStart","dragOn","onMove","dragMove","drag","getDrag","dragEnd","dragOff","_onScrollX","wheelX","onWheel","wheelXCheck","onScrollX","scrollableWhen","windowEvents","onLeft","onRight","showIndicatorFor","scrollableX","getItems","scrollableItem","scrollPrev","scrollNext","reset","doReset","oldValue","renderY","_onScrollY","wheelY","wheelYCheck","onScrollY","onTop","onBottom","scrollableY","flag","getIndicator","indicator","getIndex","currentIndex","scrollToIndex","getItemAtIndex","end","wheeling","dragging","doLeft","finally","scrollToX","doRight","animating","extendX","snapToNearestX","extending","snappable","doTop","scrollToY","doBottom","extendY","snapToNearestY","methods","VideoSourceLink","canplay","_onCanPlay","video","playing","onPlaying","onPause","onEnded","onProgress","infos","buffered","onTimeUpdate","currentTime","progressTime","videoElement","native"],"mappings":"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","file":"artisan.min.js","sourcesContent":["/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan', ['ng', 'ngRoute', 'ngMessages']);\r\n\r\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.service('FacebookService', ['$promise', '$once', 'environment', function($promise, $once, environment) {\n\n        var service = this;\n\n        var statics = {\n            login: FacebookLogin,\n            logout: FacebookLogout,\n            status: FacebookStatus,\n            getMe: FacebookGetMe,\n            getMyPicture: FacebookGetMyPicture,\n        };\n\n        angular.extend(service, statics);\n\n        // private vars\n\n        if (!environment.addons.facebook) {\n            trhow('FacebookService.error missing config object in environment.addons.facebook');\n        }\n\n        var config = environment.addons.facebook;\n\n        // statics methods\n\n        /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n         *  calling facebook initializer on page load to avoid popup blockers via asyncronous loading  *\n         * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\n\n        Facebook();\n\n        function Facebook() {\n            return $promise(function(promise) {\n                if (window.FB !== undefined) {\n                    promise.resolve(window.FB);\n                } else {\n                    FacebookInit().then(function(success) {\n                        promise.resolve(window.FB);\n                    }, function(error) {\n                        promise.reject(error);\n                    });\n                }\n            });\n        }\n\n        function FacebookStatus(response, promise, init) {\n            service.authResponse = null;\n            if (response.status === 'connected') {\n                service.authResponse = response.authResponse;\n                promise.resolve(response);\n            } else if (response.status === 'not_authorized') {\n                if (init) {\n                    promise.resolve(response);\n                } else {\n                    promise.reject(response);\n                }\n            } else {\n                promise.reject(response);\n            }\n        }\n\n        function FacebookGetMe(fields) {\n            fields = fields || config.fields;\n            return $promise(function(promise) {\n                FacebookLogin().then(function(facebook) {\n                    console.log('FacebookGetMe', facebook);\n                    facebook.api('/me', {\n                        fields: fields\n                    }, function(response) {\n                        if (!response || response.error) {\n                            promise.reject('Error occured');\n                        } else {\n                            promise.resolve(response);\n                        }\n                    });\n                });\n            });\n        }\n\n        function FacebookGetMyPicture(size) {\n            size = size || 300;\n            return $promise(function(promise) {\n                FacebookLogin().then(function(facebook) {\n                    facebook.api('/me/picture', {\n                        width: size,\n                        height: size,\n                        type: 'square'\n                    }, function(response) {\n                        if (!response || response.error) {\n                            promise.reject('Error occured');\n                        } else {\n                            promise.resolve(response);\n                        }\n                    });\n                });\n            });\n        }\n\n        function FacebookLogin() {\n            return $promise(function(promise) {\n                Facebook().then(function(facebook) {\n                    console.log('FacebookLogin', facebook);\n                    facebook.login(function(response) {\n                        FacebookStatus(response, promise);\n                    }, {\n                        scope: config.scope\n                    });\n                });\n            });\n        }\n\n        function FacebookLogout() {\n            return $promise(function(promise) {\n                Facebook().then(function(facebook) {\n                    facebook.logout(function(response) {\n                        promise.resolve(response);\n                    });\n                });\n            });\n        }\n\n        function FacebookInit() {\n            return $promise(function(promise) {\n                $once.script('//connect.facebook.net/' + environment.language.culture + '/sdk.js', 'fbAsyncInit').then(function() {\n                    // console.log('FacebookInit.fbAsyncInit', window.FB);\n                    window.FB.init({\n                        appId: config.app_id,\n                        status: true,\n                        cookie: true,\n                        xfbml: true,\n                        version: config.version,\n                    });\n                    promise.resolve(window.FB);\n                    // window.fbAsyncInit = null;\n                }, function(error) {\n                    promise.reject(error);\n                });\n            });\n        }\n\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    // todo !!!\n\n    app.directive('googlemaps', ['$timeout', '$compile', '$promise', 'Http', 'GoogleMaps', 'environment', function($timeout, $compile, $promise, Http, GoogleMaps, environment) {\n\n        var directive = {\n            restrict: 'A',\n            scope: {\n                connector: '=googlemaps',\n            },\n            link: GooglemapsLink,\n        };\n\n        if (!environment.addons.googlemaps) {\n            trhow('googlemaps.error missing config object in environment.addons.googlemaps');\n        }\n\n        var config = environment.addons.googlemaps;\n\n        return directive;\n\n        function GooglemapsLink(scope, element, attributes) {\n            console.log('GooglemapsLink', arguments);\n\n            var map, options, info, bounds, clusterer;\n            var filters = {};\n            var markers = [];\n\n            var publics = {\n                // methods available for controllers\n                /*\n                fly: MapboxFly,\n                flyPosition: MapboxFlyPosition,\n                jump: MapboxJump,\n                jumpPosition: MapboxJumpPosition,\n                */\n                setMarkers: GooglemapsMarkersSet,\n                setType: GooglemapsSetType,\n            };\n\n            if (scope.connector) {\n                angular.extend(scope.connector, publics);\n            }\n\n            Googlemaps();\n\n            function Googlemaps() {\n                return $promise(function(promise) {\n                    GoogleMaps.maps().then(function() {\n                        GooglemapsOptions().then(function(options) {\n                            map = new google.maps.Map(element[0], options);\n                            info = GooglemapsInfo();\n                            promise.resolve(map);\n                        });\n                    });\n                });\n            }\n\n            function GooglemapsOptions() {\n                return $promise(function(promise) {\n                    var options = angular.copy(config.options);\n                    if (config.styles) {\n                        Http.get(config.styles).then(function(styles) {\n                            options.styles = styles;\n                            promise.resolve(options);\n\n                        }, function(error) {\n                            console.log('GooglemapsOptions.error', 'unable to load styles', config.styles);\n                            promise.resolve(options);\n\n                        });\n\n                    } else {\n                        promise.resolve(options);\n                    }\n                });\n            }\n\n            function GooglemapsMarkersRemove() {\n                angular.forEach(markers, function(marker) {\n                    marker.setMap(null);\n                });\n            }\n\n            function GooglemapsMarkersSet(items) {\n                Googlemaps().then(function(map) {\n                    GooglemapsMarkersRemove();\n                    bounds = new google.maps.LatLngBounds();\n\n                    markers = items.filter(function(item) {\n                        var has = true;\n                        if (filters.month) {\n                            has = has && filters.month.items.has(item.id);\n                        }\n                        if (filters.category) {\n                            has = has && item.categories.indexOf(filters.category.key) !== -1;\n                        }\n                        return has;\n\n                    }).map(function(item) {\n                        return GooglemapsMarker(item);\n\n                    });\n\n                    if (config.clusterer) {\n                        clusterer = GooglemapsClusterer(markers);\n                    }\n\n                });\n            }\n\n            function GooglemapsBoundsFit() {\n                if (!bounds.isEmpty()) {\n                    map.fitBounds(bounds);\n                }\n            }\n\n            function GooglemapsSetType(typeId) {\n                var types = ['hybrid', 'roadmap', 'satellite', 'terrain'];\n                if (types.indexOf(typeId) !== -1) {\n                    map.setMapTypeId(typeId);\n                }\n            }\n\n            function GooglemapsInfo() {\n\n                var info = new google.maps.InfoWindow({\n                    maxWidth: 350,\n                    pixelOffset: new google.maps.Size(0, 15),\n                });\n\n                google.maps.event.addListener(info, 'domready', function() {\n                    var outer = $('.gm-style-iw');\n                    var background = outer.prev();\n                    background.children(':nth-child(2)').css({\n                        'display': 'none'\n                    });\n                    background.children(':nth-child(4)').css({\n                        'display': 'none'\n                    });\n                    outer.parent().parent().css({\n                        left: '115px'\n                    });\n                    background.children(':nth-child(1)').attr('style', function(i, s) {\n                        return s + 'display: none!important';\n                    });\n                    background.children(':nth-child(3)').attr('style', function(i, s) {\n                        return s + 'display: none!important';\n                    });\n                    background.children(':nth-child(3)').find('div').children().attr('style', function(i, s) {\n                        return s + 'opacity: 0!important;';\n                    });\n                    var close = outer.next();\n                    close.css({\n                        'width': '13px',\n                        'height': '13px',\n                        'overflow': 'hidden',\n                        'position': 'absolute',\n                        'right': '56px',\n                        'top': '17px',\n                        'z-index': '10000',\n                        'cursor': 'pointer',\n                        'opacity': 1,\n                        'transform': 'scale(0.8)'\n                    });\n                    close.mouseout(function() {\n                        $(this).css({\n                            opacity: '1'\n                        });\n                    });\n                });\n\n                return info;\n            }\n\n            function GooglemapsMarker(item) {\n\n                var latLng = new google.maps.LatLng(\n                    item.position.latitude,\n                    item.position.longitude\n                );\n\n                var marker = new google.maps.Marker({\n                    position: latLng,\n                    item: item,\n                    icon: {\n                        url: 'img/maps/marker.png',\n                        scaledSize: new google.maps.Size(25, 25),\n                        origin: new google.maps.Point(0, 0),\n                        anchor: new google.maps.Point(0, 0)\n                    },\n                    map: map,\n                    contentString: '<div id=\"iw-container\">' +\n                        '<div class=\"iw-image\" ng-style=\"{ \\'background-image\\': cssUrl(selectedBlog.image.url) }\"></div>' +\n                        '<div class=\"iw-title\" ng-bind=\"selectedBlog.title\"></div>' +\n                        '<div class=\"iw-cta\"><button type=\"button\" class=\"iw-link\" ng-click=\"openBlog(selectedBlog)\">Details</button></div>' +\n                        '</div>'\n                });\n\n                marker.onClick = function() {\n                    var marker = this;\n                    $timeout(function() {\n                        scope.selectedBlog = marker.item;\n                        var html = $compile(marker.contentString)(scope);\n                        info.setContent(html[0]);\n                        info.open(map, marker);\n                    });\n                };\n\n                marker.addListener('click', marker.onClick);\n\n                bounds.extend(latLng);\n\n                return marker;\n            }\n\n            function GooglemapsClusterer(markers) {\n\n                var clusterer = new MarkerClusterer(map, markers, {\n                    cssClass: 'cluster',\n                    imagePath: '/img/gmap/m'\n                });\n\n                return clusterer;\n\n            }\n\n        }\n\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.service('GoogleMaps', ['$promise', '$once', 'environment', function($promise, $once, environment) {\n\n        var service = this;\n\n        var statics = {\n            maps: GoogleMaps,\n            geocoder: GoogleMapsGeocoder,\n            parse: GoogleMapsParse,\n        };\n\n        angular.extend(service, statics);\n\n        if (!environment.addons.googlemaps) {\n            trhow('GoogleMaps.error missing config object in environment.addons.googlemaps');\n        }\n\n        function GoogleMaps() {\n            return $promise(function(promise) {\n                var apiKey = environment.addons.googlemaps.apiKey;\n                $once.script('https://maps.googleapis.com/maps/api/js?key=' + apiKey + '&callback={{callback}}', true).then(function(data) {\n                    promise.resolve(window.google.maps);\n                }, function(error) {\n                    promise.reject(error);\n                });\n            });\n        }\n\n        function GoogleMapsGeocoder() {\n            var service = this;\n            return $promise(function(promise) {\n                GoogleMaps().then(function(maps) {\n                    var geocoder = new maps.Geocoder();\n                    promise.resolve(geocoder);\n\n                }, function(error) {\n                    promise.reject(error);\n\n                });\n            });\n        }\n\n        function GoogleMapsType(type, item) {\n            var types = {\n                street: 'route',\n                number: 'street_number',\n                locality: 'locality',\n                postalCode: 'postal_code',\n                city: 'administrative_area_level_3',\n                province: 'administrative_area_level_2',\n                region: 'administrative_area_level_1',\n                country: 'country',\n            };\n            var label = null;\n            angular.forEach(item.address_components, function(c) {\n                angular.forEach(c.types, function(t) {\n                    if (t === types[type]) {\n                        label = c.long_name;\n                    }\n                });\n            });\n            // console.log('GoogleMapsType', type, item, label);\n            return label;\n        }\n\n        function GoogleMapsParse(results) {\n            var items = null;\n            if (results.length) {\n                items = results.filter(function(item) {\n                    return true; // item.geometry.location_type === 'ROOFTOP' ||\n                    // item.geometry.location_type === 'RANGE_INTERPOLATED' ||\n                    // item.geometry.location_type === 'GEOMETRIC_CENTER';\n                }).map(function(item) {\n                    return {\n                        name: item.formatted_address,\n                        street: GoogleMapsType('street', item),\n                        number: GoogleMapsType('number', item),\n                        locality: GoogleMapsType('locality', item),\n                        postalCode: GoogleMapsType('postalCode', item),\n                        city: GoogleMapsType('city', item),\n                        province: GoogleMapsType('province', item),\n                        region: GoogleMapsType('region', item),\n                        country: GoogleMapsType('country', item),\n                        position: {\n                            lng: item.geometry.location.lng(),\n                            lat: item.geometry.location.lat(),\n                        }\n                    };\n                });\n                /*\n                var first = response.data.results[0];\n                scope.model.position = first.geometry.location;\n                console.log(scope.model);\n                setLocation();\n                */\n            }\n            console.log('GoogleMapsParse', results, items);\n            return items;\n        }\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.directive('mapbox', ['$http', '$timeout', '$compile', '$promise', 'MapBox', 'environment', function ($http, $timeout, $compile, $promise, MapBox, environment) {\n\n\t\tvar directive = {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tconnector: '=mapbox',\n\t\t\t},\n\t\t\tlink: MapboxLink,\n\t\t};\n\n\t\tif (!environment.addons.mapbox) {\n\t\t\ttrhow('mapbox.error missing config object in environment.addons.mapbox');\n\t\t}\n\n\t\tvar config = environment.addons.mapbox;\n\n\t\treturn directive;\n\n\t\tfunction MapboxLink(scope, element, attributes, model) {\n\t\t\tvar map, markers, marker, geocoder, bounds, canvas, dragging, overing;\n\n\t\t\tvar publics = {\n\t\t\t\t// methods available for controllers\n\t\t\t\tfly: MapboxFly,\n\t\t\t\tflyPosition: MapboxFlyPosition,\n\t\t\t\tjump: MapboxJump,\n\t\t\t\tjumpPosition: MapboxJumpPosition,\n\t\t\t\tsetMarkers: MapboxMarkersSet,\n\t\t\t\tfitBounds: MapboxBoundsFit,\n\t\t\t};\n\n\t\t\tif (scope.connector) {\n\t\t\t\tangular.extend(scope.connector, publics);\n\t\t\t}\n\n\t\t\tfunction MapboxMap() {\n\t\t\t\treturn $promise(function (promise) {\n\n\t\t\t\t\tMapBox.get().then(function (mapboxgl) {\n\t\t\t\t\t\tmap = new mapboxgl.Map({\n\t\t\t\t\t\t\tcontainer: element[0],\n\t\t\t\t\t\t\tstyle: config.style,\n\t\t\t\t\t\t\tinteractive: true,\n\t\t\t\t\t\t\tlogoPosition: 'bottom-right',\n\t\t\t\t\t\t\t// center: config.options.center,\n\t\t\t\t\t\t\t// zoom: config.options.zoom,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tcanvas = map.getCanvasContainer();\n\t\t\t\t\t\t/*\n\t\t\t\t\t\tscope.map.setAddress = function (item) {\n\t\t\t\t\t\t\t// console.log('setAddress', item);\n\t\t\t\t\t\t\tscope.map.results = null;\n\t\t\t\t\t\t\tflyTo(item.position);\n\t\t\t\t\t\t};\n\t\t\t\t\t\tscope.map.search = function () {\n\t\t\t\t\t\t\t// console.log('address', scope.map.address);\n\t\t\t\t\t\t\tscope.map.results = null;\n\t\t\t\t\t\t\tgeocodeAddress(scope.map.address);\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tscope.map.styles = {\n\t\t\t\t\t\t\tFICO: 1,\n\t\t\t\t\t\t\tSATELLITE: 2,\n\t\t\t\t\t\t};\n\t\t\t\t\t\tscope.map.style = scope.map.styles.FICO;\n\t\t\t\t\t\tscope.map.styleToggle = function () {\n\t\t\t\t\t\t\tif (scope.map.style === scope.map.styles.FICO) {\n\t\t\t\t\t\t\t\tscope.map.style = scope.map.styles.SATELLITE;\n\t\t\t\t\t\t\t\tmap.setStyle('mapbox://styles/mapbox/satellite-v9');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tscope.map.style = scope.map.styles.FICO;\n\t\t\t\t\t\t\t\tmap.setStyle('mapbox://styles/mapbox/streets-v9');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tscope.map.setStyle = function (style) {\n\t\t\t\t\t\t\tscope.map.style = style;\n\t\t\t\t\t\t\tif (scope.map.style === scope.map.styles.FICO) {\n\t\t\t\t\t\t\t\tmap.setStyle('mapbox://styles/mapbox/streets-v9');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmap.setStyle('mapbox://styles/mapbox/satellite-v9');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};                \n\t\t\t\t\t\t*/\n\t\t\t\t\t\tif (config.options) {\n\t\t\t\t\t\t\tmap.jumpTo(config.options);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpromise.resolve(map);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction MapboxFly(options) {\n\t\t\t\tmap.flyTo(options);\n\t\t\t}\n\n\t\t\tfunction MapboxFlyPosition(position) {\n\t\t\t\tvar options = getOptions({\n\t\t\t\t\tcenter: [position.lng, position.lat],\n\t\t\t\t\tzoom: 20,\n\t\t\t\t});\n\t\t\t\tMapboxFly(options);\n\t\t\t}\n\n\t\t\tfunction MapboxJump(options) {\n\t\t\t\tmap.jumpTo(options);\n\t\t\t}\n\n\t\t\tfunction MapboxJumpPosition(position) {\n\t\t\t\tvar options = getOptions({\n\t\t\t\t\tcenter: [position.lng, position.lat],\n\t\t\t\t\tzoom: 20,\n\t\t\t\t});\n\t\t\t\tmap.MapboxJump(options);\n\t\t\t}\n\n\t\t\t/*\n\t\t\tgoogleMaps.geocoder().then(function (response) {\n\t\t\t    geocoder = response;\n\t\t\t    init();\n\t\t\t});\n\t\t\t*/\n\n\t\t\tfunction getOptions(options) {\n\t\t\t\treturn angular.extend(angular.copy(config.options), options);\n\t\t\t}\n\n\t\t\tfunction MapboxMarkersRemove() {\n\t\t\t\tif (markers) {\n\t\t\t\t\tangular.forEach(markers, function (item) {\n\t\t\t\t\t\titem.remove();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction MapboxMarkersSet(items) {\n\t\t\t\tMapboxMap().then(function () {\n\t\t\t\t\tMapboxMarkersRemove();\n\t\t\t\t\tmarkers = [];\n\t\t\t\t\tif (config.clusterer) {\n\t\t\t\t\t\tMapboxClusterer(items);\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (items) {\n\t\t\t\t\t\t\tangular.forEach(items, function (item) {\n\t\t\t\t\t\t\t\tvar marker = MapboxMarkerAdd(item);\n\t\t\t\t\t\t\t\tmarkers.push(marker);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction MapboxMarkerAdd(item) {\n\t\t\t\tvar $scope = scope.$new(true);\n\t\t\t\t$scope.item = item;\n\t\t\t\tvar node = document.createElement('div');\n\t\t\t\tnode.id = 'point';\n\t\t\t\tnode.className = 'marker ' + item.area.code;\n\t\t\t\tnode.className += item.type;\n\t\t\t\tnode.setAttribute('marker', 'item');\n\t\t\t\tvar marker = new mapboxgl.Marker(node, {\n\t\t\t\t\t\toffset: [-10, -10]\n\t\t\t\t\t})\n\t\t\t\t\t.setLngLat([item.position.lng, item.position.lat])\n\t\t\t\t\t.addTo(map);\n\t\t\t\tvar markerElement = angular.element(node);\n\t\t\t\tmarkerElement.on('click', function (e) {\n\t\t\t\t\t// console.log('marker.click', item);\n\t\t\t\t\tscope.$emit('onMarkerClicked', item);\n\t\t\t\t});\n\t\t\t\t$compile(markerElement)($scope); // Compiling marker\n\t\t\t\treturn marker;\n\t\t\t}\n\n\t\t\tfunction MapboxCoordinatesGet(item) {\n\t\t\t\tvar coordinates = null;\n\t\t\t\tif (item.position) {\n\t\t\t\t\tcoordinates = [\n\t\t\t\t\t\titem.position.longitude,\n\t\t\t\t\t\titem.position.latitude,\n\t\t\t\t\t\titem.position.altitude || 0.0,\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t\t// [0, 1, 2]; longitude, latitude, altitude\n\t\t\t\treturn coordinates;\n\t\t\t}\n\n\t\t\tfunction MapboxFeaturesGet(items) {\n\t\t\t\tvar collection = null;\n\t\t\t\tif (items) {\n\t\t\t\t\tvar features = items.map(function (item) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\ttype: 'Feature',\n\t\t\t\t\t\t\tproperties: angular.extend({}, item),\n\t\t\t\t\t\t\tgeometry: {\n\t\t\t\t\t\t\t\ttype: 'Point',\n\t\t\t\t\t\t\t\tcoordinates: MapboxCoordinatesGet(item),\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t\tcollection = {\n\t\t\t\t\t\ttype: 'FeatureCollection',\n\t\t\t\t\t\tcrs: {\n\t\t\t\t\t\t\ttype: 'name',\n\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\tname: 'urn:ogc:def:crs:OGC:1.3:CRS84'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfeatures: features,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn collection;\n\t\t\t}\n\n\t\t\tfunction MapboxClusterer(items) {\n\n\t\t\t\tvar collection = MapboxFeaturesGet(items);\n\n\t\t\t\tmap.on('load', function () {\n\t\t\t\t\t// Add a new source from our GeoJSON data and set the\n\t\t\t\t\t// 'cluster' option to true. GL-JS will add the point_count property to your source data.\n\t\t\t\t\tmap.addSource('earthquakes', {\n\t\t\t\t\t\ttype: 'geojson',\n\t\t\t\t\t\t// Point to GeoJSON data. This example visualizes all M1.0+ earthquakes\n\t\t\t\t\t\t// from 12/22/15 to 1/21/16 as logged by USGS' Earthquake hazards program.\n\t\t\t\t\t\t// data: '/api/mapbox/earthquakes.geo.json',\n\t\t\t\t\t\tdata: collection,\n\t\t\t\t\t\tcluster: true,\n\t\t\t\t\t\tclusterMaxZoom: 14, // Max zoom to cluster points on\n\t\t\t\t\t\tclusterRadius: 50 // Radius of each cluster when clustering points (defaults to 50)\n\t\t\t\t\t});\n\n\t\t\t\t\tmap.addLayer({\n\t\t\t\t\t\tid: 'clusters',\n\t\t\t\t\t\ttype: 'circle',\n\t\t\t\t\t\tsource: 'earthquakes',\n\t\t\t\t\t\tfilter: ['has', 'point_count'],\n\t\t\t\t\t\tpaint: {\n\t\t\t\t\t\t\t'circle-color': {\n\t\t\t\t\t\t\t\tproperty: 'point_count',\n\t\t\t\t\t\t\t\ttype: 'interval',\n\t\t\t\t\t\t\t\tstops: [\n                                    [0, '#51bbd6'],\n                                    [100, '#f1f075'],\n                                    [750, '#f28cb1'],\n                                ]\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'circle-radius': {\n\t\t\t\t\t\t\t\tproperty: 'point_count',\n\t\t\t\t\t\t\t\ttype: 'interval',\n\t\t\t\t\t\t\t\tstops: [\n                                    [0, 20],\n                                    [100, 30],\n                                    [750, 40]\n                                ]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tmap.addLayer({\n\t\t\t\t\t\tid: 'cluster-count',\n\t\t\t\t\t\ttype: 'symbol',\n\t\t\t\t\t\tsource: 'earthquakes',\n\t\t\t\t\t\tfilter: ['has', 'point_count'],\n\t\t\t\t\t\tlayout: {\n\t\t\t\t\t\t\t'text-field': '{point_count_abbreviated}',\n\t\t\t\t\t\t\t'text-font': ['DIN Offc Pro Medium', 'Arial Unicode MS Bold'],\n\t\t\t\t\t\t\t'text-size': 12\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tmap.addLayer({\n\t\t\t\t\t\tid: 'unclustered-point',\n\t\t\t\t\t\ttype: 'circle',\n\t\t\t\t\t\tsource: 'earthquakes',\n\t\t\t\t\t\tfilter: ['!has', 'point_count'],\n\t\t\t\t\t\tpaint: {\n\t\t\t\t\t\t\t'circle-color': '#11b4da',\n\t\t\t\t\t\t\t'circle-radius': 4,\n\t\t\t\t\t\t\t'circle-stroke-width': 1,\n\t\t\t\t\t\t\t'circle-stroke-color': '#fff'\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction MapboxBoundsFit() {\n\t\t\t\tif (bounds) {\n\t\t\t\t\tmap.fitBounds(bounds, {\n\t\t\t\t\t\tspeed: 1.5,\n\t\t\t\t\t\tcurve: 1,\n\t\t\t\t\t\tpadding: 30,\n\t\t\t\t\t\tlinear: false,\n\t\t\t\t\t\tmaxZoom: 8,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction geocodeAddress(address) {\n\t\t\t\tgeocoder.geocode({\n\t\t\t\t\t'address': address\n\t\t\t\t}, function (results, status) {\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tif (status === 'OK') {\n\t\t\t\t\t\t\tconnector.results = googleMaps.parse(results);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\talert('Geocode was not successful for the following reason: ' + status);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction reverseGeocode(position) {\n\t\t\t\t// console.log('reverseGeocode', position);\n\t\t\t\tgeocoder.geocode({\n\t\t\t\t\t'location': position\n\t\t\t\t}, function (results, status) {\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tif (status === 'OK') {\n\t\t\t\t\t\t\tconnector.results = googleMaps.parse(results);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconsole.log('Geocoder failed due to: ' + status);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction geolocalize() {\n\t\t\t\tif (navigator.geolocation) {\n\t\t\t\t\tnavigator.geolocation.getCurrentPosition(function (p) {\n\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\tvar position = {\n\t\t\t\t\t\t\t\tlat: p.coords.latitude,\n\t\t\t\t\t\t\t\tlng: p.coords.longitude\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tflyTo(position);\n\t\t\t\t\t\t\treverseGeocode(position);\n\t\t\t\t\t\t});\n\t\t\t\t\t}, function (e) {\n\t\t\t\t\t\tconsole.log('error', e);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log('error', 'Browser doesn\\'t support Geolocation');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/*\n\t\t\tfunction flyTo(position) {\n\t\t\t    map.flyTo({\n\t\t\t        center: [\n\t\t\t            parseFloat(position.lng),\n\t\t\t            parseFloat(position.lat)\n\t\t\t        ],\n\t\t\t        zoom: 15,\n\t\t\t        speed: 1.5,\n\t\t\t        curve: 1,\n\t\t\t    });\n\t\t\t}\n\t\t\t*/\n\n\t\t}\n    }]);\n\n\tapp.directive('marker', ['$http', '$timeout', function ($http, $timeout) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\titem: '=marker',\n\t\t\t},\n\t\t\ttemplate: '<div class=\"inner\">' +\n\t\t\t\t'   <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"40\" height=\"40\" viewBox=\"0 0 24 24\">' +\n\t\t\t\t'       <path d=\"M12 0c-5.522 0-10 4.395-10 9.815 0 5.505 4.375 9.268 10 14.185 5.625-4.917 10-8.68 10-14.185 0-5.42-4.478-9.815-10-9.815zm0 18c-4.419 0-8-3.582-8-8s3.581-8 8-8 8 3.582 8 8-3.581 8-8 8z\"/>' +\n\t\t\t\t'   </svg>' +\n\t\t\t\t'   <span ng-bind=\"item.code\"></span>' +\n\t\t\t\t'</div>',\n\t\t\tlink: link,\n\t\t};\n\n\t\tfunction link(scope, element, attributes, model) {\n\t\t\t// console.log('marker', scope.item);\n\t\t}\n\n    }]);\n\n\t/*\n\tapp.service('GoogleMaps', ['$q', '$http', function ($q, $http) {\n\t\tvar _key = 'AIzaSyAYuhIEO-41YT_GdYU6c1N7DyylT_OcMSY';\n\t\tvar _init = false;\n\n\t\tthis.maps = maps;\n\t\tthis.geocoder = geocoder;\n\t\tthis.parse = parse;\n\n\t\tfunction maps() {\n\t\t\tvar deferred = $q.defer();\n\t\t\tif (_init) {\n\t\t\t\tdeferred.resolve(window.google.maps);\n\t\t\t} else {\n\t\t\t\twindow.googleMapsInit = function () {\n\t\t\t\t\tdeferred.resolve(window.google.maps);\n\t\t\t\t\twindow.googleMapsInit = null;\n\t\t\t\t\t_init = true;\n\t\t\t\t};\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('async', null);\n\t\t\t\tscript.setAttribute('defer', null);\n\t\t\t\tscript.setAttribute('src', 'https://maps.googleapis.com/maps/api/js?key=' + _key + '&callback=googleMapsInit');\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t}\n\t\t\treturn deferred.promise;\n\t\t}\n\n\t\tfunction geocoder() {\n\t\t\tvar service = this;\n\t\t\tvar deferred = $q.defer();\n\t\t\tmaps().then(function (maps) {\n\t\t\t\tvar _geocoder = new maps.Geocoder();\n\t\t\t\tdeferred.resolve(_geocoder);\n\t\t\t}, function (error) {\n\t\t\t\tdeferred.reject(error);\n\t\t\t});\n\t\t\treturn deferred.promise;\n\t\t}\n\n\t\tfunction getType(type, item) {\n\t\t\tvar types = {\n\t\t\t\tstreet: 'route',\n\t\t\t\tnumber: 'street_number',\n\t\t\t\tlocality: 'locality',\n\t\t\t\tpostalCode: 'postal_code',\n\t\t\t\tcity: 'administrative_area_level_3',\n\t\t\t\tprovince: 'administrative_area_level_2',\n\t\t\t\tregion: 'administrative_area_level_1',\n\t\t\t\tcountry: 'country',\n\t\t\t};\n\t\t\tvar label = null;\n\t\t\tangular.forEach(item.address_components, function (c) {\n\t\t\t\tangular.forEach(c.types, function (t) {\n\t\t\t\t\tif (t === types[type]) {\n\t\t\t\t\t\tlabel = c.long_name;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\t// console.log('googleMaps.getType', type, item, label);\n\t\t\treturn label;\n\t\t}\n\n\t\tfunction parse(results) {\n\t\t\tvar items = null;\n\t\t\tif (results.length) {\n\t\t\t\titems = results.filter(function (item) {\n\t\t\t\t\treturn true; // item.geometry.location_type === 'ROOFTOP' ||\n\t\t\t\t\t// item.geometry.location_type === 'RANGE_INTERPOLATED' ||\n\t\t\t\t\t// item.geometry.location_type === 'GEOMETRIC_CENTER';\n\t\t\t\t}).map(function (item) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tname: item.formatted_address,\n\t\t\t\t\t\tstreet: getType('street', item),\n\t\t\t\t\t\tnumber: getType('number', item),\n\t\t\t\t\t\tlocality: getType('locality', item),\n\t\t\t\t\t\tpostalCode: getType('postalCode', item),\n\t\t\t\t\t\tcity: getType('city', item),\n\t\t\t\t\t\tprovince: getType('province', item),\n\t\t\t\t\t\tregion: getType('region', item),\n\t\t\t\t\t\tcountry: getType('country', item),\n\t\t\t\t\t\tposition: {\n\t\t\t\t\t\t\tlng: item.geometry.location.lng(),\n\t\t\t\t\t\t\tlat: item.geometry.location.lat(),\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t}\n\t\t\tconsole.log('googleMaps.parse', results, items);\n\t\t\treturn items;\n\t\t}\n\n    }]);\n    */\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.service('MapBox', ['$q', '$http', '$promise', '$once', 'environment', function($q, $http, $promise, $once, environment) {\n\n        var service = this;\n\n        var statics = {\n            get: MapBoxGet,\n        };\n\n        angular.extend(service, statics);\n\n        if (!environment.addons.mapbox) {\n            trhow('MapBox.error missing config object in environment.addons.mapbox');\n        }\n\n        var config = environment.addons.mapbox;\n\n        function MapBoxGet() {\n            return $promise(function(promise) {\n                if (window.mapboxgl) {\n                    promise.resolve(window.mapboxgl);\n                } else {\n                    $promise.all([\n                        $once.script('//api.tiles.mapbox.com/mapbox-gl-js/' + config.version + '/mapbox-gl.js'),\n                        $once.link('//api.tiles.mapbox.com/mapbox-gl-js/' + config.version + '/mapbox-gl.css'),\n                    ]).then(function() {\n                        window.mapboxgl.accessToken = config.accessToken;\n                        promise.resolve(window.mapboxgl);\n                    }, function(error) {\n                        promise.reject(error);\n                    });\n                }\n            });\n        }\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.provider('environment', ['$locationProvider', '$httpProvider', function ($locationProvider, $httpProvider) {\n\n\t\tvar provider = this;\n\n\t\tvar statics = {\n\t\t\tadd: EnvironmentAdd,\n\t\t\tuse: EnvironmentUse,\n\t\t};\n\n\t\tangular.extend(provider, statics);\n\n\t\tvar defaults = {\n\t\t\taddons: {\n\t\t\t\tfacebook: {\n\t\t\t\t\tfields: 'id,name,first_name,last_name,email,gender,picture,cover,link',\n\t\t\t\t\tscope: 'public_profile, email', // publish_stream\n\t\t\t\t\tversion: 'v2.10',\n\t\t\t\t},\n\t\t\t\tgooglemaps: {\n\t\t\t\t\tclusterer: true,\n\t\t\t\t\tstyles: '/googlemaps/applemapesque.json',\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tcenter: {\n\t\t\t\t\t\t\tlat: 43.9023386,\n\t\t\t\t\t\t\tlng: 12.8505094\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdisableDefaultUI: true,\n\t\t\t\t\t\tmapTypeId: 'roadmap', // \"hybrid\", \"roadmap\", \"satellite\", \"terrain\"\n\t\t\t\t\t\tscrollwheel: true,\n\t\t\t\t\t\t// tilt: 0, // 45\n\t\t\t\t\t\tzoom: 4.0,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tmapbox: {\n\t\t\t\t\tclusterer: true,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tbearing: 0.0,\n\t\t\t\t\t\tcenter: [\n\t\t\t\t\t\t\t12.8505094,\n\t\t\t\t\t\t\t43.9023386\n\t\t\t\t\t\t],\n\t\t\t\t\t\tcurve: 1,\n\t\t\t\t\t\tpitch: 0.0,\n\t\t\t\t\t\tspeed: 1.5,\n\t\t\t\t\t\tzoom: 4.0,\n\t\t\t\t\t},\n\t\t\t\t\tversion: 'v0.42.0',\n\t\t\t\t}\n\t\t\t},\n\t\t\thttp: {\n\t\t\t\tinterceptors: [], // ['AuthInterceptorService'],\n\t\t\t\twithCredentials: false,\n\t\t\t},\n\t\t\tlanguage: {\n\t\t\t\tcode: 'en',\n\t\t\t\tculture: 'en_US',\n\t\t\t\tiso: 'ENU',\n\t\t\t\tname: 'English',\n\t\t\t},\n\t\t\tlocation: {\n\t\t\t\thash: '!',\n\t\t\t\thtml5: false,\n\t\t\t},\n\t\t\tpaths: {},\n\t\t};\n\n\t\tvar global = {};\n\n\t\tif (window.environment) {\n\t\t\tangular.merge(global, window.environment);\n\t\t}\n\n\t\tvar config = {};\n\n\t\tvar environment = angular.copy(defaults);\n\t\tangular.merge(environment, global);\n\n\t\tfunction EnvironmentSetHttp() {\n\t\t\t$httpProvider.defaults.headers.common[\"Accept-Language\"] = environment.language.code;\n\t\t\t$httpProvider.defaults.withCredentials = environment.http.withCredentials;\n\t\t\t$httpProvider.interceptors.push.apply($httpProvider.interceptors, environment.http.interceptors);\n\t\t}\n\n\t\tfunction EnvironmentSetLocation() {\n\t\t\t$locationProvider.html5Mode(environment.location.html5);\n\t\t\t$locationProvider.hashPrefix(environment.location.hash);\n\t\t}\n\n\t\tfunction EnvironmentAdd(key, data) {\n\t\t\tconfig[key] = config[key] ? angular.merge(config[key], data) : data;\n\t\t\tEnvironmentSet();\n\t\t}\n\n\t\tfunction EnvironmentSet() {\n\t\t\tenvironment = angular.copy(defaults);\n\t\t\tif (config.environment) {\n\t\t\t\tangular.merge(environment, config.environment);\n\t\t\t}\n\t\t\tvar value = EnvironmentGet();\n\t\t\tif (value) {\n\t\t\t\tangular.merge(environment, value);\n\t\t\t}\n\t\t\tangular.merge(environment, global);\n\t\t\tEnvironmentSetHttp();\n\t\t\tEnvironmentSetLocation();\n\t\t}\n\n\t\tfunction EnvironmentUse(key) {\n\t\t\tif (config[key]) {\n\t\t\t\tenvironment = angular.copy(defaults);\n\t\t\t\tangular.merge(environment, config[key]);\n\t\t\t\tangular.merge(environment, global);\n\t\t\t\tEnvironmentSetHttp();\n\t\t\t\tEnvironmentSetLocation();\n\t\t\t}\n\t\t}\n\n\t\tfunction EnvironmentGet() {\n\t\t\tfor (var key in config) {\n\t\t\t\tvar value = config[key];\n\t\t\t\tif (value.paths && window.location.href.indexOf(value.paths.app) !== -1) {\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprovider.$get = function () {\n\t\t\treturn environment;\n\t\t};\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Animate', [function () {\n\n\t\tfunction Animate(callback) {\n\t\t\tthis.callback = callback;\n\t\t\tthis.key = null;\n\t\t\tthis.ticks = 0;\n\t\t}\n\n\t\tvar statics = {};\n\n\t\tvar publics = {\n\t\t\tpause: pause,\n\t\t\tplay: play,\n\t\t\ttoggle: toggle,\n\t\t};\n\n\t\tangular.extend(Animate, statics);\n\t\tangular.extend(Animate.prototype, publics);\n\n\t\treturn Animate;\n\n\t\t// static methods\n\n\t\t// prototype methods\n\n\t\tfunction pause() {\n\t\t\tvar animate = this;\n\t\t\tif (animate.key) {\n\t\t\t\twindow.cancelAnimationFrame(animate.key);\n\t\t\t\tanimate.key = null;\n\t\t\t}\n\t\t}\n\n\t\tfunction play() {\n\t\t\tvar animate = this;\n\n\t\t\tfunction loop(time) {\n\t\t\t\tanimate.ticks++;\n\t\t\t\tanimate.callback(time, animate.ticks);\n\t\t\t\tanimate.key = window.requestAnimationFrame(loop);\n\t\t\t}\n\t\t\tif (!animate.key) {\n\t\t\t\tloop();\n\t\t\t}\n\t\t}\n\n\t\tfunction toggle() {\n\t\t\tvar animate = this;\n\t\t\tif (animate.key) {\n\t\t\t\tanimate.pause();\n\t\t\t} else {\n\t\t\t\tanimate.play();\n\t\t\t}\n\t\t}\n\n    }]);\n\n\t(function () {\n\t\tvar lastTime = 0;\n\t\tvar vendors = ['ms', 'moz', 'webkit', 'o'];\n\t\tfor (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n\t\t\twindow.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\n\t\t\twindow.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] ||\n\t\t\t\twindow[vendors[x] + 'CancelRequestAnimationFrame'];\n\t\t}\n\t\tif (!window.requestAnimationFrame) {\n\t\t\twindow.requestAnimationFrame = function (callback, element) {\n\t\t\t\tvar currTime = new Date().getTime();\n\t\t\t\tvar timeToCall = Math.max(0, 16 - (currTime - lastTime));\n\t\t\t\tvar id = window.setTimeout(function () {\n\t\t\t\t\tcallback(currTime + timeToCall);\n\t\t\t\t}, timeToCall);\n\t\t\t\tlastTime = currTime + timeToCall;\n\t\t\t\treturn id;\n\t\t\t};\n\t\t}\n\t\tif (!window.cancelAnimationFrame) {\n\t\t\twindow.cancelAnimationFrame = function (id) {\n\t\t\t\tclearTimeout(id);\n\t\t\t};\n\t\t}\n\t}());\n\n}());\n/*\n// handle transition on resizing\nvar resizingTimeout;\n$(window).on('resize', function () {\n    clearTimeout(resizingTimeout);\n    $('body').addClass('resizing');\n    resizingTimeout = setTimeout(function () {\n        $('body').removeClass('resizing');\n    }, 100);\n})\n*/\n\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.service('Dom', ['Point', 'Rect', function (Point, Rect) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\tgetBoundRect: getBoundRect,\n\t\t\tgetClosest: getClosest,\n\t\t\tgetClosestNode: getClosestNode,\n\t\t\tgetDelta: getDelta,\n\t\t\tgetDocumentNode: getDocumentNode,\n\t\t\tgetElement: getElement,\n\t\t\tgetNode: getNode,\n\t\t\tgetNodeOffset: getNodeOffset,\n\t\t\tgetPageScroll: getPageScroll,\n\t\t\tgetParents: getParents,\n\t\t\tgetView: getView,\n\t\t\tgetPointInView: getPointInView,\n\t\t\tcompileController: compileController,\n\t\t\tdownloadFile: downloadFile,\n\t\t\tua: getUA(),\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\t// return node element BoundingClientRect\n\t\tfunction getBoundRect(node) {\n\t\t\tnode = getNode(node);\n\t\t\tif (node === window) {\n\t\t\t\tnode = getDocumentNode();\n\t\t\t}\n\t\t\tvar rect = node.getBoundingClientRect();\n\t\t\treturn rect;\n\t\t}\n\n\t\t// return closest parent node that match a selector\n\t\tfunction getClosest(node, selector) {\n\t\t\tvar matchesFn, parent;\n            ['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector', 'oMatchesSelector'].some(function (fn) {\n\t\t\t\tif (typeof document.body[fn] == 'function') {\n\t\t\t\t\tmatchesFn = fn;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t\tif (node[matchesFn](selector)) {\n\t\t\t\treturn node;\n\t\t\t}\n\t\t\twhile (node !== null) {\n\t\t\t\tparent = node.parentElement;\n\t\t\t\tif (parent !== null && parent[matchesFn](selector)) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tnode = parent;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\t// return closest parent node that math a target node\n\t\tfunction getClosestNode(node, target) {\n\t\t\tvar parent = null;\n\t\t\tif (node === target) {\n\t\t\t\treturn node;\n\t\t\t}\n\t\t\twhile (node !== null) {\n\t\t\t\tparent = node.parentElement;\n\t\t\t\tif (parent !== null && parent === target) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tnode = parent;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\t// return wheel delta\n\t\tfunction getDelta(event) {\n\t\t\tvar original = event.originalEvent ? event.originalEvent : event;\n\t\t\tvar type = original.type;\n\t\t\tvar delta = null;\n\t\t\tif (type === 'wheel' || type === 'mousewheel' || type === 'DOMMouseScroll') {\n\t\t\t\tvar deltaX = original.deltaX || original.wheelDeltaX;\n\t\t\t\tvar deltaY = original.deltaY || original.wheelDeltaY;\n\t\t\t\tdelta = new Point(deltaX, deltaY);\n\t\t\t\tif (Math.abs(deltaX) > Math.abs(deltaY)) {\n\t\t\t\t\tdelta.dir = deltaX < 0 ? 1 : -1;\n\t\t\t\t} else {\n\t\t\t\t\tdelta.dir = deltaY < 0 ? 1 : -1;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn delta;\n\t\t}\n\n\t\t// return document element node\n\t\tfunction getDocumentNode() {\n\t\t\tvar documentNode = (document.documentElement || document.body.parentNode || document.body);\n\t\t\treturn documentNode;\n\t\t}\n\n\t\t// return an angular element\n\t\tfunction getElement(element) {\n\t\t\treturn angular.isArray(element) ? element : angular.element(element);\n\t\t}\n\n\t\t// return a native html node\n\t\tfunction getNode(element) {\n\t\t\treturn angular.isArray(element) ? element[0] : element;\n\t\t}\n\n\t\t// return a node offset point\n\t\tfunction getNodeOffset(node) {\n\t\t\tvar offset = new Point();\n\t\t\tnode = getNode(node);\n\t\t\tif (node && node.nodeType === 1) {\n\t\t\t\toffset.x = node.offsetLeft;\n\t\t\t\toffset.y = node.offsetTop;\n\t\t\t}\n\t\t\treturn offset;\n\t\t}\n\n\t\t// return the current page scroll\n\t\tfunction getPageScroll() {\n\t\t\tvar scroll = new Point();\n\t\t\tvar documentNode = getDocumentNode();\n\t\t\tscroll.x = window.pageXOffset || documentNode.scrollLeft;\n\t\t\tscroll.y = window.pageYOffset || documentNode.scrollTop;\n\t\t\treturn scroll;\n\t\t}\n\n\t\t// return an array of node parants\n\t\tfunction getParents(node, topParentNode) {\n\t\t\t// if no topParentNode defined will bubble up all the way to *document*\n\t\t\ttopParentNode = topParentNode || getDocumentNode();\n\t\t\tvar parents = [];\n\t\t\tif (node) {\n\t\t\t\tparents.push(node);\n\t\t\t\tvar parentNode = node.parentNode;\n\t\t\t\twhile (parentNode && parentNode !== topParentNode) {\n\t\t\t\t\tparents.push(parentNode);\n\t\t\t\t\tparentNode = parentNode.parentNode;\n\t\t\t\t}\n\t\t\t\tparents.push(topParentNode); // push that topParentNode you wanted to stop at\n\t\t\t}\n\t\t\tparents.each = function (callback) {\n\t\t\t\tthis.filter(function (node) {\n\t\t\t\t\tif (callback) {\n\t\t\t\t\t\tcallback(angular.element(node), node);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn parents;\n\t\t}\n\n\t\t// return the view rect\n\t\tfunction getView() {\n\t\t\tvar view = new Rect();\n\t\t\tif (window.innerWidth !== undefined) {\n\t\t\t\tview.width = window.innerWidth;\n\t\t\t\tview.height = window.innerHeight;\n\t\t\t} else {\n\t\t\t\tvar documentNode = getDocumentNode();\n\t\t\t\tview.width = documentNode.clientWidth;\n\t\t\t\tview.height = documentNode.clientHeight;\n\t\t\t}\n\t\t\treturn view;\n\t\t}\n\n\t\t// add to constant\n\t\tvar MOUSE_EVENTS = ['click', 'mousedown', 'mouseup', 'mousemove', 'mouseover', 'mouseout', 'mouseenter', 'mouseleave', 'contextmenu'];\n\t\tvar TOUCH_EVENTS = ['touchstart', 'touchmove', 'touchend', 'touchcancel'];\n\n\t\tfunction getPointInView(event) {\n\t\t\tvar original = event.originalEvent ? event.originalEvent : event;\n\t\t\tvar type = original.type;\n\t\t\tvar point = null;\n\t\t\tif (TOUCH_EVENTS.indexOf(type) !== -1) {\n\t\t\t\tvar touch = null;\n\t\t\t\tvar touches = original.touches.length ? original.touches : original.changedTouches;\n\t\t\t\tif (touches && touches.length) {\n\t\t\t\t\ttouch = touches[0];\n\t\t\t\t}\n\t\t\t\tif (touch) {\n\t\t\t\t\tpoint = new Point();\n\t\t\t\t\tpoint.x = touch.pageX;\n\t\t\t\t\tpoint.y = touch.pageY;\n\t\t\t\t}\n\t\t\t} else if (MOUSE_EVENTS.indexOf(type) !== -1) {\n\t\t\t\tpoint = new Point();\n\t\t\t\tpoint.x = original.pageX;\n\t\t\t\tpoint.y = original.pageY;\n\t\t\t}\n\t\t\treturn point;\n\t\t}\n\n\t\tfunction getUA() {\n\t\t\tvar agent = window.navigator.userAgent.toLowerCase();\n\t\t\tvar safari = agent.indexOf('safari') !== -1 && agent.indexOf('chrome') === -1;\n\t\t\tvar msie = agent.indexOf('trident') !== -1 || agent.indexOf('edge') !== -1 || agent.indexOf('msie') !== -1;\n\t\t\tvar chrome = !safari && !msie && agent.indexOf('chrome') !== -1;\n\t\t\tvar mobile = agent.indexOf('mobile') !== -1;\n\t\t\tvar mac = agent.indexOf('macintosh') !== -1;\n\t\t\tvar ua = {\n\t\t\t\tagent: agent,\n\t\t\t\tsafari: safari,\n\t\t\t\tmsie: msie,\n\t\t\t\tchrome: chrome,\n\t\t\t\tmobile: mobile,\n\t\t\t\tmac: mac,\n\t\t\t};\n\t\t\tangular.forEach(ua, function (value, key) {\n\t\t\t\tif (value) {\n\t\t\t\t\tangular.element(document.getElementsByTagName('body')).addClass(key);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ua;\n\t\t}\n\n\t\t/*\n    function mobilecheck() {\n        var check = false;\n        (function(a) { if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4))) check = true; })(navigator.userAgent || navigator.vendor || window.opera);\n        return check;\n    }\n\n    // For those wishing to include tablets in this test (though arguably, you shouldn't), you can use the following function:\n    function mobileAndTabletcheck() {\n        var check = false;\n        (function(a) { if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4))) check = true; })(navigator.userAgent || navigator.vendor || window.opera);\n        return check;\n    }\n\n    var isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n    var isMobile = mobilecheck();\n    var isMobileAndTabled = mobileAndTabletcheck();\n\t\t*/\n\n\t\tfunction compileController(scope, element, html, data) {\n\t\t\t// console.log('Dom.compileController', element);\n\t\t\telement = getElement(element);\n\t\t\telement.html(html);\n\t\t\tvar link = $compile(element.contents());\n\t\t\tif (data.controller) {\n\t\t\t\tvar $scope = scope.$new();\n\t\t\t\tangular.extend($scope, data);\n\t\t\t\tvar controller = $controller(data.controller, {\n\t\t\t\t\t$scope: $scope\n\t\t\t\t});\n\t\t\t\tif (data.controllerAs) {\n\t\t\t\t\tscope[data.controllerAs] = controller;\n\t\t\t\t}\n\t\t\t\telement.data('$ngControllerController', controller);\n\t\t\t\telement.children().data('$ngControllerController', controller);\n\t\t\t\tscope = $scope;\n\t\t\t}\n\t\t\tlink(scope);\n\t\t}\n\n\t\tfunction downloadFile(content, name, type) {\n\t\t\ttype = type || 'application/octet-stream';\n\t\t\tvar base64 = null;\n\t\t\tvar blob = new Blob([content], {\n\t\t\t\ttype: type\n\t\t\t});\n\t\t\tvar reader = new window.FileReader();\n\t\t\treader.readAsDataURL(blob);\n\t\t\treader.onloadend = function () {\n\t\t\t\tbase64 = reader.result;\n\t\t\t\tdownload();\n\t\t\t};\n\n\t\t\tfunction download() {\n\t\t\t\tif (document.createEvent) {\n\t\t\t\t\tvar anchor = document.createElement('a');\n\t\t\t\t\tanchor.href = base64;\n\t\t\t\t\tif (anchor.download !== undefined) {\n\t\t\t\t\t\tvar downloadName = name || base64.substring(base64.lastIndexOf('/') + 1, base64.length);\n\t\t\t\t\t\tanchor.download = downloadName;\n\t\t\t\t\t}\n\t\t\t\t\tvar event = document.createEvent('MouseEvents');\n\t\t\t\t\tevent.initEvent('click', true, true);\n\t\t\t\t\tanchor.dispatchEvent(event);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tvar query = '?download';\n\t\t\t\twindow.open(base64.indexOf('?') > -1 ? base64 : base64 + query, '_self');\n\t\t\t}\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Event', ['EventsService', 'Dom', 'Point', 'Rect', function (EventsService, Dom, Point, Rect) {\n\n\t\tfunction Event(event, element) {\n\t\t\ttry {\n\t\t\t\tevent = event || window.event;\n\t\t\t\tvar type = event.type;\n\t\t\t\tvar originalEvent = event.originalEvent ? event.originalEvent : event;\n\t\t\t\tvar node = element[0]; // Dom.getNode(element);\n\t\t\t\tvar offset = Dom.getNodeOffset(node);\n\t\t\t\tvar rect = Dom.getBoundRect(node);\n\t\t\t\tvar view = Dom.getView();\n\t\t\t\tvar scroll = Dom.getPageScroll();\n\t\t\t\tvar point = Dom.getPointInView(event);\n\t\t\t\tif (point) {\n\t\t\t\t\tvar absolute = new Point(point.x - scroll.x, point.y - scroll.y);\n\t\t\t\t\tvar relative = new Point(absolute.x - rect.left, absolute.y - rect.top);\n\t\t\t\t\tthis.point = point;\n\t\t\t\t\tthis.absolute = absolute;\n\t\t\t\t\tthis.relative = relative;\n\t\t\t\t}\n\t\t\t\tvar delta = Dom.getDelta(event);\n\t\t\t\tif (delta) {\n\t\t\t\t\tthis.delta = delta;\n\t\t\t\t\tthis.dir = delta.dir;\n\t\t\t\t}\n\t\t\t\tthis.event = event;\n\t\t\t\tthis.type = type;\n\t\t\t\tthis.originalEvent = originalEvent;\n\t\t\t\tthis.element = element;\n\t\t\t\tthis.node = node;\n\t\t\t\tthis.offset = offset;\n\t\t\t\tthis.rect = rect;\n\t\t\t\tthis.view = view;\n\t\t\t\tthis.scroll = scroll;\n\t\t\t\tthis.timestamp = new Date().getTime();\n\t\t\t} catch (error) {\n\t\t\t\tconsole.log('Event.error', error);\n\t\t\t}\n\t\t}\n\n\t\tvar statics = {};\n\n\t\tvar publics = {\n\t\t\tstop: stop,\n\t\t};\n\n\t\tangular.extend(Event, statics);\n\t\tangular.extend(Event.prototype, publics);\n\t\treturn Event;\n\n\t\t// prototype methods\n\n\t\tfunction stop() {\n\t\t\tthis.event.stopPropagation();\n\t\t\tthis.event.preventDefault();\n\t\t}\n\n\t}]);\n\n\tapp.factory('Events', ['EventsService', 'Event', 'Dom', function (EventsService, Event, Dom) {\n\n\t\tfunction Events(element) {\n\t\t\tvar events = this;\n\n\t\t\tthis.element = Dom.getElement(element);\n\t\t\tthis.listeners = {};\n\t\t\tthis.standardEvents = {\n\t\t\t\tclick: {\n\t\t\t\t\tkey: 'click',\n\t\t\t\t\tcallback: onClick\n\t\t\t\t},\n\t\t\t\tdown: {\n\t\t\t\t\tkey: 'mousedown',\n\t\t\t\t\tcallback: onMouseDown\n\t\t\t\t},\n\t\t\t\tmove: {\n\t\t\t\t\tkey: 'mousemove',\n\t\t\t\t\tcallback: onMouseMove\n\t\t\t\t},\n\t\t\t\tup: {\n\t\t\t\t\tkey: 'mouseup',\n\t\t\t\t\tcallback: onMouseUp\n\t\t\t\t},\n\t\t\t\tresize: {\n\t\t\t\t\tkey: 'resize',\n\t\t\t\t\tcallback: onResize\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.touchEvents = {\n\t\t\t\tdown: {\n\t\t\t\t\tkey: 'touchstart',\n\t\t\t\t\tcallback: onTouchStart\n\t\t\t\t},\n\t\t\t\tmove: {\n\t\t\t\t\tkey: 'touchmove',\n\t\t\t\t\tcallback: onTouchMove\n\t\t\t\t},\n\t\t\t\tup: {\n\t\t\t\t\tkey: 'touchend',\n\t\t\t\t\tcallback: onTouchEnd\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.wheelEvents = {\n\t\t\t\twheel: {\n\t\t\t\t\tkey: 'mousewheel',\n\t\t\t\t\tcallback: onMouseWheel\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.scrollEvents = {\n\t\t\t\twheel: {\n\t\t\t\t\tkey: 'DOMMouseScroll',\n\t\t\t\t\tcallback: onMouseScroll\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.timestamp = new Date().getTime();\n\t\t\tthis.setTimestamp = setTimestamp;\n\n\t\t\tfunction setTimestamp(event) {\n\t\t\t\tif (event) {\n\t\t\t\t\tevent.interval = Math.min(250, event.timestamp - events.timestamp);\n\t\t\t\t\t// console.log(event.interval, event.timestamp, events.timestamp);\n\t\t\t\t}\n\t\t\t\tevents.timestamp = new Date().getTime();\n\t\t\t}\n\n\t\t\tfunction onClick(e) {\n\t\t\t\t// console.log('onClick', e, events);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.click.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onMouseDown(e) {\n\t\t\t\t// console.log('onMouseDown', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.down.apply(this, [event]);\n\t\t\t\tevents.removeTouchEvents();\n\t\t\t}\n\n\t\t\tfunction onMouseMove(e) {\n\t\t\t\t// console.log('onMouseMove', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.move.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onMouseUp(e) {\n\t\t\t\t// console.log('onMouseUp', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.up.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onMouseWheel(e) {\n\t\t\t\t// console.log('onMouseWheel', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.wheel.apply(this, [event]);\n\t\t\t\tevents.removeScrollEvents();\n\t\t\t}\n\n\t\t\tfunction onMouseScroll(e) {\n\t\t\t\t// console.log('onMouseScroll', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.wheel.apply(this, [event]);\n\t\t\t\tevents.removeWheelEvents();\n\t\t\t}\n\n\t\t\tfunction onResize(e) {\n\t\t\t\t// console.log('onResize', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.resize.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onTouchStart(e) {\n\t\t\t\t// console.log('onTouchStart', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.down.apply(this, [event]);\n\t\t\t\tevents.removeStandardEvents();\n\t\t\t}\n\n\t\t\tfunction onTouchMove(e) {\n\t\t\t\t// console.log('onTouchMove', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.move.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onTouchEnd(e) {\n\t\t\t\t// console.log('onTouchEnd', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.up.apply(this, [event]);\n\t\t\t}\n\t\t}\n\n\t\tvar statics = {\n\t\t\tgetTouch: getTouch,\n\t\t\tgetRelativeTouch: getRelativeTouch,\n\t\t};\n\n\t\tvar publics = {\n\t\t\tadd: add,\n\t\t\tremove: remove,\n\t\t\tremoveStandardEvents: removeStandardEvents,\n\t\t\tremoveTouchEvents: removeTouchEvents,\n\t\t\tremoveWheelEvents: removeWheelEvents,\n\t\t\tremoveScrollEvents: removeScrollEvents,\n\t\t};\n\n\t\tangular.extend(Events, statics);\n\t\tangular.extend(Events.prototype, publics);\n\t\treturn Events;\n\n\t\t// prototype methods\n\n\t\tfunction add(listeners, scope) {\n\t\t\tvar events = this,\n\t\t\t\tstandard = this.standardEvents,\n\t\t\t\ttouch = this.touchEvents,\n\t\t\t\twheel = this.wheelEvents,\n\t\t\t\tscroll = this.scrollEvents;\n\t\t\tvar element = this.element,\n\t\t\t\twindowElement = angular.element(window);\n\n\t\t\tangular.forEach(listeners, function (callback, key) {\n\t\t\t\tif (events.listeners[key]) {\n\t\t\t\t\tvar listener = {};\n\t\t\t\t\tlistener[key] = events.listeners[key];\n\t\t\t\t\tremove(listener);\n\t\t\t\t}\n\t\t\t\tevents.listeners[key] = callback;\n\t\t\t\tif (standard[key]) {\n\t\t\t\t\tif (key === 'resize') {\n\t\t\t\t\t\twindowElement.on(standard[key].key, standard[key].callback);\n\t\t\t\t\t} else {\n\t\t\t\t\t\telement.on(standard[key].key, standard[key].callback);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (touch[key]) {\n\t\t\t\t\telement.on(touch[key].key, touch[key].callback);\n\t\t\t\t}\n\t\t\t\tif (wheel[key]) {\n\t\t\t\t\telement.on(wheel[key].key, wheel[key].callback);\n\t\t\t\t}\n\t\t\t\tif (scroll[key]) {\n\t\t\t\t\telement.on(scroll[key].key, scroll[key].callback);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (scope) {\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tevents.remove(listeners);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn events;\n\t\t}\n\n\t\tfunction remove(listeners) {\n\t\t\tvar events = this,\n\t\t\t\tstandard = this.standardEvents,\n\t\t\t\ttouch = this.touchEvents,\n\t\t\t\twheel = this.wheelEvents,\n\t\t\t\tscroll = this.scrollEvents;\n\t\t\tvar element = this.element,\n\t\t\t\twindowElement = angular.element(window);\n\t\t\tangular.forEach(listeners, function (callback, key) {\n\t\t\t\tif (standard[key]) {\n\t\t\t\t\tif (key === 'resize') {\n\t\t\t\t\t\twindowElement.off(standard[key].key, standard[key].callback);\n\t\t\t\t\t} else {\n\t\t\t\t\t\telement.off(standard[key].key, standard[key].callback);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (touch[key]) {\n\t\t\t\t\telement.off(touch[key].key, touch[key].callback);\n\t\t\t\t}\n\t\t\t\tif (wheel[key]) {\n\t\t\t\t\telement.off(wheel[key].key, wheel[key].callback);\n\t\t\t\t}\n\t\t\t\tif (scroll[key]) {\n\t\t\t\t\telement.off(scroll[key].key, scroll[key].callback);\n\t\t\t\t}\n\t\t\t\tevents.listeners[key] = null;\n\t\t\t});\n\t\t\treturn events;\n\t\t}\n\n\t\tfunction removeStandardEvents() {\n\t\t\tvar events = this,\n\t\t\t\tstandard = events.standardEvents,\n\t\t\t\ttouch = events.touchEvents;\n\t\t\tvar element = events.element;\n\t\t\telement.off('mousedown', standard.down.callback);\n\t\t\telement.off('mousemove', standard.move.callback);\n\t\t\telement.off('mouseup', standard.up.callback);\n\t\t}\n\n\t\tfunction removeTouchEvents() {\n\t\t\tvar events = this,\n\t\t\t\tstandard = events.standardEvents,\n\t\t\t\ttouch = events.touchEvents;\n\t\t\tvar element = events.element;\n\t\t\telement.off('touchstart', touch.down.callback);\n\t\t\telement.off('touchmove', touch.move.callback);\n\t\t\telement.off('touchend', touch.up.callback);\n\t\t}\n\n\t\tfunction removeWheelEvents() {\n\t\t\tvar events = this;\n\t\t\tvar element = events.element;\n\t\t\telement.off('mousewheel', events.mouseEvents.wheel.callback);\n\t\t}\n\n\t\tfunction removeScrollEvents() {\n\t\t\tvar events = this;\n\t\t\tvar element = events.element;\n\t\t\telement.off('DOMMouseScroll', events.scrollEvents.wheel.callback);\n\t\t}\n\n\t\t// statics methods\n\n\t\tfunction getTouch(e, previous) {\n\t\t\tvar point = new Point();\n\t\t\tif (e.type === 'touchstart' || e.type === 'touchmove' || e.type === 'touchend' || e.type === 'touchcancel') {\n\t\t\t\tvar touch = null;\n\t\t\t\tvar event = e.originalEvent ? e.originalEvent : e;\n\t\t\t\tvar touches = event.touches.length ? event.touches : event.changedTouches;\n\t\t\t\tif (touches && touches.length) {\n\t\t\t\t\ttouch = touches[0];\n\t\t\t\t}\n\t\t\t\tif (touch) {\n\t\t\t\t\tpoint.x = touch.pageX;\n\t\t\t\t\tpoint.y = touch.pageY;\n\t\t\t\t}\n\t\t\t} else if (e.type === 'click' || e.type === 'mousedown' || e.type === 'mouseup' || e.type === 'mousemove' || e.type === 'mouseover' || e.type === 'mouseout' || e.type === 'mouseenter' || e.type === 'mouseleave' || e.type === 'contextmenu') {\n\t\t\t\tpoint.x = e.pageX;\n\t\t\t\tpoint.y = e.pageY;\n\t\t\t}\n\t\t\tif (previous) {\n\t\t\t\tpoint.s = Point.difference(t, previous);\n\t\t\t}\n\t\t\tpoint.type = e.type;\n\t\t\treturn point;\n\t\t}\n\n\t\tfunction getRelativeTouch(node, point) {\n\t\t\tnode = angular.isArray(node) ? node[0] : node;\n\t\t\treturn Point.difference(point, {\n\t\t\t\tx: node.offsetLeft,\n\t\t\t\ty: node.offsetTop\n\t\t\t});\n\t\t}\n\n    }]);\n\n\tapp.service('EventsService', ['Dom', function (Dom) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\thasPassiveEvents: hasPassiveEvents,\n\t\t\taddEventListener: getAddEventListener(),\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\t// prevent history back on mac os\n\n\t\tpreventHistoryNavigation();\n\n\t\t// static methods\n\n\t\tfunction hasPassiveEvents() {\n\t\t\tvar supported = false;\n\t\t\tif (window.addEventListener) {\n\t\t\t\ttry {\n\t\t\t\t\tvar options = Object.defineProperty({}, 'passive', {\n\t\t\t\t\t\tget: function () {\n\t\t\t\t\t\t\tsupported = true;\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\twindow.addEventListener('test', null, options);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log('getAddEventListener.isSupprted', e);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn supported;\n\t\t}\n\n\t\tfunction getAddEventListener() {\n\t\t\tvar supported = hasPassiveEvents();\n\t\t\tif (!supported) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar defaults = {\n\t\t\t\tpassive: false,\n\t\t\t\tcapture: false,\n\t\t\t};\n\n\t\t\tfunction getModifiedAddEventListener(original) {\n\t\t\t\tfunction addEventListener(type, listener, options) {\n\t\t\t\t\tif (typeof options !== 'object') {\n\t\t\t\t\t\tvar capture = options === true;\n\t\t\t\t\t\toptions = angular.copy(defaults);\n\t\t\t\t\t\toptions.capture = capture;\n\t\t\t\t\t} else {\n\t\t\t\t\t\toptions = angular.extend(angular.copy(defaults), options);\n\t\t\t\t\t}\n\t\t\t\t\toriginal.call(this, type, listener, options);\n\t\t\t\t}\n\t\t\t\treturn addEventListener;\n\t\t\t}\n\n\t\t\tvar original = EventTarget.prototype.addEventListener;\n\t\t\tvar modified = getModifiedAddEventListener(original);\n\t\t\tEventTarget.prototype.addEventListener = modified;\n\t\t\treturn modified;\n\t\t}\n\n\t\tfunction preventHistoryNavigation() {\n\t\t\tif (!Dom.ua.mac) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (Dom.ua.chrome || Dom.ua.safari || Dom.ua.firefox) {\n\t\t\t\twindow.addEventListener('mousewheel', onScroll, {\n\t\t\t\t\tpassive: false\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction onScroll(e) {\n\t\t\t\tif (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\t(e.deltaX < 0 && (Dom.getParents(e.target).filter(function (node) {\n\t\t\t\t\t\treturn node.scrollLeft > 0;\n\t\t\t\t\t}).length === 0)) ||\n\t\t\t\t\t(e.deltaX > 0 && (Dom.getParents(e.target).filter(function (node) {\n\t\t\t\t\t\treturn node.scrollWidth - node.scrollLeft > node.clientWidth;\n\t\t\t\t\t}).length === 0))\n\t\t\t\t) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n    }]);\n\n}());\n/* global angular, app, Autolinker */\r\n(function () {\r\n\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.filter('notIn', ['$filter', function ($filter) {\r\n\r\n\t\treturn function (array, filters, element) {\r\n\t\t\tif (filters) {\r\n\t\t\t\treturn $filter(\"filter\")(array, function (item) {\r\n\t\t\t\t\tfor (var i = 0; i < filters.length; i++) {\r\n\t\t\t\t\t\tif (filters[i][element] === item[element]) return false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\r\n    }]);\r\n\r\n}());\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Point', [function () {\n\n\t\tfunction Point(x, y) {\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\t\t}\n\n\t\tvar statics = {\n\t\t\tdifference: PointDifference,\n\t\t\tmultiply: PointMultiply,\n\t\t};\n\n\t\tvar publics = {\n\t\t\tclone: clone,\n\t\t\tcopy: copy,\n\t\t\tdifference: difference,\n\t\t\tmult: mult,\n\t\t\toffset: offset,\n\t\t\tsetPos: setPos,\n\t\t\tsetX: setX,\n\t\t\tsetY: setY,\n\t\t\ttoString: toString,\n\t\t};\n\n\t\tangular.extend(Point, statics);\n\t\tangular.extend(Point.prototype, publics);\n\n\t\treturn Point;\n\n\t\t// static methods\n\n\t\tfunction PointDifference(a, b) {\n\t\t\treturn new Point(a.x - b.x, a.y - b.y);\n\t\t}\n\n\t\tfunction PointMultiply(point, value) {\n\t\t\tpoint.x *= value;\n\t\t\tpoint.y *= value;\n\t\t\treturn point;\n\t\t}\n\n\t\t// prototype methods\n\n\t\tfunction clone() {\n\t\t\treturn new Point(this.x, this.y);\n\t\t}\n\n\t\tfunction copy(point) {\n\t\t\tthis.x = point.x;\n\t\t\tthis.y = point.y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction difference(b) {\n\t\t\treturn PointDifference(this, b);\n\t\t}\n\n\t\tfunction mult(value) {\n\t\t\treturn PointMultiply(this, value);\n\t\t}\n\n\t\tfunction offset(x, y) {\n\t\t\tthis.x += x;\n\t\t\tthis.y += y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setPos(x, y) {\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setX(x) {\n\t\t\tthis.x = x;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setY(y) {\n\t\t\tthis.y = y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction toString() {\n\t\t\treturn '{' + this.x + ',' + this.y + '}';\n\t\t}\n\n    }]);\n\n}());\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Rect', [function () {\n\n\t\tfunction Rect(x, y, w, h) {\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\t\t\tthis.w = w || 0;\n\t\t\tthis.h = h || 0;\n\t\t}\n\n\t\tvar statics = {\n\t\t\tmult: RectMultiply,\n\t\t};\n\n\t\tvar publics = {\n\t\t\tbottom: bottom,\n\t\t\tbottomLeft: bottomLeft,\n\t\t\tbottomRight: bottomRight,\n\t\t\tcenter: center,\n\t\t\tclone: clone,\n\t\t\tcopy: copy,\n\t\t\texpand: expand,\n\t\t\texpandRect: expandRect,\n\t\t\tintersect: intersect,\n\t\t\tleft: left,\n\t\t\tmult: mult,\n\t\t\toffset: offset,\n\t\t\treduce: reduce,\n\t\t\treduceRect: reduceRect,\n\t\t\tright: right,\n\t\t\tsetH: setH,\n\t\t\tsetPos: setPos,\n\t\t\tsetSize: setSize,\n\t\t\tsetX: setX,\n\t\t\tsetY: setY,\n\t\t\tsetW: setW,\n\t\t\ttop: top,\n\t\t\ttopLeft: topLeft,\n\t\t\ttopRight: topRight,\n\t\t\ttoString: toString,\n\t\t};\n\n\t\tangular.extend(Rect, statics);\n\t\tangular.extend(Rect.prototype, publics);\n\n\t\treturn Rect;\n\n\t\t// static methods\n\n\t\tfunction RectMultiply(rect, value) {\n\t\t\trect.x *= value;\n\t\t\trect.y *= value;\n\t\t\trect.w *= value;\n\t\t\trect.h *= value;\n\t\t\treturn rect;\n\t\t}\n\n\t\t// prototype methods\n\n\t\tfunction bottom() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w / 2,\n\t\t\t\ty: y + h\n\t\t\t};\n\t\t}\n\n\t\tfunction bottomLeft() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x,\n\t\t\t\ty: y + h\n\t\t\t};\n\t\t}\n\n\t\tfunction bottomRight() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w,\n\t\t\t\ty: y + h\n\t\t\t};\n\t\t}\n\n\t\tfunction center() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w / 2,\n\t\t\t\ty: y + h / 2\n\t\t\t};\n\t\t}\n\n\t\tfunction clone() {\n\t\t\treturn new Rect(this.x, this.y, this.w, this.h);\n\t\t}\n\n\t\tfunction copy(rect) {\n\t\t\tthis.x = rect.x;\n\t\t\tthis.y = rect.y;\n\t\t\tthis.w = rect.w;\n\t\t\tthis.h = rect.h;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction expand(size) {\n\t\t\treturn this.expandRect({\n\t\t\t\tx: size,\n\t\t\t\ty: size,\n\t\t\t\tw: size * 2,\n\t\t\t\th: size * 2\n\t\t\t});\n\t\t}\n\n\t\tfunction expandRect(rect) {\n\t\t\tthis.x -= rect.x || 0;\n\t\t\tthis.y -= rect.y || 0;\n\t\t\tthis.w += rect.w || 0;\n\t\t\tthis.h += rect.h || 0;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction intersect(rect) {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn !(rect.x > x + w || rect.x + rect.w < x || rect.y > y + h || rect.y + rect.h < y);\n\t\t}\n\n\t\tfunction left() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x,\n\t\t\t\ty: y + h / 2\n\t\t\t};\n\t\t}\n\n\t\tfunction mult(value) {\n\t\t\treturn RectMultiply(this, value);\n\t\t}\n\n\t\tfunction offset(x, y) {\n\t\t\tthis.x += x;\n\t\t\tthis.y += y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction reduce(size) {\n\t\t\treturn this.offset(-size);\n\t\t}\n\n\t\tfunction reduceRect(rect) {\n\t\t\treturn this.offsetRect(RectMultiply(rect, -1));\n\t\t}\n\n\t\tfunction right() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w,\n\t\t\t\ty: y + h / 2\n\t\t\t};\n\t\t}\n\n\t\tfunction setH(h) {\n\t\t\tthis.h = h;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setPos(x, y) {\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setSize(w, h) {\n\t\t\tthis.w = w;\n\t\t\tthis.h = h;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setX(x) {\n\t\t\tthis.x = x;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setY(y) {\n\t\t\tthis.y = y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setW(w) {\n\t\t\tthis.w = w;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction top() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w / 2,\n\t\t\t\ty: y\n\t\t\t};\n\t\t}\n\n\t\tfunction topLeft() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x,\n\t\t\t\ty: y\n\t\t\t};\n\t\t}\n\n\t\tfunction topRight() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w,\n\t\t\t\ty: y\n\t\t\t};\n\t\t}\n\n\t\tfunction toString() {\n\t\t\treturn '{' + this.x + ',' + this.y + ',' + this.w + ',' + this.h + '}';\n\t\t}\n\n    }]);\n\n}());\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Vector', function () {\n\t\tfunction Vector(x, y) {\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\t\t}\n\n\t\tvar statics = {\n\t\t\tcross: VectorCross,\n\t\t\tdifference: VectorDifference,\n\t\t\tdistance: VectorDistance,\n\t\t\tincidence: VectorIncidence,\n\t\t\tmake: VectorMake,\n\t\t\tnormalize: VectorNormalize,\n\t\t\tpower: VectorPower,\n\t\t\tsize: VectorSize,\n\t\t};\n\n\t\tvar publics = {\n\t\t\tadd: add,\n\t\t\tcopy: copy,\n\t\t\tcross: cross,\n\t\t\tdifference: difference,\n\t\t\tdistance: distance,\n\t\t\tfriction: friction,\n\t\t\tincidence: incidence,\n\t\t\tnormalize: normalize,\n\t\t\tpower: power,\n\t\t\tsize: size,\n\t\t\ttowards: towards,\n\t\t\ttoString: toString,\n\t\t};\n\n\t\tangular.extend(Vector, statics);\n\t\tangular.extend(Vector.prototype, publics);\n\n\t\treturn Vector;\n\n\t\t// statics methods\n\n\t\tfunction VectorCross(a, b) {\n\t\t\treturn (a.x * b.y) - (a.y * b.x);\n\t\t}\n\n\t\tfunction VectorDifference(a, b) {\n\t\t\treturn new Vector(a.x - b.x, a.y - b.y);\n\t\t}\n\n\t\tfunction VectorDistance(a, b) {\n\t\t\treturn Math.sqrt((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));\n\t\t}\n\n\t\tfunction VectorIncidence(a, b) {\n\t\t\tvar angle = Math.atan2(b.y, b.x) - Math.atan2(a.y, a.x);\n\t\t\treturn angle;\n\t\t}\n\n\t\tfunction VectorMake(a, b) {\n\t\t\treturn new Vector(b.x - a.x, b.y - a.y);\n\t\t}\n\n\t\tfunction VectorNormalize(a) {\n\t\t\tvar l = Vector.size(a);\n\t\t\ta.x /= l;\n\t\t\ta.y /= l;\n\t\t\treturn a;\n\t\t}\n\n\t\tfunction VectorPower(a, b) {\n\t\t\tvar x = Math.abs(b.x - a.x);\n\t\t\tvar y = Math.abs(b.y - a.y);\n\t\t\treturn (x + y) / 2;\n\t\t}\n\n\t\tfunction VectorSize(a) {\n\t\t\treturn Math.sqrt(a.x * a.x + a.y * a.y);\n\t\t}\n\n\t\t// prototype methods\n\n\t\tfunction add(b) {\n\t\t\tthis.x += b.x;\n\t\t\tthis.y += b.y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction copy(b) {\n\t\t\treturn new Vector(this.x, this.y);\n\t\t}\n\n\t\tfunction cross(b) {\n\t\t\treturn VectorCross(this, b);\n\t\t}\n\n\t\tfunction difference(b) {\n\t\t\treturn VectorDifference(this, b);\n\t\t}\n\n\t\tfunction distance(b) {\n\t\t\treturn VectorDistance(this, b);\n\t\t}\n\n\t\tfunction friction(b) {\n\t\t\tthis.x *= b;\n\t\t\tthis.y *= b;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction incidence(b) {\n\t\t\treturn VectorIncidence(this, b);\n\t\t}\n\n\t\tfunction normalize() {\n\t\t\treturn VectorNormalize(this);\n\t\t}\n\n\t\tfunction power() {\n\t\t\treturn (Math.abs(this.x) + Math.abs(this.y)) / 2;\n\t\t}\n\n\t\tfunction size() {\n\t\t\treturn VectorSize(this);\n\t\t}\n\n\t\tfunction towards(b, friction) {\n\t\t\tfriction = friction || 0.125;\n\t\t\tthis.x += (b.x - this.x) * friction;\n\t\t\tthis.y += (b.y - this.y) * friction;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction toString() {\n\t\t\treturn '{' + this.x + ',' + this.y + '}';\n\t\t}\n\n\t});\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Hash', [function () {\n\n\t\tfunction Hash(key, pool) {\n\t\t\tkey = key || 'id';\n\t\t\tpool = pool ? HashGet(pool) : {};\n\t\t\tObject.defineProperties(this, {\n\t\t\t\tkey: {\n\t\t\t\t\tvalue: key,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\twritable: false\n\t\t\t\t},\n\t\t\t\tpool: {\n\t\t\t\t\tvalue: pool,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\twritable: false\n\t\t\t\t},\n\t\t\t\tlength: {\n\t\t\t\t\tvalue: 0,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\twritable: true\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tvar pools = {};\n\n\t\tvar statics = {\n\t\t\tget: HashGet,\n\t\t};\n\n\t\tvar publics = {\n\t\t\thas: has,\n\t\t\tgetId: getId,\n\t\t\tget: get,\n\t\t\tset: set,\n\t\t\tadd: add,\n\t\t\tremove: remove,\n\t\t\teach: each,\n\t\t\taddMany: addMany,\n\t\t\tremoveMany: removeMany,\n\t\t\tremoveAll: removeAll,\n\t\t\tforward: forward,\n\t\t\tbackward: backward,\n\t\t\tdiffers: differs,\n\t\t\tupdatePool: updatePool,\n\t\t};\n\n\t\tHash.prototype = new Array;\n\n\t\tangular.extend(Hash, statics);\n\t\tangular.extend(Hash.prototype, publics);\n\n\t\treturn Hash;\n\n\t\t// static methods\n\n\t\tfunction HashGet(pool) {\n\t\t\treturn (pools[pool] = pools[pool] || {});\n\t\t}\n\n\t\tfunction has(id) {\n\t\t\treturn this.pool[id] !== undefined;\n\t\t}\n\n\t\tfunction getId(id) {\n\t\t\treturn this.pool[id];\n\t\t}\n\n\t\tfunction get(item) {\n\t\t\tvar hash = this,\n\t\t\t\tkey = this.key;\n\t\t\treturn item ? hash.getId(item[key]) : null;\n\t\t}\n\n\t\tfunction set(item) {\n\t\t\tvar hash = this,\n\t\t\t\tpool = this.pool,\n\t\t\t\tkey = this.key;\n\t\t\tpool[item[key]] = item;\n\t\t\thash.push(item);\n\t\t\treturn item;\n\t\t}\n\n\t\tfunction add(newItem) {\n\t\t\tvar hash = this;\n\t\t\tvar item = hash.get(newItem);\n\t\t\tif (item) {\n\t\t\t\tfor (var i = 0, keys = Object.keys(newItem), p; i < keys.length; i++) {\n\t\t\t\t\tp = keys[i];\n\t\t\t\t\titem[p] = newItem[p];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\titem = hash.set(newItem);\n\t\t\t}\n\t\t\treturn item;\n\t\t}\n\n\t\tfunction remove(oldItem) {\n\t\t\tvar hash = this,\n\t\t\t\tpool = this.pool,\n\t\t\t\tkey = this.key;\n\t\t\tvar item = hash.get(oldItem);\n\t\t\tif (item) {\n\t\t\t\tvar index = hash.indexOf(item);\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\thash.splice(index, 1);\n\t\t\t\t}\n\t\t\t\tdelete pool[item[key]];\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction addMany(items) {\n\t\t\tvar hash = this;\n\t\t\tif (!items) {\n\t\t\t\treturn hash;\n\t\t\t}\n\t\t\tvar i = 0;\n\t\t\twhile (i < items.length) {\n\t\t\t\thash.add(items[i]);\n\t\t\t\ti++;\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction removeMany(items) {\n\t\t\tvar hash = this;\n\t\t\tif (!items) {\n\t\t\t\treturn hash;\n\t\t\t}\n\t\t\tvar i = 0;\n\t\t\twhile (i < items.length) {\n\t\t\t\thash.remove(items[i]);\n\t\t\t\ti++;\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction removeAll() {\n\t\t\tvar hash = this,\n\t\t\t\tkey = hash.key,\n\t\t\t\tpool = hash.pool;\n\t\t\tvar i = 0,\n\t\t\t\tt = hash.length,\n\t\t\t\titem;\n\t\t\twhile (hash.length) {\n\t\t\t\titem = hash.shift();\n\t\t\t\tdelete pool[item[key]];\n\t\t\t\ti++;\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction each(callback) {\n\t\t\tvar hash = this;\n\t\t\tif (callback) {\n\t\t\t\tvar i = 0;\n\t\t\t\twhile (i < hash.length) {\n\t\t\t\t\tcallback(hash[i], i);\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction forward(key, reverse) {\n\t\t\tvar hash = this;\n\t\t\tkey = (key || this.key);\n\t\t\thash.sort(function (c, d) {\n\t\t\t\tvar a = reverse ? d : c;\n\t\t\t\tvar b = reverse ? c : d;\n\t\t\t\treturn a[key] - b[key];\n\t\t\t});\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction backward(key) {\n\t\t\treturn this.forward(key, true);\n\t\t}\n\n\t\tfunction differs(hash) {\n\t\t\tif (hash.key !== this.key || hash.length !== this.length) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tvar differs = false,\n\t\t\t\t\ti = 0,\n\t\t\t\t\tt = this.length,\n\t\t\t\t\tkey = this.key;\n\t\t\t\twhile (differs && i < t) {\n\t\t\t\t\tdiffers = this[i][key] !== hash[i][key];\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction updatePool() {\n\t\t\tvar hash = this,\n\t\t\t\tpool = this.pool,\n\t\t\t\tkey = this.key;\n\t\t\tObject.keys(pool).forEach(function (key) {\n\t\t\t\tdelete pool[key];\n\t\t\t});\n\t\t\tangular.forEach(hash, function (item) {\n\t\t\t\tpool[item[key]] = item;\n\t\t\t});\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('$promise', ['$q', function ($q) {\n\n\t\tfunction $promise(callback) {\n\t\t\tif (typeof callback !== 'function') {\n\t\t\t\tthrow ('promise resolve callback missing');\n\t\t\t}\n\t\t\tvar deferred = $q.defer();\n\t\t\tcallback(deferred);\n\t\t\treturn deferred.promise;\n\t\t}\n\n\t\tvar statics = {\n\t\t\tall: $promiseAll,\n\t\t};\n\n\t\tvar publics = {};\n\n\t\tangular.extend($promise, statics);\n\t\tangular.extend($promise.prototype, publics);\n\n\t\treturn $promise;\n\n\t\tfunction $promiseAll(promises) {\n\t\t\treturn $q.all(promises);\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('State', ['$timeout', function ($timeout) {\n\n\t\tfunction State() {\n\t\t\tthis.errors = [];\n\t\t\tthis.isReady = false;\n\t\t\tthis.idle();\n\t\t}\n\n\t\tvar DELAY = 2000;\n\n\t\tvar statics = {};\n\n\t\tvar publics = {\n\t\t\tbusy: busy,\n\t\t\tclasses: classes,\n\t\t\tenabled: enabled,\n\t\t\terror: error,\n\t\t\terrorMessage: errorMessage,\n\t\t\tidle: idle,\n\t\t\tlabels: labels,\n\t\t\tready: ready,\n\t\t\tsubmitClass: submitClass,\n\t\t\tsuccess: success,\n\t\t};\n\n\t\tangular.extend(State, statics);\n\t\tangular.extend(State.prototype, publics);\n\n\t\treturn State;\n\n\t\t// static methods\n\n\t\t// prototype methods\n\n\t\tfunction busy() {\n\t\t\tvar state = this;\n\t\t\tif (!state.isBusy) {\n\t\t\t\tstate.isBusy = true;\n\t\t\t\tstate.isError = false;\n\t\t\t\tstate.isErroring = false;\n\t\t\t\tstate.isSuccess = false;\n\t\t\t\tstate.isSuccessing = false;\n\t\t\t\tstate.errors = [];\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfunction classes(addons) {\n\t\t\tvar state = this,\n\t\t\t\tclasses = null;\n\t\t\tclasses = {\n\t\t\t\tready: state.isReady,\n\t\t\t\tbusy: state.isBusy,\n\t\t\t\tsuccessing: state.isSuccessing,\n\t\t\t\tsuccess: state.isSuccess,\n\t\t\t\terrorring: state.isErroring,\n\t\t\t\terror: state.isError,\n\t\t\t};\n\t\t\tif (addons) {\n\t\t\t\tangular.forEach(addons, function (value, key) {\n\t\t\t\t\tclasses[value] = classes[key];\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn classes;\n\t\t}\n\n\t\tfunction enabled() {\n\t\t\tvar state = this;\n\t\t\treturn !state.isBusy && !state.isErroring && !state.isSuccessing;\n\t\t}\n\n\t\tfunction error(error) {\n\t\t\tconsole.log('State.error', error);\n\t\t\tvar state = this;\n\t\t\tstate.isBusy = false;\n\t\t\tstate.isError = true;\n\t\t\tstate.isErroring = true;\n\t\t\tstate.isSuccess = false;\n\t\t\tstate.isSuccessing = false;\n\t\t\tstate.errors.push(error);\n\t\t\t$timeout(function () {\n\t\t\t\tstate.isErroring = false;\n\t\t\t}, DELAY);\n\t\t}\n\n\t\tfunction errorMessage() {\n\t\t\tvar state = this;\n\t\t\treturn state.isError ? state.errors[state.errors.length - 1] : null;\n\t\t}\n\n\t\tfunction idle() {\n\t\t\tvar state = this;\n\t\t\tstate.isBusy = false;\n\t\t\tstate.isError = false;\n\t\t\tstate.isErroring = false;\n\t\t\tstate.isSuccess = false;\n\t\t\tstate.isSuccessing = false;\n\t\t\tstate.button = null;\n\t\t\tstate.errors = [];\n\t\t}\n\n\t\tfunction labels(addons) {\n\t\t\tvar state = this;\n\t\t\tvar defaults = {\n\t\t\t\tready: 'submit',\n\t\t\t\tbusy: 'sending',\n\t\t\t\terror: 'error',\n\t\t\t\tsuccess: 'success',\n\t\t\t};\n\t\t\tif (addons) {\n\t\t\t\tangular.extend(defaults, addons);\n\t\t\t}\n\t\t\tvar label = defaults.ready;\n\t\t\tif (state.isBusy) {\n\t\t\t\tlabel = defaults.busy;\n\t\t\t} else if (state.isSuccess) {\n\t\t\t\tlabel = defaults.success;\n\t\t\t} else if (state.isError) {\n\t\t\t\tlabel = defaults.error;\n\t\t\t}\n\t\t\treturn label;\n\t\t}\n\n\t\tfunction ready() {\n\t\t\tvar state = this;\n\t\t\tstate.idle();\n\t\t\tstate.isReady = true;\n\t\t}\n\n\t\tfunction submitClass() {\n\t\t\tvar state = this;\n\t\t\treturn {\n\t\t\t\tbusy: state.isBusy,\n\t\t\t\tready: state.isReady,\n\t\t\t\tsuccessing: state.isSuccessing,\n\t\t\t\tsuccess: state.isSuccess,\n\t\t\t\terrorring: state.isErroring,\n\t\t\t\terror: state.isError,\n\t\t\t};\n\t\t}\n\n\t\tfunction success() {\n\t\t\tvar state = this;\n\t\t\tstate.isBusy = false;\n\t\t\tstate.isError = false;\n\t\t\tstate.isErroring = false;\n\t\t\tstate.isSuccess = true;\n\t\t\tstate.isSuccessing = true;\n\t\t\tstate.errors = [];\n\t\t\t$timeout(function () {\n\t\t\t\tstate.isSuccessing = false;\n\t\t\t}, DELAY);\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar transformProperty = detectTransformProperty();\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Style', [function () {\n\n\t\tfunction Style() {\n\t\t\tthis.props = {\n\t\t\t\tscale: 1,\n\t\t\t\thoverScale: 1,\n\t\t\t\tcurrentScale: 1,\n\t\t\t};\n\t\t}\n\n\t\tvar statics = {};\n\n\t\tvar publics = {\n\t\t\tset: set,\n\t\t\ttransform: transform,\n\t\t\ttransformOrigin: transformOrigin,\n\t\t};\n\n\t\tangular.extend(Style, statics);\n\t\tangular.extend(Style.prototype, publics);\n\n\t\treturn Style;\n\n\t\t// static methods\n\n\t\t// prototype methods\n\n\t\tfunction set(element) {\n\t\t\tvar styles = [];\n\t\t\tfor (var key in this) {\n\t\t\t\tif (key !== 'props') {\n\t\t\t\t\tstyles.push(key + ':' + this[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telement.style.cssText = styles.join(';') + ';';\n\t\t}\n\n\t\tfunction transform(transform) {\n\t\t\tthis[transformProperty] = transform;\n\t\t}\n\n\t\tfunction transformOrigin(x, y) {\n\t\t\tthis[transformProperty + '-origin-x'] = (Math.round(x * 1000) / 1000) + '%';\n\t\t\tthis[transformProperty + '-origin-y'] = (Math.round(y * 1000) / 1000) + '%';\n\t\t}\n\n    }]);\n\n\tfunction detectTransformProperty() {\n\t\tvar transformProperty = 'transform',\n\t\t\tsafariPropertyHack = 'webkitTransform';\n\t\tvar div = document.createElement(\"DIV\");\n\t\tif (typeof div.style[transformProperty] !== 'undefined') {\n            ['webkit', 'moz', 'o', 'ms'].every(function (prefix) {\n\t\t\t\tvar e = '-' + prefix + '-transform';\n\t\t\t\tif (typeof div.style[e] !== 'undefined') {\n\t\t\t\t\ttransformProperty = e;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t} else if (typeof div.style[safariPropertyHack] !== 'undefined') {\n\t\t\ttransformProperty = '-webkit-transform';\n\t\t} else {\n\t\t\ttransformProperty = undefined;\n\t\t}\n\t\treturn transformProperty;\n\t}\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.service('Utils', ['$compile', '$controller', 'Vector', function ($compile, $controller, Vector) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\tcompileController: compileController,\n\t\t\tformat: format,\n\t\t\tindexOf: indexOf,\n\t\t\treducer: reducer,\n\t\t\treducerAdder: reducerAdder,\n\t\t\treducerSetter: reducerSetter,\n\t\t\tremoveValue: removeValue,\n\t\t\treverseSortOn: reverseSortOn,\n\t\t\tthrottle: throttle,\n\t\t\ttoMd5: toMd5,\n\t\t\twhere: where,\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\tvar getNow = Date.now || function () {\n\t\t\treturn new Date().getTime();\n\t\t};\n\n\t\tfunction compileController(scope, element, html, data) {\n\t\t\t// console.log('Utils.compileController', element);\n\t\t\telement.html(html);\n\t\t\tvar link = $compile(element.contents());\n\t\t\tif (data.controller) {\n\t\t\t\tvar $scope = scope.$new();\n\t\t\t\tangular.extend($scope, data);\n\t\t\t\tvar controller = $controller(data.controller, {\n\t\t\t\t\t$scope: $scope\n\t\t\t\t});\n\t\t\t\tif (data.controllerAs) {\n\t\t\t\t\tscope[data.controllerAs] = controller;\n\t\t\t\t}\n\t\t\t\telement.data('$ngControllerController', controller);\n\t\t\t\telement.children().data('$ngControllerController', controller);\n\t\t\t\tscope = $scope;\n\t\t\t}\n\t\t\tlink(scope);\n\t\t}\n\n\t\tfunction format(string, prepend, expression) {\n\t\t\tstring = string || '';\n\t\t\tprepend = prepend || '';\n\t\t\tvar splitted = string.split(',');\n\t\t\tif (splitted.length > 1) {\n\t\t\t\tvar formatted = splitted.shift();\n\t\t\t\tangular.forEach(splitted, function (value, index) {\n\t\t\t\t\tif (expression) {\n\t\t\t\t\t\tformatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tformatted = formatted.split('{' + index + '}').join(prepend + value);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (expression) {\n\t\t\t\t\treturn '\\'' + formatted + '\\'';\n\t\t\t\t} else {\n\t\t\t\t\treturn formatted;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn prepend + string;\n\t\t\t}\n\t\t}\n\n\t\tfunction indexOf(array, object, key) {\n\t\t\tkey = key || 'id';\n\t\t\tvar index = -1;\n\t\t\tif (array) {\n\t\t\t\tvar i = 0,\n\t\t\t\t\tt = array.length;\n\t\t\t\twhile (i < t) {\n\t\t\t\t\tif (array[i] && array[i][key] === object[key]) {\n\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn index;\n\t\t}\n\n\t\tfunction reducer(o, key) {\n\t\t\treturn o[key];\n\t\t}\n\n\t\tfunction reducerAdder(o, key, value) {\n\t\t\tif (typeof key == 'string') {\n\t\t\t\treturn reducerAdder(o, key.split('.'), value);\n\t\t\t} else if (key.length == 1 && value !== undefined) {\n\t\t\t\treturn (o[key[0]] += value);\n\t\t\t} else if (key.length === 0) {\n\t\t\t\treturn o;\n\t\t\t} else {\n\t\t\t\treturn reducerAdder(o[key[0]], key.slice(1), value);\n\t\t\t}\n\t\t}\n\n\t\tfunction reducerSetter(o, key, value) {\n\t\t\tif (typeof key == 'string') {\n\t\t\t\treturn reducerSetter(o, key.split('.'), value);\n\t\t\t} else if (key.length == 1 && value !== undefined) {\n\t\t\t\treturn (o[key[0]] = value);\n\t\t\t} else if (key.length === 0) {\n\t\t\t\treturn o;\n\t\t\t} else {\n\t\t\t\treturn reducerSetter(o[key[0]], key.slice(1), value);\n\t\t\t}\n\t\t}\n\n\t\tfunction removeValue(array, value) {\n\t\t\tvar index = -1;\n\t\t\tif (array) {\n\t\t\t\tvar i = 0,\n\t\t\t\t\tt = array.length;\n\t\t\t\twhile (i < t) {\n\t\t\t\t\tif (array[i] === value) {\n\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (index !== -1) {\n\t\t\t\tarray.splice(index, 1);\n\t\t\t\treturn value;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\tfunction reverseSortOn(key) {\n\t\t\treturn function (a, b) {\n\t\t\t\tif (a[key] < b[key]) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\tif (a[key] > b[key]) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\t// a must be equal to b\n\t\t\t\treturn 0;\n\t\t\t};\n\t\t}\n\n\t\tfunction throttle(func, wait, options) {\n\t\t\t// Returns a function, that, when invoked, will only be triggered at most once\n\t\t\t// during a given window of time. Normally, the throttled function will run\n\t\t\t// as much as it can, without ever going more than once per `wait` duration;\n\t\t\t// but if you'd like to disable the execution on the leading edge, pass\n\t\t\t// `{leading: false}`. To disable execution on the trailing edge, ditto.\n\t\t\tvar context, args, result;\n\t\t\tvar timeout = null;\n\t\t\tvar previous = 0;\n\t\t\tif (!options) options = {};\n\t\t\tvar later = function () {\n\t\t\t\tprevious = options.leading === false ? 0 : getNow();\n\t\t\t\ttimeout = null;\n\t\t\t\tresult = func.apply(context, args);\n\t\t\t\tif (!timeout) context = args = null;\n\t\t\t};\n\t\t\treturn function () {\n\t\t\t\tvar now = getNow();\n\t\t\t\tif (!previous && options.leading === false) previous = now;\n\t\t\t\tvar remaining = wait - (now - previous);\n\t\t\t\tcontext = this;\n\t\t\t\targs = arguments;\n\t\t\t\tif (remaining <= 0 || remaining > wait) {\n\t\t\t\t\tif (timeout) {\n\t\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\t\ttimeout = null;\n\t\t\t\t\t}\n\t\t\t\t\tprevious = now;\n\t\t\t\t\tresult = func.apply(context, args);\n\t\t\t\t\tif (!timeout) context = args = null;\n\t\t\t\t} else if (!timeout && options.trailing !== false) {\n\t\t\t\t\ttimeout = setTimeout(later, remaining);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t};\n\t\t}\n\n\t\tfunction toMd5(string) {\n\t\t\t// return Md5.encode(string);\n\t\t}\n\n\t\tfunction where(array, query) {\n\t\t\tvar found = null;\n\t\t\tif (array) {\n\t\t\t\tangular.forEach(array, function (item) {\n\t\t\t\t\tvar has = true;\n\t\t\t\t\tangular.forEach(query, function (value, key) {\n\t\t\t\t\t\thas = has && item[key] === value;\n\t\t\t\t\t});\n\t\t\t\t\tif (has) {\n\t\t\t\t\t\tfound = item;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn found;\n\t\t}\n\n    }]);\n\n\t(function () {\n\t\t// POLYFILL Array.prototype.reduce\n\t\t// Production steps of ECMA-262, Edition 5, 15.4.4.21\n\t\t// Reference: http://es5.github.io/#x15.4.4.21\n\t\t// https://tc39.github.io/ecma262/#sec-array.prototype.reduce\n\t\tif (!Array.prototype.reduce) {\n\t\t\tObject.defineProperty(Array.prototype, 'reduce', {\n\t\t\t\tvalue: function (callback) { // , initialvalue\n\t\t\t\t\tif (this === null) {\n\t\t\t\t\t\tthrow new TypeError('Array.prototype.reduce called on null or undefined');\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof callback !== 'function') {\n\t\t\t\t\t\tthrow new TypeError(callback + ' is not a function');\n\t\t\t\t\t}\n\t\t\t\t\tvar o = Object(this);\n\t\t\t\t\tvar len = o.length >>> 0;\n\t\t\t\t\tvar k = 0;\n\t\t\t\t\tvar value;\n\t\t\t\t\tif (arguments.length == 2) {\n\t\t\t\t\t\tvalue = arguments[1];\n\t\t\t\t\t} else {\n\t\t\t\t\t\twhile (k < len && !(k in o)) {\n\t\t\t\t\t\t\tk++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (k >= len) {\n\t\t\t\t\t\t\tthrow new TypeError('Reduce of empty array with no initial value');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvalue = o[k++];\n\t\t\t\t\t}\n\t\t\t\t\twhile (k < len) {\n\t\t\t\t\t\tif (k in o) {\n\t\t\t\t\t\t\tvalue = callback(value, o[k], k, o);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tk++;\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}());\n\n}());\n/* global angular */\r\n\r\n(function () {\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.factory('Doc', ['Api', '$promise', function (Api, $promise) {\r\n\r\n\t\tfunction Doc(item) {\r\n\t\t\tif (item) {\r\n\t\t\t\tangular.extend(this, item);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar statics = {};\r\n\r\n\t\tvar publics = {};\r\n\r\n\t\tangular.extend(Doc, statics);\r\n\t\tangular.extend(Doc.prototype, publics);\r\n\r\n\t\treturn Doc;\r\n\r\n\t\t// static methods\r\n\r\n\t\t// prototype methods\r\n\r\n    }]);\r\n\r\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Route', ['$promise', '$location', '$route', '$routeParams', 'Router', function ($promise, $location, $route, $routeParams, Router) {\n\n\t\tfunction Route(current) {\n\n\t\t\tvar route = {\n\t\t\t\tcontroller: current.$$route.controller,\n\t\t\t\tparams: current.params,\n\t\t\t\tpath: $location.path(),\n\t\t\t\tpathParams: current.pathParams,\n\t\t\t\toriginalPath: current.$$route.originalPath,\n\t\t\t\ttemplateUrl: current.loadedTemplateUrl,\n\t\t\t};\n\t\t\tangular.extend(this, route);\n\t\t}\n\n\t\tvar statics = {\n\t\t\tcurrent: RouteCurrent,\n\t\t};\n\n\t\tvar publics = {};\n\n\t\tangular.extend(Route, statics);\n\t\tangular.extend(Route.prototype, publics);\n\n\t\treturn Route;\n\n\t\t// static methods\n\n\t\tfunction RouteCurrent() {\n\t\t\treturn new Route($route.current);\n\t\t}\n\n\t\t// prototype methods\n\n    }]);\n\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.factory('View', ['Api', '$promise', 'environment', 'Doc', 'Route', function(Api, $promise, environment, Doc, Route) {\r\n\r\n        function View(doc, route) {\r\n            var view = {\r\n                doc: doc,\r\n                environment: environment,\r\n                route: route,\r\n            };\r\n            angular.extend(this, view);\r\n        }\r\n\r\n        var statics = {\r\n            current: ViewCurrent, // ViewCurrentSimple\r\n        };\r\n\r\n        var publics = {};\r\n\r\n        angular.extend(View, statics);\r\n        angular.extend(View.prototype, publics);\r\n\r\n        return View;\r\n\r\n        // static methods\r\n\r\n        function ViewCurrent() {\r\n            return $promise(function(promise) {\r\n                var route = Route.current();\r\n                var path = route.path;\r\n                console.log('ViewCurrent', path);\r\n                Api.docs.path(path).then(function(response) {\r\n                    var doc = new Doc(response);\r\n                    var view = new View(doc, route);\r\n                    promise.resolve(view);\r\n\r\n                }, function(error) {\r\n                    promise.reject(error);\r\n\r\n                });\r\n            });\r\n        }\r\n\r\n        function ViewCurrentSimple() {\r\n            return $promise(function(promise) {\r\n                console.log('ViewCurrentSimple');\r\n                var route = Route.current();\r\n                var path = route.path;\r\n                Api.navs.main().then(function(items) {\r\n                    var doc = null,\r\n                        view = null,\r\n                        path = path,\r\n                        pool = ViewPool(items);\r\n                    var item = pool[path];\r\n                    if (item) {\r\n                        doc = new Doc(item);\r\n                        view = new View(doc, route);\r\n                    }\r\n                    promise.resolve(view);\r\n\r\n                }, function(error) {\r\n                    promise.reject(error);\r\n\r\n                });\r\n            });\r\n        }\r\n\r\n        function ViewPool(items) {\r\n            var pool = {};\r\n\r\n            function _getPool(items) {\r\n                if (items) {\r\n                    angular.forEach(items, function(item) {\r\n                        pool[item.path] = item;\r\n                        _getPool(item.items);\r\n                    });\r\n                }\r\n            }\r\n            _getPool(items);\r\n            return pool;\r\n        }\r\n\r\n        // prototype methods\r\n\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.service('Http', ['$http', '$promise', '$timeout', 'environment', function($http, $promise, $timeout, environment) {\r\n\r\n        var service = this;\r\n\r\n        var statics = {\r\n            get: HttpGet,\r\n            post: HttpPost,\r\n            put: HttpPut,\r\n            patch: HttpPatch,\r\n            'delete': HttpDelete,\r\n            fake: HttpFake,\r\n        };\r\n\r\n        angular.extend(service, statics);\r\n\r\n        // statics methods\r\n\r\n        function HttpPath(path) {\r\n            return environment.paths.api + path;\r\n        }\r\n\r\n        function HttpPromise(method, path, data) {\r\n            return $promise(function(promise) {\r\n                $http[method](HttpPath(path), data).then(function(response) {\r\n                    promise.resolve(response.data);\r\n\r\n                }, function(e, status) {\r\n                    var error = (e && e.data) ? e.data : {};\r\n                    error.status = e.status;\r\n                    promise.reject(error);\r\n\r\n                });\r\n            });\r\n        }\r\n\r\n        function HttpGet(path) {\r\n            return HttpPromise('get', path);\r\n        }\r\n\r\n        function HttpPost(path, data) {\r\n            return HttpPromise('post', path, data);\r\n        }\r\n\r\n        function HttpPut(path, data) {\r\n            return HttpPromise('put', path, data);\r\n        }\r\n\r\n        function HttpPatch(path, data) {\r\n            return HttpPromise('patch', path, data);\r\n        }\r\n\r\n        function HttpDelete(path) {\r\n            return HttpPromise('delete', path);\r\n        }\r\n\r\n        function HttpFake(data, msec) {\r\n            msec = msec || 1000;\r\n            return $promise(function(promise) {\r\n                $timeout(function() {\r\n                    promise.resolve({\r\n                        data: data\r\n                    });\r\n                }, msec);\r\n            });\r\n        }\r\n\r\n    }]);\r\n\r\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('Preload', ['$promise', function($promise) {\n\n        function Preload(path) {\n            var preload = this;\n            preload.path = path;\n            preload.loaded = 0;\n            preload.total = 0;\n            preload.progress = 0;\n        }\n\n        var statics = {\n            all: PreloadAll,\n        };\n\n        var publics = {\n            start: PreloadStart,\n            image: PreloadImage,\n        };\n\n        angular.extend(Preload, statics);\n        angular.extend(Preload.prototype, publics);\n\n        return Preload;\n\n        // statics methods\n\n        function PreloadAll(paths, callback) {\n            return $promise(function(promise) {\n                var preloads = paths.map(function(path) {\n                    return new Preload(path);\n                });\n                var progress = {\n                    loaded: 0,\n                    total: 0,\n                    progress: 0,\n                    preloads: preloads\n                };\n                var i = setInterval(update, 1000 / 10);\n                $promise.all(\n                    preloads.map(function(preload) {\n                        return preload.start();\n                    })\n                ).then(function() {\n                    clearInterval(i);\n                    update();\n                    promise.resolve(preloads.slice());\n                    // destroy();\n                }, function(error) {\n                    promise.reject(error);\n                    // destroy();\n                });\n\n                function update() {\n                    progress.loaded = 0;\n                    progress.total = 0;\n                    angular.forEach(preloads, function(preload) {\n                        progress.loaded += preload.loaded;\n                        progress.total += preload.total;\n                    });\n                    var percent = progress.total ? progress.loaded / progress.total : 0;\n                    if (percent > progress.progress) {\n                        progress.progress = percent;\n                        if (callback) {\n                            callback(progress);\n                        }\n                    }\n                }\n\n                function destroy() {\n                    angular.forEach(preloads, function(preload) {\n                        preload.buffer = null;\n                        preload.xhr = null;\n                    });\n                }\n            });\n        }\n\n        // instance methods\n\n        function PreloadStart() {\n            var preload = this;\n            return $promise(function(promise) {\n                var xhr = new XMLHttpRequest();\n                xhr.responseType = \"arraybuffer\";\n                xhr.open(\"GET\", preload.path, true);\n                xhr.onloadstart = function(e) {\n                    /*\n                    preload.loaded = 0;\n                    preload.total = 1;\n                    preload.progress = 0;\n                    */\n                };\n                xhr.onprogress = function(e) {\n                    preload.loaded = e.loaded;\n                    preload.total = e.total;\n                    preload.progress = e.total ? e.loaded / e.total : 0;\n                };\n                xhr.onloadend = function(e) {\n                    preload.loaded = preload.total;\n                    preload.progress = 1;\n                };\n                xhr.onload = function() {\n                    preload.buffer = xhr.response;\n                    promise.resolve(preload);\n                };\n                xhr.onerror = function(error) {\n                    console.log('Preload.xhr.onerror', error);\n                    preload.loaded = preload.total;\n                    preload.progress = 1;\n                    promise.reject(error);\n                };\n                xhr.send();\n                preload.xhr = xhr;\n            });\n        }\n\n        function PreloadImage() {\n            var preload = this;\n            var blob = new Blob([preload.buffer]);\n            var image = new Image();\n            image.src = window.URL.createObjectURL(blob);\n            return image;\n        }\n\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.service('$once', ['$promise', function($promise) {\n\n        var service = this;\n\n        var statics = {\n            load: OnceLoad,\n            script: OnceScript,\n            link: OnceLink,\n        };\n\n        angular.extend(service, statics);\n\n        var paths = {},\n            uid = 0;\n\n        function OnceLoad(path, callback) {\n            if (path.indexOf('.js')) {\n                return OnceScript(path, callback);\n\n            } else if (path.indexOf('.css')) {\n                return OnceLink(path);\n\n            }\n        }\n\n        function OnceScript(path, callback) {\n            return $promise(function(promise) {\n                try {\n                    var id = (paths[path] = paths[path] || ++uid);\n                    id = 'OnceScript' + id;\n                    if (document.getElementById(id)) {\n                        promise.resolve();\n                    } else {\n                        var scripts = document.getElementsByTagName('script');\n                        var script = scripts[scripts.length - 1];\n                        var node = document.createElement('script');\n                        node.id = id;\n                        if (callback) {\n                            if (callback === true) {\n                                callback = id;\n                                path = path.split('{{callback}}').join(callback);\n                            }\n                            window[callback] = function(data) {\n                                promise.resolve(data);\n                            };\n                        } else {\n                            node.addEventListener('load', promise.resolve);\n                        }\n                        node.addEventListener('error', promise.reject);\n                        node.src = path;\n                        script.parentNode.insertBefore(node, script.nextSibling);\n                    }\n                } catch (error) {\n                    promise.reject(error);\n                }\n            });\n        }\n\n        function OnceLink(path) {\n            return $promise(function(promise) {\n                try {\n                    var id = (paths[path] = paths[path] || ++uid);\n                    id = 'OnceStyle' + id;\n                    if (document.getElementById(id)) {\n                        promise.resolve();\n                    } else {\n                        var links = document.getElementsByTagName('link');\n                        var link = links[links.length - 1];\n                        var node = document.createElement('link');\n                        node.id = id;\n                        node.rel = 'stylesheet';\n                        node.href = path;\n                        node.addEventListener('load', promise.resolve);\n                        node.addEventListener('error', promise.reject);\n                        link.parentNode.insertBefore(node, link.nextSibling);\n                    }\n                } catch (error) {\n                    promise.reject(error);\n                }\n            });\n        }\n\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.service('Router', ['$rootScope', '$location', '$route', '$timeout', function($rootScope, $location, $route, $timeout) {\n\n        var service = this;\n\n        var statics = {\n            isController: RouterIsController,\n            redirect: RouterRedirect,\n            path: RouterPath,\n            apply: RouterApply,\n        };\n\n        angular.extend(service, statics);\n\n        $rootScope.$on('$routeChangeStart', RouterOnChangeStart);\n        $rootScope.$on('$routeChangeSuccess', RouterOnChangeSuccess);\n        $rootScope.$on('$routeChangeError', RouterOnChangeError);\n        $rootScope.$on('$routeUpdate', RouterOnUpdate);\n\n        var $previous, $current, $next;\n        var $previousController, $currentController, $nextController;\n\n        function RouterSetControllers() {\n            $previousController = $previous ? $previous.controller : null;\n            $currentController = $current ? $current.controller : null;\n            $nextController = $next ? $next.controller : null;\n        }\n\n        /*\n        $routeChangeStart\n        Broadcasted before a route change. At this point the route services starts resolving all of the dependencies needed for the route change to occur. Typically this involves fetching the view template as well as any dependencies defined in resolve route property. Once all of the dependencies are resolved $routeChangeSuccess is fired.\n        The route change (and the $location change that triggered it) can be prevented by calling preventDefault method of the event. See $rootScope.Scope for more details about event object.\n        */\n        function RouterOnChangeStart(event, next, current) {\n            $previous = null;\n            $current = current ? current.$$route : null;\n            $next = next ? next.$$route : null;\n            RouterSetControllers();\n            // console.log('Router.RouterOnChangeStart', '$previous', $previous, '$current', $current, '$next', $next);\n        }\n\n        /*\n        $routeChangeSuccess\n        Broadcasted after a route change has happened successfully. The resolve dependencies are now available in the current.locals property.\n        */\n        function RouterOnChangeSuccess(event, current, previous) {\n            $previous = previous ? previous.$$route : null;\n            $current = current ? current.$$route : null;\n            $next = null;\n            RouterSetControllers();\n            // console.log('Router.RouterOnChangeSuccess', '$previous', $previous, '$current', $current, '$next', $next);\n        }\n\n        /*\n        $routeChangeError\n        Broadcasted if a redirection function fails or any redirection or resolve promises are rejected.\n        */\n        function RouterOnChangeError(event, current, previous, rejection) {\n            $previous = null;\n            $current = previous.$$route || null;\n            $next = null;\n            RouterSetControllers();\n            // console.log('Router.RouterOnChangeError', '$previous', $previous, '$current', $current, '$next', $next);\n        }\n\n        /*\n        $routeUpdate\n        The reloadOnSearch property has been set to false, and we are reusing the same instance of the Controller.\n        */\n        function RouterOnUpdate(event, current) {\n            $previous = current ? current.$$route : null;\n            $current = current ? current.$$route : null;\n            $next = null;\n            RouterSetControllers();\n            // console.log('Router.RouterOnUpdate', '$previous', $previous, '$current', $current, '$next', $next);\n        }\n\n        function RouterIsController(controller) {\n            return $currentController === controller;\n        }\n\n        // navigation\n\n        function RouterRedirectTo(path) {\n            $location.$$lastRequestedPath = $location.path();\n            $location.path(path);\n        }\n\n        function RouterRetryLastRequestedPath(path) {\n            path = $location.$$lastRequestedPath || path;\n            $location.$$lastRequestedPath = null;\n            $location.path(path);\n        }\n\n        function RouterRedirect(path, msecs) {\n            if (msecs) {\n                $timeout(function() {\n                    RouterRedirectTo(path);\n                }, msecs);\n            } else {\n                RouterRedirectTo(path);\n            }\n        }\n\n        function RouterPath(path, msecs) {\n            if (msecs) {\n                $timeout(function() {\n                    RouterRetryLastRequestedPath(path);\n                }, msecs);\n            } else {\n                RouterRetryLastRequestedPath(path);\n            }\n        }\n\n        function RouterApply(path, msecs) {\n            if (msecs) {\n                $timeout(function() {\n                    $location.path(path);\n                }, msecs);\n            } else {\n                $timeout(function() {\n                    $location.path(path);\n                });\n            }\n        }\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.service('Silent', ['$rootScope', '$location', function ($rootScope, $location) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\tsilent: SilentSilent,\n\t\t\tpath: SilentPath,\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\t$rootScope.$$listeners.$locationChangeSuccess.unshift(SilentListener);\n\t\t// console.log('$rootScope.$$listeners.$locationChangeSuccess', $rootScope.$$listeners.$locationChangeSuccess);\n\n\t\t// private vars\n\n\t\tvar $path;\n\n\t\t// static methods\n\n\t\tfunction SilentGetDomain() {\n\t\t\tvar currentDomain = window.location.protocol + '//' + window.location.hostname + (window.location.port ? ':' + window.location.port : '');\n\t\t\treturn currentDomain;\n\t\t}\n\n\t\tfunction SilentUnlink() {\n\t\t\tvar listeners = $rootScope.$$listeners.$locationChangeSuccess;\n\t\t\tangular.forEach(listeners, function (value, name) {\n\t\t\t\tif (value === listener) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfunction relink() {\n\t\t\t\t\tlisteners[name] = value;\n\t\t\t\t}\n\t\t\t\tlisteners[name] = relink; // temporary unlinking\n\t\t\t});\n\t\t}\n\n\t\tfunction SilentListener(e) {\n\t\t\t// console.log('onLocationChangeSuccess', e);\n\t\t\tif ($path === $location.path()) {\n\t\t\t\tSilentUnlink();\n\t\t\t}\n\t\t\t$path = null;\n\t\t}\n\n\t\tfunction SilentSilent(path, replace) {\n\t\t\t// this.prev = $location.path(); ???\n\t\t\tvar location = $location.url(path);\n\t\t\tif (replace) {\n\t\t\t\tlocation.replace();\n\t\t\t}\n\t\t\t$path = $location.path();\n\t\t}\n\n\t\tfunction SilentPath(path) {\n\t\t\treturn $location.path(path);\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tvar TIMEOUT = 5 * 60 * 1000; // five minutes\n\n\tapp.service('Cookie', ['$promise', function ($promise) {\n\n\t\tvar service = {\n\t\t\tTIMEOUT: TIMEOUT,\n\t\t\tdelete: CookieDelete,\n\t\t\texist: CookieExists,\n\t\t\tget: CookieGet,\n\t\t\ton: CookieOn,\n\t\t\tset: CookieSet,\n\t\t};\n\n\t\tangular.extend(this, service);\n\n\t\tfunction CookieDelete(name) {\n\t\t\tCookieSetter(name, \"\", -1);\n\t\t}\n\n\t\tfunction CookieExists(name) {\n\t\t\treturn document.cookie.indexOf(';' + name + '=') !== -1 || document.cookie.indexOf(name + '=') === 0;\n\t\t}\n\n\t\tfunction CookieGet(name) {\n\t\t\tvar cookieName = name + \"=\";\n\t\t\tvar ca = document.cookie.split(';');\n\t\t\tfor (var i = 0; i < ca.length; i++) {\n\t\t\t\tvar c = ca[i];\n\t\t\t\twhile (c.charAt(0) == ' ') {\n\t\t\t\t\tc = c.substring(1, c.length);\n\t\t\t\t}\n\t\t\t\tif (c.indexOf(cookieName) === 0) {\n\t\t\t\t\tvar value = c.substring(cookieName.length, c.length);\n\t\t\t\t\tvar model = null;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tmodel = JSON.parse(decodeURIComponent(atob(value)));\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tconsole.log('Cookie.get.error parsing', key, e);\n\t\t\t\t\t}\n\t\t\t\t\treturn model;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tfunction CookieOn(name) {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tvar i, interval = 1000,\n\t\t\t\t\telapsed = 0,\n\t\t\t\t\ttimeout = Cookie.TIMEOUT;\n\n\t\t\t\tfunction checkCookie() {\n\t\t\t\t\tif (elapsed > timeout) {\n\t\t\t\t\t\tpromise.reject('timeout');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar c = CookieGet(name);\n\t\t\t\t\t\tif (c) {\n\t\t\t\t\t\t\tpromise.resolve(c);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\telapsed += interval;\n\t\t\t\t\t\t\ti = setTimeout(checkCookie, interval);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcheckCookie();\n\t\t\t});\n\t\t}\n\n\t\tfunction CookieSet(name, value, days) {\n\t\t\ttry {\n\t\t\t\tvar cache = [];\n\t\t\t\tvar json = JSON.stringify(value, function (key, value) {\n\t\t\t\t\tif (key === 'pool') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t\t// Circular reference found, discard key\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcache.push(value);\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t\tcache = null;\n\t\t\t\tCookieSetter(name, btoa(encodeURIComponent(json)), days);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('CookieSet.error serializing', name, value, e);\n\t\t\t}\n\t\t}\n\n\t\tfunction CookieSetter(name, value, days) {\n\t\t\tvar expires;\n\t\t\tif (days) {\n\t\t\t\tvar date = new Date();\n\t\t\t\tdate.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n\t\t\t\texpires = '; expires=' + date.toGMTString();\n\t\t\t} else {\n\t\t\t\texpires = '';\n\t\t\t}\n\t\t\tdocument.cookie = name + '=' + value + expires + '; path=/';\n\t\t}\n\n    }]);\n\n\tapp.service('LocalStorage', ['$promise', 'Cookie', function ($promise, Cookie) {\n\n\t\tvar service = {\n\t\t\tTIMEOUT: TIMEOUT,\n\t\t\tdelete: LocalDelete,\n\t\t\texist: LocalExists,\n\t\t\tget: LocalGet,\n\t\t\ton: LocalOn,\n\t\t\tset: LocalSet,\n\t\t};\n\n\t\tvar supported = LocalSupported();\n\n\t\tif (supported) {\n\t\t\tangular.extend(this, service);\n\t\t} else {\n\t\t\tangular.extend(this, Cookie);\n\t\t}\n\n\t\tthis.supported = supported;\n\n\t\tfunction LocalSupported() {\n\t\t\tvar supported = false;\n\t\t\ttry {\n\t\t\t\tsupported = 'localStorage' in window && window.localStorage !== null;\n\t\t\t\tif (supported) {\n\t\t\t\t\twindow.localStorage.setItem('test', '1');\n\t\t\t\t\twindow.localStorage.removeItem('test');\n\t\t\t\t} else {\n\t\t\t\t\tsupported = false;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tsupported = false;\n\t\t\t}\n\t\t\treturn supported;\n\t\t}\n\n\t\tfunction LocalExists(name) {\n\t\t\treturn window.localStorage[name] !== undefined;\n\t\t}\n\n\t\tfunction LocalGet(name) {\n\t\t\tvar value = null;\n\t\t\tif (window.localStorage[name] !== undefined) {\n\t\t\t\ttry {\n\t\t\t\t\tvalue = JSON.parse(window.localStorage[name]);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log('LocalStorage.get.error parsing', name, e);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn value;\n\t\t}\n\n\t\tfunction LocalSet(name, value) {\n\t\t\ttry {\n\t\t\t\tvar cache = [];\n\t\t\t\tvar json = JSON.stringify(value, function (key, value) {\n\t\t\t\t\tif (key === 'pool') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t\t// Circular reference found, discard key\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcache.push(value);\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t\tcache = null;\n\t\t\t\twindow.localStorage.setItem(name, json);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('LocalStorage.set.error serializing', name, value, e);\n\t\t\t}\n\t\t}\n\n\t\tfunction LocalDelete(name) {\n\t\t\twindow.localStorage.removeItem(name);\n\t\t}\n\n\t\tfunction LocalOn(name) {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tvar i, timeout = Cookie.TIMEOUT;\n\n\t\t\t\tfunction storageEvent(e) {\n\t\t\t\t\t// console.log('LocalStorage.on', name, e);\n\t\t\t\t\tif (i) {\n\t\t\t\t\t\tclearTimeout(i);\n\t\t\t\t\t}\n\t\t\t\t\tif (e.originalEvent.key == name) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvar value = JSON.parse(e.originalEvent.newValue); // , e.originalEvent.oldValue\n\t\t\t\t\t\t\tpromise.resolve(value);\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tconsole.log('LocalStorage.on.error parsing', name, error);\n\t\t\t\t\t\t\tpromise.reject('error parsing ' + name);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tangular.element(window).on('storage', storageEvent);\n\t\t\t\ti = setTimeout(function () {\n\t\t\t\t\tpromise.reject('timeout');\n\t\t\t\t}, timeout);\n\t\t\t});\n\t\t}\n\n    }]);\n\n\tapp.factory('SessionStorage', ['$promise', 'Cookie', function ($promise, Cookie) {\n\n\t\tvar service = {\n\t\t\tTIMEOUT: TIMEOUT,\n\t\t\tdelete: LocalDelete,\n\t\t\texist: LocalExists,\n\t\t\tget: LocalGet,\n\t\t\ton: LocalOn,\n\t\t\tset: LocalSet,\n\t\t};\n\n\t\tvar supported = SessionSupported();\n\n\t\tif (supported) {\n\t\t\tangular.extend(this, service);\n\t\t} else {\n\t\t\tangular.extend(this, Cookie);\n\t\t}\n\n\t\tthis.supported = supported;\n\n\t\tfunction SessionSupported() {\n\t\t\tvar supported = false;\n\t\t\ttry {\n\t\t\t\tsupported = 'sessionStorage' in window && window.sessionStorage !== undefined;\n\t\t\t\tif (supported) {\n\t\t\t\t\twindow.sessionStorage.setItem('test', '1');\n\t\t\t\t\twindow.sessionStorage.removeItem('test');\n\t\t\t\t} else {\n\t\t\t\t\tsupported = false;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tsupported = false;\n\t\t\t}\n\t\t\treturn supported;\n\t\t}\n\n\t\tfunction SessionExists(name) {\n\t\t\treturn window.sessionStorage[name] !== undefined;\n\t\t}\n\n\t\tfunction SessionGet(name) {\n\t\t\tvar value = null;\n\t\t\tif (window.sessionStorage[name] !== undefined) {\n\t\t\t\ttry {\n\t\t\t\t\tvalue = JSON.parse(window.sessionStorage[name]);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log('SessionStorage.get.error parsing', name, e);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn value;\n\t\t}\n\n\t\tfunction SessionSet(name, value) {\n\t\t\ttry {\n\t\t\t\tvar cache = [];\n\t\t\t\tvar json = JSON.stringify(value, function (key, value) {\n\t\t\t\t\tif (key === 'pool') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t\t// Circular reference found, discard key\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcache.push(value);\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t\tcache = null;\n\t\t\t\twindow.sessionStorage.setItem(name, json);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('SessionStorage.set.error serializing', name, value, e);\n\t\t\t}\n\t\t}\n\n\t\tfunction SessionDelete(name) {\n\t\t\twindow.sessionStorage.removeItem(name);\n\t\t}\n\n\t\tfunction SessionOn(name) {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tvar i, timeout = Cookie.TIMEOUT;\n\n\t\t\t\tfunction storageEvent(e) {\n\t\t\t\t\t// console.log('SessionStorage.on', name, e);\n\t\t\t\t\tif (i) {\n\t\t\t\t\t\tclearTimeout(i);\n\t\t\t\t\t}\n\t\t\t\t\tif (e.originalEvent.key === name) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvar value = JSON.parse(e.originalEvent.newValue); // , e.originalEvent.oldValue\n\t\t\t\t\t\t\tpromise.resolve(value);\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tconsole.log('SessionStorage.on.error parsing', name, error);\n\t\t\t\t\t\t\tpromise.reject('error parsing ' + name);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tangular.element(window).on('storage', storageEvent);\n\t\t\t\ti = setTimeout(function () {\n\t\t\t\t\tpromise.reject('timeout');\n\t\t\t\t}, timeout);\n\t\t\t});\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.service('Trust', ['$sce', function ($sce) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\thtml: TrustHtml,\n\t\t\tresource: TrustResource,\n\t\t\turl: TrustUrl,\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\t// private vars\n\n\t\tvar values = [],\n\t\t\ttrustedValues = [];\n\n\t\tfunction TrustGetValue(value) {\n\t\t\tvar index = values.indexOf(value);\n\t\t\tif (index !== -1) {\n\t\t\t\treturn trustedValues[index];\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\tfunction TrustSetValue(value, trustedValue) {\n\t\t\tvalues.push(value);\n\t\t\tvalues.push(trustedValue);\n\t\t}\n\n\t\tfunction TrustGetOrSet(value, callback) {\n\t\t\tvar trustedValue = TrustGetValue(value);\n\t\t\tif (!trustedValue) {\n\t\t\t\ttrustedValue = callback();\n\t\t\t\tTrustSetValue(value, trustedValue);\n\t\t\t}\n\t\t\treturn trustedValue;\n\t\t}\n\n\t\tfunction TrustHtml(value) {\n\t\t\treturn TrustGetOrSet(value, function () {\n\t\t\t\treturn $sce.trustAsHtml(value);\n\t\t\t});\n\t\t}\n\n\t\tfunction TrustResource(value) {\n\t\t\treturn TrustGetOrSet(value, function () {\n\t\t\t\treturn $sce.trustAsResourceUrl(value);\n\t\t\t});\n\t\t}\n\n\t\tfunction TrustUrl(value) {\n\t\t\treturn TrustGetOrSet(value, function () {\n\t\t\t\treturn 'url(\\'' + value + '\\')';\n\t\t\t});\n\t\t}\n\n    }]);\n\n}());\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Color', [function () {\n\t\tfunction Color(r, g, b, a) {\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tthis.r = (r || r === 0) ? r : 0;\n\t\t\t\tthis.g = (g || g === 0) ? g : 0;\n\t\t\t\tthis.b = (b || b === 0) ? b : 0;\n\t\t\t\tthis.a = (a || a === 0) ? a : 255;\n\t\t\t} else {\n\t\t\t\tvar uint = r || '0xffffff';\n\t\t\t\tuint = parseInt(uint);\n\t\t\t\tif (r.length > 8) {\n\t\t\t\t\tthis.r = uint >> 24 & 0xff;\n\t\t\t\t\tthis.g = uint >> 16 & 0xff;\n\t\t\t\t\tthis.b = uint >> 8 & 0xff;\n\t\t\t\t\tthis.a = uint >> 0 & 0xff;\n\t\t\t\t} else {\n\t\t\t\t\tthis.r = uint >> 16 & 0xff;\n\t\t\t\t\tthis.g = uint >> 8 & 0xff;\n\t\t\t\t\tthis.b = uint >> 0 & 0xff;\n\t\t\t\t\tthis.a = 255;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tColor.componentToHex = function (c) {\n\t\t\tvar hex = c.toString(16);\n\t\t\treturn hex.length == 1 ? '0' + hex : hex;\n\t\t};\n\t\tColor.luma = function (color) {\n\t\t\t// var luma = color.dot({ r: 54.213, g: 182.376, b: 18.411 });\n\t\t\tvar luma = color.dot({\n\t\t\t\tr: 95,\n\t\t\t\tg: 100,\n\t\t\t\tb: 60\n\t\t\t});\n\t\t\treturn luma;\n\t\t};\n\t\tColor.contrast = function (color) {\n\t\t\tvar luma = Color.luma(color);\n\t\t\tif (luma > 0.6) {\n\t\t\t\treturn new Color('0x000000');\n\t\t\t} else {\n\t\t\t\treturn new Color('0xffffff');\n\t\t\t}\n\t\t};\n\t\tColor.darker = function (color, pow, min) {\n\t\t\tmin = min || 0;\n\t\t\tvar r = Math.max(Math.floor(color.r * min), Math.floor(color.r - 255 * pow));\n\t\t\tvar g = Math.max(Math.floor(color.g * min), Math.floor(color.g - 255 * pow));\n\t\t\tvar b = Math.max(Math.floor(color.b * min), Math.floor(color.b - 255 * pow));\n\t\t\treturn new Color(r, g, b, color.a);\n\t\t};\n\t\tColor.lighter = function (color, pow, max) {\n\t\t\tmax = max || 1;\n\t\t\tvar r = Math.min(color.r + Math.floor((255 - color.r) * max), Math.floor(color.r + 255 * pow));\n\t\t\tvar g = Math.min(color.g + Math.floor((255 - color.g) * max), Math.floor(color.g + 255 * pow));\n\t\t\tvar b = Math.min(color.b + Math.floor((255 - color.b) * max), Math.floor(color.b + 255 * pow));\n\t\t\treturn new Color(r, g, b, color.a);\n\t\t};\n\t\t/*\n\t\tColor.rgbaToHex = function (rgba) {\n\t\t    rgba = rgba.match(/^rgba?[\\s+]?\\([\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?/i);\n\t\t    return (rgba && rgba.length === 4) ? \"#\" +\n\t\t        (\"0\" + parseInt(rgba[1], 10).toString(16)).slice(-2) +\n\t\t        (\"0\" + parseInt(rgba[2], 10).toString(16)).slice(-2) +\n\t\t        (\"0\" + parseInt(rgba[3], 10).toString(16)).slice(-2) : '';\n\t\t}\n\t\t*/\n\t\tColor.prototype = {\n\t\t\ttoUint: function () {\n\t\t\t\treturn (this.r << 24) + (this.g << 16) + (this.b << 8) + (this.a);\n\t\t\t},\n\t\t\ttoHex: function () {\n\t\t\t\treturn '#' + Color.componentToHex(this.r) + Color.componentToHex(this.g) + Color.componentToHex(this.b) + Color.componentToHex(this.a);\n\t\t\t},\n\t\t\ttoRgba: function () {\n\t\t\t\treturn 'rgba(' + this.r + ',' + this.g + ',' + this.b + ',' + (this.a / 255).toFixed(3) + ')';\n\t\t\t},\n\t\t\tdot: function (color) {\n\t\t\t\treturn ((this.r / 255) * (color.r / 255) + (this.g / 255) * (color.g / 255) + (this.b / 255) * (color.b / 255));\n\t\t\t},\n\t\t\talpha: function (pow, min, max) {\n\t\t\t\tmin = min || 0;\n\t\t\t\tmax = max || 1;\n\t\t\t\tthis.a = Math.floor((min + (pow * (max - min))) * 255);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tmakeSet: function () {\n\t\t\t\tthis.foreground = Color.contrast(this);\n\t\t\t\tthis.border = Color.darker(this, 0.3);\n\t\t\t\tthis.light = Color.lighter(this, 0.3);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t};\n\t\treturn Color;\n    }]);\n\n\tapp.factory('Shape', [function () {\n\t\tfunction Shape() {}\n\t\tShape.shapeCircle = function (p, cx, cy, r, sa, ea) {\n\t\t\tsa = sa || 0;\n\t\t\tea = ea || 2 * Math.PI;\n\t\t\tp.ctx.arc(cx, cy, r, sa, ea, false);\n\t\t};\n\t\tShape.shapeStar = function (p, cx, cy, or, ir, steps) {\n\t\t\tvar x, y;\n\t\t\tvar angle = Math.PI / 2 * 3;\n\t\t\tvar step = Math.PI / steps;\n\t\t\tvar ctx = p.ctx;\n\t\t\tctx.moveTo(cx, cy - or);\n\t\t\tfor (i = 0; i < steps; i++) {\n\t\t\t\tx = cx + Math.cos(angle) * or;\n\t\t\t\ty = cy + Math.sin(angle) * or;\n\t\t\t\tctx.lineTo(x, y);\n\t\t\t\tangle += step;\n\t\t\t\tx = cx + Math.cos(angle) * ir;\n\t\t\t\ty = cy + Math.sin(angle) * ir;\n\t\t\t\tctx.lineTo(x, y);\n\t\t\t\tangle += step;\n\t\t\t}\n\t\t\tctx.lineTo(cx, cy - or);\n\t\t};\n\t\tShape.shapeRoundRect = function (p, rect, r) {\n\t\t\tvar ctx = p.ctx,\n\t\t\t\tx = rect.x,\n\t\t\t\ty = rect.y,\n\t\t\t\tw = rect.w,\n\t\t\t\th = rect.h;\n\t\t\tif (typeof r === undefined) {\n\t\t\t\tr = 4;\n\t\t\t}\n\t\t\tif (typeof r === 'number') {\n\t\t\t\tr = {\n\t\t\t\t\ttl: r,\n\t\t\t\t\ttr: r,\n\t\t\t\t\tbr: r,\n\t\t\t\t\tbl: r\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tvar defaultRadius = {\n\t\t\t\t\ttl: 0,\n\t\t\t\t\ttr: 0,\n\t\t\t\t\tbr: 0,\n\t\t\t\t\tbl: 0\n\t\t\t\t};\n\t\t\t\tfor (var key in defaultRadius) {\n\t\t\t\t\tr[key] = r[key] || defaultRadius[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\tctx.moveTo(x + r.tl, y);\n\t\t\tctx.lineTo(x + w - r.tr, y);\n\t\t\tctx.quadraticCurveTo(x + w, y, x + w, y + r.tr);\n\t\t\tctx.lineTo(x + w, y + h - r.br);\n\t\t\tctx.quadraticCurveTo(x + w, y + h, x + w - r.br, y + h);\n\t\t\tctx.lineTo(x + r.bl, y + h);\n\t\t\tctx.quadraticCurveTo(x, y + h, x, y + h - r.bl);\n\t\t\tctx.lineTo(x, y + r.tl);\n\t\t\tctx.quadraticCurveTo(x, y, x + r.tl, y);\n\t\t};\n\t\tShape.circle = function () {\n\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\tvar ctx = params[0].ctx;\n\t\t\tctx.beginPath();\n\t\t\tShape.shapeCircle.apply(this, params);\n\t\t\tctx.closePath();\n\t\t};\n\t\tShape.star = function () {\n\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\tvar ctx = params[0].ctx;\n\t\t\tctx.beginPath();\n\t\t\tShape.shapeStar.apply(this, params);\n\t\t\tctx.closePath();\n\t\t};\n\t\tShape.roundRect = function () {\n\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\tvar ctx = params[0].ctx;\n\t\t\tctx.beginPath();\n\t\t\tShape.shapeRoundRect.apply(this, params);\n\t\t\tctx.closePath();\n\t\t};\n\t\treturn Shape;\n    }]);\n\n\tapp.constant('PainterColors', {\n\t\t/*\n\t\tblack: new Color('0x111111'),\n\t\twhite: new Color('0xffffff'),\n\t\tred: new Color('0xff0000'),\n\t\tgreen: new Color('0x00ff00'),\n\t\tblue: new Color('0x0000ff'),\n\t\tyellow: new Color('0xffff00'),\n\t\tcyan: new Color('0x00ffff'),\n\t\tpurple: new Color('0xff00ff'),\n\t\t*/\n\t\tblack: '0x14191e',\n\t\twhite: '0xffffff',\n\t\tblue: '0x0023FF',\n\t\tred: '0xF21500',\n\t\tlightBlue: '0x79ccf2',\n\t\tlightYellow: '0xfff79a',\n\t\tgreyLighter: '0xf8f8f8',\n\t\tgreyLight: '0xeeeeee',\n\t\tgreyMedium: '0xcccccc',\n\t\tgrey: '0x90939b',\n\t\tmap: '0x24292e',\n\t});\n\n\tapp.factory('Palette', ['$q', 'Painter', 'Rect', function ($q, Painter, Rect) {\n\t\tfunction Palette() {\n\t\t\tthis.painter = new Painter().setSize(0, 0);\n\t\t\tthis.buffer = new Painter().setSize(0, 0);\n\t\t\tthis.size = {\n\t\t\t\tw: 0,\n\t\t\t\th: 0\n\t\t\t};\n\t\t\tthis.pool = {};\n\t\t\tthis.rows = {};\n\t\t}\n\t\tPalette.prototype = {\n\t\t\tgetRect: function (w, h) {\n\t\t\t\tvar p = this.painter,\n\t\t\t\t\tsize = this.size,\n\t\t\t\t\trows = this.rows,\n\t\t\t\t\tr = new Rect(0, 0, w, h),\n\t\t\t\t\trow = rows[h] || {\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: size.h\n\t\t\t\t\t};\n\t\t\t\tsize.w = Math.max(size.w, row.x + w);\n\t\t\t\tsize.h = Math.max(size.h, row.y + h);\n\t\t\t\tif (!p.canvas.width && !p.canvas.height) {\n\t\t\t\t\tp.setSize(size.w, size.h);\n\t\t\t\t} else if (size.w > p.canvas.width || size.h > p.canvas.height) {\n\t\t\t\t\t// var img = new Image();\n\t\t\t\t\t// img.src = p.toDataURL();\n\t\t\t\t\t// document.body.appendChild(canvas);\n\t\t\t\t\t// console.log(p.canvas.width, p.canvas.height);\n\t\t\t\t\t// var data = p.ctx.getImageData(0, 0, p.canvas.width, p.canvas.height);\n\t\t\t\t\tvar canvas = p.canvas;\n\t\t\t\t\tp.setCanvas(document.createElement('canvas'));\n\t\t\t\t\tp.setSize(size.w, size.h);\n\t\t\t\t\tp.ctx.drawImage(canvas, 0, 0);\n\t\t\t\t\t// p.ctx.putImageData(data, 0, 0);\n\t\t\t\t\t// p.ctx.drawImage(img, 0, 0);\n\t\t\t\t\t// document.body.removeChild(canvas);\n\t\t\t\t}\n\t\t\t\tr.x = row.x;\n\t\t\t\tr.y = row.y;\n\t\t\t\trow.x += w;\n\t\t\t\trows[h] = row;\n\t\t\t\treturn r;\n\t\t\t},\n\t\t\tadd: function (key, path) {\n\t\t\t\tvar palette = this;\n\t\t\t\tif (angular.isString(path)) {\n\t\t\t\t\tvar deferred = $q.defer();\n\t\t\t\t\tvar img = new Image();\n\t\t\t\t\timg.onload = function () {\n\t\t\t\t\t\tpalette.addShape(key, img.width, img.height, function (p, rect) {\n\t\t\t\t\t\t\tp.ctx.drawImage(img, 0, 0);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdeferred.resolve(img);\n\t\t\t\t\t};\n\t\t\t\t\timg.onerror = function () {\n\t\t\t\t\t\tdeferred.reject('connot load ' + path);\n\t\t\t\t\t};\n\t\t\t\t\timg.src = path;\n\t\t\t\t\treturn deferred.promise;\n\t\t\t\t} else {\n\t\t\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\t\t\treturn palette.addShape.apply(palette, params);\n\t\t\t\t}\n\t\t\t},\n\t\t\taddShape: function (key, w, h, callback) {\n\t\t\t\tvar p = this.painter,\n\t\t\t\t\tr = this.getRect(w, h);\n\t\t\t\tp.ctx.save();\n\t\t\t\tp.ctx.rect(r.x, r.y, r.w, r.h);\n\t\t\t\t// p.ctx.stroke();\n\t\t\t\tp.ctx.clip();\n\t\t\t\tp.ctx.translate(r.x, r.y);\n\t\t\t\tcallback.call(p, p, r.clone().setPos(0, 0));\n\t\t\t\tp.ctx.restore();\n\t\t\t\tthis.pool[key] = r;\n\t\t\t\t// console.log('Painter.add', r);\n\t\t\t},\n\t\t\tdraw: function (target, key, x, y, pre) {\n\t\t\t\tvar r = this.pool[key];\n\t\t\t\tif (r) {\n\t\t\t\t\t// var ctx = target.ctx;\n\t\t\t\t\t// ctx.save();\n\t\t\t\t\ttarget.drawRect(this.painter.canvas, r, {\n\t\t\t\t\t\tx: x,\n\t\t\t\t\t\ty: y,\n\t\t\t\t\t\tw: r.w,\n\t\t\t\t\t\th: r.h\n\t\t\t\t\t}, pre);\n\t\t\t\t\t// target.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, x - r.w / 2, y - r.h / 2, r.w, r.h);\n\t\t\t\t\t// ctx.restore();\n\t\t\t\t}\n\t\t\t},\n\t\t\ttint: function (target, key, x, y, color, pre) {\n\t\t\t\tvar r = this.pool[key];\n\t\t\t\tif (r) {\n\t\t\t\t\tvar p = this.painter,\n\t\t\t\t\t\tb = this.buffer.setSize(r.w, r.h);\n\t\t\t\t\tb.save();\n\t\t\t\t\tb.setFill(color);\n\t\t\t\t\tb.fillRect();\n\t\t\t\t\tb.ctx.globalCompositeOperation = \"destination-atop\";\n\t\t\t\t\tb.ctx.drawImage(p.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n\t\t\t\t\tb.restore();\n\t\t\t\t\tconsole.log(x, y, b.canvas, target.canvas);\n\t\t\t\t\ttarget.draw(b.canvas, {\n\t\t\t\t\t\tx: x,\n\t\t\t\t\t\ty: y\n\t\t\t\t\t}, pre);\n\t\t\t\t}\n\t\t\t},\n\t\t\tpattern: function (target, key, x, y, w, h, color) {\n\t\t\t\tfunction drawPattern(pattern) {\n\t\t\t\t\tvar ctx = target.ctx;\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\t// draw\n\t\t\t\t\t// ctx.beginPath();\n\t\t\t\t\t// ctx.rect(-x, -y, w, h);\n\t\t\t\t\tctx.fillStyle = pattern;\n\t\t\t\t\tctx.fillRect(-x, -y, w, h);\n\t\t\t\t\tctx.translate(-x, -y);\n\t\t\t\t\t// ctx.fill();\n\t\t\t\t\tctx.restore();\n\t\t\t\t}\n\t\t\t\tvar r = this.pool[key];\n\t\t\t\tif (r) {\n\t\t\t\t\tvar img = r.img,\n\t\t\t\t\t\tpattern;\n\t\t\t\t\tif (!img || r.color != color) {\n\t\t\t\t\t\tvar b = this.buffer.setSize(r.w, r.h);\n\t\t\t\t\t\tif (color) {\n\t\t\t\t\t\t\tr.color = color;\n\t\t\t\t\t\t\tb.save();\n\t\t\t\t\t\t\tb.setFill(color);\n\t\t\t\t\t\t\tb.fillRect();\n\t\t\t\t\t\t\tb.ctx.globalCompositeOperation = \"destination-atop\";\n\t\t\t\t\t\t\tb.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n\t\t\t\t\t\t\tb.restore();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tb.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n\t\t\t\t\t\t}\n\t\t\t\t\t\timg = new Image();\n\t\t\t\t\t\timg.onload = function () {\n\t\t\t\t\t\t\tr.img = img;\n\t\t\t\t\t\t\tpattern = target.ctx.createPattern(img, \"repeat\");\n\t\t\t\t\t\t\tdrawPattern(pattern);\n\t\t\t\t\t\t};\n\t\t\t\t\t\timg.src = b.toDataURL();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpattern = target.ctx.createPattern(img, \"repeat\");\n\t\t\t\t\t\tdrawPattern(pattern);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t\treturn Palette;\n    }]);\n\n\tapp.factory('Painter', ['Shape', 'Rect', 'Color', 'PainterColors', function (Shape, Rect, Color, PainterColors) {\n\t\tfunction Painter(canvas) {\n\t\t\tcanvas = canvas || document.createElement('canvas');\n\t\t\tthis.rect = new Rect();\n\t\t\tthis.drawingRect = new Rect();\n\t\t\tthis.setColors();\n\t\t\tthis.setCanvas(canvas);\n\t\t}\n\t\tPainter.colors = {};\n\t\tangular.forEach(PainterColors, function (value, key) {\n\t\t\tPainter.colors[key] = new Color(value).makeSet();\n\t\t});\n\t\tvar colors = Painter.colors;\n\t\tPainter.prototype = {\n\t\t\tcolors: Painter.colors,\n\t\t\tsetColors: function () {\n\t\t\t\tvar colors = this.colors;\n\t\t\t\tangular.forEach(PainterColors, function (value, key) {\n\t\t\t\t\tcolors[key] = new Color(value).makeSet();\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCanvas: function (canvas) {\n\t\t\t\tthis.canvas = canvas;\n\t\t\t\tthis.setSize(canvas.offsetWidth, canvas.offsetHeight);\n\t\t\t\tvar ctx = canvas.getContext('2d');\n\t\t\t\tctx.lineCap = 'square';\n\t\t\t\tthis.ctx = ctx;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetSize: function (w, h) {\n\t\t\t\tthis.canvas.width = w;\n\t\t\t\tthis.canvas.height = h;\n\t\t\t\tthis.rect.w = w;\n\t\t\t\tthis.rect.h = h;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tcopy: function (canvas) {\n\t\t\t\tthis.ctx.drawImage(canvas, 0, 0);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tclear: function () {\n\t\t\t\tthis.resize();\n\t\t\t\t// this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tresize: function () {\n\t\t\t\tthis.setSize(this.canvas.offsetWidth, this.canvas.offsetHeight);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetText: function (font, align, verticalAlign, color) {\n\t\t\t\tfont = font || '11px monospace';\n\t\t\t\talign = align || 'center';\n\t\t\t\tverticalAlign = verticalAlign || 'middle';\n\t\t\t\tcolor = color || this.colors.black;\n\t\t\t\tvar ctx = this.ctx;\n\t\t\t\tctx.font = font;\n\t\t\t\tctx.textAlign = align;\n\t\t\t\tctx.textBaseline = verticalAlign;\n\t\t\t\tctx.fillStyle = color.toRgba();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetFill: function (color) {\n\t\t\t\tcolor = color || this.colors.black;\n\t\t\t\tvar ctx = this.ctx;\n\t\t\t\t/*\n\t\t\t\tvar my_gradient = ctx.createLinearGradient(0, 0, 0, 170);\n\t\t\t\tmy_gradient.addColorStop(0, \"black\");\n\t\t\t\tmy_gradient.addColorStop(1, \"white\");\n\t\t\t\tctx.fillStyle = my_gradient;\n\t\t\t\t*/\n\t\t\t\tctx.fillStyle = color.toRgba();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetStroke: function (color, size) {\n\t\t\t\tcolor = color || this.colors.black;\n\t\t\t\tvar ctx = this.ctx;\n\t\t\t\tsize = size || 1;\n\t\t\t\t/*\n\t\t\t\tvar gradient=ctx.createLinearGradient(0,0,170,0);\n\t\t\t\tgradient.addColorStop(\"0\",\"magenta\");\n\t\t\t\tgradient.addColorStop(\"0.5\",\"blue\");\n\t\t\t\tgradient.addColorStop(\"1.0\",\"red\");\n\t\t\t\tctx.strokeStyle = gradient;\n\t\t\t\t*/\n\t\t\t\t// Fill with gradient\n\t\t\t\tctx.strokeStyle = color.toRgba();\n\t\t\t\tctx.lineWidth = size;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t/*\n\t\t\tdrawRoundRect: function (rect, r) {\n\t\t\t    rect = rect || this.rect;\n\t\t\t    Shape.roundRect(this, rect, r);\n\t\t\t    return this;\n\t\t\t},\n\t\t\t*/\n\t\t\tfillText: function (text, point, width, post, maxLength) {\n\t\t\t\tif (width) {\n\t\t\t\t\tpost = post || '';\n\t\t\t\t\tmaxLength = maxLength || Math.floor(width / 8);\n\t\t\t\t\tif (text.length > maxLength) {\n\t\t\t\t\t\ttext = text.substr(0, Math.min(text.length, maxLength)).trim() + post;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.ctx.fillText(text, point.x, point.y);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tfillRect: function (rect) {\n\t\t\t\trect = rect || this.rect;\n\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\tx = rect.x,\n\t\t\t\t\ty = rect.y,\n\t\t\t\t\tw = rect.w,\n\t\t\t\t\th = rect.h;\n\t\t\t\tctx.fillRect(x, y, w, h);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tstrokeRect: function (rect) {\n\t\t\t\trect = rect || this.rect;\n\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\tx = rect.x,\n\t\t\t\t\ty = rect.y,\n\t\t\t\t\tw = rect.w,\n\t\t\t\t\th = rect.h;\n\t\t\t\tctx.strokeRect(x, y, w, h);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tfill: function () {\n\t\t\t\tthis.ctx.fill();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tstroke: function () {\n\t\t\t\tthis.ctx.stroke();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tbegin: function () {\n\t\t\t\tthis.ctx.beginPath();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tclose: function () {\n\t\t\t\tthis.ctx.closePath();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsave: function () {\n\t\t\t\tthis.ctx.save();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\trestore: function () {\n\t\t\t\tthis.ctx.restore();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\trotate: function (angle) {\n\t\t\t\tthis.ctx.rotate(angle * Math.PI / 180);\n\t\t\t},\n\t\t\ttranslate: function (xy) {\n\t\t\t\tthis.ctx.translate(xy.x, xy.y);\n\t\t\t},\n\t\t\ttoDataURL: function () {\n\t\t\t\treturn this.canvas.toDataURL();\n\t\t\t},\n\t\t\tdraw: function (image, t, pre) {\n\t\t\t\tif (image) {\n\t\t\t\t\tt.w = t.w || image.width;\n\t\t\t\t\tt.h = t.h || image.height;\n\t\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\t\trect = this.drawingRect,\n\t\t\t\t\t\tx = rect.x = t.x - t.w / 2,\n\t\t\t\t\t\ty = rect.y = t.y - t.h / 2,\n\t\t\t\t\t\tw = rect.w = t.w,\n\t\t\t\t\t\th = rect.h = t.h;\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\tif (pre) {\n\t\t\t\t\t\tpre.call(this);\n\t\t\t\t\t}\n\t\t\t\t\tctx.drawImage(image, 0, 0);\n\t\t\t\t\tctx.restore();\n\t\t\t\t\t// console.log('painter.draw', x, y, w, h);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tdrawRect: function (image, s, t, pre) {\n\t\t\t\tif (image) {\n\t\t\t\t\ts.w = s.w || image.width;\n\t\t\t\t\ts.h = s.h || image.height;\n\t\t\t\t\tt.w = t.w || image.width;\n\t\t\t\t\tt.h = t.h || image.height;\n\t\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\t\trect = this.drawingRect,\n\t\t\t\t\t\tx = rect.x = t.x - s.w / 2,\n\t\t\t\t\t\ty = rect.y = t.y - s.h / 2,\n\t\t\t\t\t\tw = rect.w = t.w,\n\t\t\t\t\t\th = rect.h = t.h;\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\tif (pre) {\n\t\t\t\t\t\tpre.call(this);\n\t\t\t\t\t}\n\t\t\t\t\tctx.drawImage(image, s.x, s.y, s.w, s.h, 0, 0, t.w, t.h);\n\t\t\t\t\tctx.restore();\n\t\t\t\t\t// console.log('painter.drawRect', x, y, w, h);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tflip: function (scale) {\n\t\t\t\tscale = scale || {\n\t\t\t\t\tx: 1,\n\t\t\t\t\ty: -1\n\t\t\t\t};\n\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\trect = this.drawingRect;\n\t\t\t\tctx.translate(scale.x === -1 ? rect.w : 0, scale.y === -1 ? rect.h : 0);\n\t\t\t\tctx.scale(scale.x, scale.y);\n\t\t\t},\n\t\t};\n\t\treturn Painter;\n    }]);\n\n}());\n\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.directive('expandable', ['$parse', 'State', 'Dom', function ($parse, State, Dom) {\n\n\t\tvar directive = {\n\t\t\trestrict: 'A',\n\t\t\t// template: '<div ng-transclude></div>',\n\t\t\t// transclude: true,\n\t\t\t// replace: true,\n\t\t\t/*\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\treturn attributes.template || 'artisan/components/nav/partial/nav';\n            },\n            */\n\t\t\tlink: ExpandableLink,\n\t\t};\n\n\t\treturn directive;\n\n\t\tfunction ExpandableLink(scope, element, attributes, model) {\n\n\t\t\tvar state = new State();\n\t\t\tstate.pow = 0;\n\n\t\t\tvar relative, absolute;\n\n\t\t\tvar target, targetElement;\n\n\t\t\tvar from, to, current,\n\t\t\t\tboundingClientRect, styleObj, originalCssText;\n\n\t\t\tvar absolute, relative;\n\n\t\t\tvar expanded = false;\n\n\t\t\tvar placeholder = document.createElement('div'),\n\t\t\t\tplaceholderElement = angular.element(placeholder);\n\t\t\tplaceholderElement.addClass('expandable-placeholder');\n\n\t\t\tfunction getStyle(node) {\n\t\t\t\tvar style = window.getComputedStyle(node, null);\n\t\t\t\tvar styleObj = {\n\t\t\t\t\t'display': style.getPropertyValue('display'),\n\t\t\t\t\t'position': style.getPropertyValue('position'),\n\t\t\t\t\t'width': style.getPropertyValue('width'),\n\t\t\t\t\t'height': style.getPropertyValue('height'),\n\t\t\t\t\t'top': style.getPropertyValue('top'),\n\t\t\t\t\t'right': style.getPropertyValue('right'),\n\t\t\t\t\t'bottom': style.getPropertyValue('bottom'),\n\t\t\t\t\t'left': style.getPropertyValue('left'),\n\t\t\t\t\t'margin-top': style.getPropertyValue('margin-top'),\n\t\t\t\t\t'margin-right': style.getPropertyValue('margin-right'),\n\t\t\t\t\t'margin-bottom': style.getPropertyValue('margin-bottom'),\n\t\t\t\t\t'margin-left': style.getPropertyValue('margin-left'),\n\t\t\t\t\t'padding-top': style.getPropertyValue('padding-top'),\n\t\t\t\t\t'padding-right': style.getPropertyValue('padding-right'),\n\t\t\t\t\t'padding-bottom': style.getPropertyValue('padding-bottom'),\n\t\t\t\t\t'padding-left': style.getPropertyValue('padding-left'),\n\t\t\t\t\t'background-color': style.getPropertyValue('background-color'),\n\t\t\t\t};\n\t\t\t\treturn styleObj;\n\t\t\t}\n\n\t\t\tfunction getTextStyle(style) {\n\t\t\t\tvar text = '';\n\t\t\t\tangular.forEach(style, function (value, key) {\n\t\t\t\t\ttext += key + ': ' + value + '; ';\n\t\t\t\t});\n\t\t\t\treturn text;\n\t\t\t}\n\n\t\t\tfunction setStyle(node, style) {\n\t\t\t\tnode.style.cssText = getTextStyle(style);\n\t\t\t}\n\n\t\t\tfunction add() {\n\t\t\t\tstyleObj = getStyle(target);\n\t\t\t\tsetStyle(placeholder, styleObj);\n\t\t\t\ttarget.parentNode.insertBefore(placeholder, target);\n\t\t\t\toriginalCssText = target.style.cssText;\n\t\t\t\ttargetElement.addClass('expandable-expanding');\n\t\t\t\tDom.getParents(target).each(function (element, node) {\n\t\t\t\t\telement.addClass('expandable-parent');\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction remove() {\n\t\t\t\ttarget.style.cssText = originalCssText;\n\t\t\t\ttargetElement.removeClass('expandable-expanding');\n\t\t\t\tplaceholder.parentNode.removeChild(placeholder);\n\t\t\t\tDom.getParents(target).each(function (element, node) {\n\t\t\t\t\telement.removeClass('expandable-parent');\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction setRects() {\n\t\t\t\tif (targetElement && targetElement.hasClass('expandable-expanding')) {\n\t\t\t\t\tboundingClientRect = placeholder.getBoundingClientRect();\n\t\t\t\t} else {\n\t\t\t\t\tboundingClientRect = target.getBoundingClientRect();\n\t\t\t\t}\n\t\t\t\tfrom = {\n\t\t\t\t\ttop: 0,\n\t\t\t\t\tleft: 0,\n\t\t\t\t\twidth: boundingClientRect.width, // parseInt(styleObj.width), // boundingClientRect.width,\n\t\t\t\t\theight: boundingClientRect.height, // parseInt(styleObj.height), // boundingClientRect.height,\n\t\t\t\t};\n\t\t\t\tto = {\n\t\t\t\t\ttop: 0 + (relative.top || 0),\n\t\t\t\t\tleft: 0 + (relative.left || 0),\n\t\t\t\t\twidth: from.width + (relative.right || 0),\n\t\t\t\t\theight: from.height + (relative.bottom || 0),\n\t\t\t\t};\n\t\t\t\tif (absolute.top) {\n\t\t\t\t\tto.top = absolute.top - boundingClientRect.top;\n\t\t\t\t}\n\t\t\t\tif (absolute.left) {\n\t\t\t\t\tto.left = absolute.left - boundingClientRect.left;\n\t\t\t\t}\n\t\t\t\tif (absolute.right) {\n\t\t\t\t\tvar absoluteRight = (window.innerWidth - absolute.right);\n\t\t\t\t\tvar absoluteLeft = boundingClientRect.left + to.left;\n\t\t\t\t\tto.width = absoluteRight - absoluteLeft;\n\t\t\t\t}\n\t\t\t\tif (absolute.bottom) {\n\t\t\t\t\tvar absoluteBottom = (window.innerHeight - absolute.bottom);\n\t\t\t\t\tvar absoluteTop = boundingClientRect.top + to.top;\n\t\t\t\t\tto.height = absoluteBottom - absoluteTop;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction expand() {\n\t\t\t\tif (!expanded) {\n\t\t\t\t\tsetRects();\n\t\t\t\t\tadd();\n\t\t\t\t\tcurrent = angular.copy(from);\n\t\t\t\t\tsetStyle(target, from);\n\t\t\t\t\tdynamics.animate(state, {\n\t\t\t\t\t\tpow: 1\n\t\t\t\t\t}, {\n\t\t\t\t\t\ttype: dynamics.easeInOut,\n\t\t\t\t\t\tduration: 350,\n\t\t\t\t\t\tcomplete: function () {\n\t\t\t\t\t\t\texpanded = true;\n\t\t\t\t\t\t\tstate.idle();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tchange: function () {\n\t\t\t\t\t\t\tupdate();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tstate.idle();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction contract() {\n\t\t\t\tif (expanded) {\n\t\t\t\t\tdynamics.animate(state, {\n\t\t\t\t\t\tpow: 0\n\t\t\t\t\t}, {\n\t\t\t\t\t\ttype: dynamics.easeInOut,\n\t\t\t\t\t\tduration: 350,\n\t\t\t\t\t\tcomplete: function () {\n\t\t\t\t\t\t\texpanded = false;\n\t\t\t\t\t\t\tremove();\n\t\t\t\t\t\t\tstate.idle();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tchange: function () {\n\t\t\t\t\t\t\tupdate();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tstate.idle();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction update() {\n\t\t\t\tcurrent.left = (from.left + (to.left - from.left) * state.pow) + 'px';\n\t\t\t\tcurrent.top = (from.top + (to.top - from.top) * state.pow) + 'px';\n\t\t\t\tcurrent.width = (from.width + (to.width - from.width) * state.pow) + 'px';\n\t\t\t\tcurrent.height = (from.height + (to.height - from.height) * state.pow) + 'px';\n\t\t\t\tsetStyle(target, current);\n\t\t\t}\n\n\t\t\tfunction toggle() {\n\t\t\t\tif (state.busy()) {\n\t\t\t\t\tif (expanded) {\n\t\t\t\t\t\tcontract();\n\t\t\t\t\t} else {\n\t\t\t\t\t\texpand();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction set() {\n\t\t\t\trelative = attributes.expandableRelative ? $parse(attributes.expandableRelative)(scope) : {};\n\t\t\t\tabsolute = attributes.expandableAbsolute ? $parse(attributes.expandableAbsolute)(scope) : {};\n\t\t\t\ttarget = element[0].querySelector(attributes.expandable);\n\t\t\t\tif (target) {\n\t\t\t\t\ttargetElement = angular.element(target);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction onDown(e) {\n\t\t\t\tset();\n\t\t\t\tif (target) {\n\t\t\t\t\texpand();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction onUp(e) {\n\t\t\t\tif (Dom.getClosestNode(e.target, element[0])) {\n\t\t\t\t\t// nope\n\t\t\t\t} else {\n\t\t\t\t\tset();\n\t\t\t\t\tif (target) {\n\t\t\t\t\t\tcontract();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction onResize(e) {\n\t\t\t\tif (expanded || state.isBusy) {\n\t\t\t\t\tsetRects();\n\t\t\t\t\tupdate();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction onKeyDown(e) {\n\t\t\t\tvar key = e.key.toLowerCase();\n\t\t\t\tswitch (key) {\n\t\t\t\t\tcase 'escape':\n\t\t\t\t\t\tset();\n\t\t\t\t\t\tif (target) {\n\t\t\t\t\t\t\tcontract();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'enter':\n\t\t\t\t\t\tset();\n\t\t\t\t\t\tif (target && target.tagName && target.tagName.toLowerCase() === 'input') {\n\t\t\t\t\t\t\tcontract();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction addListeners() {\n\t\t\t\telement\n\t\t\t\t\t.on('mousedown touchstart', onDown)\n\t\t\t\t\t.on('keydown', onKeyDown);\n\t\t\t\tangular.element(window)\n\t\t\t\t\t.on('click', onUp)\n\t\t\t\t\t.on('resize', onResize);\n\t\t\t}\n\n\t\t\tfunction removeListeners() {\n\t\t\t\telement\n\t\t\t\t\t.off('mousedown touchstart', onDown)\n\t\t\t\t\t.off('keydown', onKeyDown);\n\t\t\t\tangular.element(window)\n\t\t\t\t\t.off('click', onUp)\n\t\t\t\t\t.off('resize', onResize);\n\t\t\t}\n\n\t\t\tscope.$on('$destroy', function () {\n\t\t\t\tremoveListeners();\n\t\t\t});\n\n\t\t\taddListeners();\n\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.directive('controlMessages', [function () {\n\t\treturn {\n\t\t\trestrict: 'E',\n\t\t\ttemplateUrl: 'artisan/components/forms/partial/messages',\n\t\t\ttransclude: {\n\t\t\t\t'message': '?messageItems',\n\t\t\t},\n\t\t\tlink: function (scope, element, attributes, model) {}\n\t\t};\n    }]);\n\n\tapp.directive('control', ['$parse', function ($parse) {\n\t\tfunction formatLabel(string, prepend, expression) {\n\t\t\tstring = string || '';\n\t\t\tprepend = prepend || '';\n\t\t\tvar splitted = string.split(',');\n\t\t\tif (splitted.length > 1) {\n\t\t\t\tvar formatted = splitted.shift();\n\t\t\t\tangular.forEach(splitted, function (value, index) {\n\t\t\t\t\tif (expression) {\n\t\t\t\t\t\tformatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tformatted = formatted.split('{' + index + '}').join(prepend + value);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (expression) {\n\t\t\t\t\treturn '\\'' + formatted + '\\'';\n\t\t\t\t} else {\n\t\t\t\t\treturn formatted;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn prepend + string;\n\t\t\t}\n\t\t}\n\t\tvar uniqueId = 0;\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\tvar template = 'artisan/components/forms/partial/text';\n\t\t\t\tswitch (attributes.control) {\n\t\t\t\t\tcase 'select':\n\t\t\t\t\t\ttemplate = 'artisan/components/forms/partial/select';\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\treturn template;\n\t\t\t},\n\t\t\tscope: {\n\t\t\t\tngModel: '=',\n\t\t\t\trequired: '=',\n\t\t\t\tform: '@',\n\t\t\t\ttitle: '@',\n\t\t\t\tplaceholder: '@',\n\t\t\t\tsource: '=?',\n\t\t\t\tkey: '@?',\n\t\t\t\tlabel: '@?',\n\t\t\t},\n\t\t\trequire: 'ngModel',\n\t\t\ttransclude: true,\n\t\t\tlink: {\n\t\t\t\tpre: function preLink(scope, element, attributes, controller, transclude) {\n\t\t\t\t\tvar label = scope.label = (scope.label ? scope.label : 'name');\n\t\t\t\t\tvar key = scope.key = (scope.key ? scope.key : 'id');\n\t\t\t\t\tif (attributes.control === 'select') {\n\t\t\t\t\t\tvar filter = (attributes.filter ? '| ' + attributes.filter : '');\n\t\t\t\t\t\tvar optionLabel = formatLabel(label, 'item.', true);\n\t\t\t\t\t\tscope.getOptions = function () {\n\t\t\t\t\t\t\treturn attributes.number ?\n\t\t\t\t\t\t\t\t'item.' + key + ' as ' + optionLabel + ' disable when item.disabled for item in source ' + filter :\n\t\t\t\t\t\t\t\toptionLabel + ' disable when item.disabled for item in source ' + filter + ' track by item.' + key;\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tvar type = scope.type = attributes.control;\n\t\t\t\t\tvar form = scope.form = scope.form || 'form';\n\t\t\t\t\tvar title = scope.title = scope.title || 'untitled';\n\t\t\t\t\tvar placeholder = scope.placeholder = scope.placeholder || title;\n\t\t\t\t\tvar field = scope.field = title.replace(/[^0-9a-zA-Z]/g, \"\").split(' ').join('') + (++uniqueId);\n\t\t\t\t\tscope.format = attributes.format || null;\n\t\t\t\t\tscope.precision = attributes.precision || null;\n\t\t\t\t\tscope.validate = attributes.validate || attributes.control;\n\t\t\t\t\tscope.minLength = attributes.minLength || 0;\n\t\t\t\t\tscope.maxLength = attributes.maxLength || Number.POSITIVE_INFINITY;\n\t\t\t\t\tscope.min = attributes.min || null;\n\t\t\t\t\tscope.max = attributes.max || null;\n\t\t\t\t\tscope.options = $parse(attributes.options)(scope) || {};\n\t\t\t\t\tscope.focus = false;\n\t\t\t\t\tscope.visible = false;\n\t\t\t\t\tscope.onChange = function (model) {\n\t\t\t\t\t\t$parse(attributes.onChange)(scope.$parent);\n\t\t\t\t\t};\n\t\t\t\t\tscope.onFilter = function (model) {\n\t\t\t\t\t\t$parse(attributes.onFilter)(scope.$parent);\n\t\t\t\t\t};\n\t\t\t\t\tscope.getType = function () {\n\t\t\t\t\t\tvar type = 'text';\n\t\t\t\t\t\tswitch (attributes.control) {\n\t\t\t\t\t\t\tcase 'password':\n\t\t\t\t\t\t\t\ttype = scope.visible ? 'text' : 'password';\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\ttype = attributes.control;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn type;\n\t\t\t\t\t};\n\t\t\t\t\tscope.getClasses = function () {\n\t\t\t\t\t\tvar form = $parse(scope.form)(scope.$parent);\n\t\t\t\t\t\tvar field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t'control-focus': scope.focus,\n\t\t\t\t\t\t\t'control-success': field.$valid,\n\t\t\t\t\t\t\t'control-error': field.$invalid && (form.$submitted || field.$touched),\n\t\t\t\t\t\t\t'control-empty': !field.$viewValue\n\t\t\t\t\t\t};\n\t\t\t\t\t};\n\t\t\t\t\tscope.getMessages = function () {\n\t\t\t\t\t\tvar form = $parse(scope.form)(scope.$parent);\n\t\t\t\t\t\tvar field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n\t\t\t\t\t\treturn (form.$submitted || field.$touched) && field.$error;\n\t\t\t\t\t};\n\t\t\t\t\tscope.toggleVisibility = function () {\n\t\t\t\t\t\tscope.visible = !scope.visible;\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t},\n\t\t};\n    }]);\n\n\tapp.directive('_control', ['$http', '$templateCache', '$compile', '$parse', function ($http, $templateCache, $compile, $parse) {\n\t\tfunction formatLabel(string, prepend, expression) {\n\t\t\tstring = string || '';\n\t\t\tprepend = prepend || '';\n\t\t\tvar splitted = string.split(',');\n\t\t\tif (splitted.length > 1) {\n\t\t\t\tvar formatted = splitted.shift();\n\t\t\t\tangular.forEach(splitted, function (value, index) {\n\t\t\t\t\tif (expression) {\n\t\t\t\t\t\tformatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tformatted = formatted.split('{' + index + '}').join(prepend + value);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (expression) {\n\t\t\t\t\treturn '\\'' + formatted + '\\'';\n\t\t\t\t} else {\n\t\t\t\t\treturn formatted;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn prepend + string;\n\t\t\t}\n\t\t}\n\t\tvar uniqueId = 0;\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\tvar template = 'artisan/components/forms/partial/text';\n\t\t\t\tswitch (attributes.control) {\n\t\t\t\t\tcase 'select':\n\t\t\t\t\t\ttemplate = 'artisan/components/forms/partial/select';\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\treturn template;\n\t\t\t},\n\t\t\tscope: {\n\t\t\t\tngModel: '=',\n\t\t\t\trequired: '=',\n\t\t\t\tform: '@',\n\t\t\t\ttitle: '@',\n\t\t\t\tplaceholder: '@',\n\t\t\t},\n\t\t\trequire: 'ngModel',\n\t\t\t/*\n\t\t\tlink: function(scope, element, attributes, model) {\n\t\t\t},\n\t\t\t*/\n\t\t\tcompile: function (element, attributes) {\n\t\t\t\treturn {\n\t\t\t\t\tpre: function (scope, element, attributes) {\n\t\t\t\t\t\tif (attributes.control === 'select') {\n\t\t\t\t\t\t\tvar label = (attributes.label ? attributes.label : 'name');\n\t\t\t\t\t\t\tvar key = (attributes.key ? attributes.key : 'id');\n\t\t\t\t\t\t\tvar filter = (attributes.min ? ' | filter:gte(\\'' + key + '\\', ' + attributes.min + ')' : '');\n\t\t\t\t\t\t\tvar optionLabel = formatLabel(label, 'item.', true);\n\t\t\t\t\t\t\tscope.options = attributes.number ?\n\t\t\t\t\t\t\t\t'item.' + key + ' as ' + optionLabel + ' disable when item.disabled for item in ' + attributes.source + filter :\n\t\t\t\t\t\t\t\toptionLabel + ' disable when item.disabled for item in ' + attributes.source + filter + ' track by item.' + key;\n\t\t\t\t\t\t\tconsole.log('control.compile.pre', scope.options);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar type = scope.type = attributes.control;\n\t\t\t\t\t\tvar form = scope.form = scope.form || 'form';\n\t\t\t\t\t\tvar title = scope.title = scope.title || 'untitled';\n\t\t\t\t\t\tvar placeholder = scope.placeholder = scope.placeholder || title;\n\t\t\t\t\t\tvar field = scope.field = title.replace(/[^0-9a-zA-Z]/g, \"\").split(' ').join('') + (++uniqueId);\n\t\t\t\t\t\tscope.validate = attributes.validate || attributes.control;\n\t\t\t\t\t\tscope.format = attributes.format || null;\n\t\t\t\t\t\tscope.precision = attributes.precision || null;\n\t\t\t\t\t\tscope.validate = attributes.validate || attributes.control;\n\t\t\t\t\t\tscope.minLength = attributes.min || 0;\n\t\t\t\t\t\tscope.maxLength = attributes.max || Number.POSITIVE_INFINITY;\n\t\t\t\t\t\tscope.options = $parse(attributes.options)(scope) || {};\n\t\t\t\t\t\tscope.focus = false;\n\t\t\t\t\t\tscope.visible = false;\n\t\t\t\t\t\tscope.getType = function () {\n\t\t\t\t\t\t\tvar type = 'text';\n\t\t\t\t\t\t\tswitch (attributes.control) {\n\t\t\t\t\t\t\t\tcase 'password':\n\t\t\t\t\t\t\t\t\t// var form = $parse(scope.form)(scope.$parent);\n\t\t\t\t\t\t\t\t\t// var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n\t\t\t\t\t\t\t\t\ttype = scope.visible ? 'text' : 'password';\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\ttype = attributes.control;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// console.log('control.getType', type);\n\t\t\t\t\t\t\treturn type;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tscope.getClasses = function () {\n\t\t\t\t\t\t\tvar form = $parse(scope.form)(scope.$parent);\n\t\t\t\t\t\t\tvar field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t'control-focus': scope.focus,\n\t\t\t\t\t\t\t\t'control-success': field.$valid,\n\t\t\t\t\t\t\t\t'control-error': field.$invalid && (form.$submitted || field.$touched),\n\t\t\t\t\t\t\t\t'control-empty': !field.$viewValue\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t};\n\t\t\t\t\t\tscope.getMessages = function () {\n\t\t\t\t\t\t\tvar form = $parse(scope.form)(scope.$parent);\n\t\t\t\t\t\t\tvar field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n\t\t\t\t\t\t\treturn (form.$submitted || field.$touched) && field.$error;\n\t\t\t\t\t\t};\n\t\t\t\t\t},\n\t\t\t\t\t// post: function (scope, element, attributes) { }\n\t\t\t\t};\n\t\t\t}\n\t\t\t/*\n\t\t\tcompile: function(element, attributes) {\n\t\t\t    element.removeAttr('my-dir'); \n\t\t\t    element.attr('ng-hide', 'true');\n\t\t\t    return function(scope) {\n\t\t\t        $compile(element)(scope);\n\t\t\t    };\n\t\t\t},\n\t\t\t*/\n\t\t};\n    }]);\n\n\tapp.directive('numberPicker', ['$parse', '$timeout', function ($parse, $timeout) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplate: '<div class=\"input-group\">' +\n\t\t\t\t'   <span class=\"input-group-btn\"><button class=\"btn btn-outline-primary\" type=\"button\">-</button></span>' +\n\t\t\t\t'   <div ng-transclude></div>' +\n\t\t\t\t'   <span class=\"input-group-btn\"><button class=\"btn btn-outline-primary\" type=\"button\">+</button></span>' +\n\t\t\t\t'</div>',\n\t\t\treplace: true,\n\t\t\ttransclude: true,\n\t\t\tlink: function (scope, element, attributes, model) {\n\t\t\t\tvar node = element[0];\n\t\t\t\tvar nodeRemove = node.querySelectorAll('.input-group-btn > .btn')[0];\n\t\t\t\tvar nodeAdd = node.querySelectorAll('.input-group-btn > .btn')[1];\n\n\t\t\t\tfunction onRemove(e) {\n\t\t\t\t\tvar min = $parse(attributes.min)(scope);\n\t\t\t\t\tvar getter = $parse(attributes.numberPicker);\n\t\t\t\t\tvar setter = getter.assign;\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tsetter(scope, Math.max(min, getter(scope) - 1));\n\t\t\t\t\t});\n\t\t\t\t\t// console.log('numberPicker.onRemove', min);\n\t\t\t\t}\n\n\t\t\t\tfunction onAdd(e) {\n\t\t\t\t\tvar max = $parse(attributes.max)(scope);\n\t\t\t\t\tvar getter = $parse(attributes.numberPicker);\n\t\t\t\t\tvar setter = getter.assign;\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tsetter(scope, Math.min(max, getter(scope) + 1));\n\t\t\t\t\t});\n\t\t\t\t\t// console.log('numberPicker.onAdd', max);\n\t\t\t\t}\n\n\t\t\t\tfunction addListeners() {\n\t\t\t\t\tangular.element(nodeRemove).on('touchstart mousedown', onRemove);\n\t\t\t\t\tangular.element(nodeAdd).on('touchstart mousedown', onAdd);\n\t\t\t\t}\n\n\t\t\t\tfunction removeListeners() {\n\t\t\t\t\tangular.element(nodeRemove).off('touchstart mousedown', onRemove);\n\t\t\t\t\tangular.element(nodeAdd).off('touchstart mousedown', onAdd);\n\t\t\t\t}\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tremoveListeners();\n\t\t\t\t});\n\t\t\t\taddListeners();\n\t\t\t}\n\t\t};\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.directive('validate', ['$filter', function($filter) {\n        return {\n            require: 'ngModel',\n            link: function(scope, element, attributes, model) {\n                var type = attributes.validate;\n                var format = attributes.format || '';\n                var precision = attributes.precision || 2;\n                var focus = false;\n                // console.log('validate', type);\n                switch (type) {\n                    case 'date':\n                    case 'datetime':\n                    case 'datetime-local':\n                        model.$formatters.push(function(value) {\n                            if (value) {\n                                return $filter('date')(value, format);\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                    case 'number':\n                        model.$parsers.unshift(function(value) {\n                            var valid = false;\n                            if (value !== undefined && value !== \"\") {\n                                valid = String(value).indexOf(Number(value).toString()) !== -1; // isFinite(value); // \n                                value = Number(value);\n                                model.$setValidity('number', valid);\n                                if (valid) {\n                                    model.$setValidity('positive', value >= 0.01);\n                                    if (attributes.min !== undefined) {\n                                        model.$setValidity('range', value >= Number(attributes.min));\n                                    }\n                                    if (attributes.max !== undefined) {\n                                        model.$setValidity('range', value <= Number(attributes.max));\n                                    }\n                                }\n                            } else {\n                                valid = true;\n                                value = Number(value);\n                                model.$setValidity('number', true);\n                                model.$setValidity('positive', true);\n                                if (attributes.min !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                                if (attributes.max !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                            }\n                            return value;\n                        });\n                        model.$formatters.push(function(value) {\n                            if (value) {\n                                return $filter('number')(value, precision) + ' ' + format;\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                    case 'anynumber':\n                        model.$parsers.unshift(function(value) {\n                            var valid = false;\n                            if (value !== undefined && value !== \"\") {\n                                valid = String(value).indexOf(Number(value).toString()) !== -1; // isFinite(value); // \n                                value = Number(value);\n                                model.$setValidity('number', valid);\n                                if (valid) {\n                                    if (attributes.min !== undefined) {\n                                        model.$setValidity('range', value >= Number(attributes.min));\n                                    }\n                                    if (attributes.max !== undefined) {\n                                        model.$setValidity('range', value <= Number(attributes.max));\n                                    }\n                                }\n                            } else {\n                                valid = true;\n                                value = Number(value);\n                                model.$setValidity('number', true);\n                                if (attributes.min !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                                if (attributes.max !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                            }\n                            return value;\n                        });\n                        model.$formatters.push(function(value) {\n                            if (value || value === 0) {\n                                return $filter('number')(value, precision) + ' ' + format;\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                }\n\n                function onFocus() {\n                    focus = true;\n                    if (format) {\n                        element[0].value = model.$modelValue || null;\n                        if (!model.$modelValue) {\n                            model.$setViewValue(null);\n                        }\n                    }\n                }\n\n                function doBlur() {\n                    if (format && !model.$invalid) {\n                        switch (type) {\n                            case 'date':\n                            case 'datetime':\n                            case 'datetime-local':\n                                element[0].value = model.$modelValue ? $filter('date')(model.$modelValue, format) : ' ';\n                                break;\n                            default:\n                                element[0].value = model.$modelValue ? $filter('number')(model.$modelValue, precision) + ' ' + format : ' ';\n                                break;\n                        }\n                    }\n                }\n\n                function onBlur() {\n                    focus = false;\n                    doBlur();\n                }\n\n                function addListeners() {\n                    element.on('focus', onFocus);\n                    element.on('blur', onBlur);\n                }\n\n                function removeListeners() {\n                    element.off('focus', onFocus);\n                    element.off('blur', onBlur);\n                }\n                scope.$on('$destroy', function() {\n                    removeListeners();\n                });\n                addListeners();\n            }\n        };\n    }]);\n\n}());\n/* global angular */\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\t// micro interactions\n\n\tfunction tap(Events) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tpriority: 0,\n\t\t\tlink: link\n\t\t};\n\n\t\tfunction link(scope, element, attributes, model) {\n\t\t\tif (attributes.ngBind) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t/*\n\t\t\tif (attributes.href === '#' && !attributes.ngHref && !attributes.ngClick) {\n\t\t\t\treturn;\n            }\n            */\n\n\t\t\telement.addClass('interaction-tap');\n\t\t\tvar node = document.createElement('interaction');\n\t\t\telement[0].appendChild(node);\n\n\t\t\tfunction onDown(e) {\n\t\t\t\telement.removeClass('interaction-animate');\n\t\t\t\tvoid element.offsetWidth;\n\t\t\t\t// node.style.animationPlayState = \"paused\";\n\t\t\t\tnode.style.left = e.relative.x + 'px';\n\t\t\t\tnode.style.top = e.relative.y + 'px';\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\telement.addClass('interaction-animate');\n\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\telement.removeClass('interaction-animate');\n\t\t\t\t\t}, 1000);\n\t\t\t\t}, 10);\n\n\t\t\t\t// console.log('tap.onDown', node, node.parentElement);\n\t\t\t}\n\t\t\tvar listeners = { // down, move, up, click\n\t\t\t\tdown: onDown,\n\t\t\t};\n\t\t\tvar events = new Events(element).add(listeners, scope); // passing scope to add remove listeners automatically on $destroy\n\t\t}\n\t}\n\tapp.directive('ngHref', ['Events', tap]);\n\tapp.directive('ngClick', ['Events', tap]);\n\n}());\n/* global angular */\r\n\r\n(function () {\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.directive('modalView', ['$parse', '$templateRequest', '$compile', '$controller', 'Dom', function ($parse, $templateRequest, $compile, $controller, Dom) {\r\n\r\n\t\tfunction compileController(scope, element, html, data) {\r\n\t\t\t// console.log('modalView.compileController', element);\r\n\t\t\telement.html(html);\r\n\t\t\tvar link = $compile(element.contents());\r\n\t\t\tif (data.controller) {\r\n\t\t\t\tvar $scope = scope.$new();\r\n\t\t\t\tangular.extend($scope, data);\r\n\t\t\t\tvar controller = $controller(data.controller, {\r\n\t\t\t\t\t$scope: $scope\r\n\t\t\t\t});\r\n\t\t\t\tif (data.controllerAs) {\r\n\t\t\t\t\tscope[data.controllerAs] = controller;\r\n\t\t\t\t}\r\n\t\t\t\telement.data('$ngControllerController', controller);\r\n\t\t\t\telement.children().data('$ngControllerController', controller);\r\n\t\t\t\tscope = $scope;\r\n\t\t\t}\r\n\t\t\tlink(scope);\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\trestrict: 'A',\r\n\t\t\tpriority: -400,\r\n\t\t\tlink: function (scope, element, attributes, model) {\r\n\t\t\t\tvar modal = $parse(attributes.modalView);\r\n\t\t\t\tmodal = modal(scope);\r\n\t\t\t\tmodal.templateUrl = modal.templateUrl || 'artisan/components/modals/partial/modal';\r\n\t\t\t\t$templateRequest(modal.templateUrl).then(function (html) {\r\n\t\t\t\t\tcompileController(scope, element, html, modal);\r\n\t\t\t\t});\r\n\t\t\t\t/*\r\n\t\t\t\t// window.scrollTo(0, element[0].offsetTop - 100);\r\n\t\t\t\tfunction onClick(e) {\r\n\t\t\t\t    var closest = Dom.getClosestNode(e.target, element[0]);\r\n\t\t\t\t    if (closest === null) {\r\n\t\t\t\t        modal.reject(null);\r\n\t\t\t\t    }\r\n\t\t\t\t    // console.log('onClick', closest);\r\n\t\t\t\t}\r\n\t\t\t\tfunction addListeners() {\r\n\t\t\t\t    angular.element(window).on('click', onClick);\r\n\t\t\t\t}\r\n\t\t\t\tfunction removeListeners() {\r\n\t\t\t\t    angular.element(window).off('click', onClick);\r\n\t\t\t\t}\r\n\t\t\t\tscope.$on('destroy', function () {\r\n\t\t\t\t    removeListeners();\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    addListeners();\r\n\t\t\t\t}, 500);\r\n\t\t\t\t*/\r\n\t\t\t}\r\n\t\t};\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function () {\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.provider('$modal', [function $modalProvider() {\r\n\r\n\t\tvar modals = [];\r\n\t\tvar routes = {};\r\n\r\n\t\tthis.modals = modals;\r\n\t\tthis.routes = routes;\r\n\t\tthis.when = when;\r\n\r\n\t\tfunction when(path, modal) {\r\n\t\t\troutes[path] = modal;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tthis.$get = ['$q', '$timeout', function modalFactory($q, $timeout) {\r\n\r\n\t\t\tfunction popModal(modal) {\r\n\t\t\t\t// console.log('modalProvider.popModal', modal);                \r\n\t\t\t\tvar index = -1;\r\n\t\t\t\tangular.forEach(modals, function (m, i) {\r\n\t\t\t\t\tif (m === modal) {\r\n\t\t\t\t\t\tindex = i;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\t$timeout(function () {\r\n\t\t\t\t\t\tmodal.active = false;\r\n\t\t\t\t\t\tmodals.splice(index, 1);\r\n\t\t\t\t\t\tif (modals.length) {\r\n\t\t\t\t\t\t\tmodals[modals.length - 1].active = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfunction closeModal(modal) {\r\n\t\t\t\t// console.log('modalProvider.closeModal', modal);                \r\n\t\t\t\tvar index = -1;\r\n\t\t\t\tangular.forEach(modals, function (m, i) {\r\n\t\t\t\t\tif (m === modal) {\r\n\t\t\t\t\t\tindex = i;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\tmodal.active = false;\r\n\t\t\t\t\t$timeout(function () {\r\n\t\t\t\t\t\twhile (modals.length) {\r\n\t\t\t\t\t\t\tmodals.splice(modals.length - 1, 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 500);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfunction addModal(path, params) {\r\n\t\t\t\t// console.log('modalProvider.addModal', path, params);\r\n\t\t\t\tvar deferred = $q.defer();\r\n\t\t\t\tparams = params || null;\r\n\t\t\t\tvar modal = {\r\n\t\t\t\t\ttitle: 'Untitled',\r\n\t\t\t\t\tcontroller: null,\r\n\t\t\t\t\ttemplateUrl: null,\r\n\t\t\t\t\tparams: params,\r\n\t\t\t\t};\r\n\t\t\t\tvar current = routes[path];\r\n\t\t\t\tif (current) {\r\n\t\t\t\t\tangular.extend(modal, current);\r\n\t\t\t\t}\r\n\t\t\t\tmodal.deferred = deferred;\r\n\t\t\t\tmodal.back = function (data) {\r\n\t\t\t\t\tpopModal(this);\r\n\t\t\t\t\tmodal.deferred.resolve(data, modal);\r\n\t\t\t\t}\r\n\t\t\t\tmodal.resolve = function (data) {\r\n\t\t\t\t\tcloseModal(this);\r\n\t\t\t\t\tmodal.deferred.resolve(data, modal);\r\n\t\t\t\t}\r\n\t\t\t\tmodal.reject = function () {\r\n\t\t\t\t\tcloseModal(this);\r\n\t\t\t\t\tmodal.deferred.reject(modal);\r\n\t\t\t\t}\r\n\t\t\t\tmodals.push(modal);\r\n\t\t\t\tangular.forEach(modals, function (m, i) {\r\n\t\t\t\t\tm.active = false;\r\n\t\t\t\t});\r\n\t\t\t\tif (modals.length) {\r\n\t\t\t\t\tmodal.active = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$timeout(function () {\r\n\t\t\t\t\t\tmodal.active = true;\r\n\t\t\t\t\t\t// window.scrollTo(0, 0);\r\n\t\t\t\t\t}, 500);\r\n\t\t\t\t}\r\n\t\t\t\treturn deferred.promise;\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\tmodals: modals,\r\n\t\t\t\taddModal: addModal,\r\n\t\t\t};\r\n        }];\r\n\r\n    }]);\r\n\r\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.directive('nav', ['$parse', 'Nav', function ($parse, Nav) {\n\n\t\tvar directive = {\n\t\t\trestrict: 'A',\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\treturn attributes.template || 'artisan/components/nav/partial/nav';\n\t\t\t},\n\t\t\tscope: {\n\t\t\t\titems: '=nav',\n\t\t\t},\n\t\t\tlink: NavLink,\n\t\t};\n\n\t\treturn directive;\n\n\t\tfunction NavLink(scope, element, attributes, model) {\n\t\t\tscope.$watch('items', function (value) {\n\t\t\t\t// console.log(value instanceof Nav, value);\n\t\t\t\tif (value) {\n\t\t\t\t\tif (angular.isArray(value)) {\n\t\t\t\t\t\tvar onPath = $parse(attributes.onPath)(scope.$parent);\n\t\t\t\t\t\tvar onNav = $parse(attributes.onNav)(scope.$parent);\n\t\t\t\t\t\tvar nav = new Nav({\n\t\t\t\t\t\t\tonPath: onPath,\n\t\t\t\t\t\t\tonNav: onNav\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnav.setItems(value);\n\t\t\t\t\t\tscope.item = nav;\n\n\t\t\t\t\t} else if (value instanceof Nav) {\n\t\t\t\t\t\tscope.item = value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n    }]);\n\n\tapp.directive('navItem', ['$timeout', 'Events', function ($timeout, Events) {\n\n\t\tvar directive = {\n\t\t\trestrict: 'A',\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\treturn attributes.template || 'artisan/components/nav/partial/nav-item';\n\t\t\t},\n\t\t\tscope: {\n\t\t\t\titem: '=navItem',\n\t\t\t},\n\t\t\tlink: NavItemLink,\n\t\t};\n\n\t\treturn directive;\n\n\t\tfunction NavItemLink(scope, element, attributes, model) {\n\t\t\tvar navItem = angular.element(element[0].querySelector('.nav-link'));\n\n\t\t\tvar output;\n\n\t\t\tfunction itemOpen(item, immediate) {\n\t\t\t\tvar state = item.$nav.state;\n\t\t\t\tstate.active = true;\n\t\t\t\t$timeout(function () {\n\t\t\t\t\tstate.immediate = immediate;\n\t\t\t\t\tstate.closed = state.closing = false;\n\t\t\t\t\tstate.opening = true;\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tstate.opening = false;\n\t\t\t\t\t\tstate.opened = true;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction itemClose(item, immediate) {\n\t\t\t\tvar state = item.$nav.state;\n\t\t\t\tstate.active = false;\n\t\t\t\t$timeout(function () {\n\t\t\t\t\tstate.immediate = immediate;\n\t\t\t\t\tstate.opened = state.opening = false;\n\t\t\t\t\tstate.closing = true;\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tstate.closing = false;\n\t\t\t\t\t\tstate.closed = true;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tif (item.items) {\n\t\t\t\t\tangular.forEach(item.items, function (o) {\n\t\t\t\t\t\titemClose(o, true);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction itemToggle(item) {\n\t\t\t\t// console.log('itemToggle', item);\n\t\t\t\tvar state = item.$nav.state;\n\t\t\t\tstate.active = item.items ? !state.active : true;\n\t\t\t\tif (state.active) {\n\t\t\t\t\tif (item.$nav.parent) {\n\t\t\t\t\t\tangular.forEach(item.$nav.parent.items, function (o) {\n\t\t\t\t\t\t\tif (o !== item) {\n\t\t\t\t\t\t\t\titemClose(o, true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\titemOpen(item);\n\t\t\t\t} else {\n\t\t\t\t\titemClose(item);\n\t\t\t\t}\n\t\t\t\t// console.log(state);\n\t\t\t}\n\n\t\t\tfunction onDown(e) {\n\t\t\t\tvar item = scope.item;\n\t\t\t\t// console.log('Item.onDown', item);\n\t\t\t\tvar state = item.$nav.state;\n\t\t\t\tif (state.active) {\n\t\t\t\t\toutput = false;\n\t\t\t\t\ttrigger();\n\t\t\t\t} else if (item.$nav.onNav) {\n\t\t\t\t\tvar promise = item.$nav.onNav(item, item.$nav);\n\t\t\t\t\tif (promise && typeof promise.then === 'function') {\n\t\t\t\t\t\tpromise.then(function (resolved) {\n\t\t\t\t\t\t\t// go on\n\t\t\t\t\t\t\ttrigger();\n\t\t\t\t\t\t}, function (rejected) {\n\t\t\t\t\t\t\t// do nothing\n\t\t\t\t\t\t});\n\t\t\t\t\t\toutput = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\toutput = promise;\n\t\t\t\t\t\ttrigger();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction trigger() {\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\titemToggle(item);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t// preventDefault(e);\n\t\t\t}\n\n\t\t\tfunction onClick(e) {\n\t\t\t\t// console.log('Item.onClick', e);\n\t\t\t\treturn preventDefault(e);\n\t\t\t}\n\n\t\t\tfunction preventDefault(e) {\n\t\t\t\tif (output === false) {\n\t\t\t\t\t// console.log('Item.preventDefault', e);\n\t\t\t\t\te.stop();\n\t\t\t\t\t// e.preventDefault();\n\t\t\t\t\t// e.stopPropagation();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar events = new Events(navItem).add({\n\t\t\t\tdown: onDown,\n\t\t\t\tclick: onClick,\n\t\t\t}, scope);\n\t\t}\n\n    }]);\n\n\tapp.directive('navTo', ['$parse', '$timeout', 'Events', function ($parse, $timeout, Events) {\n\n\t\tvar directive = {\n\t\t\trestrict: 'A',\n\t\t\tlink: NavToLink\n\t\t};\n\n\t\treturn directive;\n\n\t\tfunction NavToLink(scope, element, attributes) {\n\t\t\tfunction onDown(e) {\n\t\t\t\tconsole.log('navTo.onDown', attributes.navTo);\n\t\t\t\t$timeout(function () {\n\t\t\t\t\tvar callback = $parse(attributes.navTo);\n\t\t\t\t\tcallback(scope);\n\t\t\t\t});\n\t\t\t\te.preventDefault();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar events = new Events(element).add({\n\t\t\t\tdown: onDown,\n\t\t\t}, scope);\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('Nav', ['Silent', function(Silent) {\n\n        function Nav(options) {\n            var nav = this;\n            var defaults = {\n                items: [],\n            }\n            angular.extend(nav, defaults);\n            if (options) {\n                angular.extend(nav, options);\n            }\n            nav.setNav(nav, null);\n        }\n\n        var statics = {\n            silent: NavSilent,\n            path: NavPath,\n        };\n\n        var publics = {\n            addItem: addItem,\n            addItems: addItems,\n            getPath: getPath,\n            setItems: setItems,\n            setNav: setNav,\n            setNavs: setNavs,\n        };\n\n        angular.extend(Nav, statics);\n        angular.extend(Nav.prototype, publics);\n\n        return Nav;\n\n        // static methods\n\n        function NavSilent(path) {\n            Silent.silent(path);\n        }\n\n        function NavPath(path) {\n            Silent.path(path);\n        }\n\n        // prototype methods\n\n        function setItems(items) {\n            var nav = this;\n            nav.path = Silent.path();\n            nav.items = items;\n            nav.setNavs(items, nav);\n        }\n\n        function setNavs(items, parent) {\n            var nav = this;\n            if (items) {\n                angular.forEach(items, function(item) {\n                    nav.setNav(item, parent);\n                    nav.setNavs(item.items, item);\n                });\n            }\n        }\n\n        function setNav(item, parent) {\n            var nav = this;\n            var $nav = {\n                parent: parent || null,\n                level: parent ? parent.$nav.level + 1 : 0,\n                state: {},\n                addItems: function(x) {\n                    nav.addItems(x, item);\n                },\n                onNav: nav.onNav,\n            };\n            item.$nav = $nav;\n            $nav.path = nav.getPath(item);\n            if ($nav.path === nav.path) {\n                $nav.state.active = true;\n                $nav.state.opened = true;\n                while ($nav.parent) {\n                    $nav = $nav.parent.$nav;\n                    $nav.state.active = true;\n                    $nav.state.opened = true;\n                }\n            }\n        }\n\n        function addItems(itemOrItems, parent) {\n            var nav = this;\n            if (angular.isArray(itemOrItems)) {\n                angular.forEach(itemOrItems, function(item) {\n                    nav.addItem(item, parent);\n                });\n            } else {\n                nav.addItem(itemOrItems, parent);\n            }\n        }\n\n        function addItem(item, parent) {\n            var nav = this,\n                onPath = nav.onPath,\n                onNav = nav.onNav;\n            nav.setNav(item, parent);\n            if (parent) {\n                parent.items = parent.items || [];\n                parent.items.push(item);\n            }\n        }\n\n        function getPath(item) {\n            var path = null;\n            if (this.onPath) {\n                path = this.onPath(item, item.$nav);\n            } else {\n                path = item.path;\n            }\n            return path;\n        }\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\twindow.ondragstart = function () {\n\t\treturn false;\n\t};\n\n\tvar app = angular.module('artisan');\n\n\tapp.directive('scrollableX', ['$parse', '$compile', '$timeout', 'Scrollable', 'Animate', 'Style', 'Events', 'Utils', function ($parse, $compile, $timeout, Scrollable, Animate, Style, Events, Utils) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplate: '<div class=\"scrollable-content\" ng-transclude></div>',\n\t\t\ttransclude: true,\n\t\t\tlink: function (scope, element, attributes, model) {\n\n\t\t\t\tvar onLeft, onRight, showIndicatorFor, scrollableWhen;\n\t\t\t\tif (attributes.onLeft) {\n\t\t\t\t\tonLeft = $parse(attributes.onLeft);\n\t\t\t\t}\n\t\t\t\tif (attributes.onRight) {\n\t\t\t\t\tonRight = $parse(attributes.onRight);\n\t\t\t\t}\n\t\t\t\tif (attributes.showIndicatorFor) {\n\t\t\t\t\tshowIndicatorFor = $parse(attributes.showIndicatorFor);\n\t\t\t\t}\n\t\t\t\tif (attributes.scrollableWhen) {\n\t\t\t\t\tscrollableWhen = $parse(attributes.scrollableWhen);\n\t\t\t\t}\n\n\t\t\t\t// ELEMENTS & STYLESHEETS;\n\t\t\t\telement.attr('unselectable', 'on').addClass('unselectable');\n\t\t\t\tvar containerNode = element[0];\n\t\t\t\tvar contentNode = containerNode.querySelector('.scrollable-content');\n\t\t\t\tvar content = angular.element(content);\n\t\t\t\tvar contentStyle = new Style();\n\n\t\t\t\tvar animate = new Animate(render);\n\n\t\t\t\tvar scrollable = attributes.scrollableX ? $parse(attributes.scrollableX)(scope) : new Scrollable();\n\n\t\t\t\tlink(scrollable);\n\n\t\t\t\tfunction link(scrollable) {\n\t\t\t\t\tscrollable.link({\n\t\t\t\t\t\tgetItems: function () {\n\t\t\t\t\t\t\tif (attributes.scrollableItem) {\n\t\t\t\t\t\t\t\tvar items = containerNode.querySelectorAll(attributes.scrollableItem);\n\t\t\t\t\t\t\t\treturn items;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tprev: function () {\n\t\t\t\t\t\t\tscrollable.scrollPrev();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnext: function () {\n\t\t\t\t\t\t\tscrollable.scrollNext();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\treset: function () {\n\t\t\t\t\t\t\tscrollable.doReset();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonLeft: onLeft,\n\t\t\t\t\t\tonRight: onRight,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t/*\n\t\t\t\tscope.$watch(attributes.scrollableX, function (newValue) {\n\t\t\t\t\tconsole.log(newValue);\n\t\t\t\t});\n\t\t\t\t*/\n\n\t\t\t\t/*\n\t\t\t\tvar indicator = null,\n\t\t\t\t\tindicatorNode = null,\n\t\t\t\t\tindicatorStyle;\n\t\t\t\tshowIndicatorFor = false;\n\t\t\t\tif (showIndicatorFor) {\n\t\t\t\t\tindicator = angular.element('<div class=\"indicator\"></div>');\n\t\t\t\t\tindicatorNode = indicator[0];\n\t\t\t\t\tindicatorStyle = new Style();\n\t\t\t\t\telement.append(indicator);\n\t\t\t\t\t$compile(indicator.contents())(scope);\n\t\t\t\t\tvar i = scrollbar.getIndicator();\n\t\t\t\t\tindicatorStyle.transform('translate3d(' + i.x.toFixed(2) + 'px,' + i.y.toFixed(2) + 'px,0)');\n\t\t\t\t\tindicatorStyle.set(indicatorNode);\n\t\t\t\t}\n\t\t\t\t*/\n\n\t\t\t\tfunction render(time) {\n\t\t\t\t\tscrollable.setContainer(containerNode);\n\t\t\t\t\tscrollable.setContent(contentNode);\n\t\t\t\t\tscrollable.setEnabled(isEnabled());\n\t\t\t\t\tvar animating = scrollable.renderX();\n\t\t\t\t\tif (!animating) {\n\t\t\t\t\t\t// animate.pause();\n\t\t\t\t\t}\n\t\t\t\t\tvar current = scrollable.getCurrent();\n\t\t\t\t\tcontentStyle.transform('translate3d(' + current.x.toFixed(2) + 'px,0,0)');\n\t\t\t\t\tcontentStyle.set(contentNode);\n\t\t\t\t\t/*\n\t\t\t\t\tif (showIndicatorFor) {\n\t\t\t\t\t\tif (dragging || wheeling || speed) {\n\t\t\t\t\t\t\tvar percent = c.x / (containerNode.offsetWidth - contentNode.offsetWidth);\n\t\t\t\t\t\t\tpercent = Math.max(0, Math.min(1, percent));\n\t\t\t\t\t\t\ti.x = (containerNode.offsetWidth - indicatorNode.offsetWidth) * (percent);\n\t\t\t\t\t\t\ti.y += (0 - i.y) / 4;\n\t\t\t\t\t\t\t// var count = Math.round(contentNode.offsetWidth / 315);\n\t\t\t\t\t\t\tvar index = Math.max(1, Math.round(percent * showIndicatorFor.rows.length));\n\t\t\t\t\t\t\tindicator.html(index + '/' + showIndicatorFor.count);\n\t\t\t\t\t\t\t// indicator.html((percent * 100).toFixed(2).toString());\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ti.y += (45 - i.y) / 4;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tindicatorStyle.transform('translate3d(' + i.x.toFixed(2) + 'px,' + i.y.toFixed(2) + 'px,0)');\n\t\t\t\t\t\tindicatorStyle.set(indicatorNode);\n\t\t\t\t\t}\n\t\t\t\t\t*/\n\t\t\t\t}\n\n\t\t\t\tfunction undrag() {\n\t\t\t\t\tscrollable.off();\n\t\t\t\t\tdragOff();\n\t\t\t\t}\n\n\t\t\t\tfunction onDown(event) {\n\t\t\t\t\tif (scrollable.dragStart(event.absolute)) {\n\t\t\t\t\t\tdragOn();\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onMove(event) {\n\t\t\t\t\tscrollable.dragMove(event.absolute);\n\t\t\t\t\tvar drag = scrollable.getDrag();\n\t\t\t\t\tif (Math.abs(drag.y) > Math.abs(drag.x)) {\n\t\t\t\t\t\tonUp(event);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onUp(event) {\n\t\t\t\t\tscrollable.dragEnd(event.absolute);\n\t\t\t\t\tevent.stop();\n\t\t\t\t\tdragOff();\n\t\t\t\t}\n\n\t\t\t\tfunction _onScrollX(dir, interval) {\n\t\t\t\t\treturn scrollable.wheelX(dir, interval);\n\t\t\t\t}\n\n\t\t\t\tvar onScrollX = _onScrollX;\n\t\t\t\t// var onScrollX = Utils.throttle(_onScrollX, 25);\n\n\t\t\t\tfunction onWheel(event) {\n\t\t\t\t\t// console.log('onWheelX', event.dir, scrollable.wheelXCheck(event.dir));\n\t\t\t\t\tif (scrollable.wheelXCheck(event.dir)) {\n\t\t\t\t\t\tonScrollX(event.dir, event.interval);\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction off() {\n\t\t\t\t\tdragOff();\n\t\t\t\t\t// animate.pause();\n\t\t\t\t\tscrollable.off();\n\t\t\t\t}\n\n\t\t\t\tfunction isEnabled() {\n\t\t\t\t\tvar enabled = true;\n\t\t\t\t\tif (scrollableWhen) {\n\t\t\t\t\t\tenabled = enabled && scrollableWhen(scope);\n\t\t\t\t\t}\n\t\t\t\t\tenabled = enabled && window.innerWidth >= 1024;\n\t\t\t\t\tenabled = enabled && (containerNode.offsetWidth < contentNode.offsetWidth);\n\t\t\t\t\treturn enabled;\n\t\t\t\t}\n\n\t\t\t\tfunction onResize() {\n\t\t\t\t\tvar enabled = isEnabled();\n\t\t\t\t\tif (!enabled) {\n\t\t\t\t\t\toff();\n\t\t\t\t\t}\n\t\t\t\t\trender();\n\t\t\t\t}\n\n\t\t\t\tscope.$watch(function () {\n\t\t\t\t\treturn contentNode.offsetWidth;\n\t\t\t\t}, function (newValue, oldValue) {\n\t\t\t\t\tonResize();\n\t\t\t\t});\n\n\t\t\t\tvar events = new Events(element).add({\n\t\t\t\t\tdown: onDown,\n\t\t\t\t\twheel: onWheel,\n\t\t\t\t}, scope);\n\n\t\t\t\tvar windowEvents = new Events(window).add({\n\t\t\t\t\tresize: onResize,\n\t\t\t\t}, scope);\n\n\t\t\t\tfunction dragOn() {\n\t\t\t\t\twindowEvents.add({\n\t\t\t\t\t\tmove: onMove,\n\t\t\t\t\t\tup: onUp,\n\t\t\t\t\t}, scope);\n\t\t\t\t}\n\n\t\t\t\tfunction dragOff() {\n\t\t\t\t\twindowEvents.remove({\n\t\t\t\t\t\tmove: onMove,\n\t\t\t\t\t\tup: onUp,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tanimate.pause();\n\t\t\t\t});\n\n\t\t\t},\n\t\t};\n    }]);\n\n\tapp.directive('scrollableY', ['$parse', '$compile', '$timeout', 'Scrollable', 'Animate', 'Style', 'Events', 'Utils', function ($parse, $compile, $timeout, Scrollable, Animate, Style, Events, Utils) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplate: '<div class=\"scrollable-content\" ng-transclude></div>',\n\t\t\ttransclude: true,\n\t\t\tlink: function (scope, element, attributes, model) {\n\n\t\t\t\tvar onTop, onBottom, showIndicatorFor, scrollableWhen;\n\t\t\t\tif (attributes.onTop) {\n\t\t\t\t\tonTop = $parse(attributes.onTop);\n\t\t\t\t}\n\t\t\t\tif (attributes.onBottom) {\n\t\t\t\t\tonBottom = $parse(attributes.onBottom);\n\t\t\t\t}\n\t\t\t\tif (attributes.showIndicatorFor) {\n\t\t\t\t\tshowIndicatorFor = $parse(attributes.showIndicatorFor);\n\t\t\t\t}\n\t\t\t\tif (attributes.scrollableWhen) {\n\t\t\t\t\tscrollableWhen = $parse(attributes.scrollableWhen);\n\t\t\t\t}\n\n\t\t\t\t// ELEMENTS & STYLESHEETS;\n\t\t\t\telement.attr('unselectable', 'on').addClass('unselectable');\n\t\t\t\tvar containerNode = element[0];\n\t\t\t\tvar contentNode = containerNode.querySelector('.scrollable-content');\n\t\t\t\tvar content = angular.element(content);\n\t\t\t\tvar contentStyle = new Style();\n\n\t\t\t\tvar animate = new Animate(render);\n\n\t\t\t\tvar scrollable = attributes.scrollableY ? $parse(attributes.scrollableY)(scope) : new Scrollable();\n\t\t\t\tlink(scrollable);\n\n\t\t\t\tfunction link(scrollable) {\n\t\t\t\t\tscrollable.link({\n\t\t\t\t\t\tgetItems: function () {\n\t\t\t\t\t\t\tif (attributes.scrollableItem) {\n\t\t\t\t\t\t\t\tvar items = containerNode.querySelectorAll(attributes.scrollableItem);\n\t\t\t\t\t\t\t\treturn items;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tprev: function () {\n\t\t\t\t\t\t\tscrollable.scrollPrev();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnext: function () {\n\t\t\t\t\t\t\tscrollable.scrollNext();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\treset: function () {\n\t\t\t\t\t\t\tscrollable.doReset();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonTop: onTop,\n\t\t\t\t\t\tonBottom: onBottom,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction render(time) {\n\t\t\t\t\tscrollable.setContainer(containerNode);\n\t\t\t\t\tscrollable.setContent(contentNode);\n\t\t\t\t\tscrollable.setEnabled(isEnabled());\n\t\t\t\t\tvar animating = scrollable.renderY();\n\t\t\t\t\tif (!animating) {\n\t\t\t\t\t\t// animate.pause();\n\t\t\t\t\t}\n\t\t\t\t\tvar current = scrollable.getCurrent();\n\t\t\t\t\tcontentStyle.transform('translate3d(0,' + current.y.toFixed(2) + 'px,0)');\n\t\t\t\t\tcontentStyle.set(contentNode);\n\t\t\t\t}\n\n\t\t\t\tfunction undrag() {\n\t\t\t\t\tscrollable.off();\n\t\t\t\t\tdragOff();\n\t\t\t\t}\n\n\t\t\t\tfunction onDown(event) {\n\t\t\t\t\tif (scrollable.dragStart(event.absolute)) {\n\t\t\t\t\t\tdragOn();\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onMove(event) {\n\t\t\t\t\tscrollable.dragMove(event.absolute);\n\t\t\t\t\tvar drag = scrollable.getDrag();\n\t\t\t\t\tif (Math.abs(drag.x) > Math.abs(drag.y)) {\n\t\t\t\t\t\tonUp(event);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onUp(event) {\n\t\t\t\t\tscrollable.dragEnd(event.absolute);\n\t\t\t\t\tevent.stop();\n\t\t\t\t\tdragOff();\n\t\t\t\t}\n\n\t\t\t\tfunction _onScrollY(dir, interval) {\n\t\t\t\t\treturn scrollable.wheelY(dir, interval);\n\t\t\t\t}\n\n\t\t\t\tvar onScrollY = _onScrollY;\n\t\t\t\t// var onScrollY = Utils.throttle(_onScrollY, 25);\n\n\t\t\t\tfunction onWheel(event) {\n\t\t\t\t\t// console.log('onWheelY', event.dir, scrollable.wheelYCheck(event.dir));\n\t\t\t\t\tif (scrollable.wheelYCheck(event.dir)) {\n\t\t\t\t\t\tonScrollY(event.dir, event.interval);\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction off() {\n\t\t\t\t\tdragOff();\n\t\t\t\t\t// animate.pause();\n\t\t\t\t\tscrollable.off();\n\t\t\t\t}\n\n\t\t\t\tfunction isEnabled() {\n\t\t\t\t\tvar enabled = true;\n\t\t\t\t\tif (scrollableWhen) {\n\t\t\t\t\t\tenabled = enabled && scrollableWhen(scope);\n\t\t\t\t\t}\n\t\t\t\t\tenabled = enabled && window.innerWidth >= 1024;\n\t\t\t\t\tenabled = enabled && (containerNode.offsetHeight < contentNode.offsetHeight);\n\t\t\t\t\treturn enabled;\n\t\t\t\t}\n\n\t\t\t\tfunction onResize() {\n\t\t\t\t\tvar enabled = isEnabled();\n\t\t\t\t\tif (!enabled) {\n\t\t\t\t\t\toff();\n\t\t\t\t\t}\n\t\t\t\t\trender();\n\t\t\t\t}\n\n\t\t\t\tscope.$watch(function () {\n\t\t\t\t\treturn contentNode.offsetHeight;\n\t\t\t\t}, function (newValue, oldValue) {\n\t\t\t\t\tonResize();\n\t\t\t\t});\n\n\t\t\t\tvar events = new Events(element).add({\n\t\t\t\t\tdown: onDown,\n\t\t\t\t\twheel: onWheel,\n\t\t\t\t}, scope);\n\n\t\t\t\tvar windowEvents = new Events(window).add({\n\t\t\t\t\tresize: onResize,\n\t\t\t\t}, scope);\n\n\t\t\t\tfunction dragOn() {\n\t\t\t\t\twindowEvents.add({\n\t\t\t\t\t\tmove: onMove,\n\t\t\t\t\t\tup: onUp,\n\t\t\t\t\t}, scope);\n\t\t\t\t}\n\n\t\t\t\tfunction dragOff() {\n\t\t\t\t\twindowEvents.remove({\n\t\t\t\t\t\tmove: onMove,\n\t\t\t\t\t\tup: onUp,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tanimate.pause();\n\t\t\t\t});\n\n\t\t\t},\n\t\t};\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('Scrollable', ['Utils', 'Point', 'Rect', function(Utils, Point, Rect) {\n\n        function Scrollable() {\n\n            var padding = 150;\n            var enabled, snappable, busy, dragging, wheeling, down, move, prev;\n            var currentIndex = 0;\n\n            snappable = true;\n\n            var start = new Point(),\n                end = new Point(),\n                current = new Point(),\n                drag = new Point(),\n                indicator = new Point(),\n                offset = new Point(),\n                speed = new Point(),\n                container = new Rect(),\n                content = new Rect(),\n                overflow = new Rect();\n\n            var scrollable = {\n                // properties\n                start: start,\n                end: end,\n                current: current,\n                indicator: indicator,\n                speed: speed,\n                overflow: overflow,\n                container: container,\n                content: content,\n                // methods\n                setContainer: setContainer,\n                setContent: setContent,\n                setEnabled: setEnabled,\n                getCurrent: getCurrent,\n                getDrag: getDrag,\n                getIndicator: getIndicator,\n                getIndex: getIndex,\n                scrollToIndex: scrollToIndex,\n                scrollPrev: scrollPrev,\n                scrollNext: scrollNext,\n                dragStart: dragStart,\n                dragMove: dragMove,\n                dragEnd: dragEnd,\n                doReset: doReset,\n                off: off,\n                // x direction\n                doLeft: doLeft,\n                doRight: doRight,\n                renderX: renderX,\n                scrollToX: scrollToX,\n                wheelX: wheelX,\n                wheelXCheck: wheelXCheck,\n                // y direction\n                doTop: doTop,\n                doBottom: doBottom,\n                renderY: renderY,\n                scrollToY: scrollToY,\n                wheelY: wheelY,\n                wheelYCheck: wheelYCheck,\n            };\n\n            angular.extend(this, scrollable);\n\n            scrollable = this;\n\n            function setContainer(node) {\n                container.width = node.offsetWidth;\n                container.height = node.offsetHeight;\n            }\n\n            function setContent(node) {\n                content.width = node.offsetWidth;\n                content.height = node.offsetHeight;\n            }\n\n            function setEnabled(flag) {\n                enabled = flag;\n            }\n\n            function getCurrent() {\n                return current;\n            }\n\n            function getDrag() {\n                return drag;\n            }\n\n            function getIndicator() {\n                return indicator;\n            }\n\n            function getIndex() {\n                return currentIndex;\n            }\n\n            function scrollToIndex(index) {\n                if (index !== currentIndex) {\n                    currentIndex = index;\n                    var item = getItemAtIndex(index);\n                    if (item) {\n                        offset = new Point(\n                            item.offsetLeft,\n                            item.offsetTop\n                        );\n                        // console.log('scrollToIndex', index, offset);\n                    }\n                    return true;\n                }\n            }\n\n            function dragStart(point) {\n                if (!busy) {\n                    start.x = end.x = current.x;\n                    start.y = end.y = current.y;\n                    speed.x = 0;\n                    speed.y = 0;\n                    down = point;\n                    currentIndex = -1;\n                    wheeling = false;\n                    return true;\n                } else {\n                    return false;\n                }\n            }\n\n            function dragMove(point) {\n                prev = move;\n                move = point;\n                drag.x = move.x - down.x;\n                drag.y = move.y - down.y;\n                dragging = true;\n            }\n\n            function dragEnd() {\n                if (move && prev) {\n                    speed.x += (move.x - prev.x) * 4;\n                    speed.y += (move.y - prev.y) * 4;\n                }\n                start.x = end.x = current.x;\n                start.y = end.y = current.y;\n                dragging = false;\n                move = null;\n                down = null;\n                prev = null;\n            }\n\n            function getItemAtIndex(index) {\n                var item = null;\n                var items = scrollable.getItems();\n                if (items) {\n                    if (index >= 0 && index < items.length) {\n                        item = items[index];\n                    }\n                }\n                // console.log('getItemAtIndex', index, items.length, item);\n                return item;\n            }\n\n            function scrollPrev() {\n                var index = Math.max(0, currentIndex - 1);\n                console.log('scrollPrev', index);\n                scrollToIndex(index);\n            }\n\n            function scrollNext() {\n                var items = scrollable.getItems();\n                var index = Math.min(items.length - 1, currentIndex + 1);\n                console.log('scrollNext', index);\n                scrollToIndex(index);\n            }\n\n            function doReset() {\n                end.x = current.x = 0;\n            }\n\n            function off() {\n                dragging = false;\n                wheeling = false;\n                move = null;\n                down = null;\n            }\n\n            // x - direction\n\n            function doLeft(scope) {\n                if (busy) {\n                    return;\n                }\n                if (!scrollable.onLeft) {\n                    return;\n                }\n                busy = true;\n                scrollable.onLeft(scope).then().finally(function() {\n                    scrollToX(0);\n                });\n            }\n\n            function doRight(scope) {\n                if (busy) {\n                    return;\n                }\n                if (!scrollable.onRight) {\n                    return;\n                }\n                busy = true;\n                scrollable.onRight(scope).then().finally(function() {\n                    var right = container.width - content.width;\n                    if (right > overflow.width) {\n                        start.x = end.x = overflow.width;\n                    } else {\n                        start.x = end.x = overflow.width + padding;\n                    }\n                    scrollToX(0);\n                });\n            }\n\n            function renderX() {\n                var animating = true;\n                if (enabled) {\n                    overflow.x = 0;\n                    overflow.width = container.width - content.width;\n                    if (dragging) {\n                        end.x = start.x + move.x - down.x;\n                        if (extendX()) {\n                            start.x = end.x;\n                            down.x = move.x;\n                        }\n                    } else if (speed.x) {\n                        end.x += speed.x;\n                        speed.x *= 0.75;\n                        if (wheeling) {\n                            extendX();\n                        }\n                        if (Math.abs(speed.x) < 2.05) {\n                            speed.x = 0;\n                            scrollable.wheeling = wheeling = false;\n                            snapToNearestX();\n                        }\n                    } else if (offset) {\n                        end.x = -offset.x;\n                        offset = null;\n                    }\n                    end.x = Math.round(end.x * 10000) / 10000;\n                    end.x = Math.min(overflow.x, end.x);\n                    end.x = Math.max(overflow.width, end.x);\n                    current.x += (end.x - current.x) / 4;\n                    if (speed.x === 0 && Math.abs(end.x - current.x) < 0.05) {\n                        current.x = end.x;\n                        if (!snapToNearestX()) {\n                            animating = false;\n                        }\n                    }\n                    // console.log('renderX', current.x, end.x, overflow.x);\n                } else {\n                    current.x = end.x = 0;\n                    animating = false;\n                }\n                return animating;\n            }\n\n            function extendX() {\n                var extending = false;\n                overflow.x += padding;\n                overflow.width -= padding;\n                if (end.x > overflow.x) {\n                    extending = true;\n                    doLeft();\n                } else if (end.x < overflow.width) {\n                    extending = true;\n                    doRight();\n                }\n                return extending;\n            }\n\n            function snapToNearestX() {\n                var items = scrollable.getItems();\n                if (items) {\n                    var index = -1;\n                    var min = Number.POSITIVE_INFINITY;\n                    angular.forEach(items, function(item, i) {\n                        var distance = Math.abs((end.x + speed.x) - (item.offsetLeft * -1));\n                        if (distance < min) {\n                            min = distance;\n                            index = i;\n                        }\n                    });\n                    if (index !== -1) {\n                        if (snappable) {\n                            return scrollToIndex(index);\n                        } else {\n                            currentIndex = index;\n                        }\n                    }\n                }\n            }\n\n            function wheelXCheck(dir) {\n                // console.log('wheelYCheck', dir < 0 ? (end.x - overflow.width) : (end.x - overflow.x));\n                if (!busy && enabled) {\n                    if (dir < 0) {\n                        return end.x - overflow.width;\n                    } else {\n                        return end.x - overflow.x;\n                    }\n                } else {\n                    return false;\n                }\n            }\n\n            function wheelX(dir, interval) {\n                end.x += dir * 100 / 1000 * interval;\n                speed.x += dir * 100 / 1000 * interval;\n                wheeling = true;\n            }\n\n            function scrollToX(value) {\n                start.x = end.x = value;\n                setTimeout(function() {\n                    off();\n                    busy = false;\n                }, 500);\n            }\n\n            // y - direction\n\n            function doTop(scope) {\n                if (busy) {\n                    return;\n                }\n                if (!scrollable.onTop) {\n                    return;\n                }\n                busy = true;\n                scrollable.onTop(scope).then().finally(function() {\n                    scrollToY(0);\n                });\n            }\n\n            function doBottom(scope) {\n                if (busy) {\n                    return;\n                }\n                if (!scrollable.onBottom) {\n                    return;\n                }\n                busy = true;\n                scrollable.onBottom(scope).then().finally(function() {\n                    var bottom = container.height - content.height;\n                    if (bottom > overflow.height) {\n                        start.y = end.y = overflow.height;\n                    } else {\n                        start.y = end.y = overflow.height + padding;\n                    }\n                    scrollToY(0);\n                });\n            }\n\n            function renderY() {\n                var animating = true;\n                if (enabled) {\n                    overflow.y = 0;\n                    overflow.height = container.height - content.height;\n                    if (dragging) {\n                        end.y = start.y + move.y - down.y;\n                        if (extendY()) {\n                            start.y = end.y;\n                            down.y = move.y;\n                        }\n                    } else if (speed.y) {\n                        end.y += speed.y;\n                        speed.y *= 0.75;\n                        if (wheeling) {\n                            extendY();\n                        }\n                        if (Math.abs(speed.y) < 2.05) {\n                            speed.y = 0;\n                            scrollable.wheeling = wheeling = false;\n                            snapToNearestY();\n                        }\n                    } else if (offset) {\n                        end.y = -offset.y;\n                        offset = null;\n                    }\n                    end.y = Math.round(end.y * 10000) / 10000;\n                    end.y = Math.min(overflow.y, end.y);\n                    end.y = Math.max(overflow.height, end.y);\n                    current.y += (end.y - current.y) / 4;\n                    if (speed.y === 0 && Math.abs(end.y - current.y) < 0.05) {\n                        current.y = end.y;\n                        if (!snapToNearestY()) {\n                            animating = false;\n                        }\n                    }\n                    // console.log(parseFloat(current.y.toFixed(6)), end.y, overflow.y);\n                    // console.log(dragging, wheeling, end.y, speed.y, Math.abs(end.y - current.y));\n                } else {\n                    current.y = end.y = 0;\n                    animating = false;\n                }\n                return animating;\n            }\n\n            function extendY() {\n                var extending = false;\n                overflow.y += padding;\n                overflow.height -= padding;\n                if (end.y > overflow.y) {\n                    extending = true;\n                    doTop();\n                } else if (end.y < overflow.height) {\n                    extending = true;\n                    doBottom();\n                }\n                return extending;\n            }\n\n            function snapToNearestY() {\n                var items = scrollable.getItems();\n                if (items) {\n                    var index = -1;\n                    var min = Number.POSITIVE_INFINITY;\n                    angular.forEach(items, function(item, i) {\n                        var distance = Math.abs((end.y + speed.y) - (item.offsetTop * -1));\n                        if (distance < min) {\n                            min = distance;\n                            index = i;\n                        }\n                    });\n                    // console.log('snapToNearestY', index, min);\n                    if (index !== -1) {\n                        if (snappable) {\n                            return scrollToIndex(index);\n                        } else {\n                            currentIndex = index;\n                        }\n                    }\n                }\n            }\n\n            function wheelYCheck(dir) {\n                // console.log('wheelYCheck', dir < 0 ? (end.y - overflow.height) : (end.y - overflow.y));\n                if (!busy && enabled) {\n                    if (dir < 0) {\n                        return end.y - overflow.height;\n                    } else {\n                        return end.y - overflow.y;\n                    }\n                } else {\n                    return false;\n                }\n            }\n\n            function wheelY(dir, interval) {\n                end.y += dir * 100 / 1000 * interval;\n                speed.y += dir * 100 / 1000 * interval;\n                wheeling = true;\n            }\n\n            function scrollToY(value) {\n                start.y = end.y = value;\n                setTimeout(function() {\n                    off();\n                    busy = false;\n                }, 500);\n            }\n\n        }\n\n        function link(methods) {\n            angular.extend(this, methods);\n        }\n\n        Scrollable.prototype = {\n            link: link,\n            getItems: function() {\n                return [content];\n            },\n        };\n        return Scrollable;\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.directive('videoSource', ['$timeout', '$promise', function ($timeout, $promise) {\n\n\t\tvar directive = {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tsource: '=videoSource',\n\t\t\t\timage: '=videoImage',\n\t\t\t},\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\treturn attributes.template || 'artisan/components/video/partial/video-player';\n\t\t\t},\n\t\t\tlink: VideoSourceLink\n\t\t};\n\n\t\treturn directive;\n\n\t\tfunction VideoSourceLink(scope, element, attributes) {\n\n\t\t\tvar native = element[0];\n\t\t\tvar video = native.querySelector('video');\n\t\t\tvar img = native.querySelector('img');\n\t\t\tvar infos = {};\n\t\t\tscope.canplay = false;\n\t\t\tscope.playing = false;\n\t\t\tscope.busy = false;\n\t\t\tscope.toggle = toggle;\n\t\t\tscope.play = play;\n\t\t\tscope.pause = pause;\n\t\t\tscope.infos = infos;\n\n\t\t\t// loop><source src=\"{{source}}\" type=\"video/mp4\"\n\n\t\t\tfunction canplay() {\n\t\t\t\treturn $promise(function (promise) {\n\n\t\t\t\t\tfunction _onCanPlay(e) {\n\t\t\t\t\t\tscope.canplay = true;\n\t\t\t\t\t\tangular.element(video).off('canplay', _onCanPlay);\n\t\t\t\t\t\t// console.log('videoSource._onCanPlay', e);\n\t\t\t\t\t\tpromise.resolve();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (scope.canplay) {\n\t\t\t\t\t\tpromise.resolve();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tangular.element(video).on('canplay', _onCanPlay);\n\t\t\t\t\t\tvideo.preload = true;\n\t\t\t\t\t\tvideo.src = scope.source;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction toggle() {\n\t\t\t\tif (!scope.busy) {\n\t\t\t\t\tscope.busy = true;\n\t\t\t\t\tif (scope.playing) {\n\t\t\t\t\t\tvideo.pause();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcanplay().then(function () {\n\t\t\t\t\t\t\tvideo.play();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction play() {\n\t\t\t\tif (!scope.busy) {\n\t\t\t\t\tscope.busy = true;\n\t\t\t\t\tcanplay().then(function () {\n\t\t\t\t\t\tvideo.play();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction pause() {\n\t\t\t\tif (!scope.busy) {\n\t\t\t\t\tscope.busy = true;\n\t\t\t\t\tvideo.pause();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction onCanPlay(e) {\n\t\t\t\t$timeout(function () {\n\t\t\t\t\tscope.canplay = true;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction onPlaying(e) {\n\t\t\t\t$timeout(function () {\n\t\t\t\t\tscope.playing = true;\n\t\t\t\t\tscope.busy = false;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction onPause(e) {\n\t\t\t\t$timeout(function () {\n\t\t\t\t\tscope.playing = false;\n\t\t\t\t\tscope.busy = false;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction onEnded(e) {\n\t\t\t\t$timeout(function () {\n\t\t\t\t\tscope.playing = false;\n\t\t\t\t\tscope.busy = false;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction onProgress(e) {\n\t\t\t\t$timeout(function () {\n\t\t\t\t\tinfos.buffered = video.buffered; // todo: TimeRanges\n\t\t\t\t\t// console.log('onProgress', infos);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction onTimeUpdate(e) {\n\t\t\t\t$timeout(function () {\n\t\t\t\t\tinfos.duration = video.duration;\n\t\t\t\t\tinfos.currentTime = video.currentTime;\n\t\t\t\t\tinfos.progressTime = infos.currentTime / infos.duration;\n\t\t\t\t\t// console.log('onTimeUpdate', infos);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tvar videoElement = angular.element(video);\n\n\t\t\tfunction addListeners() {\n\t\t\t\t// videoElement.on('canplay', onCanPlay);\n\t\t\t\tvideoElement.on('playing', onPlaying);\n\t\t\t\tvideoElement.on('pause', onPause);\n\t\t\t\tvideoElement.on('ended', onEnded);\n\t\t\t\tvideoElement.on('progress', onProgress);\n\t\t\t\tvideoElement.on('timeupdate', onTimeUpdate);\n\t\t\t}\n\n\t\t\tfunction removeListeners() {\n\t\t\t\t// videoElement.off('canplay', onCanPlay);\n\t\t\t\tvideoElement.off('playing', onPlaying);\n\t\t\t\tvideoElement.off('pause', onPause);\n\t\t\t\tvideoElement.off('ended', onEnded);\n\t\t\t\tvideoElement.off('progress', onProgress);\n\t\t\t\tvideoElement.off('timeupdate', onTimeUpdate);\n\t\t\t}\n\n\t\t\taddListeners();\n\t\t\tscope.$on('destroy', function () {\n\t\t\t\tremoveListeners();\n\t\t\t});\n\n\t\t}\n\n    }]);\n\n\t/*\n\tObject.defineProperty(HTMLMediaElement.prototype, 'playing', {\n\t    get: function () {\n\t        return !!(this.currentTime > 0 && !this.paused && !this.ended && this.readyState > 2);\n\t    }\n\t});\n\t*/\n\n}());"]}