{"version":3,"sources":["docs/js/artisan.js"],"names":["angular","module","service","$promise","$window","$document","environment","Facebook","promise","undefined","FB","resolve","FacebookInit","then","success","error","reject","FacebookStatus","response","init","authResponse","status","FacebookGetMe","facebook","api","fields","FacebookGetMyPicture","width","height","type","FacebookLogin","login","scope","FacebookLogout","logout","fbAsyncInit","appId","config","app_id","cookie","xfbml","version","d","s","id","js","fjs","getElementsByTagName","getElementById","createElement","src","parentNode","insertBefore","document","this","statics","getMe","getMyPicture","extend","addons","trhow","factory","Animate","callback","key","ticks","pause","animate","window","cancelAnimationFrame","play","loop","time","requestAnimationFrame","toggle","methods","prototype","lastTime","vendors","x","length","element","currTime","Date","getTime","timeToCall","Math","max","setTimeout","clearTimeout","getNode","getElement","isArray","getClosest","el","selector","matchesFn","parent","some","fn","body","parentElement","getClosestElement","target","getDocumentNode","documentElement","getParents","node","topParentNode","parents","push","compileController","html","data","link","$compile","contents","controller","$scope","$new","$controller","controllerAs","children","downloadFile","content","name","download","createEvent","anchor","href","base64","downloadName","substring","lastIndexOf","event","initEvent","dispatchEvent","open","indexOf","blob","Blob","reader","FileReader","readAsDataURL","onloadend","result","ua","agent","navigator","userAgent","toLowerCase","safari","msie","chrome","mobile","mac","forEach","value","addClass","app","EventsService","Dom","Point","Rect","Event","e","documentNode","scroll","pageXOffset","scrollLeft","pageYOffset","scrollTop","offset","nodeType","offsetLeft","y","offsetTop","boundNode","rect","getBoundingClientRect","page","getPage","relative","left","top","absolute","view","w","getWidth","h","getHeight","originalEvent","deltaX","wheelDeltaX","deltaY","wheelDeltaY","abs","dir","timestamp","console","log","self","innerWidth","clientWidth","innerHeight","clientHeight","standardEvents","t","touches","changedTouches","pageX","pageY","stop","stopPropagation","preventDefault","Events","setTimestamp","interval","min","events","onClick","listeners","click","apply","onMouseDown","down","removeTouchEvents","onMouseMove","move","onMouseUp","up","onMouseWheel","wheel","removeScrollEvents","onMouseScroll","removeWheelEvents","onResize","resize","onTouchStart","removeStandardEvents","onTouchMove","onTouchEnd","touchEvents","wheelEvents","scrollEvents","add","standard","touch","windowElement","listener","remove","on","$on","off","mouseEvents","getTouch","previous","point","difference","getRelativeTouch","hasPassiveEvents","supported","addEventListener","options","Object","defineProperty","get","defaults","passive","capture","original","EventTarget","modified","copy","call","onScroll","filter","scrollWidth","firefox","$filter","array","filters","item","i","PointDifference","a","b","PointMultiply","clone","mult","setPos","setX","setY","toString","multiply","RectMultiply","bottom","bottomLeft","bottomRight","center","expand","size","expandRect","intersect","reduce","reduceRect","offsetRect","right","setH","setSize","setW","topLeft","topRight","Vector","VectorCross","VectorDifference","VectorDistance","sqrt","VectorIncidence","atan2","VectorMake","VectorNormalize","l","VectorPower","VectorSize","cross","distance","friction","incidence","normalize","power","towards","make","Hash","pool","HashGet","defineProperties","enumerable","writable","pools","has","getId","hash","set","newItem","p","keys","oldItem","index","splice","addMany","items","removeMany","removeAll","shift","each","forward","reverse","sort","c","backward","differs","updatePool","Array","$q","deferred","defer","$promiseAll","promises","all","$timeout","State","errors","isReady","idle","busy","state","isBusy","isError","isErroring","isSuccess","isSuccessing","classes","ready","successing","errorring","enabled","DELAY","errorMessage","button","labels","label","submitClass","transformProperty","div","style","every","prefix","Style","props","scale","hoverScale","currentScale","styles","cssText","join","transform","transformOrigin","round","format","string","prepend","expression","splitted","split","formatted","object","reducer","o","reducerAdder","slice","reducerSetter","removeValue","reverseSortOn","throttle","func","wait","context","args","timeout","later","leading","getNow","now","remaining","arguments","trailing","toMd5","where","query","found","TypeError","len","k","Api","Doc","$location","$routeParams","View","doc","url","path","params","route","ViewCurrent","docs","current","$http","HttpPromise","method","urls","HttpGet","HttpPost","HttpPut","HttpPatch","HttpDelete","HttpFake","post","put","patch","delete","fake","redirect","msecs","doRedirect","$$lastRequestedPath","doRetry","$rootScope","Silent","SilentUnlink","$$listeners","$locationChangeSuccess","relink","SilentListener","$path","SilentSilent","replace","location","SilentPath","silent","unshift","CookieDelete","CookieSetter","CookieExists","CookieGet","cookieName","ca","charAt","model","JSON","parse","decodeURIComponent","atob","CookieOn","checkCookie","elapsed","Cookie","TIMEOUT","CookieSet","days","cache","json","stringify","btoa","encodeURIComponent","expires","date","setTime","toGMTString","exist","LocalExists","localStorage","LocalGet","LocalSet","setItem","LocalDelete","removeItem","LocalOn","storageEvent","newValue","sessionStorage","Color","r","g","uint","parseInt","componentToHex","hex","luma","color","dot","contrast","darker","pow","floor","lighter","toUint","toHex","toRgba","toFixed","alpha","makeSet","foreground","border","light","Shape","shapeCircle","cx","cy","sa","ea","PI","ctx","arc","shapeStar","or","ir","steps","angle","step","moveTo","cos","sin","lineTo","shapeRoundRect","tl","tr","br","bl","defaultRadius","quadraticCurveTo","circle","beginPath","closePath","star","roundRect","constant","black","white","blue","red","lightBlue","lightYellow","greyLighter","greyLight","greyMedium","grey","map","Painter","Palette","painter","buffer","rows","getRect","row","canvas","setCanvas","drawImage","palette","isString","img","Image","onload","addShape","onerror","save","clip","translate","restore","draw","pre","drawRect","tint","setFill","fillRect","globalCompositeOperation","pattern","drawPattern","fillStyle","createPattern","toDataURL","PainterColors","drawingRect","setColors","colors","offsetWidth","offsetHeight","getContext","lineCap","clear","setText","font","align","verticalAlign","textAlign","textBaseline","setStroke","strokeStyle","lineWidth","fillText","text","maxLength","substr","trim","strokeRect","fill","stroke","begin","close","rotate","xy","image","flip","directive","restrict","templateUrl","transclude","message","attributes","$parse","formatLabel","uniqueId","template","control","ngModel","required","form","title","placeholder","source","require","optionLabel","getOptions","number","field","precision","validate","minLength","Number","POSITIVE_INFINITY","focus","visible","onChange","$parent","onFilter","getType","getClasses","control-focus","control-success","$valid","control-error","$invalid","$submitted","$touched","control-empty","$viewValue","getMessages","$error","toggleVisibility","$templateCache","compile","onRemove","getter","numberPicker","setter","assign","onAdd","removeListeners","nodeRemove","nodeAdd","querySelectorAll","onFocus","$modelValue","$setViewValue","doBlur","onBlur","$formatters","$parsers","valid","String","$setValidity","$templateRequest","priority","modal","modalView","provider","when","routes","modals","$get","popModal","m","active","closeModal","addModal","back","Nav","$watch","onLink","onNav","nav","setItems","itemOpen","immediate","$nav","closed","closing","opening","opened","itemClose","itemToggle","onTap","trigger","output","resolved","rejected","navItem","prevent","querySelector","setNav","NavSilent","NavPath","setNavs","level","addItems","getLink","itemOrItems","addItem","ondragstart","Scrollable","Utils","render","scrollable","setContainer","containerNode","setContent","contentNode","setEnabled","isEnabled","renderX","getCurrent","contentStyle","onDown","dragStart","dragOn","onMove","dragMove","drag","getDrag","onUp","dragEnd","dragOff","_onScrollX","wheelX","onWheel","wheelXCheck","onScrollX","scrollableWhen","windowEvents","onLeft","onRight","showIndicatorFor","attr","scrollableX","getItems","scrollableItem","prev","scrollPrev","next","scrollNext","reset","doReset","oldValue","renderY","_onScrollY","wheelY","wheelYCheck","onScrollY","onTop","onBottom","scrollableY","container","flag","getIndicator","indicator","scrollToIndex","currentIndex","getItemAtIndex","start","end","speed","wheeling","dragging","doLeft","finally","scrollToX","doRight","overflow","padding","animating","extendX","snapToNearestX","extending","snappable","doTop","scrollToY","doBottom","extendY","snapToNearestY","tap","removeClass","ngBind","appendChild"],"mappings":"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","file":"artisan.min.js","sourcesContent":["/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan', ['ng', 'ngRoute', 'ngMessages']);\r\n\r\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.service('FacebookService', ['$promise', '$window', '$document', 'environment', function ($promise, $window, $document, environment) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\tlogin: FacebookLogin,\n\t\t\tlogout: FacebookLogout,\n\t\t\tstatus: FacebookStatus,\n\t\t\tgetMe: FacebookGetMe,\n\t\t\tgetMyPicture: FacebookGetMyPicture,\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\t// private vars\n\n\t\tif (!environment.addons || !environment.addons.facebook) {\n\t\t\ttrhow('FacebookService.error missing environment.addons.facebook');\n\t\t}\n\n\t\tvar config = environment.addons.facebook;\n\n\t\t// statics methods\n\n\t\tfunction Facebook() {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tif ($window.FB !== undefined) {\n\t\t\t\t\tpromise.resolve($window.FB);\n\t\t\t\t} else {\n\t\t\t\t\tFacebookInit().then(function (success) {\n\t\t\t\t\t\tpromise.resolve($window.FB);\n\t\t\t\t\t}, function (error) {\n\t\t\t\t\t\tpromise.reject(error);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tfunction FacebookStatus(response, promise, init) {\n\t\t\tservice.authResponse = null;\n\t\t\tif (response.status === 'connected') {\n\t\t\t\tservice.authResponse = response.authResponse;\n\t\t\t\tpromise.resolve(response);\n\t\t\t} else if (response.status === 'not_authorized') {\n\t\t\t\tif (init) {\n\t\t\t\t\tpromise.resolve(response);\n\t\t\t\t} else {\n\t\t\t\t\tpromise.reject(response);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tpromise.reject(response);\n\t\t\t}\n\t\t}\n\n\t\tfunction FacebookGetMe() {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tFacebook().then(function (facebook) {\n\t\t\t\t\tfacebook.api('/me', {\n\t\t\t\t\t\tfields: 'id,name,first_name,last_name,email,gender,picture,cover,link'\n\t\t\t\t\t}, function (response) {\n\t\t\t\t\t\tif (!response || response.error) {\n\t\t\t\t\t\t\tpromise.reject('Error occured');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpromise.resolve(response);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tfunction FacebookGetMyPicture() {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tFacebook().then(function (facebook) {\n\t\t\t\t\tfacebook.api('/me/picture', {\n\t\t\t\t\t\twidth: 300,\n\t\t\t\t\t\theight: 300,\n\t\t\t\t\t\ttype: 'square'\n\t\t\t\t\t}, function (response) {\n\t\t\t\t\t\tif (!response || response.error) {\n\t\t\t\t\t\t\tpromise.reject('Error occured');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpromise.resolve(response);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tfunction FacebookLogin() {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tFacebook().then(function (facebook) {\n\t\t\t\t\tfacebook.login(function (response) {\n\t\t\t\t\t\tFacebookStatus(response, promise);\n\t\t\t\t\t}, {\n\t\t\t\t\t\tscope: 'public_profile, email' // publish_stream,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tfunction FacebookLogout() {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tFacebook().then(function (facebook) {\n\t\t\t\t\tfacebook.logout(function (response) {\n\t\t\t\t\t\tpromise.resolve(response);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tfunction FacebookInit() {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\t$window.fbAsyncInit = function () {\n\t\t\t\t\t$window.FB.init({\n\t\t\t\t\t\tappId: config.app_id,\n\t\t\t\t\t\tstatus: true,\n\t\t\t\t\t\tcookie: true,\n\t\t\t\t\t\txfbml: true,\n\t\t\t\t\t\tversion: 'v2.10'\n\t\t\t\t\t});\n\t\t\t\t\tpromise.resolve($window.FB);\n\t\t\t\t\t// $window.fbAsyncInit = null;\n\t\t\t\t};\n\t\t\t\ttry {\n\t\t\t\t\t(function (d, s, id) {\n\t\t\t\t\t\tvar js, fjs = d.getElementsByTagName(s)[0];\n\t\t\t\t\t\tif (d.getElementById(id)) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tjs = d.createElement(s);\n\t\t\t\t\t\tjs.id = id;\n\t\t\t\t\t\tjs.src = \"//connect.facebook.net/en_US/sdk.js\";\n\t\t\t\t\t\tfjs.parentNode.insertBefore(js, fjs);\n\t\t\t\t\t}(document, 'script', 'facebook-jssdk'));\n\t\t\t\t} catch (error) {\n\t\t\t\t\tpromise.reject(error);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Animate', [function () {\n\n\t\tfunction Animate(callback) {\n\t\t\tthis.callback = callback;\n\t\t\tthis.key = null;\n\t\t\tthis.ticks = 0;\n\t\t}\n\n\t\tvar statics = {};\n\n\t\tvar methods = {\n\t\t\tpause: pause,\n\t\t\tplay: play,\n\t\t\ttoggle: toggle,\n\t\t};\n\n\t\tangular.extend(Animate, statics);\n\t\tangular.extend(Animate.prototype, methods);\n\n\t\treturn Animate;\n\n\t\t// static methods\n\n\t\t// prototype methods\n\n\t\tfunction pause() {\n\t\t\tvar animate = this;\n\t\t\tif (animate.key) {\n\t\t\t\twindow.cancelAnimationFrame(animate.key);\n\t\t\t\tanimate.key = null;\n\t\t\t}\n\t\t}\n\n\t\tfunction play() {\n\t\t\tvar animate = this;\n\n\t\t\tfunction loop(time) {\n\t\t\t\tanimate.ticks++;\n\t\t\t\tanimate.callback(time, animate.ticks);\n\t\t\t\tanimate.key = window.requestAnimationFrame(loop);\n\t\t\t}\n\t\t\tif (!animate.key) {\n\t\t\t\tloop();\n\t\t\t}\n\t\t}\n\n\t\tfunction toggle() {\n\t\t\tvar animate = this;\n\t\t\tif (animate.key) {\n\t\t\t\tanimate.pause();\n\t\t\t} else {\n\t\t\t\tanimate.play();\n\t\t\t}\n\t\t}\n\n    }]);\n\n\t(function () {\n\t\tvar lastTime = 0;\n\t\tvar vendors = ['ms', 'moz', 'webkit', 'o'];\n\t\tfor (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n\t\t\twindow.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\n\t\t\twindow.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] ||\n\t\t\t\twindow[vendors[x] + 'CancelRequestAnimationFrame'];\n\t\t}\n\t\tif (!window.requestAnimationFrame) {\n\t\t\twindow.requestAnimationFrame = function (callback, element) {\n\t\t\t\tvar currTime = new Date().getTime();\n\t\t\t\tvar timeToCall = Math.max(0, 16 - (currTime - lastTime));\n\t\t\t\tvar id = window.setTimeout(function () {\n\t\t\t\t\tcallback(currTime + timeToCall);\n\t\t\t\t}, timeToCall);\n\t\t\t\tlastTime = currTime + timeToCall;\n\t\t\t\treturn id;\n\t\t\t};\n\t\t}\n\t\tif (!window.cancelAnimationFrame) {\n\t\t\twindow.cancelAnimationFrame = function (id) {\n\t\t\t\tclearTimeout(id);\n\t\t\t};\n\t\t}\n\t}());\n\n}());\n/*\n// handle transition on resizing\nvar resizingTimeout;\n$(window).on('resize', function () {\n    clearTimeout(resizingTimeout);\n    $('body').addClass('resizing');\n    resizingTimeout = setTimeout(function () {\n        $('body').removeClass('resizing');\n    }, 100);\n})\n*/\n\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.service('Dom', ['$window', '$document', function ($window, $document) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\tua: getUA(),\n\t\t\tgetNode: getNode,\n\t\t\tgetElement: getElement,\n\t\t\tgetClosest: getClosest,\n\t\t\tgetClosestElement: getClosestElement,\n\t\t\tgetParents: getParents,\n\t\t\tgetDocumentNode: getDocumentNode,\n\t\t\tcompileController: compileController,\n\t\t\tdownloadFile: downloadFile,\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\tfunction getUA() {\n\t\t\tvar agent = window.navigator.userAgent.toLowerCase();\n\t\t\tvar safari = agent.indexOf('safari') !== -1 && agent.indexOf('chrome') === -1;\n\t\t\tvar msie = agent.indexOf('trident') !== -1 || agent.indexOf('edge') !== -1 || agent.indexOf('msie') !== -1;\n\t\t\tvar chrome = !safari && !msie && agent.indexOf('chrome') !== -1;\n\t\t\tvar mobile = agent.indexOf('mobile') !== -1;\n\t\t\tvar mac = agent.indexOf('macintosh') !== -1;\n\t\t\tvar ua = {\n\t\t\t\tagent: agent,\n\t\t\t\tsafari: safari,\n\t\t\t\tmsie: msie,\n\t\t\t\tchrome: chrome,\n\t\t\t\tmobile: mobile,\n\t\t\t\tmac: mac,\n\t\t\t};\n\t\t\tangular.forEach(ua, function (value, key) {\n\t\t\t\tif (value) {\n\t\t\t\t\tangular.element(document.getElementsByTagName('body')).addClass(key);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ua;\n\t\t}\n\n\t\tfunction getNode(element) {\n\t\t\treturn element.length ? element[0] : element;\n\t\t}\n\n\t\tfunction getElement(element) {\n\t\t\treturn angular.isArray(element) ? element : angular.element(element);\n\t\t}\n\n\t\tfunction getClosest(el, selector) {\n\t\t\tvar matchesFn, parent;\n            ['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector', 'oMatchesSelector'].some(function (fn) {\n\t\t\t\tif (typeof document.body[fn] == 'function') {\n\t\t\t\t\tmatchesFn = fn;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t\tif (el[matchesFn](selector)) {\n\t\t\t\treturn el;\n\t\t\t}\n\t\t\twhile (el !== null) {\n\t\t\t\tparent = el.parentElement;\n\t\t\t\tif (parent !== null && parent[matchesFn](selector)) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tel = parent;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tfunction getClosestElement(el, target) {\n\t\t\tvar matchesFn, parent;\n\t\t\tif (el === target) {\n\t\t\t\treturn el;\n\t\t\t}\n\t\t\twhile (el !== null) {\n\t\t\t\tparent = el.parentElement;\n\t\t\t\tif (parent !== null && parent === target) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tel = parent;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tfunction getDocumentNode() {\n\t\t\tvar documentNode = (document.documentElement || document.body.parentNode || document.body);\n\t\t\treturn documentNode;\n\t\t}\n\n\t\tfunction getParents(node, topParentNode) {\n\t\t\t// if no topParentNode defined will bubble up all the way to *document*\n\t\t\ttopParentNode = topParentNode || getDocumentNode();\n\t\t\tvar parents = [];\n\t\t\tif (node) {\n\t\t\t\tparents.push(node);\n\t\t\t\tvar parentNode = node.parentNode;\n\t\t\t\twhile (parentNode !== topParentNode) {\n\t\t\t\t\tparents.push(parentNode);\n\t\t\t\t\tparentNode = parentNode.parentNode;\n\t\t\t\t}\n\t\t\t\tparents.push(topParentNode); // push that topParentNode you wanted to stop at\n\t\t\t}\n\t\t\treturn parents;\n\t\t}\n\n\t\tfunction compileController(scope, element, html, data) {\n\t\t\t// console.log('Dom.compileController', element);\n\t\t\telement.html(html);\n\t\t\tvar link = $compile(element.contents());\n\t\t\tif (data.controller) {\n\t\t\t\tvar $scope = scope.$new();\n\t\t\t\tangular.extend($scope, data);\n\t\t\t\tvar controller = $controller(data.controller, {\n\t\t\t\t\t$scope: $scope\n\t\t\t\t});\n\t\t\t\tif (data.controllerAs) {\n\t\t\t\t\tscope[data.controllerAs] = controller;\n\t\t\t\t}\n\t\t\t\telement.data('$ngControllerController', controller);\n\t\t\t\telement.children().data('$ngControllerController', controller);\n\t\t\t\tscope = $scope;\n\t\t\t}\n\t\t\tlink(scope);\n\t\t}\n\n\t\tfunction downloadFile(content, name, type) {\n\t\t\ttype = type || 'application/octet-stream';\n\t\t\tvar base64 = null;\n\t\t\tvar blob = new Blob([content], {\n\t\t\t\ttype: type\n\t\t\t});\n\t\t\tvar reader = new window.FileReader();\n\t\t\treader.readAsDataURL(blob);\n\t\t\treader.onloadend = function () {\n\t\t\t\tbase64 = reader.result;\n\t\t\t\tdownload();\n\t\t\t};\n\n\t\t\tfunction download() {\n\t\t\t\tif (document.createEvent) {\n\t\t\t\t\tvar anchor = document.createElement('a');\n\t\t\t\t\tanchor.href = base64;\n\t\t\t\t\tif (anchor.download !== undefined) {\n\t\t\t\t\t\tvar downloadName = name || base64.substring(base64.lastIndexOf('/') + 1, base64.length);\n\t\t\t\t\t\tanchor.download = downloadName;\n\t\t\t\t\t}\n\t\t\t\t\tvar event = document.createEvent('MouseEvents');\n\t\t\t\t\tevent.initEvent('click', true, true);\n\t\t\t\t\tanchor.dispatchEvent(event);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tvar query = '?download';\n\t\t\t\twindow.open(base64.indexOf('?') > -1 ? base64 : base64 + query, '_self');\n\t\t\t}\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Event', ['$window', '$document', 'EventsService', 'Dom', 'Point', 'Rect', function ($window, $document, EventsService, Dom, Point, Rect) {\n\n\t\tfunction Event(e, element) {\n\t\t\ttry {\n\t\t\t\tvar event = this;\n\t\t\t\te = e || $window.event;\n\t\t\t\tvar documentNode = Dom.getDocumentNode();\n\t\t\t\tvar scroll = new Point(\n\t\t\t\t\t$window.pageXOffset || documentNode.scrollLeft,\n\t\t\t\t\t$window.pageYOffset || documentNode.scrollTop\n\t\t\t\t);\n\t\t\t\tvar offset = new Point();\n\t\t\t\tvar node = Dom.getNode(element);\n\t\t\t\tif (node && node.nodeType === 1) {\n\t\t\t\t\toffset.x = node.offsetLeft;\n\t\t\t\t\toffset.y = node.offsetTop;\n\t\t\t\t}\n\t\t\t\tvar boundNode = node === $window ? documentNode : node;\n\t\t\t\tvar rect = boundNode.getBoundingClientRect();\n\t\t\t\tvar page = event.getPage(e);\n\t\t\t\tif (page) {\n\t\t\t\t\tvar relative = new Point(\n\t\t\t\t\t\tpage.x - scroll.x - rect.left,\n\t\t\t\t\t\tpage.y - scroll.y - rect.top\n\t\t\t\t\t);\n\t\t\t\t\tvar absolute = new Point(\n\t\t\t\t\t\tpage.x - scroll.x,\n\t\t\t\t\t\tpage.y - scroll.y\n\t\t\t\t\t);\n\t\t\t\t\tevent.relative = relative;\n\t\t\t\t\tevent.absolute = absolute;\n\t\t\t\t}\n\t\t\t\tif (e.type === 'resize') {\n\t\t\t\t\tvar view = {\n\t\t\t\t\t\tw: event.getWidth(),\n\t\t\t\t\t\th: event.getHeight(),\n\t\t\t\t\t};\n\t\t\t\t\tevent.view = view;\n\t\t\t\t}\n\t\t\t\tif (e.type === 'mousewheel' || e.type === 'DOMMouseScroll') {\n\t\t\t\t\te = e.originalEvent ? e.originalEvent : e;\n\t\t\t\t\tvar deltaX = e.deltaX || e.wheelDeltaX;\n\t\t\t\t\tvar deltaY = e.deltaY || e.wheelDeltaY;\n\t\t\t\t\tif (Math.abs(deltaX) > Math.abs(deltaY)) {\n\t\t\t\t\t\tevent.dir = deltaX < 0 ? 1 : -1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tevent.dir = deltaY < 0 ? 1 : -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tevent.originalEvent = e;\n\t\t\t\tevent.element = element;\n\t\t\t\tevent.node = node;\n\t\t\t\tevent.offset = offset;\n\t\t\t\tevent.rect = rect;\n\t\t\t\tevent.timestamp = new Date().getTime();\n\t\t\t} catch (error) {\n\t\t\t\tconsole.log('Event.error', error);\n\t\t\t}\n\t\t}\n\n\t\tvar methods = {\n\t\t\tgetPage: getPage,\n\t\t\tgetWidth: getWidth,\n\t\t\tgetHeight: getHeight,\n\t\t\tstop: stop,\n\t\t};\n\n\t\tvar statics = {};\n\n\t\tangular.extend(Event.prototype, methods);\n\t\tangular.extend(Event, statics);\n\t\treturn Event;\n\n\t\t// prototype methods\n\n\t\tfunction getWidth() {\n\t\t\tif (self.innerWidth) {\n\t\t\t\treturn self.innerWidth;\n\t\t\t}\n\t\t\tvar documentNode = Dom.getDocumentNode();\n\t\t\treturn documentNode.clientWidth;\n\t\t}\n\n\t\tfunction getHeight() {\n\t\t\tif (self.innerHeight) {\n\t\t\t\treturn self.innerHeight;\n\t\t\t}\n\t\t\tvar documentNode = Dom.getDocumentNode();\n\t\t\treturn documentNode.clientHeight;\n\t\t}\n\n\t\tfunction getPage(e) {\n\t\t\tvar page = null;\n\t\t\tvar standardEvents = ['click', 'mousedown', 'mouseup', 'mousemove', 'mouseover', 'mouseout', 'mouseenter', 'mouseleave', 'contextmenu'];\n\t\t\tvar touchEvents = ['touchstart', 'touchmove', 'touchend', 'touchcancel'];\n\t\t\tif (touchEvents.indexOf(e.type) !== -1) {\n\t\t\t\tvar t = null;\n\t\t\t\tvar event = e.originalEvent ? e.originalEvent : e;\n\t\t\t\tvar touches = event.touches.length ? event.touches : event.changedTouches;\n\t\t\t\tif (touches && touches.length) {\n\t\t\t\t\tt = touches[0];\n\t\t\t\t}\n\t\t\t\tif (t) {\n\t\t\t\t\tpage = new Point(\n\t\t\t\t\t\tt.pageX,\n\t\t\t\t\t\tt.pageY\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else if (standardEvents.indexOf(e.type) !== -1) {\n\t\t\t\tpage = new Point(\n\t\t\t\t\te.pageX,\n\t\t\t\t\te.pageY\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.type = e.type;\n\t\t\treturn page;\n\t\t}\n\n\t\tfunction stop() {\n\t\t\tthis.originalEvent.stopPropagation();\n\t\t\tthis.originalEvent.preventDefault();\n\t\t}\n\n\t}]);\n\n\tapp.factory('Events', ['$window', '$document', 'EventsService', 'Event', 'Dom', function ($window, $document, EventsService, Event, Dom) {\n\n\t\tfunction Events(element) {\n\t\t\tvar events = this;\n\n\t\t\tthis.element = element;\n\t\t\tthis.listeners = {};\n\t\t\tthis.standardEvents = {\n\t\t\t\tclick: {\n\t\t\t\t\tkey: 'click',\n\t\t\t\t\tcallback: onClick\n\t\t\t\t},\n\t\t\t\tdown: {\n\t\t\t\t\tkey: 'mousedown',\n\t\t\t\t\tcallback: onMouseDown\n\t\t\t\t},\n\t\t\t\tmove: {\n\t\t\t\t\tkey: 'mousemove',\n\t\t\t\t\tcallback: onMouseMove\n\t\t\t\t},\n\t\t\t\tup: {\n\t\t\t\t\tkey: 'mouseup',\n\t\t\t\t\tcallback: onMouseUp\n\t\t\t\t},\n\t\t\t\tresize: {\n\t\t\t\t\tkey: 'resize',\n\t\t\t\t\tcallback: onResize\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.touchEvents = {\n\t\t\t\tdown: {\n\t\t\t\t\tkey: 'touchstart',\n\t\t\t\t\tcallback: onTouchStart\n\t\t\t\t},\n\t\t\t\tmove: {\n\t\t\t\t\tkey: 'touchmove',\n\t\t\t\t\tcallback: onTouchMove\n\t\t\t\t},\n\t\t\t\tup: {\n\t\t\t\t\tkey: 'touchend',\n\t\t\t\t\tcallback: onTouchEnd\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.wheelEvents = {\n\t\t\t\twheel: {\n\t\t\t\t\tkey: 'mousewheel',\n\t\t\t\t\tcallback: onMouseWheel\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.scrollEvents = {\n\t\t\t\twheel: {\n\t\t\t\t\tkey: 'DOMMouseScroll',\n\t\t\t\t\tcallback: onMouseScroll\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.timestamp = new Date().getTime();\n\t\t\tthis.setTimestamp = setTimestamp;\n\n\t\t\tfunction setTimestamp(event) {\n\t\t\t\tif (event) {\n\t\t\t\t\tevent.interval = Math.min(250, event.timestamp - events.timestamp);\n\t\t\t\t\t// console.log(event.interval, event.timestamp, events.timestamp);\n\t\t\t\t}\n\t\t\t\tevents.timestamp = new Date().getTime();\n\t\t\t}\n\n\t\t\tfunction onClick(e) {\n\t\t\t\t// console.log('onClick', e, events);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.click.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onMouseDown(e) {\n\t\t\t\t// console.log('onMouseDown', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.down.apply(this, [event]);\n\t\t\t\tevents.removeTouchEvents();\n\t\t\t}\n\n\t\t\tfunction onMouseMove(e) {\n\t\t\t\t// console.log('onMouseMove', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.move.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onMouseUp(e) {\n\t\t\t\t// console.log('onMouseUp', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.up.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onMouseWheel(e) {\n\t\t\t\t// console.log('onMouseWheel', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.wheel.apply(this, [event]);\n\t\t\t\tevents.removeScrollEvents();\n\t\t\t}\n\n\t\t\tfunction onMouseScroll(e) {\n\t\t\t\t// console.log('onMouseScroll', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.wheel.apply(this, [event]);\n\t\t\t\tevents.removeWheelEvents();\n\t\t\t}\n\n\t\t\tfunction onResize(e) {\n\t\t\t\t// console.log('onResize', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.resize.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onTouchStart(e) {\n\t\t\t\t// console.log('onTouchStart', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.down.apply(this, [event]);\n\t\t\t\tevents.removeStandardEvents();\n\t\t\t}\n\n\t\t\tfunction onTouchMove(e) {\n\t\t\t\t// console.log('onTouchMove', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.move.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onTouchEnd(e) {\n\t\t\t\t// console.log('onTouchEnd', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.up.apply(this, [event]);\n\t\t\t}\n\t\t}\n\n\t\tvar methods = {\n\t\t\tadd: add,\n\t\t\tremove: remove,\n\t\t\tremoveStandardEvents: removeStandardEvents,\n\t\t\tremoveTouchEvents: removeTouchEvents,\n\t\t\tremoveWheelEvents: removeWheelEvents,\n\t\t\tremoveScrollEvents: removeScrollEvents,\n\t\t};\n\n\t\tvar statics = {\n\t\t\tgetTouch: getTouch,\n\t\t\tgetRelativeTouch: getRelativeTouch,\n\t\t};\n\n\t\tangular.extend(Events.prototype, methods);\n\t\tangular.extend(Events, statics);\n\t\treturn Events;\n\n\t\t// prototype methods\n\n\t\tfunction add(listeners, scope) {\n\t\t\tvar events = this,\n\t\t\t\tstandard = this.standardEvents,\n\t\t\t\ttouch = this.touchEvents,\n\t\t\t\twheel = this.wheelEvents,\n\t\t\t\tscroll = this.scrollEvents;\n\t\t\tvar element = Dom.getElement(this.element),\n\t\t\t\twindowElement = angular.element($window);\n\n\t\t\tangular.forEach(listeners, function (callback, key) {\n\t\t\t\tif (events.listeners[key]) {\n\t\t\t\t\tvar listener = {};\n\t\t\t\t\tlistener[key] = events.listeners[key];\n\t\t\t\t\tremove(listener);\n\t\t\t\t}\n\t\t\t\tevents.listeners[key] = callback;\n\t\t\t\tif (standard[key]) {\n\t\t\t\t\tif (key === 'resize') {\n\t\t\t\t\t\twindowElement.on(standard[key].key, standard[key].callback);\n\t\t\t\t\t} else {\n\t\t\t\t\t\telement.on(standard[key].key, standard[key].callback);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (touch[key]) {\n\t\t\t\t\telement.on(touch[key].key, touch[key].callback);\n\t\t\t\t}\n\t\t\t\tif (wheel[key]) {\n\t\t\t\t\telement.on(wheel[key].key, wheel[key].callback);\n\t\t\t\t}\n\t\t\t\tif (scroll[key]) {\n\t\t\t\t\telement.on(scroll[key].key, scroll[key].callback);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (scope) {\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tevents.remove(listeners);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn events;\n\t\t}\n\n\t\tfunction remove(listeners) {\n\t\t\tvar events = this,\n\t\t\t\tstandard = this.standardEvents,\n\t\t\t\ttouch = this.touchEvents,\n\t\t\t\twheel = this.wheelEvents,\n\t\t\t\tscroll = this.scrollEvents;\n\t\t\tvar element = Dom.getElement(this.element),\n\t\t\t\twindowElement = angular.element($window);\n\t\t\tangular.forEach(listeners, function (callback, key) {\n\t\t\t\tif (standard[key]) {\n\t\t\t\t\tif (key === 'resize') {\n\t\t\t\t\t\twindowElement.off(standard[key].key, standard[key].callback);\n\t\t\t\t\t} else {\n\t\t\t\t\t\telement.off(standard[key].key, standard[key].callback);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (touch[key]) {\n\t\t\t\t\telement.off(touch[key].key, touch[key].callback);\n\t\t\t\t}\n\t\t\t\tif (wheel[key]) {\n\t\t\t\t\telement.off(wheel[key].key, wheel[key].callback);\n\t\t\t\t}\n\t\t\t\tif (scroll[key]) {\n\t\t\t\t\telement.off(scroll[key].key, scroll[key].callback);\n\t\t\t\t}\n\t\t\t\tevents.listeners[key] = null;\n\t\t\t});\n\t\t\treturn events;\n\t\t}\n\n\t\tfunction removeStandardEvents() {\n\t\t\tvar events = this,\n\t\t\t\tstandard = events.standardEvents,\n\t\t\t\ttouch = events.touchEvents;\n\t\t\tvar element = Dom.getElement(events.element);\n\t\t\telement.off('mousedown', standard.down.callback);\n\t\t\telement.off('mousemove', standard.move.callback);\n\t\t\telement.off('mouseup', standard.up.callback);\n\t\t}\n\n\t\tfunction removeTouchEvents() {\n\t\t\tvar events = this,\n\t\t\t\tstandard = events.standardEvents,\n\t\t\t\ttouch = events.touchEvents;\n\t\t\tvar element = Dom.getElement(events.element);\n\t\t\telement.off('touchstart', touch.down.callback);\n\t\t\telement.off('touchmove', touch.move.callback);\n\t\t\telement.off('touchend', touch.up.callback);\n\t\t}\n\n\t\tfunction removeWheelEvents() {\n\t\t\tvar events = this;\n\t\t\tvar element = Dom.getElement(events.element);\n\t\t\telement.off('mousewheel', events.mouseEvents.wheel.callback);\n\t\t}\n\n\t\tfunction removeScrollEvents() {\n\t\t\tvar events = this;\n\t\t\tvar element = Dom.getElement(events.element);\n\t\t\telement.off('DOMMouseScroll', events.scrollEvents.wheel.callback);\n\t\t}\n\n\t\t// statics methods\n\n\t\tfunction getTouch(e, previous) {\n\t\t\tvar point = new Point();\n\t\t\tif (e.type === 'touchstart' || e.type === 'touchmove' || e.type === 'touchend' || e.type === 'touchcancel') {\n\t\t\t\tvar touch = null;\n\t\t\t\tvar event = e.originalEvent ? e.originalEvent : e;\n\t\t\t\tvar touches = event.touches.length ? event.touches : event.changedTouches;\n\t\t\t\tif (touches && touches.length) {\n\t\t\t\t\ttouch = touches[0];\n\t\t\t\t}\n\t\t\t\tif (touch) {\n\t\t\t\t\tpoint.x = touch.pageX;\n\t\t\t\t\tpoint.y = touch.pageY;\n\t\t\t\t}\n\t\t\t} else if (e.type === 'click' || e.type === 'mousedown' || e.type === 'mouseup' || e.type === 'mousemove' || e.type === 'mouseover' || e.type === 'mouseout' || e.type === 'mouseenter' || e.type === 'mouseleave' || e.type === 'contextmenu') {\n\t\t\t\tpoint.x = e.pageX;\n\t\t\t\tpoint.y = e.pageY;\n\t\t\t}\n\t\t\tif (previous) {\n\t\t\t\tpoint.s = Point.difference(t, previous);\n\t\t\t}\n\t\t\tpoint.type = e.type;\n\t\t\treturn point;\n\t\t}\n\n\t\tfunction getRelativeTouch(node, point) {\n\t\t\tnode = angular.isArray(node) ? node[0] : node;\n\t\t\treturn Point.difference(point, {\n\t\t\t\tx: node.offsetLeft,\n\t\t\t\ty: node.offsetTop\n\t\t\t});\n\t\t}\n\n    }]);\n\n\tapp.service('EventsService', ['$window', 'Dom', function ($window, Dom) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\thasPassiveEvents: hasPassiveEvents,\n\t\t\taddEventListener: getAddEventListener(),\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\t// prevent history back on mac os\n\n\t\tpreventHistoryNavigation();\n\n\t\t// static methods\n\n\t\tfunction hasPassiveEvents() {\n\t\t\tvar supported = false;\n\t\t\tif ($window.addEventListener) {\n\t\t\t\ttry {\n\t\t\t\t\tvar options = Object.defineProperty({}, 'passive', {\n\t\t\t\t\t\tget: function () {\n\t\t\t\t\t\t\tsupported = true;\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\t$window.addEventListener('test', null, options);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log('getAddEventListener.isSupprted', e);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn supported;\n\t\t}\n\n\t\tfunction getAddEventListener() {\n\t\t\tvar supported = hasPassiveEvents();\n\t\t\tif (!supported) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar defaults = {\n\t\t\t\tpassive: false,\n\t\t\t\tcapture: false,\n\t\t\t};\n\n\t\t\tfunction getModifiedAddEventListener(original) {\n\t\t\t\tfunction addEventListener(type, listener, options) {\n\t\t\t\t\tif (typeof options !== 'object') {\n\t\t\t\t\t\tvar capture = options === true;\n\t\t\t\t\t\toptions = angular.copy(defaults);\n\t\t\t\t\t\toptions.capture = capture;\n\t\t\t\t\t} else {\n\t\t\t\t\t\toptions = angular.extend(angular.copy(defaults), options);\n\t\t\t\t\t}\n\t\t\t\t\toriginal.call(this, type, listener, options);\n\t\t\t\t}\n\t\t\t\treturn addEventListener;\n\t\t\t}\n\n\t\t\tvar original = EventTarget.prototype.addEventListener;\n\t\t\tvar modified = getModifiedAddEventListener(original);\n\t\t\tEventTarget.prototype.addEventListener = modified;\n\t\t\treturn modified;\n\t\t}\n\n\t\tfunction preventHistoryNavigation() {\n\t\t\tif (!Dom.ua.mac) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (Dom.ua.chrome || Dom.ua.safari || Dom.ua.firefox) {\n\t\t\t\t$window.addEventListener('mousewheel', onScroll, {\n\t\t\t\t\tpassive: false\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction onScroll(e) {\n\t\t\t\tif (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\t(e.deltaX < 0 && (Dom.getParents(e.target).filter(function (node) {\n\t\t\t\t\t\treturn node.scrollLeft > 0;\n\t\t\t\t\t}).length === 0)) ||\n\t\t\t\t\t(e.deltaX > 0 && (Dom.getParents(e.target).filter(function (node) {\n\t\t\t\t\t\treturn node.scrollWidth - node.scrollLeft > node.clientWidth;\n\t\t\t\t\t}).length === 0))\n\t\t\t\t) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n    }]);\n\n}());\n/* global angular, app, Autolinker */\r\n(function () {\r\n\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.filter('notIn', ['$filter', function ($filter) {\r\n\r\n\t\treturn function (array, filters, element) {\r\n\t\t\tif (filters) {\r\n\t\t\t\treturn $filter(\"filter\")(array, function (item) {\r\n\t\t\t\t\tfor (var i = 0; i < filters.length; i++) {\r\n\t\t\t\t\t\tif (filters[i][element] === item[element]) return false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\r\n    }]);\r\n\r\n}());\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Point', [function () {\n\n\t\tfunction Point(x, y) {\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\t\t}\n\n\t\tvar statics = {\n\t\t\tdifference: PointDifference,\n\t\t\tmultiply: PointMultiply,\n\t\t};\n\n\t\tvar methods = {\n\t\t\tclone: clone,\n\t\t\tcopy: copy,\n\t\t\tdifference: difference,\n\t\t\tmult: mult,\n\t\t\toffset: offset,\n\t\t\tsetPos: setPos,\n\t\t\tsetX: setX,\n\t\t\tsetY: setY,\n\t\t\ttoString: toString,\n\t\t};\n\n\t\tangular.extend(Point, statics);\n\t\tangular.extend(Point.prototype, methods);\n\n\t\treturn Point;\n\n\t\t// static methods\n\n\t\tfunction PointDifference(a, b) {\n\t\t\treturn new Point(a.x - b.x, a.y - b.y);\n\t\t}\n\n\t\tfunction PointMultiply(point, value) {\n\t\t\tpoint.x *= value;\n\t\t\tpoint.y *= value;\n\t\t\treturn point;\n\t\t}\n\n\t\t// prototype methods\n\n\t\tfunction clone() {\n\t\t\treturn new Point(this.x, this.y);\n\t\t}\n\n\t\tfunction copy(point) {\n\t\t\tthis.x = point.x;\n\t\t\tthis.y = point.y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction difference(b) {\n\t\t\treturn PointDifference(this, b);\n\t\t}\n\n\t\tfunction mult(value) {\n\t\t\treturn PointMultiply(this, value);\n\t\t}\n\n\t\tfunction offset(x, y) {\n\t\t\tthis.x += x;\n\t\t\tthis.y += y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setPos(x, y) {\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setX(x) {\n\t\t\tthis.x = x;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setY(y) {\n\t\t\tthis.y = y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction toString() {\n\t\t\treturn '{' + this.x + ',' + this.y + '}';\n\t\t}\n\n    }]);\n\n}());\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Rect', [function () {\n\n\t\tfunction Rect(x, y, w, h) {\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\t\t\tthis.w = w || 0;\n\t\t\tthis.h = h || 0;\n\t\t}\n\n\t\tvar statics = {\n\t\t\tmult: RectMultiply,\n\t\t};\n\n\t\tvar methods = {\n\t\t\tbottom: bottom,\n\t\t\tbottomLeft: bottomLeft,\n\t\t\tbottomRight: bottomRight,\n\t\t\tcenter: center,\n\t\t\tclone: clone,\n\t\t\tcopy: copy,\n\t\t\texpand: expand,\n\t\t\texpandRect: expandRect,\n\t\t\tintersect: intersect,\n\t\t\tleft: left,\n\t\t\tmult: mult,\n\t\t\toffset: offset,\n\t\t\treduce: reduce,\n\t\t\treduceRect: reduceRect,\n\t\t\tright: right,\n\t\t\tsetH: setH,\n\t\t\tsetPos: setPos,\n\t\t\tsetSize: setSize,\n\t\t\tsetX: setX,\n\t\t\tsetY: setY,\n\t\t\tsetW: setW,\n\t\t\ttop: top,\n\t\t\ttopLeft: topLeft,\n\t\t\ttopRight: topRight,\n\t\t\ttoString: toString,\n\t\t};\n\n\t\tangular.extend(Rect, statics);\n\t\tangular.extend(Rect.prototype, methods);\n\n\t\treturn Rect;\n\n\t\t// static methods\n\n\t\tfunction RectMultiply(rect, value) {\n\t\t\trect.x *= value;\n\t\t\trect.y *= value;\n\t\t\trect.w *= value;\n\t\t\trect.h *= value;\n\t\t\treturn rect;\n\t\t}\n\n\t\t// prototype methods\n\n\t\tfunction bottom() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w / 2,\n\t\t\t\ty: y + h\n\t\t\t};\n\t\t}\n\n\t\tfunction bottomLeft() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x,\n\t\t\t\ty: y + h\n\t\t\t};\n\t\t}\n\n\t\tfunction bottomRight() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w,\n\t\t\t\ty: y + h\n\t\t\t};\n\t\t}\n\n\t\tfunction center() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w / 2,\n\t\t\t\ty: y + h / 2\n\t\t\t};\n\t\t}\n\n\t\tfunction clone() {\n\t\t\treturn new Rect(this.x, this.y, this.w, this.h);\n\t\t}\n\n\t\tfunction copy(rect) {\n\t\t\tthis.x = rect.x;\n\t\t\tthis.y = rect.y;\n\t\t\tthis.w = rect.w;\n\t\t\tthis.h = rect.h;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction expand(size) {\n\t\t\treturn this.expandRect({\n\t\t\t\tx: size,\n\t\t\t\ty: size,\n\t\t\t\tw: size * 2,\n\t\t\t\th: size * 2\n\t\t\t});\n\t\t}\n\n\t\tfunction expandRect(rect) {\n\t\t\tthis.x -= rect.x || 0;\n\t\t\tthis.y -= rect.y || 0;\n\t\t\tthis.w += rect.w || 0;\n\t\t\tthis.h += rect.h || 0;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction intersect(rect) {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn !(rect.x > x + w || rect.x + rect.w < x || rect.y > y + h || rect.y + rect.h < y);\n\t\t}\n\n\t\tfunction left() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x,\n\t\t\t\ty: y + h / 2\n\t\t\t};\n\t\t}\n\n\t\tfunction mult(value) {\n\t\t\treturn RectMultiply(this, value);\n\t\t}\n\n\t\tfunction offset(x, y) {\n\t\t\tthis.x += x;\n\t\t\tthis.y += y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction reduce(size) {\n\t\t\treturn this.offset(-size);\n\t\t}\n\n\t\tfunction reduceRect(rect) {\n\t\t\treturn this.offsetRect(RectMultiply(rect, -1));\n\t\t}\n\n\t\tfunction right() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w,\n\t\t\t\ty: y + h / 2\n\t\t\t};\n\t\t}\n\n\t\tfunction setH(h) {\n\t\t\tthis.h = h;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setPos(x, y) {\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setSize(w, h) {\n\t\t\tthis.w = w;\n\t\t\tthis.h = h;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setX(x) {\n\t\t\tthis.x = x;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setY(y) {\n\t\t\tthis.y = y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setW(w) {\n\t\t\tthis.w = w;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction top() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w / 2,\n\t\t\t\ty: y\n\t\t\t};\n\t\t}\n\n\t\tfunction topLeft() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x,\n\t\t\t\ty: y\n\t\t\t};\n\t\t}\n\n\t\tfunction topRight() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w,\n\t\t\t\ty: y\n\t\t\t};\n\t\t}\n\n\t\tfunction toString() {\n\t\t\treturn '{' + this.x + ',' + this.y + ',' + this.w + ',' + this.h + '}';\n\t\t}\n\n    }]);\n\n}());\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Vector', function () {\n\t\tfunction Vector(x, y) {\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\t\t}\n\n\t\tvar statics = {\n\t\t\tcross: VectorCross,\n\t\t\tdifference: VectorDifference,\n\t\t\tdistance: VectorDistance,\n\t\t\tincidence: VectorIncidence,\n\t\t\tmake: VectorMake,\n\t\t\tnormalize: VectorNormalize,\n\t\t\tpower: VectorPower,\n\t\t\tsize: VectorSize,\n\t\t};\n\n\t\tvar methods = {\n\t\t\tadd: add,\n\t\t\tcopy: copy,\n\t\t\tcross: cross,\n\t\t\tdifference: difference,\n\t\t\tdistance: distance,\n\t\t\tfriction: friction,\n\t\t\tincidence: incidence,\n\t\t\tnormalize: normalize,\n\t\t\tpower: power,\n\t\t\tsize: size,\n\t\t\ttowards: towards,\n\t\t\ttoString: toString,\n\t\t};\n\n\t\tangular.extend(Vector, statics);\n\t\tangular.extend(Vector.prototype, methods);\n\n\t\treturn Vector;\n\n\t\t// statics methods\n\n\t\tfunction VectorCross(a, b) {\n\t\t\treturn (a.x * b.y) - (a.y * b.x);\n\t\t}\n\n\t\tfunction VectorDifference(a, b) {\n\t\t\treturn new Vector(a.x - b.x, a.y - b.y);\n\t\t}\n\n\t\tfunction VectorDistance(a, b) {\n\t\t\treturn Math.sqrt((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));\n\t\t}\n\n\t\tfunction VectorIncidence(a, b) {\n\t\t\tvar angle = Math.atan2(b.y, b.x) - Math.atan2(a.y, a.x);\n\t\t\treturn angle;\n\t\t}\n\n\t\tfunction VectorMake(a, b) {\n\t\t\treturn new Vector(b.x - a.x, b.y - a.y);\n\t\t}\n\n\t\tfunction VectorNormalize(a) {\n\t\t\tvar l = Vector.size(a);\n\t\t\ta.x /= l;\n\t\t\ta.y /= l;\n\t\t\treturn a;\n\t\t}\n\n\t\tfunction VectorPower(a, b) {\n\t\t\tvar x = Math.abs(b.x - a.x);\n\t\t\tvar y = Math.abs(b.y - a.y);\n\t\t\treturn (x + y) / 2;\n\t\t}\n\n\t\tfunction VectorSize(a) {\n\t\t\treturn Math.sqrt(a.x * a.x + a.y * a.y);\n\t\t}\n\n\t\t// prototype methods\n\n\t\tfunction add(b) {\n\t\t\tthis.x += b.x;\n\t\t\tthis.y += b.y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction copy(b) {\n\t\t\treturn new Vector(this.x, this.y);\n\t\t}\n\n\t\tfunction cross(b) {\n\t\t\treturn VectorCross(this, b);\n\t\t}\n\n\t\tfunction difference(b) {\n\t\t\treturn VectorDifference(this, b);\n\t\t}\n\n\t\tfunction distance(b) {\n\t\t\treturn VectorDistance(this, b);\n\t\t}\n\n\t\tfunction friction(b) {\n\t\t\tthis.x *= b;\n\t\t\tthis.y *= b;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction incidence(b) {\n\t\t\treturn VectorIncidence(this, b);\n\t\t}\n\n\t\tfunction normalize() {\n\t\t\treturn VectorNormalize(this);\n\t\t}\n\n\t\tfunction power() {\n\t\t\treturn (Math.abs(this.x) + Math.abs(this.y)) / 2;\n\t\t}\n\n\t\tfunction size() {\n\t\t\treturn VectorSize(this);\n\t\t}\n\n\t\tfunction towards(b, friction) {\n\t\t\tfriction = friction || 0.125;\n\t\t\tthis.x += (b.x - this.x) * friction;\n\t\t\tthis.y += (b.y - this.y) * friction;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction toString() {\n\t\t\treturn '{' + this.x + ',' + this.y + '}';\n\t\t}\n\n\t});\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Hash', [function () {\n\n\t\tfunction Hash(key, pool) {\n\t\t\tkey = key || 'id';\n\t\t\tpool = pool ? HashGet(pool) : {};\n\t\t\tObject.defineProperties(this, {\n\t\t\t\tkey: {\n\t\t\t\t\tvalue: key,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\twritable: false\n\t\t\t\t},\n\t\t\t\tpool: {\n\t\t\t\t\tvalue: pool,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\twritable: false\n\t\t\t\t},\n\t\t\t\tlength: {\n\t\t\t\t\tvalue: 0,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\twritable: true\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tvar pools = {};\n\n\t\tvar statics = {\n\t\t\tget: HashGet,\n\t\t};\n\n\t\tvar methods = {\n\t\t\thas: has,\n\t\t\tgetId: getId,\n\t\t\tget: get,\n\t\t\tset: set,\n\t\t\tadd: add,\n\t\t\tremove: remove,\n\t\t\teach: each,\n\t\t\taddMany: addMany,\n\t\t\tremoveMany: removeMany,\n\t\t\tremoveAll: removeAll,\n\t\t\tforward: forward,\n\t\t\tbackward: backward,\n\t\t\tdiffers: differs,\n\t\t\tupdatePool: updatePool,\n\t\t};\n\n\t\tHash.prototype = new Array;\n\n\t\tangular.extend(Hash, statics);\n\t\tangular.extend(Hash.prototype, methods);\n\n\t\treturn Hash;\n\n\t\t// static methods\n\n\t\tfunction HashGet(pool) {\n\t\t\treturn (pools[pool] = pools[pool] || {});\n\t\t}\n\n\t\tfunction has(id) {\n\t\t\treturn this.pool[id] !== undefined;\n\t\t}\n\n\t\tfunction getId(id) {\n\t\t\treturn this.pool[id];\n\t\t}\n\n\t\tfunction get(item) {\n\t\t\tvar hash = this,\n\t\t\t\tkey = this.key;\n\t\t\treturn item ? hash.getId(item[key]) : null;\n\t\t}\n\n\t\tfunction set(item) {\n\t\t\tvar hash = this,\n\t\t\t\tpool = this.pool,\n\t\t\t\tkey = this.key;\n\t\t\tpool[item[key]] = item;\n\t\t\thash.push(item);\n\t\t\treturn item;\n\t\t}\n\n\t\tfunction add(newItem) {\n\t\t\tvar hash = this;\n\t\t\tvar item = hash.get(newItem);\n\t\t\tif (item) {\n\t\t\t\tfor (var i = 0, keys = Object.keys(newItem), p; i < keys.length; i++) {\n\t\t\t\t\tp = keys[i];\n\t\t\t\t\titem[p] = newItem[p];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\titem = hash.set(newItem);\n\t\t\t}\n\t\t\treturn item;\n\t\t}\n\n\t\tfunction remove(oldItem) {\n\t\t\tvar hash = this,\n\t\t\t\tpool = this.pool,\n\t\t\t\tkey = this.key;\n\t\t\tvar item = hash.get(oldItem);\n\t\t\tif (item) {\n\t\t\t\tvar index = hash.indexOf(item);\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\thash.splice(index, 1);\n\t\t\t\t}\n\t\t\t\tdelete pool[item[key]];\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction addMany(items) {\n\t\t\tvar hash = this;\n\t\t\tif (!items) {\n\t\t\t\treturn hash;\n\t\t\t}\n\t\t\tvar i = 0;\n\t\t\twhile (i < items.length) {\n\t\t\t\thash.add(items[i]);\n\t\t\t\ti++;\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction removeMany(items) {\n\t\t\tvar hash = this;\n\t\t\tif (!items) {\n\t\t\t\treturn hash;\n\t\t\t}\n\t\t\tvar i = 0;\n\t\t\twhile (i < items.length) {\n\t\t\t\thash.remove(items[i]);\n\t\t\t\ti++;\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction removeAll() {\n\t\t\tvar hash = this,\n\t\t\t\tkey = hash.key,\n\t\t\t\tpool = hash.pool;\n\t\t\tvar i = 0,\n\t\t\t\tt = hash.length,\n\t\t\t\titem;\n\t\t\twhile (hash.length) {\n\t\t\t\titem = hash.shift();\n\t\t\t\tdelete pool[item[key]];\n\t\t\t\ti++;\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction each(callback) {\n\t\t\tvar hash = this;\n\t\t\tif (callback) {\n\t\t\t\tvar i = 0;\n\t\t\t\twhile (i < hash.length) {\n\t\t\t\t\tcallback(hash[i], i);\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction forward(key, reverse) {\n\t\t\tvar hash = this;\n\t\t\tkey = (key || this.key);\n\t\t\thash.sort(function (c, d) {\n\t\t\t\tvar a = reverse ? d : c;\n\t\t\t\tvar b = reverse ? c : d;\n\t\t\t\treturn a[key] - b[key];\n\t\t\t});\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction backward(key) {\n\t\t\treturn this.forward(key, true);\n\t\t}\n\n\t\tfunction differs(hash) {\n\t\t\tif (hash.key !== this.key || hash.length !== this.length) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tvar differs = false,\n\t\t\t\t\ti = 0,\n\t\t\t\t\tt = this.length,\n\t\t\t\t\tkey = this.key;\n\t\t\t\twhile (differs && i < t) {\n\t\t\t\t\tdiffers = this[i][key] !== hash[i][key];\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction updatePool() {\n\t\t\tvar hash = this,\n\t\t\t\tpool = this.pool,\n\t\t\t\tkey = this.key;\n\t\t\tObject.keys(pool).forEach(function (key) {\n\t\t\t\tdelete pool[key];\n\t\t\t});\n\t\t\tangular.forEach(hash, function (item) {\n\t\t\t\tpool[item[key]] = item;\n\t\t\t});\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('$promise', ['$q', function ($q) {\n\n\t\tfunction $promise(callback) {\n\t\t\tif (typeof callback !== 'function') {\n\t\t\t\tthrow ('promise resolve callback missing');\n\t\t\t}\n\t\t\tvar deferred = $q.defer();\n\t\t\tcallback(deferred);\n\t\t\treturn deferred.promise;\n\t\t}\n\n\t\tvar statics = {\n\t\t\tall: $promiseAll,\n\t\t};\n\n\t\tvar methods = {};\n\n\t\tangular.extend($promise, statics);\n\t\tangular.extend($promise.prototype, methods);\n\n\t\treturn $promise;\n\n\t\tfunction $promiseAll(promises) {\n\t\t\treturn $q.all(promises);\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('State', ['$timeout', function ($timeout) {\n\n\t\tfunction State() {\n\t\t\tthis.errors = [];\n\t\t\tthis.isReady = false;\n\t\t\tthis.idle();\n\t\t}\n\n\t\tvar DELAY = 2000;\n\n\t\tvar statics = {};\n\n\t\tvar methods = {\n\t\t\tbusy: busy,\n\t\t\tclasses: classes,\n\t\t\tenabled: enabled,\n\t\t\terror: error,\n\t\t\terrorMessage: errorMessage,\n\t\t\tidle: idle,\n\t\t\tlabels: labels,\n\t\t\tready: ready,\n\t\t\tsubmitClass: submitClass,\n\t\t\tsuccess: success,\n\t\t};\n\n\t\tangular.extend(State, statics);\n\t\tangular.extend(State.prototype, methods);\n\n\t\treturn State;\n\n\t\t// static methods\n\n\t\t// prototype methods\n\n\t\tfunction busy() {\n\t\t\tvar state = this;\n\t\t\tif (!state.isBusy) {\n\t\t\t\tstate.isBusy = true;\n\t\t\t\tstate.isError = false;\n\t\t\t\tstate.isErroring = false;\n\t\t\t\tstate.isSuccess = false;\n\t\t\t\tstate.isSuccessing = false;\n\t\t\t\tstate.errors = [];\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfunction classes(addons) {\n\t\t\tvar state = this,\n\t\t\t\tclasses = null;\n\t\t\tclasses = {\n\t\t\t\tready: state.isReady,\n\t\t\t\tbusy: state.isBusy,\n\t\t\t\tsuccessing: state.isSuccessing,\n\t\t\t\tsuccess: state.isSuccess,\n\t\t\t\terrorring: state.isErroring,\n\t\t\t\terror: state.isError,\n\t\t\t};\n\t\t\tif (addons) {\n\t\t\t\tangular.forEach(addons, function (value, key) {\n\t\t\t\t\tclasses[value] = classes[key];\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn classes;\n\t\t}\n\n\t\tfunction enabled() {\n\t\t\tvar state = this;\n\t\t\treturn !state.isBusy && !state.isErroring && !state.isSuccessing;\n\t\t}\n\n\t\tfunction error(error) {\n\t\t\tconsole.log('State.error', error);\n\t\t\tvar state = this;\n\t\t\tstate.isBusy = false;\n\t\t\tstate.isError = true;\n\t\t\tstate.isErroring = true;\n\t\t\tstate.isSuccess = false;\n\t\t\tstate.isSuccessing = false;\n\t\t\tstate.errors.push(error);\n\t\t\t$timeout(function () {\n\t\t\t\tstate.isErroring = false;\n\t\t\t}, DELAY);\n\t\t}\n\n\t\tfunction errorMessage() {\n\t\t\tvar state = this;\n\t\t\treturn state.isError ? state.errors[state.errors.length - 1] : null;\n\t\t}\n\n\t\tfunction idle() {\n\t\t\tvar state = this;\n\t\t\tstate.isBusy = false;\n\t\t\tstate.isError = false;\n\t\t\tstate.isErroring = false;\n\t\t\tstate.isSuccess = false;\n\t\t\tstate.isSuccessing = false;\n\t\t\tstate.button = null;\n\t\t\tstate.errors = [];\n\t\t}\n\n\t\tfunction labels(addons) {\n\t\t\tvar state = this;\n\t\t\tvar defaults = {\n\t\t\t\tready: 'submit',\n\t\t\t\tbusy: 'sending',\n\t\t\t\terror: 'error',\n\t\t\t\tsuccess: 'success',\n\t\t\t};\n\t\t\tif (addons) {\n\t\t\t\tangular.extend(defaults, addons);\n\t\t\t}\n\t\t\tvar label = defaults.ready;\n\t\t\tif (state.isBusy) {\n\t\t\t\tlabel = defaults.busy;\n\t\t\t} else if (state.isSuccess) {\n\t\t\t\tlabel = defaults.success;\n\t\t\t} else if (state.isError) {\n\t\t\t\tlabel = defaults.error;\n\t\t\t}\n\t\t\treturn label;\n\t\t}\n\n\t\tfunction ready() {\n\t\t\tvar state = this;\n\t\t\tstate.idle();\n\t\t\tstate.isReady = true;\n\t\t}\n\n\t\tfunction submitClass() {\n\t\t\tvar state = this;\n\t\t\treturn {\n\t\t\t\tbusy: state.isBusy,\n\t\t\t\tready: state.isReady,\n\t\t\t\tsuccessing: state.isSuccessing,\n\t\t\t\tsuccess: state.isSuccess,\n\t\t\t\terrorring: state.isErroring,\n\t\t\t\terror: state.isError,\n\t\t\t};\n\t\t}\n\n\t\tfunction success() {\n\t\t\tvar state = this;\n\t\t\tstate.isBusy = false;\n\t\t\tstate.isError = false;\n\t\t\tstate.isErroring = false;\n\t\t\tstate.isSuccess = true;\n\t\t\tstate.isSuccessing = true;\n\t\t\tstate.errors = [];\n\t\t\t$timeout(function () {\n\t\t\t\tstate.isSuccessing = false;\n\t\t\t}, DELAY);\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar transformProperty = detectTransformProperty();\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Style', [function () {\n\n\t\tfunction Style() {\n\t\t\tthis.props = {\n\t\t\t\tscale: 1,\n\t\t\t\thoverScale: 1,\n\t\t\t\tcurrentScale: 1,\n\t\t\t};\n\t\t}\n\n\t\tvar statics = {};\n\n\t\tvar methods = {\n\t\t\tset: set,\n\t\t\ttransform: transform,\n\t\t\ttransformOrigin: transformOrigin,\n\t\t};\n\n\t\tangular.extend(Style, statics);\n\t\tangular.extend(Style.prototype, methods);\n\n\t\treturn Style;\n\n\t\t// static methods\n\n\t\t// prototype methods\n\n\t\tfunction set(element) {\n\t\t\tvar styles = [];\n\t\t\tfor (var key in this) {\n\t\t\t\tif (key !== 'props') {\n\t\t\t\t\tstyles.push(key + ':' + this[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telement.style.cssText = styles.join(';') + ';';\n\t\t}\n\n\t\tfunction transform(transform) {\n\t\t\tthis[transformProperty] = transform;\n\t\t}\n\n\t\tfunction transformOrigin(x, y) {\n\t\t\tthis[transformProperty + '-origin-x'] = (Math.round(x * 1000) / 1000) + '%';\n\t\t\tthis[transformProperty + '-origin-y'] = (Math.round(y * 1000) / 1000) + '%';\n\t\t}\n\n    }]);\n\n\tfunction detectTransformProperty() {\n\t\tvar transformProperty = 'transform',\n\t\t\tsafariPropertyHack = 'webkitTransform';\n\t\tvar div = document.createElement(\"DIV\");\n\t\tif (typeof div.style[transformProperty] !== 'undefined') {\n            ['webkit', 'moz', 'o', 'ms'].every(function (prefix) {\n\t\t\t\tvar e = '-' + prefix + '-transform';\n\t\t\t\tif (typeof div.style[e] !== 'undefined') {\n\t\t\t\t\ttransformProperty = e;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t} else if (typeof div.style[safariPropertyHack] !== 'undefined') {\n\t\t\ttransformProperty = '-webkit-transform';\n\t\t} else {\n\t\t\ttransformProperty = undefined;\n\t\t}\n\t\treturn transformProperty;\n\t}\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.service('Utils', ['$compile', '$controller', 'Vector', function ($compile, $controller, Vector) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\tcompileController: compileController,\n\t\t\tformat: format,\n\t\t\tindexOf: indexOf,\n\t\t\treducer: reducer,\n\t\t\treducerAdder: reducerAdder,\n\t\t\treducerSetter: reducerSetter,\n\t\t\tremoveValue: removeValue,\n\t\t\treverseSortOn: reverseSortOn,\n\t\t\tthrottle: throttle,\n\t\t\ttoMd5: toMd5,\n\t\t\twhere: where,\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\tvar getNow = Date.now || function () {\n\t\t\treturn new Date().getTime();\n\t\t};\n\n\t\tfunction compileController(scope, element, html, data) {\n\t\t\t// console.log('Utils.compileController', element);\n\t\t\telement.html(html);\n\t\t\tvar link = $compile(element.contents());\n\t\t\tif (data.controller) {\n\t\t\t\tvar $scope = scope.$new();\n\t\t\t\tangular.extend($scope, data);\n\t\t\t\tvar controller = $controller(data.controller, {\n\t\t\t\t\t$scope: $scope\n\t\t\t\t});\n\t\t\t\tif (data.controllerAs) {\n\t\t\t\t\tscope[data.controllerAs] = controller;\n\t\t\t\t}\n\t\t\t\telement.data('$ngControllerController', controller);\n\t\t\t\telement.children().data('$ngControllerController', controller);\n\t\t\t\tscope = $scope;\n\t\t\t}\n\t\t\tlink(scope);\n\t\t}\n\n\t\tfunction format(string, prepend, expression) {\n\t\t\tstring = string || '';\n\t\t\tprepend = prepend || '';\n\t\t\tvar splitted = string.split(',');\n\t\t\tif (splitted.length > 1) {\n\t\t\t\tvar formatted = splitted.shift();\n\t\t\t\tangular.forEach(splitted, function (value, index) {\n\t\t\t\t\tif (expression) {\n\t\t\t\t\t\tformatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tformatted = formatted.split('{' + index + '}').join(prepend + value);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (expression) {\n\t\t\t\t\treturn '\\'' + formatted + '\\'';\n\t\t\t\t} else {\n\t\t\t\t\treturn formatted;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn prepend + string;\n\t\t\t}\n\t\t}\n\n\t\tfunction indexOf(array, object, key) {\n\t\t\tkey = key || 'id';\n\t\t\tvar index = -1;\n\t\t\tif (array) {\n\t\t\t\tvar i = 0,\n\t\t\t\t\tt = array.length;\n\t\t\t\twhile (i < t) {\n\t\t\t\t\tif (array[i] && array[i][key] === object[key]) {\n\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn index;\n\t\t}\n\n\t\tfunction reducer(o, key) {\n\t\t\treturn o[key];\n\t\t}\n\n\t\tfunction reducerAdder(o, key, value) {\n\t\t\tif (typeof key == 'string') {\n\t\t\t\treturn reducerAdder(o, key.split('.'), value);\n\t\t\t} else if (key.length == 1 && value !== undefined) {\n\t\t\t\treturn (o[key[0]] += value);\n\t\t\t} else if (key.length === 0) {\n\t\t\t\treturn o;\n\t\t\t} else {\n\t\t\t\treturn reducerAdder(o[key[0]], key.slice(1), value);\n\t\t\t}\n\t\t}\n\n\t\tfunction reducerSetter(o, key, value) {\n\t\t\tif (typeof key == 'string') {\n\t\t\t\treturn reducerSetter(o, key.split('.'), value);\n\t\t\t} else if (key.length == 1 && value !== undefined) {\n\t\t\t\treturn (o[key[0]] = value);\n\t\t\t} else if (key.length === 0) {\n\t\t\t\treturn o;\n\t\t\t} else {\n\t\t\t\treturn reducerSetter(o[key[0]], key.slice(1), value);\n\t\t\t}\n\t\t}\n\n\t\tfunction removeValue(array, value) {\n\t\t\tvar index = -1;\n\t\t\tif (array) {\n\t\t\t\tvar i = 0,\n\t\t\t\t\tt = array.length;\n\t\t\t\twhile (i < t) {\n\t\t\t\t\tif (array[i] === value) {\n\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (index !== -1) {\n\t\t\t\tarray.splice(index, 1);\n\t\t\t\treturn value;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\tfunction reverseSortOn(key) {\n\t\t\treturn function (a, b) {\n\t\t\t\tif (a[key] < b[key]) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\tif (a[key] > b[key]) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\t// a must be equal to b\n\t\t\t\treturn 0;\n\t\t\t};\n\t\t}\n\n\t\tfunction throttle(func, wait, options) {\n\t\t\t// Returns a function, that, when invoked, will only be triggered at most once\n\t\t\t// during a given window of time. Normally, the throttled function will run\n\t\t\t// as much as it can, without ever going more than once per `wait` duration;\n\t\t\t// but if you'd like to disable the execution on the leading edge, pass\n\t\t\t// `{leading: false}`. To disable execution on the trailing edge, ditto.\n\t\t\tvar context, args, result;\n\t\t\tvar timeout = null;\n\t\t\tvar previous = 0;\n\t\t\tif (!options) options = {};\n\t\t\tvar later = function () {\n\t\t\t\tprevious = options.leading === false ? 0 : getNow();\n\t\t\t\ttimeout = null;\n\t\t\t\tresult = func.apply(context, args);\n\t\t\t\tif (!timeout) context = args = null;\n\t\t\t};\n\t\t\treturn function () {\n\t\t\t\tvar now = getNow();\n\t\t\t\tif (!previous && options.leading === false) previous = now;\n\t\t\t\tvar remaining = wait - (now - previous);\n\t\t\t\tcontext = this;\n\t\t\t\targs = arguments;\n\t\t\t\tif (remaining <= 0 || remaining > wait) {\n\t\t\t\t\tif (timeout) {\n\t\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\t\ttimeout = null;\n\t\t\t\t\t}\n\t\t\t\t\tprevious = now;\n\t\t\t\t\tresult = func.apply(context, args);\n\t\t\t\t\tif (!timeout) context = args = null;\n\t\t\t\t} else if (!timeout && options.trailing !== false) {\n\t\t\t\t\ttimeout = setTimeout(later, remaining);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t};\n\t\t}\n\n\t\tfunction toMd5(string) {\n\t\t\t// return Md5.encode(string);\n\t\t}\n\n\t\tfunction where(array, query) {\n\t\t\tvar found = null;\n\t\t\tif (array) {\n\t\t\t\tangular.forEach(array, function (item) {\n\t\t\t\t\tvar has = true;\n\t\t\t\t\tangular.forEach(query, function (value, key) {\n\t\t\t\t\t\thas = has && item[key] === value;\n\t\t\t\t\t});\n\t\t\t\t\tif (has) {\n\t\t\t\t\t\tfound = item;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn found;\n\t\t}\n\n    }]);\n\n\t(function () {\n\t\t// POLYFILL Array.prototype.reduce\n\t\t// Production steps of ECMA-262, Edition 5, 15.4.4.21\n\t\t// Reference: http://es5.github.io/#x15.4.4.21\n\t\t// https://tc39.github.io/ecma262/#sec-array.prototype.reduce\n\t\tif (!Array.prototype.reduce) {\n\t\t\tObject.defineProperty(Array.prototype, 'reduce', {\n\t\t\t\tvalue: function (callback) { // , initialvalue\n\t\t\t\t\tif (this === null) {\n\t\t\t\t\t\tthrow new TypeError('Array.prototype.reduce called on null or undefined');\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof callback !== 'function') {\n\t\t\t\t\t\tthrow new TypeError(callback + ' is not a function');\n\t\t\t\t\t}\n\t\t\t\t\tvar o = Object(this);\n\t\t\t\t\tvar len = o.length >>> 0;\n\t\t\t\t\tvar k = 0;\n\t\t\t\t\tvar value;\n\t\t\t\t\tif (arguments.length == 2) {\n\t\t\t\t\t\tvalue = arguments[1];\n\t\t\t\t\t} else {\n\t\t\t\t\t\twhile (k < len && !(k in o)) {\n\t\t\t\t\t\t\tk++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (k >= len) {\n\t\t\t\t\t\t\tthrow new TypeError('Reduce of empty array with no initial value');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvalue = o[k++];\n\t\t\t\t\t}\n\t\t\t\t\twhile (k < len) {\n\t\t\t\t\t\tif (k in o) {\n\t\t\t\t\t\t\tvalue = callback(value, o[k], k, o);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tk++;\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}());\n\n}());\n/* global angular */\r\n\r\n(function () {\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.factory('Doc', ['Api', '$promise', function (Api, $promise) {\r\n\r\n\t\tfunction Doc(item) {\r\n\t\t\tif (item) {\r\n\t\t\t\tangular.extend(this, item);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar statics = {};\r\n\r\n\t\tvar methods = {};\r\n\r\n\t\tangular.extend(Doc, statics);\r\n\t\tangular.extend(Doc.prototype, methods);\r\n\r\n\t\treturn Doc;\r\n\r\n\t\t// static methods\r\n\r\n\t\t// prototype methods\r\n\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function () {\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.factory('View', ['Api', '$promise', '$location', '$routeParams', 'environment', 'Doc', function (Api, $promise, $location, $routeParams, environment, Doc) {\r\n\r\n\t\tfunction View(doc) {\r\n\t\t\tvar url = $location.path(),\r\n\t\t\t\tparams = $routeParams;\r\n\t\t\tvar view = {\r\n\t\t\t\tenvironment: environment,\r\n\t\t\t\troute: {\r\n\t\t\t\t\turl: url,\r\n\t\t\t\t\tparams: params,\r\n\t\t\t\t},\r\n\t\t\t\tdoc: doc,\r\n\t\t\t};\r\n\t\t\tangular.extend(this, view);\r\n\t\t}\r\n\r\n\t\tvar statics = {\r\n\t\t\tcurrent: ViewCurrent,\r\n\t\t};\r\n\r\n\t\tvar methods = {};\r\n\r\n\t\tangular.extend(View, statics);\r\n\t\tangular.extend(View.prototype, methods);\r\n\r\n\t\treturn View;\r\n\r\n\t\t// static methods\r\n\r\n\t\tfunction ViewCurrent() {\r\n\t\t\treturn $promise(function (promise) {\r\n\t\t\t\tvar url = $location.path();\r\n\t\t\t\tconsole.log('View.current', url);\r\n\t\t\t\tApi.docs.url(url).then(function (response) {\r\n\t\t\t\t\tvar doc = new Doc(response);\r\n\t\t\t\t\tvar view = new View(doc);\r\n\t\t\t\t\tpromise.resolve(view);\r\n\r\n\t\t\t\t}, function (error) {\r\n\t\t\t\t\tpromise.reject(error);\r\n\r\n\t\t\t\t});\r\n\t\t\t\t/*\r\n\t\t\t\tApi.navs.main().then(function(items) {\r\n\t\t\t\t    var doc = null,\r\n\t\t\t\t        url = $location.path(),\r\n\t\t\t\t        pool = getPool(items);\r\n\t\t\t\t    var item = pool[url];\r\n\t\t\t\t    if (item) {\r\n\t\t\t\t        doc = new Doc(item);\r\n\t\t\t\t    }\r\n\t\t\t\t    promise.resolve(doc);\r\n\r\n\t\t\t\t}, function(error) {\r\n\t\t\t\t    promise.reject(error);\r\n\r\n\t\t\t\t});\r\n\t\t\t\t*/\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfunction ViewPool(items) {\r\n\t\t\tvar pool = {};\r\n\r\n\t\t\tfunction _getPool(items) {\r\n\t\t\t\tif (items) {\r\n\t\t\t\t\tangular.forEach(items, function (item) {\r\n\t\t\t\t\t\tpool[item.url] = item;\r\n\t\t\t\t\t\t_getPool(item.items);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t_getPool(items);\r\n\t\t\treturn pool;\r\n\t\t}\r\n\r\n\t\t// prototype methods\r\n\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function () {\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.service('Http', ['$http', '$promise', '$timeout', 'environment', function ($http, $promise, $timeout, environment) {\r\n\r\n\t\t\tvar service = this;\r\n\r\n\t\t\tvar statics = {\r\n\t\t\t\tget: HttpGet,\r\n\t\t\t\tpost: HttpPost,\r\n\t\t\t\tput: HttpPut,\r\n\t\t\t\tpatch: HttpPatch,\r\n\t\t\t\t'delete': HttpDelete,\r\n\t\t\t\tfake: HttpFake,\r\n\t\t\t};\r\n\r\n\t\t\tangular.extend(service, statics);\r\n\r\n\t\t\t// statics methods\r\n\r\n\t\t\tfunction HttpPromise(method, url, data) {\r\n\t\t\t\treturn $promise(function (promise) {\r\n\t\t\t\t\t$http[method](environment.urls.api + url, data).then(function (response) {\r\n\t\t\t\t\t\tpromise.resolve(response.data);\r\n\r\n\t\t\t\t\t}, function (e, status) {\r\n\t\t\t\t\t\tvar error = (e && e.data) ? e.data : {};\r\n\t\t\t\t\t\terror.status = e.status;\r\n\t\t\t\t\t\tpromise.reject(error);\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tfunction HttpGet(url) {\r\n\t\t\t\treturn HttpPromise('get', url);\r\n\t\t\t}\r\n\r\n\t\t\tfunction HttpPost(url, data) {\r\n\t\t\t\treturn HttpPromise('post', url, data);\r\n\t\t\t}\r\n\r\n\t\t\tfunction HttpPut(url, data) {\r\n\t\t\t\treturn HttpPromise('put', url, data);\r\n\t\t\t}\r\n\r\n\t\t\tfunction HttpPatch(url, data) {\r\n\t\t\t\treturn HttpPromise('patch', url, data);\r\n\t\t\t}\r\n\r\n\t\t\tfunction HttpDelete(url) {\r\n\t\t\t\treturn HttpPromise('delete', url);\r\n\t\t\t}\r\n\r\n\t\t\tfunction HttpFake(data) {\r\n\t\t\t\tvar deferred = $q.defer();\r\n\t\t\t\t$timeout(function () {\r\n\t\t\t\t\tdeferred.resolve({\r\n\t\t\t\t\t\tdata: data\r\n\t\t\t\t\t});\r\n\t\t\t\t}, 1000);\r\n\t\t\t\treturn deferred.promise;\r\n\t\t\t}\r\n\r\n        }\r\n    ]);\r\n\r\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.service('Router', ['$location', '$timeout', function($location, $timeout) {\n\n        var service = this;\n        service.redirect = redirect;\n        service.path = path;\n        service.apply = apply;\n\n        function redirect(path, msecs) {\n            function doRedirect() {\n                $location.$$lastRequestedPath = $location.path();\n                $location.path(path);\n            }\n            if (msecs) {\n                $timeout(function() {\n                    doRedirect();\n                }, msecs);\n            } else {\n                doRedirect();\n            }\n        }\n\n        function path(path, msecs) {\n            function doRetry() {\n                path = $location.$$lastRequestedPath || path;\n                $location.$$lastRequestedPath = null;\n                $location.path(path);\n            }\n            if (msecs) {\n                $timeout(function() {\n                    doRetry();\n                }, msecs);\n            } else {\n                doRetry();\n            }\n        }\n\n        function apply(path, msecs) {\n            function doRetry() {\n                $location.path(path);\n            }\n            if (msecs) {\n                $timeout(function() {\n                    doRetry();\n                }, msecs);\n            } else {\n                $timeout(function() {\n                    doRetry();\n                });\n            }\n        }\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Silent', ['$rootScope', '$location', function ($rootScope, $location) {\n\n\t\tfunction Silent() {}\n\n\t\tvar statics = {\n\t\t\tsilent: SilentSilent,\n\t\t\tpath: SilentPath,\n\t\t};\n\n\t\tvar methods = {};\n\n\t\tangular.extend(Silent, statics);\n\t\tangular.extend(Silent.prototype, methods);\n\n\t\t$rootScope.$$listeners.$locationChangeSuccess.unshift(SilentListener);\n\t\t// console.log('$rootScope.$$listeners.$locationChangeSuccess', $rootScope.$$listeners.$locationChangeSuccess);\n\n\t\t// private vars\n\n\t\tvar $path;\n\n\t\treturn Silent;\n\n\t\t// static methods\n\n\t\tfunction SilentUnlink() {\n\t\t\tvar listeners = $rootScope.$$listeners.$locationChangeSuccess;\n\t\t\tangular.forEach(listeners, function (value, name) {\n\t\t\t\tif (value === listener) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfunction relink() {\n\t\t\t\t\tlisteners[name] = value;\n\t\t\t\t}\n\t\t\t\tlisteners[name] = relink; // temporary unlinking\n\t\t\t});\n\t\t}\n\n\t\tfunction SilentListener(e) {\n\t\t\t// console.log('onLocationChangeSuccess', e);\n\t\t\tif ($path === $location.path()) {\n\t\t\t\tSilentUnlink();\n\t\t\t}\n\t\t\t$path = null;\n\t\t}\n\n\t\tfunction SilentSilent(path, replace) {\n\t\t\t// this.prev = $location.path(); ???\n\t\t\tvar location = $location.url(path);\n\t\t\tif (replace) {\n\t\t\t\tlocation.replace();\n\t\t\t}\n\t\t\t$path = $location.path();\n\t\t}\n\n\t\tfunction SilentPath(path) {\n\t\t\treturn $location.path(path);\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tvar TIMEOUT = 5 * 60 * 1000; // five minutes\n\n\tapp.service('Cookie', ['$promise', '$window', function ($promise, $window) {\n\n\t\tvar service = {\n\t\t\tTIMEOUT: TIMEOUT,\n\t\t\tdelete: CookieDelete,\n\t\t\texist: CookieExists,\n\t\t\tget: CookieGet,\n\t\t\ton: CookieOn,\n\t\t\tset: CookieSet,\n\t\t};\n\n\t\tangular.extend(this, service);\n\n\t\tfunction CookieDelete(name) {\n\t\t\tCookieSetter(name, \"\", -1);\n\t\t}\n\n\t\tfunction CookieExists(name) {\n\t\t\treturn $window.document.cookie.indexOf(';' + name + '=') !== -1 || $window.document.cookie.indexOf(name + '=') === 0;\n\t\t}\n\n\t\tfunction CookieGet(name) {\n\t\t\tvar cookieName = name + \"=\";\n\t\t\tvar ca = $window.document.cookie.split(';');\n\t\t\tfor (var i = 0; i < ca.length; i++) {\n\t\t\t\tvar c = ca[i];\n\t\t\t\twhile (c.charAt(0) == ' ') {\n\t\t\t\t\tc = c.substring(1, c.length);\n\t\t\t\t}\n\t\t\t\tif (c.indexOf(cookieName) === 0) {\n\t\t\t\t\tvar value = c.substring(cookieName.length, c.length);\n\t\t\t\t\tvar model = null;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tmodel = JSON.parse(decodeURIComponent(atob(value)));\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tconsole.log('Cookie.get.error parsing', key, e);\n\t\t\t\t\t}\n\t\t\t\t\treturn model;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tfunction CookieOn(name) {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tvar i, interval = 1000,\n\t\t\t\t\telapsed = 0,\n\t\t\t\t\ttimeout = Cookie.TIMEOUT;\n\n\t\t\t\tfunction checkCookie() {\n\t\t\t\t\tif (elapsed > timeout) {\n\t\t\t\t\t\tpromise.reject('timeout');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar c = CookieGet(name);\n\t\t\t\t\t\tif (c) {\n\t\t\t\t\t\t\tpromise.resolve(c);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\telapsed += interval;\n\t\t\t\t\t\t\ti = setTimeout(checkCookie, interval);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcheckCookie();\n\t\t\t});\n\t\t}\n\n\t\tfunction CookieSet(name, value, days) {\n\t\t\ttry {\n\t\t\t\tvar cache = [];\n\t\t\t\tvar json = JSON.stringify(value, function (key, value) {\n\t\t\t\t\tif (key === 'pool') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t\t// Circular reference found, discard key\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcache.push(value);\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t\tcache = null;\n\t\t\t\tCookieSetter(name, btoa(encodeURIComponent(json)), days);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('CookieSet.error serializing', name, value, e);\n\t\t\t}\n\t\t}\n\n\t\tfunction CookieSetter(name, value, days) {\n\t\t\tvar expires;\n\t\t\tif (days) {\n\t\t\t\tvar date = new Date();\n\t\t\t\tdate.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n\t\t\t\texpires = '; expires=' + date.toGMTString();\n\t\t\t} else {\n\t\t\t\texpires = '';\n\t\t\t}\n\t\t\t$window.document.cookie = name + '=' + value + expires + '; path=/';\n\t\t}\n\n    }]);\n\n\tapp.service('LocalStorage', ['$promise', '$window', 'Cookie', function ($promise, $window, Cookie) {\n\n\t\tvar service = {\n\t\t\tTIMEOUT: TIMEOUT,\n\t\t\tdelete: LocalDelete,\n\t\t\texist: LocalExists,\n\t\t\tget: LocalGet,\n\t\t\ton: LocalOn,\n\t\t\tset: LocalSet,\n\t\t};\n\n\t\tvar supported = LocalSupported();\n\n\t\tif (supported) {\n\t\t\tangular.extend(this, service);\n\t\t} else {\n\t\t\tangular.extend(this, Cookie);\n\t\t}\n\n\t\tthis.supported = supported;\n\n\t\tfunction LocalSupported() {\n\t\t\tvar supported = false;\n\t\t\ttry {\n\t\t\t\tsupported = 'localStorage' in $window && $window.localStorage !== null;\n\t\t\t\tif (supported) {\n\t\t\t\t\t$window.localStorage.setItem('test', '1');\n\t\t\t\t\t$window.localStorage.removeItem('test');\n\t\t\t\t} else {\n\t\t\t\t\tsupported = false;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tsupported = false;\n\t\t\t}\n\t\t\treturn supported;\n\t\t}\n\n\t\tfunction LocalExists(name) {\n\t\t\treturn $window.localStorage[name] !== undefined;\n\t\t}\n\n\t\tfunction LocalGet(name) {\n\t\t\tvar value = null;\n\t\t\tif ($window.localStorage[name] !== undefined) {\n\t\t\t\ttry {\n\t\t\t\t\tvalue = JSON.parse($window.localStorage[name]);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log('LocalStorage.get.error parsing', name, e);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn value;\n\t\t}\n\n\t\tfunction LocalSet(name, value) {\n\t\t\ttry {\n\t\t\t\tvar cache = [];\n\t\t\t\tvar json = JSON.stringify(value, function (key, value) {\n\t\t\t\t\tif (key === 'pool') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t\t// Circular reference found, discard key\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcache.push(value);\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t\tcache = null;\n\t\t\t\t$window.localStorage.setItem(name, json);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('LocalStorage.set.error serializing', name, value, e);\n\t\t\t}\n\t\t}\n\n\t\tfunction LocalDelete(name) {\n\t\t\t$window.localStorage.removeItem(name);\n\t\t}\n\n\t\tfunction LocalOn(name) {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tvar i, timeout = Cookie.TIMEOUT;\n\n\t\t\t\tfunction storageEvent(e) {\n\t\t\t\t\t// console.log('LocalStorage.on', name, e);\n\t\t\t\t\tif (i) {\n\t\t\t\t\t\tclearTimeout(i);\n\t\t\t\t\t}\n\t\t\t\t\tif (e.originalEvent.key == name) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvar value = JSON.parse(e.originalEvent.newValue); // , e.originalEvent.oldValue\n\t\t\t\t\t\t\tpromise.resolve(value);\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tconsole.log('LocalStorage.on.error parsing', name, error);\n\t\t\t\t\t\t\tpromise.reject('error parsing ' + name);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tangular.element($window).on('storage', storageEvent);\n\t\t\t\ti = setTimeout(function () {\n\t\t\t\t\tpromise.reject('timeout');\n\t\t\t\t}, timeout);\n\t\t\t});\n\t\t}\n\n    }]);\n\n\tapp.factory('SessionStorage', ['$promise', '$window', 'Cookie', function ($promise, $window, Cookie) {\n\n\t\tvar service = {\n\t\t\tTIMEOUT: TIMEOUT,\n\t\t\tdelete: LocalDelete,\n\t\t\texist: LocalExists,\n\t\t\tget: LocalGet,\n\t\t\ton: LocalOn,\n\t\t\tset: LocalSet,\n\t\t};\n\n\t\tvar supported = SessionSupported();\n\n\t\tif (supported) {\n\t\t\tangular.extend(this, service);\n\t\t} else {\n\t\t\tangular.extend(this, Cookie);\n\t\t}\n\n\t\tthis.supported = supported;\n\n\t\tfunction SessionSupported() {\n\t\t\tvar supported = false;\n\t\t\ttry {\n\t\t\t\tsupported = 'sessionStorage' in $window && $window.sessionStorage !== undefined;\n\t\t\t\tif (supported) {\n\t\t\t\t\t$window.sessionStorage.setItem('test', '1');\n\t\t\t\t\t$window.sessionStorage.removeItem('test');\n\t\t\t\t} else {\n\t\t\t\t\tsupported = false;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tsupported = false;\n\t\t\t}\n\t\t\treturn supported;\n\t\t}\n\n\t\tfunction SessionExists(name) {\n\t\t\treturn $window.sessionStorage[name] !== undefined;\n\t\t}\n\n\t\tfunction SessionGet(name) {\n\t\t\tvar value = null;\n\t\t\tif ($window.sessionStorage[name] !== undefined) {\n\t\t\t\ttry {\n\t\t\t\t\tvalue = JSON.parse($window.sessionStorage[name]);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log('SessionStorage.get.error parsing', name, e);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn value;\n\t\t}\n\n\t\tfunction SessionSet(name, value) {\n\t\t\ttry {\n\t\t\t\tvar cache = [];\n\t\t\t\tvar json = JSON.stringify(value, function (key, value) {\n\t\t\t\t\tif (key === 'pool') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t\t// Circular reference found, discard key\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcache.push(value);\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t\tcache = null;\n\t\t\t\t$window.sessionStorage.setItem(name, json);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('SessionStorage.set.error serializing', name, value, e);\n\t\t\t}\n\t\t}\n\n\t\tfunction SessionDelete(name) {\n\t\t\t$window.sessionStorage.removeItem(name);\n\t\t}\n\n\t\tfunction SessionOn(name) {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tvar i, timeout = Cookie.TIMEOUT;\n\n\t\t\t\tfunction storageEvent(e) {\n\t\t\t\t\t// console.log('SessionStorage.on', name, e);\n\t\t\t\t\tif (i) {\n\t\t\t\t\t\tclearTimeout(i);\n\t\t\t\t\t}\n\t\t\t\t\tif (e.originalEvent.key === name) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvar value = JSON.parse(e.originalEvent.newValue); // , e.originalEvent.oldValue\n\t\t\t\t\t\t\tpromise.resolve(value);\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tconsole.log('SessionStorage.on.error parsing', name, error);\n\t\t\t\t\t\t\tpromise.reject('error parsing ' + name);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tangular.element($window).on('storage', storageEvent);\n\t\t\t\ti = setTimeout(function () {\n\t\t\t\t\tpromise.reject('timeout');\n\t\t\t\t}, timeout);\n\t\t\t});\n\t\t}\n\n    }]);\n\n}());\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Color', [function () {\n\t\tfunction Color(r, g, b, a) {\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tthis.r = (r || r === 0) ? r : 0;\n\t\t\t\tthis.g = (g || g === 0) ? g : 0;\n\t\t\t\tthis.b = (b || b === 0) ? b : 0;\n\t\t\t\tthis.a = (a || a === 0) ? a : 255;\n\t\t\t} else {\n\t\t\t\tvar uint = r || '0xffffff';\n\t\t\t\tuint = parseInt(uint);\n\t\t\t\tif (r.length > 8) {\n\t\t\t\t\tthis.r = uint >> 24 & 0xff;\n\t\t\t\t\tthis.g = uint >> 16 & 0xff;\n\t\t\t\t\tthis.b = uint >> 8 & 0xff;\n\t\t\t\t\tthis.a = uint >> 0 & 0xff;\n\t\t\t\t} else {\n\t\t\t\t\tthis.r = uint >> 16 & 0xff;\n\t\t\t\t\tthis.g = uint >> 8 & 0xff;\n\t\t\t\t\tthis.b = uint >> 0 & 0xff;\n\t\t\t\t\tthis.a = 255;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tColor.componentToHex = function (c) {\n\t\t\tvar hex = c.toString(16);\n\t\t\treturn hex.length == 1 ? '0' + hex : hex;\n\t\t};\n\t\tColor.luma = function (color) {\n\t\t\t// var luma = color.dot({ r: 54.213, g: 182.376, b: 18.411 });\n\t\t\tvar luma = color.dot({\n\t\t\t\tr: 95,\n\t\t\t\tg: 100,\n\t\t\t\tb: 60\n\t\t\t});\n\t\t\treturn luma;\n\t\t};\n\t\tColor.contrast = function (color) {\n\t\t\tvar luma = Color.luma(color);\n\t\t\tif (luma > 0.6) {\n\t\t\t\treturn new Color('0x000000');\n\t\t\t} else {\n\t\t\t\treturn new Color('0xffffff');\n\t\t\t}\n\t\t};\n\t\tColor.darker = function (color, pow, min) {\n\t\t\tmin = min || 0;\n\t\t\tvar r = Math.max(Math.floor(color.r * min), Math.floor(color.r - 255 * pow));\n\t\t\tvar g = Math.max(Math.floor(color.g * min), Math.floor(color.g - 255 * pow));\n\t\t\tvar b = Math.max(Math.floor(color.b * min), Math.floor(color.b - 255 * pow));\n\t\t\treturn new Color(r, g, b, color.a);\n\t\t};\n\t\tColor.lighter = function (color, pow, max) {\n\t\t\tmax = max || 1;\n\t\t\tvar r = Math.min(color.r + Math.floor((255 - color.r) * max), Math.floor(color.r + 255 * pow));\n\t\t\tvar g = Math.min(color.g + Math.floor((255 - color.g) * max), Math.floor(color.g + 255 * pow));\n\t\t\tvar b = Math.min(color.b + Math.floor((255 - color.b) * max), Math.floor(color.b + 255 * pow));\n\t\t\treturn new Color(r, g, b, color.a);\n\t\t};\n\t\t/*\n\t\tColor.rgbaToHex = function (rgba) {\n\t\t    rgba = rgba.match(/^rgba?[\\s+]?\\([\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?/i);\n\t\t    return (rgba && rgba.length === 4) ? \"#\" +\n\t\t        (\"0\" + parseInt(rgba[1], 10).toString(16)).slice(-2) +\n\t\t        (\"0\" + parseInt(rgba[2], 10).toString(16)).slice(-2) +\n\t\t        (\"0\" + parseInt(rgba[3], 10).toString(16)).slice(-2) : '';\n\t\t}\n\t\t*/\n\t\tColor.prototype = {\n\t\t\ttoUint: function () {\n\t\t\t\treturn (this.r << 24) + (this.g << 16) + (this.b << 8) + (this.a);\n\t\t\t},\n\t\t\ttoHex: function () {\n\t\t\t\treturn '#' + Color.componentToHex(this.r) + Color.componentToHex(this.g) + Color.componentToHex(this.b) + Color.componentToHex(this.a);\n\t\t\t},\n\t\t\ttoRgba: function () {\n\t\t\t\treturn 'rgba(' + this.r + ',' + this.g + ',' + this.b + ',' + (this.a / 255).toFixed(3) + ')';\n\t\t\t},\n\t\t\tdot: function (color) {\n\t\t\t\treturn ((this.r / 255) * (color.r / 255) + (this.g / 255) * (color.g / 255) + (this.b / 255) * (color.b / 255));\n\t\t\t},\n\t\t\talpha: function (pow, min, max) {\n\t\t\t\tmin = min || 0;\n\t\t\t\tmax = max || 1;\n\t\t\t\tthis.a = Math.floor((min + (pow * (max - min))) * 255);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tmakeSet: function () {\n\t\t\t\tthis.foreground = Color.contrast(this);\n\t\t\t\tthis.border = Color.darker(this, 0.3);\n\t\t\t\tthis.light = Color.lighter(this, 0.3);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t};\n\t\treturn Color;\n    }]);\n\n\tapp.factory('Shape', [function () {\n\t\tfunction Shape() {}\n\t\tShape.shapeCircle = function (p, cx, cy, r, sa, ea) {\n\t\t\tsa = sa || 0;\n\t\t\tea = ea || 2 * Math.PI;\n\t\t\tp.ctx.arc(cx, cy, r, sa, ea, false);\n\t\t};\n\t\tShape.shapeStar = function (p, cx, cy, or, ir, steps) {\n\t\t\tvar x, y;\n\t\t\tvar angle = Math.PI / 2 * 3;\n\t\t\tvar step = Math.PI / steps;\n\t\t\tvar ctx = p.ctx;\n\t\t\tctx.moveTo(cx, cy - or);\n\t\t\tfor (i = 0; i < steps; i++) {\n\t\t\t\tx = cx + Math.cos(angle) * or;\n\t\t\t\ty = cy + Math.sin(angle) * or;\n\t\t\t\tctx.lineTo(x, y);\n\t\t\t\tangle += step;\n\t\t\t\tx = cx + Math.cos(angle) * ir;\n\t\t\t\ty = cy + Math.sin(angle) * ir;\n\t\t\t\tctx.lineTo(x, y);\n\t\t\t\tangle += step;\n\t\t\t}\n\t\t\tctx.lineTo(cx, cy - or);\n\t\t};\n\t\tShape.shapeRoundRect = function (p, rect, r) {\n\t\t\tvar ctx = p.ctx,\n\t\t\t\tx = rect.x,\n\t\t\t\ty = rect.y,\n\t\t\t\tw = rect.w,\n\t\t\t\th = rect.h;\n\t\t\tif (typeof r === undefined) {\n\t\t\t\tr = 4;\n\t\t\t}\n\t\t\tif (typeof r === 'number') {\n\t\t\t\tr = {\n\t\t\t\t\ttl: r,\n\t\t\t\t\ttr: r,\n\t\t\t\t\tbr: r,\n\t\t\t\t\tbl: r\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tvar defaultRadius = {\n\t\t\t\t\ttl: 0,\n\t\t\t\t\ttr: 0,\n\t\t\t\t\tbr: 0,\n\t\t\t\t\tbl: 0\n\t\t\t\t};\n\t\t\t\tfor (var key in defaultRadius) {\n\t\t\t\t\tr[key] = r[key] || defaultRadius[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\tctx.moveTo(x + r.tl, y);\n\t\t\tctx.lineTo(x + w - r.tr, y);\n\t\t\tctx.quadraticCurveTo(x + w, y, x + w, y + r.tr);\n\t\t\tctx.lineTo(x + w, y + h - r.br);\n\t\t\tctx.quadraticCurveTo(x + w, y + h, x + w - r.br, y + h);\n\t\t\tctx.lineTo(x + r.bl, y + h);\n\t\t\tctx.quadraticCurveTo(x, y + h, x, y + h - r.bl);\n\t\t\tctx.lineTo(x, y + r.tl);\n\t\t\tctx.quadraticCurveTo(x, y, x + r.tl, y);\n\t\t};\n\t\tShape.circle = function () {\n\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\tvar ctx = params[0].ctx;\n\t\t\tctx.beginPath();\n\t\t\tShape.shapeCircle.apply(this, params);\n\t\t\tctx.closePath();\n\t\t};\n\t\tShape.star = function () {\n\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\tvar ctx = params[0].ctx;\n\t\t\tctx.beginPath();\n\t\t\tShape.shapeStar.apply(this, params);\n\t\t\tctx.closePath();\n\t\t};\n\t\tShape.roundRect = function () {\n\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\tvar ctx = params[0].ctx;\n\t\t\tctx.beginPath();\n\t\t\tShape.shapeRoundRect.apply(this, params);\n\t\t\tctx.closePath();\n\t\t};\n\t\treturn Shape;\n    }]);\n\n\tapp.constant('PainterColors', {\n\t\t/*\n\t\tblack: new Color('0x111111'),\n\t\twhite: new Color('0xffffff'),\n\t\tred: new Color('0xff0000'),\n\t\tgreen: new Color('0x00ff00'),\n\t\tblue: new Color('0x0000ff'),\n\t\tyellow: new Color('0xffff00'),\n\t\tcyan: new Color('0x00ffff'),\n\t\tpurple: new Color('0xff00ff'),\n\t\t*/\n\t\tblack: '0x14191e',\n\t\twhite: '0xffffff',\n\t\tblue: '0x0023FF',\n\t\tred: '0xF21500',\n\t\tlightBlue: '0x79ccf2',\n\t\tlightYellow: '0xfff79a',\n\t\tgreyLighter: '0xf8f8f8',\n\t\tgreyLight: '0xeeeeee',\n\t\tgreyMedium: '0xcccccc',\n\t\tgrey: '0x90939b',\n\t\tmap: '0x24292e',\n\t});\n\n\tapp.factory('Palette', ['$q', 'Painter', 'Rect', function ($q, Painter, Rect) {\n\t\tfunction Palette() {\n\t\t\tthis.painter = new Painter().setSize(0, 0);\n\t\t\tthis.buffer = new Painter().setSize(0, 0);\n\t\t\tthis.size = {\n\t\t\t\tw: 0,\n\t\t\t\th: 0\n\t\t\t};\n\t\t\tthis.pool = {};\n\t\t\tthis.rows = {};\n\t\t}\n\t\tPalette.prototype = {\n\t\t\tgetRect: function (w, h) {\n\t\t\t\tvar p = this.painter,\n\t\t\t\t\tsize = this.size,\n\t\t\t\t\trows = this.rows,\n\t\t\t\t\tr = new Rect(0, 0, w, h),\n\t\t\t\t\trow = rows[h] || {\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: size.h\n\t\t\t\t\t};\n\t\t\t\tsize.w = Math.max(size.w, row.x + w);\n\t\t\t\tsize.h = Math.max(size.h, row.y + h);\n\t\t\t\tif (!p.canvas.width && !p.canvas.height) {\n\t\t\t\t\tp.setSize(size.w, size.h);\n\t\t\t\t} else if (size.w > p.canvas.width || size.h > p.canvas.height) {\n\t\t\t\t\t// var img = new Image();\n\t\t\t\t\t// img.src = p.toDataURL();\n\t\t\t\t\t// document.body.appendChild(canvas);\n\t\t\t\t\t// console.log(p.canvas.width, p.canvas.height);\n\t\t\t\t\t// var data = p.ctx.getImageData(0, 0, p.canvas.width, p.canvas.height);\n\t\t\t\t\tvar canvas = p.canvas;\n\t\t\t\t\tp.setCanvas(document.createElement('canvas'));\n\t\t\t\t\tp.setSize(size.w, size.h);\n\t\t\t\t\tp.ctx.drawImage(canvas, 0, 0);\n\t\t\t\t\t// p.ctx.putImageData(data, 0, 0);\n\t\t\t\t\t// p.ctx.drawImage(img, 0, 0);\n\t\t\t\t\t// document.body.removeChild(canvas);\n\t\t\t\t}\n\t\t\t\tr.x = row.x;\n\t\t\t\tr.y = row.y;\n\t\t\t\trow.x += w;\n\t\t\t\trows[h] = row;\n\t\t\t\treturn r;\n\t\t\t},\n\t\t\tadd: function (key, path) {\n\t\t\t\tvar palette = this;\n\t\t\t\tif (angular.isString(path)) {\n\t\t\t\t\tvar deferred = $q.defer();\n\t\t\t\t\tvar img = new Image();\n\t\t\t\t\timg.onload = function () {\n\t\t\t\t\t\tpalette.addShape(key, img.width, img.height, function (p, rect) {\n\t\t\t\t\t\t\tp.ctx.drawImage(img, 0, 0);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdeferred.resolve(img);\n\t\t\t\t\t};\n\t\t\t\t\timg.onerror = function () {\n\t\t\t\t\t\tdeferred.reject('connot load ' + path);\n\t\t\t\t\t};\n\t\t\t\t\timg.src = path;\n\t\t\t\t\treturn deferred.promise;\n\t\t\t\t} else {\n\t\t\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\t\t\treturn palette.addShape.apply(palette, params);\n\t\t\t\t}\n\t\t\t},\n\t\t\taddShape: function (key, w, h, callback) {\n\t\t\t\tvar p = this.painter,\n\t\t\t\t\tr = this.getRect(w, h);\n\t\t\t\tp.ctx.save();\n\t\t\t\tp.ctx.rect(r.x, r.y, r.w, r.h);\n\t\t\t\t// p.ctx.stroke();\n\t\t\t\tp.ctx.clip();\n\t\t\t\tp.ctx.translate(r.x, r.y);\n\t\t\t\tcallback.call(p, p, r.clone().setPos(0, 0));\n\t\t\t\tp.ctx.restore();\n\t\t\t\tthis.pool[key] = r;\n\t\t\t\t// console.log('Painter.add', r);\n\t\t\t},\n\t\t\tdraw: function (target, key, x, y, pre) {\n\t\t\t\tvar r = this.pool[key];\n\t\t\t\tif (r) {\n\t\t\t\t\t// var ctx = target.ctx;\n\t\t\t\t\t// ctx.save();\n\t\t\t\t\ttarget.drawRect(this.painter.canvas, r, {\n\t\t\t\t\t\tx: x,\n\t\t\t\t\t\ty: y,\n\t\t\t\t\t\tw: r.w,\n\t\t\t\t\t\th: r.h\n\t\t\t\t\t}, pre);\n\t\t\t\t\t// target.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, x - r.w / 2, y - r.h / 2, r.w, r.h);\n\t\t\t\t\t// ctx.restore();\n\t\t\t\t}\n\t\t\t},\n\t\t\ttint: function (target, key, x, y, color, pre) {\n\t\t\t\tvar r = this.pool[key];\n\t\t\t\tif (r) {\n\t\t\t\t\tvar p = this.painter,\n\t\t\t\t\t\tb = this.buffer.setSize(r.w, r.h);\n\t\t\t\t\tb.save();\n\t\t\t\t\tb.setFill(color);\n\t\t\t\t\tb.fillRect();\n\t\t\t\t\tb.ctx.globalCompositeOperation = \"destination-atop\";\n\t\t\t\t\tb.ctx.drawImage(p.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n\t\t\t\t\tb.restore();\n\t\t\t\t\tconsole.log(x, y, b.canvas, target.canvas);\n\t\t\t\t\ttarget.draw(b.canvas, {\n\t\t\t\t\t\tx: x,\n\t\t\t\t\t\ty: y\n\t\t\t\t\t}, pre);\n\t\t\t\t}\n\t\t\t},\n\t\t\tpattern: function (target, key, x, y, w, h, color) {\n\t\t\t\tfunction drawPattern(pattern) {\n\t\t\t\t\tvar ctx = target.ctx;\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\t// draw\n\t\t\t\t\t// ctx.beginPath();\n\t\t\t\t\t// ctx.rect(-x, -y, w, h);\n\t\t\t\t\tctx.fillStyle = pattern;\n\t\t\t\t\tctx.fillRect(-x, -y, w, h);\n\t\t\t\t\tctx.translate(-x, -y);\n\t\t\t\t\t// ctx.fill();\n\t\t\t\t\tctx.restore();\n\t\t\t\t}\n\t\t\t\tvar r = this.pool[key];\n\t\t\t\tif (r) {\n\t\t\t\t\tvar img = r.img,\n\t\t\t\t\t\tpattern;\n\t\t\t\t\tif (!img || r.color != color) {\n\t\t\t\t\t\tvar b = this.buffer.setSize(r.w, r.h);\n\t\t\t\t\t\tif (color) {\n\t\t\t\t\t\t\tr.color = color;\n\t\t\t\t\t\t\tb.save();\n\t\t\t\t\t\t\tb.setFill(color);\n\t\t\t\t\t\t\tb.fillRect();\n\t\t\t\t\t\t\tb.ctx.globalCompositeOperation = \"destination-atop\";\n\t\t\t\t\t\t\tb.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n\t\t\t\t\t\t\tb.restore();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tb.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n\t\t\t\t\t\t}\n\t\t\t\t\t\timg = new Image();\n\t\t\t\t\t\timg.onload = function () {\n\t\t\t\t\t\t\tr.img = img;\n\t\t\t\t\t\t\tpattern = target.ctx.createPattern(img, \"repeat\");\n\t\t\t\t\t\t\tdrawPattern(pattern);\n\t\t\t\t\t\t};\n\t\t\t\t\t\timg.src = b.toDataURL();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpattern = target.ctx.createPattern(img, \"repeat\");\n\t\t\t\t\t\tdrawPattern(pattern);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t\treturn Palette;\n    }]);\n\n\tapp.factory('Painter', ['Shape', 'Rect', 'Color', 'PainterColors', function (Shape, Rect, Color, PainterColors) {\n\t\tfunction Painter(canvas) {\n\t\t\tcanvas = canvas || document.createElement('canvas');\n\t\t\tthis.rect = new Rect();\n\t\t\tthis.drawingRect = new Rect();\n\t\t\tthis.setColors();\n\t\t\tthis.setCanvas(canvas);\n\t\t}\n\t\tPainter.colors = {};\n\t\tangular.forEach(PainterColors, function (value, key) {\n\t\t\tPainter.colors[key] = new Color(value).makeSet();\n\t\t});\n\t\tvar colors = Painter.colors;\n\t\tPainter.prototype = {\n\t\t\tcolors: Painter.colors,\n\t\t\tsetColors: function () {\n\t\t\t\tvar colors = this.colors;\n\t\t\t\tangular.forEach(PainterColors, function (value, key) {\n\t\t\t\t\tcolors[key] = new Color(value).makeSet();\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCanvas: function (canvas) {\n\t\t\t\tthis.canvas = canvas;\n\t\t\t\tthis.setSize(canvas.offsetWidth, canvas.offsetHeight);\n\t\t\t\tvar ctx = canvas.getContext('2d');\n\t\t\t\tctx.lineCap = 'square';\n\t\t\t\tthis.ctx = ctx;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetSize: function (w, h) {\n\t\t\t\tthis.canvas.width = w;\n\t\t\t\tthis.canvas.height = h;\n\t\t\t\tthis.rect.w = w;\n\t\t\t\tthis.rect.h = h;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tcopy: function (canvas) {\n\t\t\t\tthis.ctx.drawImage(canvas, 0, 0);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tclear: function () {\n\t\t\t\tthis.resize();\n\t\t\t\t// this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tresize: function () {\n\t\t\t\tthis.setSize(this.canvas.offsetWidth, this.canvas.offsetHeight);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetText: function (font, align, verticalAlign, color) {\n\t\t\t\tfont = font || '11px monospace';\n\t\t\t\talign = align || 'center';\n\t\t\t\tverticalAlign = verticalAlign || 'middle';\n\t\t\t\tcolor = color || this.colors.black;\n\t\t\t\tvar ctx = this.ctx;\n\t\t\t\tctx.font = font;\n\t\t\t\tctx.textAlign = align;\n\t\t\t\tctx.textBaseline = verticalAlign;\n\t\t\t\tctx.fillStyle = color.toRgba();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetFill: function (color) {\n\t\t\t\tcolor = color || this.colors.black;\n\t\t\t\tvar ctx = this.ctx;\n\t\t\t\t/*\n\t\t\t\tvar my_gradient = ctx.createLinearGradient(0, 0, 0, 170);\n\t\t\t\tmy_gradient.addColorStop(0, \"black\");\n\t\t\t\tmy_gradient.addColorStop(1, \"white\");\n\t\t\t\tctx.fillStyle = my_gradient;\n\t\t\t\t*/\n\t\t\t\tctx.fillStyle = color.toRgba();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetStroke: function (color, size) {\n\t\t\t\tcolor = color || this.colors.black;\n\t\t\t\tvar ctx = this.ctx;\n\t\t\t\tsize = size || 1;\n\t\t\t\t/*\n\t\t\t\tvar gradient=ctx.createLinearGradient(0,0,170,0);\n\t\t\t\tgradient.addColorStop(\"0\",\"magenta\");\n\t\t\t\tgradient.addColorStop(\"0.5\",\"blue\");\n\t\t\t\tgradient.addColorStop(\"1.0\",\"red\");\n\t\t\t\tctx.strokeStyle = gradient;\n\t\t\t\t*/\n\t\t\t\t// Fill with gradient\n\t\t\t\tctx.strokeStyle = color.toRgba();\n\t\t\t\tctx.lineWidth = size;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t/*\n\t\t\tdrawRoundRect: function (rect, r) {\n\t\t\t    rect = rect || this.rect;\n\t\t\t    Shape.roundRect(this, rect, r);\n\t\t\t    return this;\n\t\t\t},\n\t\t\t*/\n\t\t\tfillText: function (text, point, width, post, maxLength) {\n\t\t\t\tif (width) {\n\t\t\t\t\tpost = post || '';\n\t\t\t\t\tmaxLength = maxLength || Math.floor(width / 8);\n\t\t\t\t\tif (text.length > maxLength) {\n\t\t\t\t\t\ttext = text.substr(0, Math.min(text.length, maxLength)).trim() + post;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.ctx.fillText(text, point.x, point.y);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tfillRect: function (rect) {\n\t\t\t\trect = rect || this.rect;\n\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\tx = rect.x,\n\t\t\t\t\ty = rect.y,\n\t\t\t\t\tw = rect.w,\n\t\t\t\t\th = rect.h;\n\t\t\t\tctx.fillRect(x, y, w, h);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tstrokeRect: function (rect) {\n\t\t\t\trect = rect || this.rect;\n\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\tx = rect.x,\n\t\t\t\t\ty = rect.y,\n\t\t\t\t\tw = rect.w,\n\t\t\t\t\th = rect.h;\n\t\t\t\tctx.strokeRect(x, y, w, h);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tfill: function () {\n\t\t\t\tthis.ctx.fill();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tstroke: function () {\n\t\t\t\tthis.ctx.stroke();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tbegin: function () {\n\t\t\t\tthis.ctx.beginPath();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tclose: function () {\n\t\t\t\tthis.ctx.closePath();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsave: function () {\n\t\t\t\tthis.ctx.save();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\trestore: function () {\n\t\t\t\tthis.ctx.restore();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\trotate: function (angle) {\n\t\t\t\tthis.ctx.rotate(angle * Math.PI / 180);\n\t\t\t},\n\t\t\ttranslate: function (xy) {\n\t\t\t\tthis.ctx.translate(xy.x, xy.y);\n\t\t\t},\n\t\t\ttoDataURL: function () {\n\t\t\t\treturn this.canvas.toDataURL();\n\t\t\t},\n\t\t\tdraw: function (image, t, pre) {\n\t\t\t\tif (image) {\n\t\t\t\t\tt.w = t.w || image.width;\n\t\t\t\t\tt.h = t.h || image.height;\n\t\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\t\trect = this.drawingRect,\n\t\t\t\t\t\tx = rect.x = t.x - t.w / 2,\n\t\t\t\t\t\ty = rect.y = t.y - t.h / 2,\n\t\t\t\t\t\tw = rect.w = t.w,\n\t\t\t\t\t\th = rect.h = t.h;\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\tif (pre) {\n\t\t\t\t\t\tpre.call(this);\n\t\t\t\t\t}\n\t\t\t\t\tctx.drawImage(image, 0, 0);\n\t\t\t\t\tctx.restore();\n\t\t\t\t\t// console.log('painter.draw', x, y, w, h);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tdrawRect: function (image, s, t, pre) {\n\t\t\t\tif (image) {\n\t\t\t\t\ts.w = s.w || image.width;\n\t\t\t\t\ts.h = s.h || image.height;\n\t\t\t\t\tt.w = t.w || image.width;\n\t\t\t\t\tt.h = t.h || image.height;\n\t\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\t\trect = this.drawingRect,\n\t\t\t\t\t\tx = rect.x = t.x - s.w / 2,\n\t\t\t\t\t\ty = rect.y = t.y - s.h / 2,\n\t\t\t\t\t\tw = rect.w = t.w,\n\t\t\t\t\t\th = rect.h = t.h;\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\tif (pre) {\n\t\t\t\t\t\tpre.call(this);\n\t\t\t\t\t}\n\t\t\t\t\tctx.drawImage(image, s.x, s.y, s.w, s.h, 0, 0, t.w, t.h);\n\t\t\t\t\tctx.restore();\n\t\t\t\t\t// console.log('painter.drawRect', x, y, w, h);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tflip: function (scale) {\n\t\t\t\tscale = scale || {\n\t\t\t\t\tx: 1,\n\t\t\t\t\ty: -1\n\t\t\t\t};\n\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\trect = this.drawingRect;\n\t\t\t\tctx.translate(scale.x === -1 ? rect.w : 0, scale.y === -1 ? rect.h : 0);\n\t\t\t\tctx.scale(scale.x, scale.y);\n\t\t\t},\n\t\t};\n\t\treturn Painter;\n    }]);\n\n}());\n\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.directive('controlMessages', [function() {\n        return {\n            restrict: 'E',\n            templateUrl: 'artisan/forms/messages',\n            transclude: {\n                'message': '?messageItems',\n            },\n            link: function(scope, element, attributes, model) {}\n        };\n    }]);\n\n    app.directive('control', ['$parse', function($parse) {\n        function formatLabel(string, prepend, expression) {\n            string = string || '';\n            prepend = prepend || '';\n            var splitted = string.split(',');\n            if (splitted.length > 1) {\n                var formatted = splitted.shift();\n                angular.forEach(splitted, function(value, index) {\n                    if (expression) {\n                        formatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n                    } else {\n                        formatted = formatted.split('{' + index + '}').join(prepend + value);\n                    }\n                });\n                if (expression) {\n                    return '\\'' + formatted + '\\'';\n                } else {\n                    return formatted;\n                }\n            } else {\n                return prepend + string;\n            }\n        }\n        var uniqueId = 0;\n        return {\n            restrict: 'A',\n            templateUrl: function(element, attributes) {\n                var template = 'artisan/forms/text';\n                switch (attributes.control) {\n                    case 'select':\n                        template = 'artisan/forms/select';\n                        break;\n                }\n                return template;\n            },\n            scope: {\n                ngModel: '=',\n                required: '=',\n                form: '@',\n                title: '@',\n                placeholder: '@',\n                source: '=?',\n                key: '@?',\n                label: '@?',\n            },\n            require: 'ngModel',\n            transclude: true,\n            link: {\n                pre: function preLink(scope, element, attributes, controller, transclude) {\n                    var label = scope.label = (scope.label ? scope.label : 'name');\n                    var key = scope.key = (scope.key ? scope.key : 'id');\n                    if (attributes.control === 'select') {\n                        var filter = (attributes.filter ? '| ' + attributes.filter : '');\n                        var optionLabel = formatLabel(label, 'item.', true);\n                        scope.getOptions = function() {\n                            return attributes.number ?\n                                'item.' + key + ' as ' + optionLabel + ' disable when item.disabled for item in source ' + filter :\n                                optionLabel + ' disable when item.disabled for item in source ' + filter + ' track by item.' + key;\n                        };\n                    }\n                    var type = scope.type = attributes.control;\n                    var form = scope.form = scope.form || 'form';\n                    var title = scope.title = scope.title || 'untitled';\n                    var placeholder = scope.placeholder = scope.placeholder || title;\n                    var field = scope.field = title.replace(/[^0-9a-zA-Z]/g, \"\").split(' ').join('') + (++uniqueId);\n                    scope.format = attributes.format || null;\n                    scope.precision = attributes.precision || null;\n                    scope.validate = attributes.validate || attributes.control;\n                    scope.minLength = attributes.minLength || 0;\n                    scope.maxLength = attributes.maxLength || Number.POSITIVE_INFINITY;\n                    scope.min = attributes.min || null;\n                    scope.max = attributes.max || null;\n                    scope.options = $parse(attributes.options)(scope) || {};\n                    scope.focus = false;\n                    scope.visible = false;\n                    scope.onChange = function(model) {\n                        $parse(attributes.onChange)(scope.$parent);\n                    };\n                    scope.onFilter = function(model) {\n                        $parse(attributes.onFilter)(scope.$parent);\n                    };\n                    scope.getType = function() {\n                        var type = 'text';\n                        switch (attributes.control) {\n                            case 'password':\n                                type = scope.visible ? 'text' : 'password';\n                                break;\n                            default:\n                                type = attributes.control;\n                        }\n                        return type;\n                    };\n                    scope.getClasses = function() {\n                        var form = $parse(scope.form)(scope.$parent);\n                        var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                        return {\n                            'control-focus': scope.focus,\n                            'control-success': field.$valid,\n                            'control-error': field.$invalid && (form.$submitted || field.$touched),\n                            'control-empty': !field.$viewValue\n                        };\n                    };\n                    scope.getMessages = function() {\n                        var form = $parse(scope.form)(scope.$parent);\n                        var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                        return (form.$submitted || field.$touched) && field.$error;\n                    };\n                    scope.toggleVisibility = function() {\n                        scope.visible = !scope.visible;\n                    };\n                },\n            },\n        };\n    }]);\n\n    app.directive('_control', ['$http', '$templateCache', '$compile', '$parse', function($http, $templateCache, $compile, $parse) {\n        function formatLabel(string, prepend, expression) {\n            string = string || '';\n            prepend = prepend || '';\n            var splitted = string.split(',');\n            if (splitted.length > 1) {\n                var formatted = splitted.shift();\n                angular.forEach(splitted, function(value, index) {\n                    if (expression) {\n                        formatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n                    } else {\n                        formatted = formatted.split('{' + index + '}').join(prepend + value);\n                    }\n                });\n                if (expression) {\n                    return '\\'' + formatted + '\\'';\n                } else {\n                    return formatted;\n                }\n            } else {\n                return prepend + string;\n            }\n        }\n        var uniqueId = 0;\n        return {\n            restrict: 'A',\n            templateUrl: function(element, attributes) {\n                var template = 'artisan/forms/text';\n                switch (attributes.control) {\n                    case 'select':\n                        template = 'artisan/forms/select';\n                        break;\n                }\n                return template;\n            },\n            scope: {\n                ngModel: '=',\n                required: '=',\n                form: '@',\n                title: '@',\n                placeholder: '@',\n            },\n            require: 'ngModel',\n            /*\n            link: function(scope, element, attributes, model) {\n            },\n            */\n            compile: function(element, attributes) {\n                    return {\n                        pre: function(scope, element, attributes) {\n                            if (attributes.control === 'select') {\n                                var label = (attributes.label ? attributes.label : 'name');\n                                var key = (attributes.key ? attributes.key : 'id');\n                                var filter = (attributes.min ? ' | filter:gte(\\'' + key + '\\', ' + attributes.min + ')' : '');\n                                var optionLabel = formatLabel(label, 'item.', true);\n                                scope.options = attributes.number ?\n                                    'item.' + key + ' as ' + optionLabel + ' disable when item.disabled for item in ' + attributes.source + filter :\n                                    optionLabel + ' disable when item.disabled for item in ' + attributes.source + filter + ' track by item.' + key;\n                                console.log('control.compile.pre', scope.options);\n                            }\n                            var type = scope.type = attributes.control;\n                            var form = scope.form = scope.form || 'form';\n                            var title = scope.title = scope.title || 'untitled';\n                            var placeholder = scope.placeholder = scope.placeholder || title;\n                            var field = scope.field = title.replace(/[^0-9a-zA-Z]/g, \"\").split(' ').join('') + (++uniqueId);\n                            scope.validate = attributes.validate || attributes.control;\n                            scope.format = attributes.format || null;\n                            scope.precision = attributes.precision || null;\n                            scope.validate = attributes.validate || attributes.control;\n                            scope.minLength = attributes.min || 0;\n                            scope.maxLength = attributes.max || Number.POSITIVE_INFINITY;\n                            scope.options = $parse(attributes.options)(scope) || {};\n                            scope.focus = false;\n                            scope.visible = false;\n                            scope.getType = function() {\n                                var type = 'text';\n                                switch (attributes.control) {\n                                    case 'password':\n                                        // var form = $parse(scope.form)(scope.$parent);\n                                        // var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                        type = scope.visible ? 'text' : 'password';\n                                        break;\n                                    default:\n                                        type = attributes.control;\n                                }\n                                // console.log('control.getType', type);\n                                return type;\n                            };\n                            scope.getClasses = function() {\n                                var form = $parse(scope.form)(scope.$parent);\n                                var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                return {\n                                    'control-focus': scope.focus,\n                                    'control-success': field.$valid,\n                                    'control-error': field.$invalid && (form.$submitted || field.$touched),\n                                    'control-empty': !field.$viewValue\n                                };\n                            };\n                            scope.getMessages = function() {\n                                var form = $parse(scope.form)(scope.$parent);\n                                var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                return (form.$submitted || field.$touched) && field.$error;\n                            };\n                        },\n                        // post: function (scope, element, attributes) { }\n                    };\n                }\n                /*\n                compile: function(element, attributes) {\n                    element.removeAttr('my-dir'); \n                    element.attr('ng-hide', 'true');\n                    return function(scope) {\n                        $compile(element)(scope);\n                    };\n                },\n                */\n        };\n    }]);\n\n    app.directive('numberPicker', ['$parse', '$timeout', function($parse, $timeout) {\n        return {\n            restrict: 'A',\n            template: '<div class=\"input-group\">' +\n                '   <span class=\"input-group-btn\"><button class=\"btn btn-outline-primary\" type=\"button\">-</button></span>' +\n                '   <div ng-transclude></div>' +\n                '   <span class=\"input-group-btn\"><button class=\"btn btn-outline-primary\" type=\"button\">+</button></span>' +\n                '</div>',\n            replace: true,\n            transclude: true,\n            link: function(scope, element, attributes, model) {\n                var node = element[0];\n                var nodeRemove = node.querySelectorAll('.input-group-btn > .btn')[0];\n                var nodeAdd = node.querySelectorAll('.input-group-btn > .btn')[1];\n\n                function onRemove(e) {\n                    var min = $parse(attributes.min)(scope);\n                    var getter = $parse(attributes.numberPicker);\n                    var setter = getter.assign;\n                    $timeout(function() {\n                        setter(scope, Math.max(min, getter(scope) - 1));\n                    });\n                    // console.log('numberPicker.onRemove', min);\n                }\n\n                function onAdd(e) {\n                    var max = $parse(attributes.max)(scope);\n                    var getter = $parse(attributes.numberPicker);\n                    var setter = getter.assign;\n                    $timeout(function() {\n                        setter(scope, Math.min(max, getter(scope) + 1));\n                    });\n                    // console.log('numberPicker.onAdd', max);\n                }\n\n                function addListeners() {\n                    angular.element(nodeRemove).on('touchstart mousedown', onRemove);\n                    angular.element(nodeAdd).on('touchstart mousedown', onAdd);\n                }\n\n                function removeListeners() {\n                    angular.element(nodeRemove).off('touchstart mousedown', onRemove);\n                    angular.element(nodeAdd).off('touchstart mousedown', onAdd);\n                }\n                scope.$on('$destroy', function() {\n                    removeListeners();\n                });\n                addListeners();\n            }\n        };\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.directive('validate', ['$filter', function($filter) {\n        return {\n            require: 'ngModel',\n            link: function(scope, element, attributes, model) {\n                var type = attributes.validate;\n                var format = attributes.format || '';\n                var precision = attributes.precision || 2;\n                var focus = false;\n                // console.log('validate', type);\n                switch (type) {\n                    case 'date':\n                    case 'datetime':\n                    case 'datetime-local':\n                        model.$formatters.push(function(value) {\n                            if (value) {\n                                return $filter('date')(value, format);\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                    case 'number':\n                        model.$parsers.unshift(function(value) {\n                            var valid = false;\n                            if (value !== undefined && value !== \"\") {\n                                valid = String(value).indexOf(Number(value).toString()) !== -1; // isFinite(value); // \n                                value = Number(value);\n                                model.$setValidity('number', valid);\n                                if (valid) {\n                                    model.$setValidity('positive', value >= 0.01);\n                                    if (attributes.min !== undefined) {\n                                        model.$setValidity('range', value >= Number(attributes.min));\n                                    }\n                                    if (attributes.max !== undefined) {\n                                        model.$setValidity('range', value <= Number(attributes.max));\n                                    }\n                                }\n                            } else {\n                                valid = true;\n                                value = Number(value);\n                                model.$setValidity('number', true);\n                                model.$setValidity('positive', true);\n                                if (attributes.min !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                                if (attributes.max !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                            }\n                            return value;\n                        });\n                        model.$formatters.push(function(value) {\n                            if (value) {\n                                return $filter('number')(value, precision) + ' ' + format;\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                    case 'anynumber':\n                        model.$parsers.unshift(function(value) {\n                            var valid = false;\n                            if (value !== undefined && value !== \"\") {\n                                valid = String(value).indexOf(Number(value).toString()) !== -1; // isFinite(value); // \n                                value = Number(value);\n                                model.$setValidity('number', valid);\n                                if (valid) {\n                                    if (attributes.min !== undefined) {\n                                        model.$setValidity('range', value >= Number(attributes.min));\n                                    }\n                                    if (attributes.max !== undefined) {\n                                        model.$setValidity('range', value <= Number(attributes.max));\n                                    }\n                                }\n                            } else {\n                                valid = true;\n                                value = Number(value);\n                                model.$setValidity('number', true);\n                                if (attributes.min !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                                if (attributes.max !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                            }\n                            return value;\n                        });\n                        model.$formatters.push(function(value) {\n                            if (value || value === 0) {\n                                return $filter('number')(value, precision) + ' ' + format;\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                }\n\n                function onFocus() {\n                    focus = true;\n                    if (format) {\n                        element[0].value = model.$modelValue || null;\n                        if (!model.$modelValue) {\n                            model.$setViewValue(null);\n                        }\n                    }\n                }\n\n                function doBlur() {\n                    if (format && !model.$invalid) {\n                        switch (type) {\n                            case 'date':\n                            case 'datetime':\n                            case 'datetime-local':\n                                element[0].value = model.$modelValue ? $filter('date')(model.$modelValue, format) : ' ';\n                                break;\n                            default:\n                                element[0].value = model.$modelValue ? $filter('number')(model.$modelValue, precision) + ' ' + format : ' ';\n                                break;\n                        }\n                    }\n                }\n\n                function onBlur() {\n                    focus = false;\n                    doBlur();\n                }\n\n                function addListeners() {\n                    element.on('focus', onFocus);\n                    element.on('blur', onBlur);\n                }\n\n                function removeListeners() {\n                    element.off('focus', onFocus);\n                    element.off('blur', onBlur);\n                }\n                scope.$on('$destroy', function() {\n                    removeListeners();\n                });\n                addListeners();\n            }\n        };\n    }]);\n\n}());\n/* global angular */\r\n\r\n(function () {\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.directive('modalView', ['$parse', '$templateRequest', '$compile', '$controller', 'Dom', function ($parse, $templateRequest, $compile, $controller, Dom) {\r\n\r\n\t\tfunction compileController(scope, element, html, data) {\r\n\t\t\t// console.log('modalView.compileController', element);\r\n\t\t\telement.html(html);\r\n\t\t\tvar link = $compile(element.contents());\r\n\t\t\tif (data.controller) {\r\n\t\t\t\tvar $scope = scope.$new();\r\n\t\t\t\tangular.extend($scope, data);\r\n\t\t\t\tvar controller = $controller(data.controller, {\r\n\t\t\t\t\t$scope: $scope\r\n\t\t\t\t});\r\n\t\t\t\tif (data.controllerAs) {\r\n\t\t\t\t\tscope[data.controllerAs] = controller;\r\n\t\t\t\t}\r\n\t\t\t\telement.data('$ngControllerController', controller);\r\n\t\t\t\telement.children().data('$ngControllerController', controller);\r\n\t\t\t\tscope = $scope;\r\n\t\t\t}\r\n\t\t\tlink(scope);\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\trestrict: 'A',\r\n\t\t\tpriority: -400,\r\n\t\t\tlink: function (scope, element, attributes, model) {\r\n\t\t\t\tvar modal = $parse(attributes.modalView);\r\n\t\t\t\tmodal = modal(scope);\r\n\t\t\t\tmodal.templateUrl = modal.templateUrl || 'artisan/modals/modal';\r\n\t\t\t\t$templateRequest(modal.templateUrl).then(function (html) {\r\n\t\t\t\t\tcompileController(scope, element, html, modal);\r\n\t\t\t\t});\r\n\t\t\t\t/*\r\n\t\t\t\t// window.scrollTo(0, element[0].offsetTop - 100);\r\n\t\t\t\tfunction onClick(e) {\r\n\t\t\t\t    var closest = Dom.getClosestElement(e.target, element[0]);\r\n\t\t\t\t    if (closest === null) {\r\n\t\t\t\t        modal.reject(null);\r\n\t\t\t\t    }\r\n\t\t\t\t    // console.log('onClick', closest);\r\n\t\t\t\t}\r\n\t\t\t\tfunction addListeners() {\r\n\t\t\t\t    angular.element(window).on('click', onClick);\r\n\t\t\t\t}\r\n\t\t\t\tfunction removeListeners() {\r\n\t\t\t\t    angular.element(window).off('click', onClick);\r\n\t\t\t\t}\r\n\t\t\t\tscope.$on('destroy', function () {\r\n\t\t\t\t    removeListeners();\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    addListeners();\r\n\t\t\t\t}, 500);\r\n\t\t\t\t*/\r\n\t\t\t}\r\n\t\t};\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.provider('$modal', [function $modalProvider() {\r\n\r\n        var modals = [];\r\n        var routes = {};\r\n\r\n        this.modals = modals;\r\n        this.routes = routes;\r\n        this.when = when;\r\n\r\n        function when(path, modal) {\r\n            routes[path] = modal;\r\n            return this;\r\n        }\r\n\r\n        this.$get = ['$q', '$timeout', function modalFactory($q, $timeout) {\r\n\r\n            function popModal(modal) {\r\n                // console.log('modalProvider.popModal', modal);                \r\n                var index = -1;\r\n                angular.forEach(modals, function(m, i) {\r\n                    if (m === modal) {\r\n                        index = i;\r\n                    }\r\n                });\r\n                if (index !== -1) {\r\n                    $timeout(function() {\r\n                        modal.active = false;\r\n                        modals.splice(index, 1);\r\n                        if (modals.length) {\r\n                            modals[modals.length - 1].active = true;\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n\r\n            function closeModal(modal) {\r\n                // console.log('modalProvider.closeModal', modal);                \r\n                var index = -1;\r\n                angular.forEach(modals, function(m, i) {\r\n                    if (m === modal) {\r\n                        index = i;\r\n                    }\r\n                });\r\n                if (index !== -1) {\r\n                    modal.active = false;\r\n                    $timeout(function() {\r\n                        while (modals.length) {\r\n                            modals.splice(modals.length - 1, 1);\r\n                        }\r\n                    }, 500);\r\n                }\r\n            }\r\n\r\n            function addModal(path, params) {\r\n                // console.log('modalProvider.addModal', path, params);\r\n                var deferred = $q.defer();\r\n                params = params || null;\r\n                var modal = {\r\n                    title: 'Untitled',\r\n                    controller: null,\r\n                    templateUrl: null,\r\n                    params: params,\r\n                };\r\n                var current = routes[path];\r\n                if (current) {\r\n                    angular.extend(modal, current);\r\n                }\r\n                modal.deferred = deferred;\r\n                modal.back = function(data) {\r\n                    popModal(this);\r\n                    modal.deferred.resolve(data, modal);\r\n                }\r\n                modal.resolve = function(data) {\r\n                    closeModal(this);\r\n                    modal.deferred.resolve(data, modal);\r\n                }\r\n                modal.reject = function() {\r\n                    closeModal(this);\r\n                    modal.deferred.reject(modal);\r\n                }\r\n                modals.push(modal);\r\n                angular.forEach(modals, function(m, i) {\r\n                    m.active = false;\r\n                });\r\n                if (modals.length) {\r\n                    modal.active = true;\r\n                } else {\r\n                    $timeout(function() {\r\n                        modal.active = true;\r\n                        // window.scrollTo(0, 0);\r\n                    }, 500);\r\n                }\r\n                return deferred.promise;\r\n            }\r\n\r\n            return {\r\n                modals: modals,\r\n                addModal: addModal,\r\n            };\r\n        }];\r\n\r\n    }]);\r\n\r\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.directive('nav', ['$parse', 'Nav', function ($parse, Nav) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\treturn attributes.template || 'artisan/nav/nav';\n\t\t\t},\n\t\t\tscope: {\n\t\t\t\titems: '=nav',\n\t\t\t},\n\t\t\tlink: function (scope, element, attributes, model) {\n\t\t\t\tscope.$watch('items', function (value) {\n\t\t\t\t\t// console.log(value instanceof Nav, value);\n\t\t\t\t\tif (value) {\n\t\t\t\t\t\tif (angular.isArray(value)) {\n\t\t\t\t\t\t\tvar onLink = $parse(attributes.onLink)(scope.$parent);\n\t\t\t\t\t\t\tvar onNav = $parse(attributes.onNav)(scope.$parent);\n\t\t\t\t\t\t\tvar nav = new Nav({\n\t\t\t\t\t\t\t\tonLink: onLink,\n\t\t\t\t\t\t\t\tonNav: onNav\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tnav.setItems(value);\n\t\t\t\t\t\t\tscope.item = nav;\n\n\t\t\t\t\t\t} else if (value instanceof Nav) {\n\t\t\t\t\t\t\tscope.item = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n    }]);\n\n\tapp.directive('navItem', ['$timeout', function ($timeout) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\treturn attributes.template || 'artisan/nav/nav-item';\n\t\t\t},\n\t\t\tscope: {\n\t\t\t\titem: '=navItem',\n\t\t\t},\n\t\t\tlink: function (scope, element, attributes, model) {\n\t\t\t\tvar navItem = angular.element(element[0].querySelector('.nav-link'));\n\n\t\t\t\tvar output;\n\n\t\t\t\tfunction itemOpen(item, immediate) {\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tstate.active = true;\n\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tstate.immediate = immediate;\n\t\t\t\t\t\tstate.closed = state.closing = false;\n\t\t\t\t\t\tstate.opening = true;\n\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\tstate.opening = false;\n\t\t\t\t\t\t\tstate.opened = true;\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction itemClose(item, immediate) {\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tstate.active = false;\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tstate.immediate = immediate;\n\t\t\t\t\t\tstate.opened = state.opening = false;\n\t\t\t\t\t\tstate.closing = true;\n\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\tstate.closing = false;\n\t\t\t\t\t\t\tstate.closed = true;\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tif (item.items) {\n\t\t\t\t\t\tangular.forEach(item.items, function (o) {\n\t\t\t\t\t\t\titemClose(o, true);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction itemToggle(item) {\n\t\t\t\t\t// console.log('itemToggle', item);\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tstate.active = item.items ? !state.active : true;\n\t\t\t\t\tif (state.active) {\n\t\t\t\t\t\tif (item.$nav.parent) {\n\t\t\t\t\t\t\tangular.forEach(item.$nav.parent.items, function (o) {\n\t\t\t\t\t\t\t\tif (o !== item) {\n\t\t\t\t\t\t\t\t\titemClose(o, true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\titemOpen(item);\n\t\t\t\t\t} else {\n\t\t\t\t\t\titemClose(item);\n\t\t\t\t\t}\n\t\t\t\t\t// console.log(state);\n\t\t\t\t}\n\n\t\t\t\tfunction onTap(e) {\n\t\t\t\t\tvar item = scope.item;\n\t\t\t\t\t// console.log('Item.onTap', item);\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tif (state.active) {\n\t\t\t\t\t\toutput = false;\n\t\t\t\t\t\ttrigger();\n\t\t\t\t\t} else if (item.$nav.onNav) {\n\t\t\t\t\t\tvar promise = item.$nav.onNav(item, item.$nav);\n\t\t\t\t\t\tif (promise && typeof promise.then === 'function') {\n\t\t\t\t\t\t\tpromise.then(function (resolved) {\n\t\t\t\t\t\t\t\t// go on\n\t\t\t\t\t\t\t\ttrigger();\n\t\t\t\t\t\t\t}, function (rejected) {\n\t\t\t\t\t\t\t\t// do nothing\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\toutput = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\toutput = promise;\n\t\t\t\t\t\t\ttrigger();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction trigger() {\n\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\titemToggle(item);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onTouchStart(e) {\n\t\t\t\t\t// console.log('Item.onTouchStart', e);\n\t\t\t\t\tonTap(e);\n\t\t\t\t\tnavItem\n\t\t\t\t\t\t.off('mousedown', onMouseDown);\n\t\t\t\t\t// return r || prevent(e);\n\t\t\t\t}\n\n\t\t\t\tfunction onMouseDown(e) {\n\t\t\t\t\t// console.log('Item.onMouseDown', e);\n\t\t\t\t\tonTap(e);\n\t\t\t\t\tnavItem\n\t\t\t\t\t\t.off('touchstart', onTouchStart);\n\t\t\t\t\t// return r || prevent(e);\n\t\t\t\t}\n\n\t\t\t\tfunction onClick(e) {\n\t\t\t\t\t// console.log('Item.onClick', e);\n\t\t\t\t\treturn prevent(e);\n\t\t\t\t}\n\n\t\t\t\tfunction prevent(e) {\n\t\t\t\t\tif (output === false) {\n\t\t\t\t\t\t// console.log('Item.prevent', e);\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t// e.stopPropagation();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction addListeners() {\n\t\t\t\t\tnavItem\n\t\t\t\t\t\t.on('touchstart', onTouchStart)\n\t\t\t\t\t\t.on('mousedown', onMouseDown)\n\t\t\t\t\t\t.on('click', onClick);\n\t\t\t\t}\n\n\t\t\t\tfunction removeListeners() {\n\t\t\t\t\tnavItem\n\t\t\t\t\t\t.off('touchstart', onTouchStart)\n\t\t\t\t\t\t.off('mousedown', onMouseDown)\n\t\t\t\t\t\t.off('click', onClick);\n\t\t\t\t}\n\n\t\t\t\taddListeners();\n\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tremoveListeners();\n\t\t\t\t});\n\t\t\t}\n\t\t};\n    }]);\n\n}());\n\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Nav', ['Silent', function (Silent) {\n\n\t\tfunction Nav(options) {\n\t\t\tvar nav = this;\n\t\t\tvar defaults = {\n\t\t\t\titems: [],\n\t\t\t}\n\t\t\tangular.extend(nav, defaults);\n\t\t\tif (options) {\n\t\t\t\tangular.extend(nav, options);\n\t\t\t}\n\t\t\tnav.setNav(nav, null);\n\t\t}\n\n\t\tvar statics = {\n\t\t\tsilent: NavSilent,\n\t\t\tpath: NavPath,\n\t\t};\n\n\t\tvar methods = {\n\t\t\taddItem: addItem,\n\t\t\taddItems: addItems,\n\t\t\tgetLink: getLink,\n\t\t\tsetItems: setItems,\n\t\t\tsetNav: setNav,\n\t\t\tsetNavs: setNavs,\n\t\t};\n\n\t\tangular.extend(Nav, statics);\n\t\tangular.extend(Nav.prototype, methods);\n\n\t\treturn Nav;\n\n\t\t// static methods\n\n\t\tfunction NavSilent(path) {\n\t\t\tSilent.silent(path);\n\t\t}\n\n\t\tfunction NavPath(path) {\n\t\t\tSilent.path(path);\n\t\t}\n\n\t\t// prototype methods\n\n\t\tfunction setItems(items) {\n\t\t\tvar nav = this;\n\t\t\tnav.path = Silent.path();\n\t\t\tnav.items = items;\n\t\t\tnav.setNavs(items, nav);\n\t\t}\n\n\t\tfunction setNavs(items, parent) {\n\t\t\tvar nav = this;\n\t\t\tif (items) {\n\t\t\t\tangular.forEach(items, function (item) {\n\t\t\t\t\tnav.setNav(item, parent);\n\t\t\t\t\tnav.setNavs(item.items, item);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tfunction setNav(item, parent) {\n\t\t\tvar nav = this;\n\t\t\tvar $nav = {\n\t\t\t\tparent: parent || null,\n\t\t\t\tlevel: parent ? parent.$nav.level + 1 : 0,\n\t\t\t\tstate: {},\n\t\t\t\taddItems: function (x) {\n\t\t\t\t\tnav.addItems(x, item);\n\t\t\t\t},\n\t\t\t\tonNav: nav.onNav,\n\t\t\t};\n\t\t\titem.$nav = $nav;\n\t\t\t$nav.link = nav.getLink(item);\n\t\t\tif ($nav.link === nav.path) {\n\t\t\t\t$nav.state.active = true;\n\t\t\t\t$nav.state.opened = true;\n\t\t\t\twhile ($nav.parent) {\n\t\t\t\t\t$nav = $nav.parent.$nav;\n\t\t\t\t\t$nav.state.active = true;\n\t\t\t\t\t$nav.state.opened = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction addItems(itemOrItems, parent) {\n\t\t\tvar nav = this;\n\t\t\tif (angular.isArray(itemOrItems)) {\n\t\t\t\tangular.forEach(itemOrItems, function (item) {\n\t\t\t\t\tnav.addItem(item, parent);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tnav.addItem(itemOrItems, parent);\n\t\t\t}\n\t\t}\n\n\t\tfunction addItem(item, parent) {\n\t\t\tvar nav = this,\n\t\t\t\tonLink = nav.onLink,\n\t\t\t\tonNav = nav.onNav;\n\t\t\tnav.setNav(item, parent);\n\t\t\tif (parent) {\n\t\t\t\tparent.items = parent.items || [];\n\t\t\t\tparent.items.push(item);\n\t\t\t}\n\t\t}\n\n\t\tfunction getLink(item) {\n\t\t\tvar link = null;\n\t\t\tif (this.onLink) {\n\t\t\t\tlink = this.onLink(item, item.$nav);\n\t\t\t} else {\n\t\t\t\tlink = item.link;\n\t\t\t}\n\t\t\treturn link;\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    window.ondragstart = function() {\n        return false;\n    };\n\n    var app = angular.module('artisan');\n\n    app.directive('scrollableX', ['$parse', '$compile', '$window', '$timeout', 'Scrollable', 'Animate', 'Style', 'Events', 'Utils', function($parse, $compile, $window, $timeout, Scrollable, Animate, Style, Events, Utils) {\n        return {\n            restrict: 'A',\n            template: '<div class=\"content\" ng-transclude></div>',\n            transclude: true,\n            link: function(scope, element, attributes, model) {\n\n                var onLeft, onRight, showIndicatorFor, scrollableWhen;\n                if (attributes.onLeft) {\n                    onLeft = $parse(attributes.onLeft);\n                }\n                if (attributes.onRight) {\n                    onRight = $parse(attributes.onRight);\n                }\n                if (attributes.showIndicatorFor) {\n                    showIndicatorFor = $parse(attributes.showIndicatorFor);\n                }\n                if (attributes.scrollableWhen) {\n                    scrollableWhen = $parse(attributes.scrollableWhen);\n                }\n\n                // ELEMENTS & STYLESHEETS;\n                element.attr('unselectable', 'on').addClass('unselectable');\n                var containerNode = element[0];\n                var contentNode = containerNode.querySelector('.content');\n                var content = angular.element(content);\n                var contentStyle = new Style();\n\n                var animate = new Animate(render);\n\n                var scrollable = attributes.scrollableX ? $parse(attributes.scrollableX)(scope) : new Scrollable();\n                link(scrollable);\n\n                function link(scrollable) {\n                    scrollable.link({\n                        getItems: function() {\n                            if (attributes.scrollableItem) {\n                                var items = containerNode.querySelectorAll(attributes.scrollableItem);\n                                return items;\n                            }\n                        },\n                        prev: function() {\n                            scrollable.scrollPrev();\n                            animate.play();\n                        },\n                        next: function() {\n                            scrollable.scrollNext();\n                            animate.play();\n                        },\n                        reset: function() {\n                            scrollable.doReset();\n                            animate.play();\n                        },\n                        onLeft: onLeft,\n                        onRight: onRight,\n                    });\n                }\n\n                /*\n                scope.$watch(attributes.scrollableX, function (newValue) {\n                \tconsole.log(newValue);\n                });\n                */\n\n                /*\n                var indicator = null,\n                \tindicatorNode = null,\n                \tindicatorStyle;\n                showIndicatorFor = false;\n                if (showIndicatorFor) {\n                \tindicator = angular.element('<div class=\"indicator\"></div>');\n                \tindicatorNode = indicator[0];\n                \tindicatorStyle = new Style();\n                \telement.append(indicator);\n                \t$compile(indicator.contents())(scope);\n                \tvar i = scrollbar.getIndicator();\n                \tindicatorStyle.transform('translate3d(' + i.x.toFixed(2) + 'px,' + i.y.toFixed(2) + 'px,0)');\n                \tindicatorStyle.set(indicatorNode);\n                }\n                */\n\n                function render(time) {\n                    scrollable.setContainer(containerNode);\n                    scrollable.setContent(contentNode);\n                    scrollable.setEnabled(isEnabled());\n                    var animating = scrollable.renderX();\n                    if (!animating) {\n                        // animate.pause();\n                    }\n                    var current = scrollable.getCurrent();\n                    contentStyle.transform('translate3d(' + current.x.toFixed(2) + 'px,0,0)');\n                    contentStyle.set(contentNode);\n                    /*\n                    if (showIndicatorFor) {\n                    \tif (dragging || wheeling || speed) {\n                    \t\tvar percent = c.x / (containerNode.offsetWidth - contentNode.offsetWidth);\n                    \t\tpercent = Math.max(0, Math.min(1, percent));\n                    \t\ti.x = (containerNode.offsetWidth - indicatorNode.offsetWidth) * (percent);\n                    \t\ti.y += (0 - i.y) / 4;\n                    \t\t// var count = Math.round(contentNode.offsetWidth / 315);\n                    \t\tvar index = Math.max(1, Math.round(percent * showIndicatorFor.rows.length));\n                    \t\tindicator.html(index + '/' + showIndicatorFor.count);\n                    \t\t// indicator.html((percent * 100).toFixed(2).toString());\n                    \t} else {\n                    \t\ti.y += (45 - i.y) / 4;\n                    \t}\n                    \tindicatorStyle.transform('translate3d(' + i.x.toFixed(2) + 'px,' + i.y.toFixed(2) + 'px,0)');\n                    \tindicatorStyle.set(indicatorNode);\n                    }\n                    */\n                }\n\n                function undrag() {\n                    scrollable.off();\n                    dragOff();\n                }\n\n                function onDown(event) {\n                    if (scrollable.dragStart(event.absolute)) {\n                        dragOn();\n                        animate.play();\n                    }\n                }\n\n                function onMove(event) {\n                    scrollable.dragMove(event.absolute);\n                    var drag = scrollable.getDrag();\n                    if (Math.abs(drag.y) > Math.abs(drag.x)) {\n                        onUp(event);\n                    } else {\n                        event.stop();\n                    }\n                }\n\n                function onUp(event) {\n                    scrollable.dragEnd(event.absolute);\n                    event.stop();\n                    dragOff();\n                }\n\n                function _onScrollX(dir, interval) {\n                    return scrollable.wheelX(dir, interval);\n                }\n\n                var onScrollX = _onScrollX;\n                // var onScrollX = Utils.throttle(_onScrollX, 25);\n\n                function onWheel(event) {\n                    // console.log('onWheelX', event.dir, scrollable.wheelXCheck(event.dir));\n                    if (scrollable.wheelXCheck(event.dir)) {\n                        onScrollX(event.dir, event.interval);\n                        animate.play();\n                        event.stop();\n                    }\n                }\n\n                function off() {\n                    dragOff();\n                    // animate.pause();\n                    scrollable.off();\n                }\n\n                function isEnabled() {\n                    var enabled = true;\n                    if (scrollableWhen) {\n                        enabled = enabled && scrollableWhen(scope);\n                    }\n                    enabled = enabled && $window.innerWidth >= 1024;\n                    enabled = enabled && (containerNode.offsetWidth < contentNode.offsetWidth);\n                    return enabled;\n                }\n\n                function onResize() {\n                    var enabled = isEnabled();\n                    if (!enabled) {\n                        off();\n                    }\n                    render();\n                }\n\n                scope.$watch(function() {\n                    return contentNode.offsetWidth;\n                }, function(newValue, oldValue) {\n                    onResize();\n                });\n\n                var events = new Events(element).add({\n                    down: onDown,\n                    wheel: onWheel,\n                }, scope);\n\n                var windowEvents = new Events($window).add({\n                    resize: onResize,\n                }, scope);\n\n                function dragOn() {\n                    windowEvents.add({\n                        move: onMove,\n                        up: onUp,\n                    }, scope);\n                }\n\n                function dragOff() {\n                    windowEvents.remove({\n                        move: onMove,\n                        up: onUp,\n                    });\n                }\n\n                scope.$on('$destroy', function() {\n                    animate.pause();\n                });\n\n            },\n        };\n    }]);\n\n    app.directive('scrollableY', ['$parse', '$compile', '$window', '$timeout', 'Scrollable', 'Animate', 'Style', 'Events', 'Utils', function($parse, $compile, $window, $timeout, Scrollable, Animate, Style, Events, Utils) {\n        return {\n            restrict: 'A',\n            template: '<div class=\"content\" ng-transclude></div>',\n            transclude: true,\n            link: function(scope, element, attributes, model) {\n\n                var onTop, onBottom, showIndicatorFor, scrollableWhen;\n                if (attributes.onTop) {\n                    onTop = $parse(attributes.onTop);\n                }\n                if (attributes.onBottom) {\n                    onBottom = $parse(attributes.onBottom);\n                }\n                if (attributes.showIndicatorFor) {\n                    showIndicatorFor = $parse(attributes.showIndicatorFor);\n                }\n                if (attributes.scrollableWhen) {\n                    scrollableWhen = $parse(attributes.scrollableWhen);\n                }\n\n                // ELEMENTS & STYLESHEETS;\n                element.attr('unselectable', 'on').addClass('unselectable');\n                var containerNode = element[0];\n                var contentNode = containerNode.querySelector('.content');\n                var content = angular.element(content);\n                var contentStyle = new Style();\n\n                var animate = new Animate(render);\n\n                var scrollable = attributes.scrollableY ? $parse(attributes.scrollableY)(scope) : new Scrollable();\n                link(scrollable);\n\n                function link(scrollable) {\n                    scrollable.link({\n                        getItems: function() {\n                            if (attributes.scrollableItem) {\n                                var items = containerNode.querySelectorAll(attributes.scrollableItem);\n                                return items;\n                            }\n                        },\n                        prev: function() {\n                            scrollable.scrollPrev();\n                            animate.play();\n                        },\n                        next: function() {\n                            scrollable.scrollNext();\n                            animate.play();\n                        },\n                        reset: function() {\n                            scrollable.doReset();\n                            animate.play();\n                        },\n                        onTop: onTop,\n                        onBottom: onBottom,\n                    });\n                }\n\n                function render(time) {\n                    scrollable.setContainer(containerNode);\n                    scrollable.setContent(contentNode);\n                    scrollable.setEnabled(isEnabled());\n                    var animating = scrollable.renderY();\n                    if (!animating) {\n                        // animate.pause();\n                    }\n                    var current = scrollable.getCurrent();\n                    contentStyle.transform('translate3d(0,' + current.y.toFixed(2) + 'px,0)');\n                    contentStyle.set(contentNode);\n                }\n\n                function undrag() {\n                    scrollable.off();\n                    dragOff();\n                }\n\n                function onDown(event) {\n                    if (scrollable.dragStart(event.absolute)) {\n                        dragOn();\n                        animate.play();\n                    }\n                }\n\n                function onMove(event) {\n                    scrollable.dragMove(event.absolute);\n                    var drag = scrollable.getDrag();\n                    if (Math.abs(drag.x) > Math.abs(drag.y)) {\n                        onUp(event);\n                    } else {\n                        event.stop();\n                    }\n                }\n\n                function onUp(event) {\n                    scrollable.dragEnd(event.absolute);\n                    event.stop();\n                    dragOff();\n                }\n\n                function _onScrollY(dir, interval) {\n                    return scrollable.wheelY(dir, interval);\n                }\n\n                var onScrollY = _onScrollY;\n                // var onScrollY = Utils.throttle(_onScrollY, 25);\n\n                function onWheel(event) {\n                    // console.log('onWheelY', event.dir, scrollable.wheelYCheck(event.dir));\n                    if (scrollable.wheelYCheck(event.dir)) {\n                        onScrollY(event.dir, event.interval);\n                        animate.play();\n                        event.stop();\n                    }\n                }\n\n                function off() {\n                    dragOff();\n                    // animate.pause();\n                    scrollable.off();\n                }\n\n                function isEnabled() {\n                    var enabled = true;\n                    if (scrollableWhen) {\n                        enabled = enabled && scrollableWhen(scope);\n                    }\n                    enabled = enabled && $window.innerWidth >= 1024;\n                    enabled = enabled && (containerNode.offsetHeight < contentNode.offsetHeight);\n                    return enabled;\n                }\n\n                function onResize() {\n                    var enabled = isEnabled();\n                    if (!enabled) {\n                        off();\n                    }\n                    render();\n                }\n\n                scope.$watch(function() {\n                    return contentNode.offsetHeight;\n                }, function(newValue, oldValue) {\n                    onResize();\n                });\n\n                var events = new Events(element).add({\n                    down: onDown,\n                    wheel: onWheel,\n                }, scope);\n\n                var windowEvents = new Events($window).add({\n                    resize: onResize,\n                }, scope);\n\n                function dragOn() {\n                    windowEvents.add({\n                        move: onMove,\n                        up: onUp,\n                    }, scope);\n                }\n\n                function dragOff() {\n                    windowEvents.remove({\n                        move: onMove,\n                        up: onUp,\n                    });\n                }\n\n                scope.$on('$destroy', function() {\n                    animate.pause();\n                });\n\n            },\n        };\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Scrollable', ['Utils', 'Point', 'Rect', function (Utils, Point, Rect) {\n\n\t\tfunction Scrollable() {\n\n\t\t\tvar padding = 150;\n\t\t\tvar enabled, snappable, busy, dragging, wheeling, down, move, prev;\n\t\t\tvar currentIndex = 0;\n\n\t\t\tsnappable = true;\n\n\t\t\tvar start = new Point(),\n\t\t\t\tend = new Point(),\n\t\t\t\tcurrent = new Point(),\n\t\t\t\tdrag = new Point(),\n\t\t\t\tindicator = new Point(),\n\t\t\t\toffset = new Point(),\n\t\t\t\tspeed = new Point(),\n\t\t\t\tcontainer = new Rect(),\n\t\t\t\tcontent = new Rect(),\n\t\t\t\toverflow = new Rect();\n\n\t\t\tvar scrollable = {\n\t\t\t\t// properties\n\t\t\t\tstart: start,\n\t\t\t\tend: end,\n\t\t\t\tcurrent: current,\n\t\t\t\tindicator: indicator,\n\t\t\t\tspeed: speed,\n\t\t\t\toverflow: overflow,\n\t\t\t\tcontainer: container,\n\t\t\t\tcontent: content,\n\t\t\t\t// methods\n\t\t\t\tsetContainer: setContainer,\n\t\t\t\tsetContent: setContent,\n\t\t\t\tsetEnabled: setEnabled,\n\t\t\t\tgetCurrent: getCurrent,\n\t\t\t\tgetDrag: getDrag,\n\t\t\t\tgetIndicator: getIndicator,\n\t\t\t\tscrollToIndex: scrollToIndex,\n\t\t\t\tscrollPrev: scrollPrev,\n\t\t\t\tscrollNext: scrollNext,\n\t\t\t\tdragStart: dragStart,\n\t\t\t\tdragMove: dragMove,\n\t\t\t\tdragEnd: dragEnd,\n\t\t\t\tdoReset: doReset,\n\t\t\t\toff: off,\n\t\t\t\t// x direction\n\t\t\t\tdoLeft: doLeft,\n\t\t\t\tdoRight: doRight,\n\t\t\t\trenderX: renderX,\n\t\t\t\tscrollToX: scrollToX,\n\t\t\t\twheelX: wheelX,\n\t\t\t\twheelXCheck: wheelXCheck,\n\t\t\t\t// y direction\n\t\t\t\tdoTop: doTop,\n\t\t\t\tdoBottom: doBottom,\n\t\t\t\trenderY: renderY,\n\t\t\t\tscrollToY: scrollToY,\n\t\t\t\twheelY: wheelY,\n\t\t\t\twheelYCheck: wheelYCheck,\n\t\t\t};\n\n\t\t\tangular.extend(this, scrollable);\n\n\t\t\tscrollable = this;\n\n\t\t\tfunction setContainer(node) {\n\t\t\t\tcontainer.width = node.offsetWidth;\n\t\t\t\tcontainer.height = node.offsetHeight;\n\t\t\t}\n\n\t\t\tfunction setContent(node) {\n\t\t\t\tcontent.width = node.offsetWidth;\n\t\t\t\tcontent.height = node.offsetHeight;\n\t\t\t}\n\n\t\t\tfunction setEnabled(flag) {\n\t\t\t\tenabled = flag;\n\t\t\t}\n\n\t\t\tfunction getCurrent() {\n\t\t\t\treturn current;\n\t\t\t}\n\n\t\t\tfunction getDrag() {\n\t\t\t\treturn drag;\n\t\t\t}\n\n\t\t\tfunction getIndicator() {\n\t\t\t\treturn indicator;\n\t\t\t}\n\n\t\t\tfunction scrollToIndex(index) {\n\t\t\t\tif (index !== currentIndex) {\n\t\t\t\t\tcurrentIndex = index;\n\t\t\t\t\tvar item = getItemAtIndex(index);\n\t\t\t\t\tif (item) {\n\t\t\t\t\t\toffset = new Point(\n\t\t\t\t\t\t\titem.offsetLeft,\n\t\t\t\t\t\t\titem.offsetTop\n\t\t\t\t\t\t);\n\t\t\t\t\t\t// console.log('scrollToIndex', index, offset);\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction dragStart(point) {\n\t\t\t\tif (!busy) {\n\t\t\t\t\tstart.x = end.x = current.x;\n\t\t\t\t\tstart.y = end.y = current.y;\n\t\t\t\t\tspeed.x = 0;\n\t\t\t\t\tspeed.y = 0;\n\t\t\t\t\tdown = point;\n\t\t\t\t\tcurrentIndex = -1;\n\t\t\t\t\twheeling = false;\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction dragMove(point) {\n\t\t\t\tprev = move;\n\t\t\t\tmove = point;\n\t\t\t\tdrag.x = move.x - down.x;\n\t\t\t\tdrag.y = move.y - down.y;\n\t\t\t\tdragging = true;\n\t\t\t}\n\n\t\t\tfunction dragEnd() {\n\t\t\t\tif (move && prev) {\n\t\t\t\t\tspeed.x += (move.x - prev.x) * 4;\n\t\t\t\t\tspeed.y += (move.y - prev.y) * 4;\n\t\t\t\t}\n\t\t\t\tstart.x = end.x = current.x;\n\t\t\t\tstart.y = end.y = current.y;\n\t\t\t\tdragging = false;\n\t\t\t\tmove = null;\n\t\t\t\tdown = null;\n\t\t\t\tprev = null;\n\t\t\t}\n\n\t\t\tfunction getItemAtIndex(index) {\n\t\t\t\tvar item = null;\n\t\t\t\tvar items = scrollable.getItems();\n\t\t\t\tif (items) {\n\t\t\t\t\tif (index >= 0 && index < items.length) {\n\t\t\t\t\t\titem = items[index];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// console.log('getItemAtIndex', index, items.length, item);\n\t\t\t\treturn item;\n\t\t\t}\n\n\t\t\tfunction scrollPrev() {\n\t\t\t\tvar index = Math.max(0, currentIndex - 1);\n\t\t\t\t// console.log('scrollPrev', index);\n\t\t\t\tscrollToIndex(index);\n\t\t\t}\n\n\t\t\tfunction scrollNext() {\n\t\t\t\tvar items = scrollable.getItems();\n\t\t\t\tvar index = Math.min(items.length - 1, currentIndex + 1);\n\t\t\t\t// console.log('scrollNext', index);\n\t\t\t\tscrollToIndex(index);\n\t\t\t}\n\n\t\t\tfunction doReset() {\n\t\t\t\tend.x = current.x = 0;\n\t\t\t}\n\n\t\t\tfunction off() {\n\t\t\t\tdragging = false;\n\t\t\t\twheeling = false;\n\t\t\t\tmove = null;\n\t\t\t\tdown = null;\n\t\t\t}\n\n\t\t\t// x - direction\n\n\t\t\tfunction doLeft(scope) {\n\t\t\t\tif (busy) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!scrollable.onLeft) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tbusy = true;\n\t\t\t\tscrollable.onLeft(scope).then().finally(function () {\n\t\t\t\t\tscrollToX(0);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction doRight(scope) {\n\t\t\t\tif (busy) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!scrollable.onRight) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tbusy = true;\n\t\t\t\tscrollable.onRight(scope).then().finally(function () {\n\t\t\t\t\tvar right = container.width - content.width;\n\t\t\t\t\tif (right > overflow.width) {\n\t\t\t\t\t\tstart.x = end.x = overflow.width;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstart.x = end.x = overflow.width + padding;\n\t\t\t\t\t}\n\t\t\t\t\tscrollToX(0);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction renderX() {\n\t\t\t\tvar animating = true;\n\t\t\t\tif (enabled) {\n\t\t\t\t\toverflow.x = 0;\n\t\t\t\t\toverflow.width = container.width - content.width;\n\t\t\t\t\tif (dragging) {\n\t\t\t\t\t\tend.x = start.x + move.x - down.x;\n\t\t\t\t\t\tif (extendX()) {\n\t\t\t\t\t\t\tstart.x = end.x;\n\t\t\t\t\t\t\tdown.x = move.x;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (speed.x) {\n\t\t\t\t\t\tend.x += speed.x;\n\t\t\t\t\t\tspeed.x *= 0.75;\n\t\t\t\t\t\tif (wheeling) {\n\t\t\t\t\t\t\textendX();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (Math.abs(speed.x) < 2.05) {\n\t\t\t\t\t\t\tspeed.x = 0;\n\t\t\t\t\t\t\tscrollable.wheeling = wheeling = false;\n\t\t\t\t\t\t\tsnapToNearestX();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (offset) {\n\t\t\t\t\t\tend.x = -offset.x;\n\t\t\t\t\t\toffset = null;\n\t\t\t\t\t}\n\t\t\t\t\tend.x = Math.round(end.x * 10000) / 10000;\n\t\t\t\t\tend.x = Math.min(overflow.x, end.x);\n\t\t\t\t\tend.x = Math.max(overflow.width, end.x);\n\t\t\t\t\tcurrent.x += (end.x - current.x) / 4;\n\t\t\t\t\tif (speed.x === 0 && Math.abs(end.x - current.x) < 0.05) {\n\t\t\t\t\t\tcurrent.x = end.x;\n\t\t\t\t\t\tif (!snapToNearestX()) {\n\t\t\t\t\t\t\tanimating = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// console.log('renderX', current.x, end.x, overflow.x);\n\t\t\t\t} else {\n\t\t\t\t\tcurrent.x = end.x = 0;\n\t\t\t\t\tanimating = false;\n\t\t\t\t}\n\t\t\t\treturn animating;\n\t\t\t}\n\n\t\t\tfunction extendX() {\n\t\t\t\tvar extending = false;\n\t\t\t\toverflow.x += padding;\n\t\t\t\toverflow.width -= padding;\n\t\t\t\tif (end.x > overflow.x) {\n\t\t\t\t\textending = true;\n\t\t\t\t\tdoLeft();\n\t\t\t\t} else if (end.x < overflow.width) {\n\t\t\t\t\textending = true;\n\t\t\t\t\tdoRight();\n\t\t\t\t}\n\t\t\t\treturn extending;\n\t\t\t}\n\n\t\t\tfunction snapToNearestX() {\n\t\t\t\tvar items = scrollable.getItems();\n\t\t\t\tif (items) {\n\t\t\t\t\tvar index = -1;\n\t\t\t\t\tvar min = Number.POSITIVE_INFINITY;\n\t\t\t\t\tangular.forEach(items, function (item, i) {\n\t\t\t\t\t\tvar distance = Math.abs((end.x + speed.x) - (item.offsetLeft * -1));\n\t\t\t\t\t\tif (distance < min) {\n\t\t\t\t\t\t\tmin = distance;\n\t\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\tif (snappable) {\n\t\t\t\t\t\t\treturn scrollToIndex(index);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcurrentIndex = index;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction wheelXCheck(dir) {\n\t\t\t\t// console.log('wheelYCheck', dir < 0 ? (end.x - overflow.width) : (end.x - overflow.x));\n\t\t\t\tif (!busy && enabled) {\n\t\t\t\t\tif (dir < 0) {\n\t\t\t\t\t\treturn end.x - overflow.width;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn end.x - overflow.x;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction wheelX(dir, interval) {\n\t\t\t\tend.x += dir * 100 / 1000 * interval;\n\t\t\t\tspeed.x += dir * 100 / 1000 * interval;\n\t\t\t\twheeling = true;\n\t\t\t}\n\n\t\t\tfunction scrollToX(value) {\n\t\t\t\tstart.x = end.x = value;\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\toff();\n\t\t\t\t\tbusy = false;\n\t\t\t\t}, 500);\n\t\t\t}\n\n\t\t\t// y - direction\n\n\t\t\tfunction doTop(scope) {\n\t\t\t\tif (busy) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!scrollable.onTop) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tbusy = true;\n\t\t\t\tscrollable.onTop(scope).then().finally(function () {\n\t\t\t\t\tscrollToY(0);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction doBottom(scope) {\n\t\t\t\tif (busy) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!scrollable.onBottom) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tbusy = true;\n\t\t\t\tscrollable.onBottom(scope).then().finally(function () {\n\t\t\t\t\tvar bottom = container.height - content.height;\n\t\t\t\t\tif (bottom > overflow.height) {\n\t\t\t\t\t\tstart.y = end.y = overflow.height;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstart.y = end.y = overflow.height + padding;\n\t\t\t\t\t}\n\t\t\t\t\tscrollToY(0);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction renderY() {\n\t\t\t\tvar animating = true;\n\t\t\t\tif (enabled) {\n\t\t\t\t\toverflow.y = 0;\n\t\t\t\t\toverflow.height = container.height - content.height;\n\t\t\t\t\tif (dragging) {\n\t\t\t\t\t\tend.y = start.y + move.y - down.y;\n\t\t\t\t\t\tif (extendY()) {\n\t\t\t\t\t\t\tstart.y = end.y;\n\t\t\t\t\t\t\tdown.y = move.y;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (speed.y) {\n\t\t\t\t\t\tend.y += speed.y;\n\t\t\t\t\t\tspeed.y *= 0.75;\n\t\t\t\t\t\tif (wheeling) {\n\t\t\t\t\t\t\textendY();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (Math.abs(speed.y) < 2.05) {\n\t\t\t\t\t\t\tspeed.y = 0;\n\t\t\t\t\t\t\tscrollable.wheeling = wheeling = false;\n\t\t\t\t\t\t\tsnapToNearestY();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (offset) {\n\t\t\t\t\t\tend.y = -offset.y;\n\t\t\t\t\t\toffset = null;\n\t\t\t\t\t}\n\t\t\t\t\tend.y = Math.round(end.y * 10000) / 10000;\n\t\t\t\t\tend.y = Math.min(overflow.y, end.y);\n\t\t\t\t\tend.y = Math.max(overflow.height, end.y);\n\t\t\t\t\tcurrent.y += (end.y - current.y) / 4;\n\t\t\t\t\tif (speed.y === 0 && Math.abs(end.y - current.y) < 0.05) {\n\t\t\t\t\t\tcurrent.y = end.y;\n\t\t\t\t\t\tif (!snapToNearestY()) {\n\t\t\t\t\t\t\tanimating = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// console.log(parseFloat(current.y.toFixed(6)), end.y, overflow.y);\n\t\t\t\t\t// console.log(dragging, wheeling, end.y, speed.y, Math.abs(end.y - current.y));\n\t\t\t\t} else {\n\t\t\t\t\tcurrent.y = end.y = 0;\n\t\t\t\t\tanimating = false;\n\t\t\t\t}\n\t\t\t\treturn animating;\n\t\t\t}\n\n\t\t\tfunction extendY() {\n\t\t\t\tvar extending = false;\n\t\t\t\toverflow.y += padding;\n\t\t\t\toverflow.height -= padding;\n\t\t\t\tif (end.y > overflow.y) {\n\t\t\t\t\textending = true;\n\t\t\t\t\tdoTop();\n\t\t\t\t} else if (end.y < overflow.height) {\n\t\t\t\t\textending = true;\n\t\t\t\t\tdoBottom();\n\t\t\t\t}\n\t\t\t\treturn extending;\n\t\t\t}\n\n\t\t\tfunction snapToNearestY() {\n\t\t\t\tvar items = scrollable.getItems();\n\t\t\t\tif (items) {\n\t\t\t\t\tvar index = -1;\n\t\t\t\t\tvar min = Number.POSITIVE_INFINITY;\n\t\t\t\t\tangular.forEach(items, function (item, i) {\n\t\t\t\t\t\tvar distance = Math.abs((end.y + speed.y) - (item.offsetTop * -1));\n\t\t\t\t\t\tif (distance < min) {\n\t\t\t\t\t\t\tmin = distance;\n\t\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t// console.log('snapToNearestY', index, min);\n\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\tif (snappable) {\n\t\t\t\t\t\t\treturn scrollToIndex(index);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcurrentIndex = index;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction wheelYCheck(dir) {\n\t\t\t\t// console.log('wheelYCheck', dir < 0 ? (end.y - overflow.height) : (end.y - overflow.y));\n\t\t\t\tif (!busy && enabled) {\n\t\t\t\t\tif (dir < 0) {\n\t\t\t\t\t\treturn end.y - overflow.height;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn end.y - overflow.y;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction wheelY(dir, interval) {\n\t\t\t\tend.y += dir * 100 / 1000 * interval;\n\t\t\t\tspeed.y += dir * 100 / 1000 * interval;\n\t\t\t\twheeling = true;\n\t\t\t}\n\n\t\t\tfunction scrollToY(value) {\n\t\t\t\tstart.y = end.y = value;\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\toff();\n\t\t\t\t\tbusy = false;\n\t\t\t\t}, 500);\n\t\t\t}\n\n\t\t}\n\n\t\tfunction link(methods) {\n\t\t\tangular.extend(this, methods);\n\t\t}\n\n\t\tScrollable.prototype = {\n\t\t\tlink: link,\n\t\t\tgetItems: function () {\n\t\t\t\treturn [content];\n\t\t\t},\n\t\t};\n\t\treturn Scrollable;\n    }]);\n\n}());\n/* global angular */\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\t// micro interactions\n\n\tfunction tap(Events) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tpriority: 0,\n\t\t\tlink: link\n\t\t};\n\n\t\tfunction link(scope, element, attributes, model) {\n\t\t\tif (attributes.ngBind) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t/*\n\t\t\tif (attributes.href === '#' && !attributes.ngHref && !attributes.ngClick) {\n\t\t\t\treturn;\n            }\n            */\n\n\t\t\telement.addClass('interaction-tap');\n\t\t\tvar node = document.createElement('interaction');\n\t\t\telement[0].appendChild(node);\n\n\t\t\tfunction onDown(e) {\n\t\t\t\telement.removeClass('interaction-animate');\n\t\t\t\tvoid element.offsetWidth;\n\t\t\t\t// node.style.animationPlayState = \"paused\";\n\t\t\t\tnode.style.left = e.relative.x + 'px';\n\t\t\t\tnode.style.top = e.relative.y + 'px';\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\telement.addClass('interaction-animate');\n\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\telement.removeClass('interaction-animate');\n\t\t\t\t\t}, 1000);\n\t\t\t\t}, 10);\n\n\t\t\t\t// console.log('tap.onDown', node, node.parentElement);\n\t\t\t}\n\t\t\tvar listeners = { // down, move, up, click\n\t\t\t\tdown: onDown,\n\t\t\t};\n\t\t\tvar events = new Events(element).add(listeners, scope); // passing scope to add remove listeners automatically on $destroy\n\t\t}\n\t}\n\tapp.directive('ngHref', ['Events', tap]);\n\tapp.directive('ngClick', ['Events', tap]);\n\n}());"]}