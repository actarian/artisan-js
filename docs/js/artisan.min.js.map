{"version":3,"sources":["docs/js/artisan.js"],"names":["angular","module","factory","Animate","callback","this","key","ticks","prototype","play","loop","time","_this","window","requestAnimationFrame","pause","cancelAnimationFrame","playpause","doNOTPlay","lastTime","vendors","x","length","element","currTime","Date","getTime","timeToCall","Math","max","id","setTimeout","clearTimeout","app","$window","$document","EventsService","Utils","Event","e","event","documentNode","getDocumentNode","scroll","pageXOffset","scrollLeft","y","pageYOffset","scrollTop","node","getNode","offset","offsetLeft","offsetTop","boundNode","rect","getBoundingClientRect","page","getPage","relative","left","top","absolute","type","view","w","getWidth","h","getHeight","originalEvent","deltaX","wheelDeltaX","deltaY","wheelDeltaY","abs","dir","timestamp","self","innerWidth","clientWidth","innerHeight","clientHeight","standardEvents","touchEvents","indexOf","t","touches","changedTouches","pageX","pageY","stop","stopPropagation","preventDefault","Events","setTimestamp","interval","min","events","onClick","listeners","click","apply","onMouseDown","down","removeTouchEvents","onMouseMove","move","onMouseUp","up","onMouseWheel","wheel","removeScrollEvents","onMouseScroll","removeWheelEvents","onResize","resize","onTouchStart","removeStandardEvents","onTouchMove","onTouchEnd","wheelEvents","scrollEvents","getElement","add","scope","standard","touch","windowElement","forEach","listener","remove","on","$on","off","mouseEvents","service","hasPassiveEvents","supported","addEventListener","options","Object","defineProperty","get","console","log","defaults","passive","capture","original","EventTarget","modified","copy","undefined","call","onScroll","getParents","target","filter","scrollWidth","ua","mac","chrome","safari","firefox","$filter","array","filters","item","i","Point","mult","point","value","setX","setY","setPos","clone","toString","Rect","reduce","size","reduceRect","offsetRect","expandRect","expand","intersect","right","bottom","center","topLeft","topRight","bottomRight","bottomLeft","setW","setH","setSize","Vector","make","a","b","sqrt","normalize","l","incidence","atan2","distance","cross","difference","power","towards","friction","Hash","pool","defineProperties","enumerable","writable","has","getId","hash","set","push","newItem","p","keys","oldItem","index","splice","addMany","items","removeMany","removeAll","shift","each","forward","reverse","sort","c","d","backward","differs","updatePool","pools","Array","$q","$promise","deferred","defer","promise","statics","all","promises","extend","$timeout","State","errors","isReady","idle","state","isBusy","isError","isErroring","isSuccess","isSuccessing","button","busy","error","ready","success","enabled","errorMessage","submitClass","successing","errorring","labels","addons","label","classes","transformProperty","div","document","createElement","style","every","prefix","Style","props","scale","hoverScale","currentScale","styles","cssText","join","transform","transformOrigin","round","$compile","$controller","toMd5","string","getTouch","previous","s","getRelativeTouch","getClosest","el","selector","matchesFn","parent","some","fn","body","parentElement","getClosestElement","documentElement","parentNode","topParentNode","parents","object","removeValue","throttle","func","wait","context","args","result","timeout","later","leading","getNow","now","remaining","arguments","trailing","where","query","found","compileController","html","data","link","contents","controller","$scope","$new","controllerAs","children","reverseSortOn","format","prepend","expression","splitted","split","formatted","reducer","o","reducerSetter","slice","reducerAdder","downloadFile","content","name","download","createEvent","anchor","href","base64","downloadName","substring","lastIndexOf","initEvent","dispatchEvent","open","blob","Blob","reader","FileReader","readAsDataURL","onloadend","serverDownload","uri","extension","JSON","stringify","form","input","appendChild","action","method","enctype","submit","removeChild","agent","navigator","userAgent","toLowerCase","msie","mobile","getElementsByTagName","addClass","TypeError","len","k","Api","Doc","$location","$routeParams","environment","View","doc","url","path","params","route","current","docs","then","response","resolve","reject","$http","$httpPromise","urls","api","status","$get","$post","$put","$patch","$delete","$fake","post","put","patch","delete","fake","redirect","msecs","doRedirect","$$lastRequestedPath","doRetry","$rootScope","$silent","unlink","$$listeners","$locationChangeSuccess","relink","$path","silent","replace","location","unshift","Cookie","TIMEOUT","_set","days","expires","date","setTime","toGMTString","cookie","exists","cookieName","ca","charAt","model","parse","decodeURIComponent","atob","cache","json","btoa","encodeURIComponent","checkCookie","elapsed","LocalStorage","isSupported","localStorage","setItem","removeItem","storageEvent","newValue","SessionStorage","sessionStorage","Color","r","g","uint","parseInt","componentToHex","hex","luma","color","dot","contrast","darker","pow","floor","lighter","toUint","toHex","toRgba","toFixed","alpha","makeSet","foreground","border","light","Shape","shapeCircle","cx","cy","sa","ea","PI","ctx","arc","shapeStar","or","ir","steps","angle","step","moveTo","cos","sin","lineTo","shapeRoundRect","tl","tr","br","bl","defaultRadius","quadraticCurveTo","circle","beginPath","closePath","star","roundRect","constant","black","white","blue","red","lightBlue","lightYellow","greyLighter","greyLight","greyMedium","grey","map","Painter","Palette","painter","buffer","rows","getRect","row","canvas","width","height","setCanvas","drawImage","palette","isString","img","Image","onload","addShape","onerror","src","save","clip","translate","restore","draw","pre","drawRect","tint","setFill","fillRect","globalCompositeOperation","pattern","drawPattern","fillStyle","createPattern","toDataURL","PainterColors","drawingRect","setColors","colors","offsetWidth","offsetHeight","getContext","lineCap","clear","setText","font","align","verticalAlign","textAlign","textBaseline","setStroke","strokeStyle","lineWidth","fillText","text","maxLength","substr","trim","strokeRect","fill","stroke","begin","close","rotate","xy","image","flip","directive","restrict","templateUrl","transclude","message","attributes","$parse","formatLabel","uniqueId","template","control","ngModel","required","title","placeholder","source","require","optionLabel","getOptions","number","field","precision","validate","minLength","Number","POSITIVE_INFINITY","focus","visible","onChange","$parent","onFilter","getType","getClasses","control-focus","control-success","$valid","control-error","$invalid","$submitted","$touched","control-empty","$viewValue","getMessages","$error","toggleVisibility","$templateCache","compile","onRemove","getter","numberPicker","setter","assign","onAdd","removeListeners","nodeRemove","nodeAdd","querySelectorAll","onFocus","$modelValue","$setViewValue","doBlur","onBlur","$formatters","$parsers","valid","String","$setValidity","$templateRequest","priority","modal","modalView","provider","when","routes","modals","popModal","m","active","closeModal","addModal","back","Nav","$watch","isArray","onLink","onNav","nav","setItems","itemOpen","immediate","$nav","closed","closing","opening","opened","itemClose","itemToggle","onTap","trigger","output","resolved","rejected","navItem","prevent","querySelector","setNav","setNavs","level","addItems","getLink","itemOrItems","addItem","ondragstart","Scrollable","render","scrollable","setContainer","containerNode","setContent","contentNode","setEnabled","isEnabled","renderX","getCurrent","contentStyle","onDown","dragStart","dragOn","animate","onMove","dragMove","drag","getDrag","onUp","dragEnd","dragOff","_onScrollX","wheelX","onWheel","wheelXCheck","onScrollX","scrollableWhen","windowEvents","onLeft","onRight","showIndicatorFor","attr","scrollableX","getItems","scrollableItem","prev","scrollPrev","next","scrollNext","reset","doReset","oldValue","renderY","_onScrollY","wheelY","wheelYCheck","onScrollY","onTop","onBottom","scrollableY","container","flag","getIndicator","indicator","scrollToIndex","currentIndex","getItemAtIndex","start","end","speed","wheeling","dragging","doLeft","finally","scrollToX","doRight","overflow","padding","animating","extendX","snapToNearestX","extending","snappable","doTop","scrollToY","doBottom","extendY","snapToNearestY","methods","tap","removeClass","ngBind","ngHref","ngClick"],"mappings":"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","file":"artisan.min.js","sourcesContent":["/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan', ['ng', 'ngRoute', 'ngMessages']);\r\n\r\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Animate', [function () {\n\n\t\tfunction Animate(callback) {\n\t\t\tthis.callback = callback;\n\t\t\tthis.key = null;\n\t\t\tthis.ticks = 0;\n\t\t}\n\t\tAnimate.prototype = {\n\t\t\tplay: function () {\n\t\t\t\tvar _this = this;\n\n\t\t\t\tfunction loop(time) {\n\t\t\t\t\t_this.ticks++;\n\t\t\t\t\t_this.callback(time, _this.ticks);\n\t\t\t\t\t_this.key = window.requestAnimationFrame(loop);\n\t\t\t\t}\n\t\t\t\tif (!this.key) {\n\t\t\t\t\tloop();\n\t\t\t\t}\n\t\t\t},\n\t\t\tpause: function () {\n\t\t\t\tif (this.key) {\n\t\t\t\t\twindow.cancelAnimationFrame(this.key);\n\t\t\t\t\tthis.key = null;\n\t\t\t\t}\n\t\t\t},\n\t\t\tplaypause: function () {\n\t\t\t\tif (this.key) {\n\t\t\t\t\tthis.pause();\n\t\t\t\t} else {\n\t\t\t\t\tthis.play();\n\t\t\t\t}\n\t\t\t},\n\t\t\tdoNOTPlay: function () {\n\t\t\t\tthis.pause();\n\t\t\t},\n\t\t}\n\t\treturn Animate;\n    }]);\n\n\t(function () {\n\t\tvar lastTime = 0;\n\t\tvar vendors = ['ms', 'moz', 'webkit', 'o'];\n\t\tfor (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n\t\t\twindow.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\n\t\t\twindow.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] ||\n\t\t\t\twindow[vendors[x] + 'CancelRequestAnimationFrame'];\n\t\t}\n\t\tif (!window.requestAnimationFrame) {\n\t\t\twindow.requestAnimationFrame = function (callback, element) {\n\t\t\t\tvar currTime = new Date().getTime();\n\t\t\t\tvar timeToCall = Math.max(0, 16 - (currTime - lastTime));\n\t\t\t\tvar id = window.setTimeout(function () {\n\t\t\t\t\tcallback(currTime + timeToCall);\n\t\t\t\t}, timeToCall);\n\t\t\t\tlastTime = currTime + timeToCall;\n\t\t\t\treturn id;\n\t\t\t};\n\t\t}\n\t\tif (!window.cancelAnimationFrame) {\n\t\t\twindow.cancelAnimationFrame = function (id) {\n\t\t\t\tclearTimeout(id);\n\t\t\t};\n\t\t}\n\t}());\n\n}());\n\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Events', ['$window', '$document', 'EventsService', 'Utils', function ($window, $document, EventsService, Utils) {\n\n\t\tfunction Event(e, element) {\n\t\t\te = e || $window.event;\n\t\t\tvar documentNode = Utils.getDocumentNode();\n\t\t\tvar scroll = {\n\t\t\t\tx: $window.pageXOffset || documentNode.scrollLeft,\n\t\t\t\ty: $window.pageYOffset || documentNode.scrollTop\n\t\t\t};\n\t\t\tvar node = getNode(element);\n\t\t\tvar offset = {\n\t\t\t\tx: node.offsetLeft,\n\t\t\t\ty: node.offsetTop,\n\t\t\t};\n\t\t\tvar boundNode = node === $window ? documentNode : node;\n\t\t\tvar rect = boundNode.getBoundingClientRect();\n\t\t\tvar page = this.getPage(e);\n\t\t\tif (page) {\n\t\t\t\tvar relative = {\n\t\t\t\t\tx: page.x - scroll.x - rect.left,\n\t\t\t\t\ty: page.y - scroll.y - rect.top,\n\t\t\t\t};\n\t\t\t\tvar absolute = {\n\t\t\t\t\tx: page.x - scroll.x,\n\t\t\t\t\ty: page.y - scroll.y,\n\t\t\t\t};\n\t\t\t\tthis.relative = relative;\n\t\t\t\tthis.absolute = absolute;\n\t\t\t}\n\t\t\tif (e.type === 'resize') {\n\t\t\t\tvar view = {\n\t\t\t\t\tw: this.getWidth(),\n\t\t\t\t\th: this.getHeight(),\n\t\t\t\t};\n\t\t\t\tthis.view = view;\n\t\t\t}\n\t\t\tif (e.type === 'mousewheel' || e.type === 'DOMMouseScroll') {\n\t\t\t\te = e.originalEvent ? e.originalEvent : e;\n\t\t\t\tvar deltaX = e.deltaX || e.wheelDeltaX;\n\t\t\t\tvar deltaY = e.deltaY || e.wheelDeltaY;\n\t\t\t\tif (Math.abs(deltaX) > Math.abs(deltaY)) {\n\t\t\t\t\tthis.dir = deltaX < 0 ? 1 : -1;\n\t\t\t\t} else {\n\t\t\t\t\tthis.dir = deltaY < 0 ? 1 : -1;\n\t\t\t\t}\n\t\t\t\t// console.log(element, this.dir, e.deltaX, e.deltaY, e.wheelDeltaX, e.wheelDeltaY);\n\t\t\t}\n\t\t\tthis.originalEvent = e;\n\t\t\tthis.element = element;\n\t\t\tthis.node = node;\n\t\t\tthis.offset = offset;\n\t\t\tthis.rect = rect;\n\t\t\tthis.timestamp = new Date().getTime();\n\t\t\t// console.log('Event', 'page', page, 'scroll', scroll, 'offset', offset, 'rect', rect, 'relative', relative, 'absolute', absolute);\n\t\t\t// console.log('scroll.y', scroll.y, 'page.y', page.y, 'offset.y', offset.y, 'rect.top', rect.top);\n\t\t}\n\t\tEvent.prototype = {\n\t\t\tgetPage: getPage,\n\t\t\tgetWidth: getWidth,\n\t\t\tgetHeight: getHeight,\n\t\t\tstop: stop,\n\t\t};\n\n\t\tfunction getWidth() {\n\t\t\tif (self.innerWidth) {\n\t\t\t\treturn self.innerWidth;\n\t\t\t}\n\t\t\tvar documentNode = Utils.getDocumentNode();\n\t\t\treturn documentNode.clientWidth;\n\t\t\t/*\n\t\t\tif ($document.documentElement && $document.documentElement.clientWidth) {\n\t\t\t\treturn $document.documentElement.clientWidth;\n\t\t\t}\n\t\t\tif ($document.body) {\n\t\t\t\treturn $document.body.clientWidth;\n            }\n            */\n\t\t}\n\n\t\tfunction getHeight() {\n\t\t\tif (self.innerHeight) {\n\t\t\t\treturn self.innerHeight;\n\t\t\t}\n\t\t\tvar documentNode = Utils.getDocumentNode();\n\t\t\treturn documentNode.clientHeight;\n\t\t\t/*\n            if ($document.documentElement && $document.documentElement.clientHeight) {\n\t\t\t\treturn $document.documentElement.clientHeight;\n\t\t\t}\n\t\t\tif ($document.body) {\n\t\t\t\treturn $document.body.clientHeight;\n            }\n            */\n\t\t}\n\n\t\tfunction getPage(e) {\n\t\t\tvar standardEvents = ['click', 'mousedown', 'mouseup', 'mousemove', 'mouseover', 'mouseout', 'mouseenter', 'mouseleave', 'contextmenu'];\n\t\t\tvar touchEvents = ['touchstart', 'touchmove', 'touchend', 'touchcancel'];\n\t\t\tvar page = null;\n\t\t\tif (touchEvents.indexOf(e.type) !== -1) {\n\t\t\t\tvar t = null;\n\t\t\t\tvar event = e.originalEvent ? e.originalEvent : e;\n\t\t\t\tvar touches = event.touches.length ? event.touches : event.changedTouches;\n\t\t\t\tif (touches && touches.length) {\n\t\t\t\t\tt = touches[0];\n\t\t\t\t}\n\t\t\t\tif (t) {\n\t\t\t\t\tpage = {\n\t\t\t\t\t\tx: t.pageX,\n\t\t\t\t\t\ty: t.pageY,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t} else if (standardEvents.indexOf(e.type) !== -1) {\n\t\t\t\tpage = {\n\t\t\t\t\tx: e.pageX,\n\t\t\t\t\ty: e.pageY,\n\t\t\t\t};\n\t\t\t}\n\t\t\tthis.type = e.type;\n\t\t\treturn page;\n\t\t}\n\n\t\tfunction stop() {\n\t\t\tthis.originalEvent.stopPropagation();\n\t\t\tthis.originalEvent.preventDefault();\n\t\t}\n\n\t\tfunction Events(element) {\n\t\t\tvar events = this;\n\n\t\t\tthis.element = element;\n\t\t\tthis.listeners = {};\n\t\t\tthis.standardEvents = {\n\t\t\t\tclick: {\n\t\t\t\t\tkey: 'click',\n\t\t\t\t\tcallback: onClick\n\t\t\t\t},\n\t\t\t\tdown: {\n\t\t\t\t\tkey: 'mousedown',\n\t\t\t\t\tcallback: onMouseDown\n\t\t\t\t},\n\t\t\t\tmove: {\n\t\t\t\t\tkey: 'mousemove',\n\t\t\t\t\tcallback: onMouseMove\n\t\t\t\t},\n\t\t\t\tup: {\n\t\t\t\t\tkey: 'mouseup',\n\t\t\t\t\tcallback: onMouseUp\n\t\t\t\t},\n\t\t\t\tresize: {\n\t\t\t\t\tkey: 'resize',\n\t\t\t\t\tcallback: onResize\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.touchEvents = {\n\t\t\t\tdown: {\n\t\t\t\t\tkey: 'touchstart',\n\t\t\t\t\tcallback: onTouchStart\n\t\t\t\t},\n\t\t\t\tmove: {\n\t\t\t\t\tkey: 'touchmove',\n\t\t\t\t\tcallback: onTouchMove\n\t\t\t\t},\n\t\t\t\tup: {\n\t\t\t\t\tkey: 'touchend',\n\t\t\t\t\tcallback: onTouchEnd\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.wheelEvents = {\n\t\t\t\twheel: {\n\t\t\t\t\tkey: 'mousewheel',\n\t\t\t\t\tcallback: onMouseWheel\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.scrollEvents = {\n\t\t\t\twheel: {\n\t\t\t\t\tkey: 'DOMMouseScroll',\n\t\t\t\t\tcallback: onMouseScroll\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.timestamp = new Date().getTime();\n\t\t\tthis.setTimestamp = setTimestamp;\n\n\t\t\tfunction setTimestamp(event) {\n\t\t\t\tif (event) {\n\t\t\t\t\tevent.interval = Math.min(250, event.timestamp - events.timestamp);\n\t\t\t\t\t// console.log(event.interval, event.timestamp, events.timestamp);\n\t\t\t\t}\n\t\t\t\tevents.timestamp = new Date().getTime();\n\t\t\t}\n\n\t\t\tfunction onClick(e) {\n\t\t\t\t// console.log('onClick', e, events);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.click.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onMouseDown(e) {\n\t\t\t\t// console.log('onMouseDown', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.down.apply(this, [event]);\n\t\t\t\tevents.removeTouchEvents();\n\t\t\t}\n\n\t\t\tfunction onMouseMove(e) {\n\t\t\t\t// console.log('onMouseMove', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.move.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onMouseUp(e) {\n\t\t\t\t// console.log('onMouseUp', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.up.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onMouseWheel(e) {\n\t\t\t\t// console.log('onMouseWheel', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.wheel.apply(this, [event]);\n\t\t\t\tevents.removeScrollEvents();\n\t\t\t}\n\n\t\t\tfunction onMouseScroll(e) {\n\t\t\t\t// console.log('onMouseScroll', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.wheel.apply(this, [event]);\n\t\t\t\tevents.removeWheelEvents();\n\t\t\t}\n\n\t\t\tfunction onResize(e) {\n\t\t\t\t// console.log('onResize', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.resize.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onTouchStart(e) {\n\t\t\t\t// console.log('onTouchStart', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.down.apply(this, [event]);\n\t\t\t\tevents.removeStandardEvents();\n\t\t\t}\n\n\t\t\tfunction onTouchMove(e) {\n\t\t\t\t// console.log('onTouchMove', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.move.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onTouchEnd(e) {\n\t\t\t\t// console.log('onTouchEnd', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.up.apply(this, [event]);\n\t\t\t}\n\t\t}\n\t\tEvents.prototype = {\n\t\t\tadd: add,\n\t\t\tremove: remove,\n\t\t\tremoveStandardEvents: removeStandardEvents,\n\t\t\tremoveTouchEvents: removeTouchEvents,\n\t\t\tremoveWheelEvents: removeWheelEvents,\n\t\t\tremoveScrollEvents: removeScrollEvents,\n\t\t};\n\t\treturn Events;\n\n\t\tfunction getNode(element) {\n\t\t\treturn element.length ? element[0] : element;\n\t\t}\n\n\t\tfunction getElement(element) {\n\t\t\treturn element.length ? element : angular.element(element);\n\t\t}\n\n\t\tfunction add(listeners, scope) {\n\t\t\tvar events = this,\n\t\t\t\tstandard = this.standardEvents,\n\t\t\t\ttouch = this.touchEvents,\n\t\t\t\twheel = this.wheelEvents,\n\t\t\t\tscroll = this.scrollEvents;\n\t\t\tvar element = getElement(this.element),\n\t\t\t\twindowElement = angular.element($window);\n\n\t\t\tangular.forEach(listeners, function (callback, key) {\n\t\t\t\tif (events.listeners[key]) {\n\t\t\t\t\tvar listener = {};\n\t\t\t\t\tlistener[key] = events.listeners[key];\n\t\t\t\t\tremove(listener);\n\t\t\t\t}\n\t\t\t\tevents.listeners[key] = callback;\n\t\t\t\tif (standard[key]) {\n\t\t\t\t\tif (key === 'resize') {\n\t\t\t\t\t\twindowElement.on(standard[key].key, standard[key].callback);\n\t\t\t\t\t} else {\n\t\t\t\t\t\telement.on(standard[key].key, standard[key].callback);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (touch[key]) {\n\t\t\t\t\telement.on(touch[key].key, touch[key].callback);\n\t\t\t\t}\n\t\t\t\tif (wheel[key]) {\n\t\t\t\t\telement.on(wheel[key].key, wheel[key].callback);\n\t\t\t\t}\n\t\t\t\tif (scroll[key]) {\n\t\t\t\t\telement.on(scroll[key].key, scroll[key].callback);\n\t\t\t\t}\n\t\t\t\t// console.log('add', key, element);\n\t\t\t});\n\n\t\t\tif (scope) {\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tevents.remove(listeners);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn events;\n\t\t}\n\n\t\tfunction remove(listeners) {\n\t\t\tvar events = this,\n\t\t\t\tstandard = this.standardEvents,\n\t\t\t\ttouch = this.touchEvents,\n\t\t\t\twheel = this.wheelEvents,\n\t\t\t\tscroll = this.scrollEvents;\n\t\t\tvar element = getElement(this.element),\n\t\t\t\twindowElement = angular.element($window);\n\t\t\tangular.forEach(listeners, function (callback, key) {\n\t\t\t\tif (standard[key]) {\n\t\t\t\t\tif (key === 'resize') {\n\t\t\t\t\t\twindowElement.off(standard[key].key, standard[key].callback);\n\t\t\t\t\t} else {\n\t\t\t\t\t\telement.off(standard[key].key, standard[key].callback);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (touch[key]) {\n\t\t\t\t\telement.off(touch[key].key, touch[key].callback);\n\t\t\t\t}\n\t\t\t\tif (wheel[key]) {\n\t\t\t\t\telement.off(wheel[key].key, wheel[key].callback);\n\t\t\t\t}\n\t\t\t\tif (scroll[key]) {\n\t\t\t\t\telement.off(scroll[key].key, scroll[key].callback);\n\t\t\t\t}\n\t\t\t\tevents.listeners[key] = null;\n\t\t\t});\n\t\t\treturn events;\n\t\t}\n\n\t\tfunction removeStandardEvents() {\n\t\t\tvar events = this,\n\t\t\t\tstandard = events.standardEvents,\n\t\t\t\ttouch = events.touchEvents;\n\t\t\tvar element = getElement(events.element);\n\t\t\telement.off('mousedown', standard.down.callback);\n\t\t\telement.off('mousemove', standard.move.callback);\n\t\t\telement.off('mouseup', standard.up.callback);\n\t\t}\n\n\t\tfunction removeTouchEvents() {\n\t\t\tvar events = this,\n\t\t\t\tstandard = events.standardEvents,\n\t\t\t\ttouch = events.touchEvents;\n\t\t\tvar element = getElement(events.element);\n\t\t\telement.off('touchstart', touch.down.callback);\n\t\t\telement.off('touchmove', touch.move.callback);\n\t\t\telement.off('touchend', touch.up.callback);\n\t\t}\n\n\t\tfunction removeWheelEvents() {\n\t\t\tvar events = this;\n\t\t\tvar element = getElement(events.element);\n\t\t\telement.off('mousewheel', events.mouseEvents.wheel.callback);\n\t\t}\n\n\t\tfunction removeScrollEvents() {\n\t\t\tvar events = this;\n\t\t\tvar element = getElement(events.element);\n\t\t\telement.off('DOMMouseScroll', events.scrollEvents.wheel.callback);\n\t\t}\n\n    }]);\n\n\tapp.service('EventsService', ['$window', 'Utils', function ($window, Utils) {\n\n\t\tvar service = this;\n\n\t\tservice.hasPassiveEvents = hasPassiveEvents;\n\t\tservice.addEventListener = getAddEventListener();\n\n\t\tpreventHistoryNavigation();\n\n\t\tfunction hasPassiveEvents() {\n\t\t\tvar supported = false;\n\t\t\tif ($window.addEventListener) {\n\t\t\t\ttry {\n\t\t\t\t\tvar options = Object.defineProperty({}, 'passive', {\n\t\t\t\t\t\tget: function () {\n\t\t\t\t\t\t\tsupported = true;\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\t$window.addEventListener('test', null, options);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log('getAddEventListener.isSupprted', e);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn supported;\n\t\t}\n\n\t\tfunction getAddEventListener() {\n\t\t\tvar supported = hasPassiveEvents();\n\t\t\tif (!supported) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar defaults = {\n\t\t\t\tpassive: false,\n\t\t\t\tcapture: false,\n\t\t\t};\n\n\t\t\tfunction getModifiedAddEventListener(original) {\n\t\t\t\tfunction addEventListener(type, listener, options) {\n\t\t\t\t\tif (options === true) {\n\t\t\t\t\t\toptions = angular.copy(defaults);\n\t\t\t\t\t\toptions.capture = true;\n\t\t\t\t\t} else if (options === undefined) {\n\t\t\t\t\t\toptions = angular.copy(defaults);\n\t\t\t\t\t}\n\t\t\t\t\toptions.passive = options.passive !== undefined ? options.passive : defaults.passive;\n\t\t\t\t\toptions.capture = options.capture !== undefined ? options.capture : defaults.capture;\n\t\t\t\t\t// console.log(type, options);\n\t\t\t\t\t/*\n\t\t\t\t\tvar usesListenerOptions = typeof options === 'object';\n\t\t\t\t\toptions = usesListenerOptions ? options : {};\n\t\t\t\t\tvar descriptor = Object.getOwnPropertyDescriptor(options, 'passive');\n\t\t\t\t\tif (!descriptor || descriptor.writable) {\n\t\t\t\t\t\tvar capture = usesListenerOptions ? options.capture : options;\n\t\t\t\t\t\toptions.passive = options.passive !== undefined ? options.passive : defaults.passive;\n\t\t\t\t\t\toptions.capture = capture !== undefined ? capture : defaults.capture;\n\t\t\t\t\t\t// console.log(this, type);\n\t\t\t\t\t}\n\t\t\t\t\t*/\n\t\t\t\t\toriginal.call(this, type, listener, options);\n\t\t\t\t}\n\t\t\t\treturn addEventListener;\n\t\t\t}\n\n\t\t\tvar original = EventTarget.prototype.addEventListener;\n\t\t\tvar modified = getModifiedAddEventListener(original);\n\n\t\t\tEventTarget.prototype.addEventListener = modified;\n\n\t\t\treturn modified;\n\t\t}\n\n\t\tfunction preventHistoryNavigation() {\n\t\t\tif (!Utils.ua.mac) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (Utils.ua.chrome || Utils.ua.safari || Utils.ua.firefox) {\n\t\t\t\t$window.addEventListener('mousewheel', onScroll, {\n\t\t\t\t\tpassive: false\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction onScroll(e) {\n\t\t\t\tif (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\t(e.deltaX < 0 && (Utils.getParents(e.target).filter(function (node) {\n\t\t\t\t\t\treturn node.scrollLeft > 0;\n\t\t\t\t\t}).length === 0)) ||\n\t\t\t\t\t(e.deltaX > 0 && (Utils.getParents(e.target).filter(function (node) {\n\t\t\t\t\t\treturn node.scrollWidth - node.scrollLeft > node.clientWidth;\n\t\t\t\t\t}).length === 0))\n\t\t\t\t) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n    }]);\n\n}());\n/* global angular, app, Autolinker */\r\n(function () {\r\n\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.filter('notIn', ['$filter', function ($filter) {\r\n\t\treturn function (array, filters, element) {\r\n\t\t\tif (filters) {\r\n\t\t\t\treturn $filter(\"filter\")(array, function (item) {\r\n\t\t\t\t\tfor (var i = 0; i < filters.length; i++) {\r\n\t\t\t\t\t\tif (filters[i][element] === item[element]) return false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n    }]);\r\n\r\n}());\r\n\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Point', [function () {\n\t\tfunction Point(x, y) {\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\t\t}\n\t\tPoint.mult = function (point, value) {\n\t\t\tpoint.x *= value;\n\t\t\tpoint.y *= value;\n\t\t\treturn point;\n\t\t};\n\t\tPoint.prototype = {\n\t\t\tmult: function (value) {\n\t\t\t\treturn Point.mult(this, value);\n\t\t\t},\n\t\t\toffset: function (x, y) {\n\t\t\t\tthis.x += x;\n\t\t\t\tthis.y += y;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetX: function (x) {\n\t\t\t\tthis.x = x;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetY: function (y) {\n\t\t\t\tthis.y = y;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetPos: function (x, y) {\n\t\t\t\tthis.x = x;\n\t\t\t\tthis.y = y;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tcopy: function (point) {\n\t\t\t\tthis.x = point.x;\n\t\t\t\tthis.y = point.y;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tclone: function () {\n\t\t\t\treturn new Point(this.x, this.y);\n\t\t\t},\n\t\t\ttoString: function () {\n\t\t\t\treturn '{' + this.x + ',' + this.y + '}';\n\t\t\t},\n\t\t};\n\t\treturn Point;\n    }]);\n\n}());\n\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Rect', [function () {\n\t\tfunction Rect(x, y, w, h) {\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\t\t\tthis.w = w || 0;\n\t\t\tthis.h = h || 0;\n\t\t}\n\t\tRect.mult = function (rect, value) {\n\t\t\trect.x *= value;\n\t\t\trect.y *= value;\n\t\t\trect.w *= value;\n\t\t\trect.h *= value;\n\t\t\treturn rect;\n\t\t};\n\t\tRect.prototype = {\n\t\t\tmult: function (value) {\n\t\t\t\treturn Rect.mult(this, value);\n\t\t\t},\n\t\t\toffset: function (x, y) {\n\t\t\t\tthis.x += x;\n\t\t\t\tthis.y += y;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\treduce: function (size) {\n\t\t\t\treturn this.offset(-size);\n\t\t\t},\n\t\t\treduceRect: function (rect) {\n\t\t\t\treturn this.offsetRect(Rect.mult(rect, -1));\n\t\t\t},\n\t\t\texpandRect: function (rect) {\n\t\t\t\tthis.x -= rect.x || 0;\n\t\t\t\tthis.y -= rect.y || 0;\n\t\t\t\tthis.w += rect.w || 0;\n\t\t\t\tthis.h += rect.h || 0;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\texpand: function (size) {\n\t\t\t\treturn this.expandRect({\n\t\t\t\t\tx: size,\n\t\t\t\t\ty: size,\n\t\t\t\t\tw: size * 2,\n\t\t\t\t\th: size * 2\n\t\t\t\t});\n\t\t\t},\n\t\t\tintersect: function (rect) {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn !(rect.x > x + w || rect.x + rect.w < x || rect.y > y + h || rect.y + rect.h < y);\n\t\t\t},\n\t\t\ttop: function () {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn {\n\t\t\t\t\tx: x + w / 2,\n\t\t\t\t\ty: y\n\t\t\t\t};\n\t\t\t},\n\t\t\tright: function () {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn {\n\t\t\t\t\tx: x + w,\n\t\t\t\t\ty: y + h / 2\n\t\t\t\t};\n\t\t\t},\n\t\t\tbottom: function () {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn {\n\t\t\t\t\tx: x + w / 2,\n\t\t\t\t\ty: y + h\n\t\t\t\t};\n\t\t\t},\n\t\t\tleft: function () {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn {\n\t\t\t\t\tx: x,\n\t\t\t\t\ty: y + h / 2\n\t\t\t\t};\n\t\t\t},\n\t\t\tcenter: function () {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn {\n\t\t\t\t\tx: x + w / 2,\n\t\t\t\t\ty: y + h / 2\n\t\t\t\t};\n\t\t\t},\n\t\t\ttopLeft: function () {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn {\n\t\t\t\t\tx: x,\n\t\t\t\t\ty: y\n\t\t\t\t};\n\t\t\t},\n\t\t\ttopRight: function () {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn {\n\t\t\t\t\tx: x + w,\n\t\t\t\t\ty: y\n\t\t\t\t};\n\t\t\t},\n\t\t\tbottomRight: function () {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn {\n\t\t\t\t\tx: x + w,\n\t\t\t\t\ty: y + h\n\t\t\t\t};\n\t\t\t},\n\t\t\tbottomLeft: function () {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn {\n\t\t\t\t\tx: x,\n\t\t\t\t\ty: y + h\n\t\t\t\t};\n\t\t\t},\n\t\t\tsetX: function (x) {\n\t\t\t\tthis.x = x;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetY: function (y) {\n\t\t\t\tthis.y = y;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetW: function (w) {\n\t\t\t\tthis.w = w;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetH: function (h) {\n\t\t\t\tthis.h = h;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetPos: function (x, y) {\n\t\t\t\tthis.x = x;\n\t\t\t\tthis.y = y;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetSize: function (w, h) {\n\t\t\t\tthis.w = w;\n\t\t\t\tthis.h = h;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tcopy: function (rect) {\n\t\t\t\tthis.x = rect.x;\n\t\t\t\tthis.y = rect.y;\n\t\t\t\tthis.w = rect.w;\n\t\t\t\tthis.h = rect.h;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tclone: function () {\n\t\t\t\treturn new Rect(this.x, this.y, this.w, this.h);\n\t\t\t},\n\t\t\ttoString: function () {\n\t\t\t\treturn '{' + this.x + ',' + this.y + ',' + this.w + ',' + this.h + '}';\n\t\t\t},\n\t\t};\n\t\treturn Rect;\n    }]);\n\n}());\n\n/* global angular, firebase */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('Vector', function() {\n        function Vector(x, y) {\n            this.x = x || 0;\n            this.y = y || 0;\n        }\n        Vector.make = function(a, b) {\n            return new Vector(b.x - a.x, b.y - a.y);\n        };\n        Vector.size = function(a) {\n            return Math.sqrt(a.x * a.x + a.y * a.y);\n        };\n        Vector.normalize = function(a) {\n            var l = Vector.size(a);\n            a.x /= l;\n            a.y /= l;\n            return a;\n        };\n        Vector.incidence = function(a, b) {\n            var angle = Math.atan2(b.y, b.x) - Math.atan2(a.y, a.x);\n            // if (angle < 0) angle += 2 * Math.PI;\n            // angle = Math.min(angle, (Math.PI * 2 - angle));\n            return angle;\n        };\n        Vector.distance = function(a, b) {\n            return Math.sqrt((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));\n        };\n        Vector.cross = function(a, b) {\n            return (a.x * b.y) - (a.y * b.x);\n        };\n        Vector.difference = function(a, b) {\n            return new Vector(a.x - b.x, a.y - b.y);\n        };\n        Vector.power = function(a, b) {\n            var x = Math.abs(b.x - a.x);\n            var y = Math.abs(b.y - a.y);\n            return (x + y) / 2;\n        };\n        Vector.prototype = {\n            size: function() {\n                return Vector.size(this);\n            },\n            normalize: function() {\n                return Vector.normalize(this);\n            },\n            incidence: function(b) {\n                return Vector.incidence(this, b);\n            },\n            cross: function(b) {\n                return Vector.cross(this, b);\n            },\n            distance: function(b) {\n                return Vector.distance(this, b);\n            },\n            difference: function(b) {\n                return Vector.difference(this, b);\n            },\n            power: function() {\n                return (Math.abs(this.x) + Math.abs(this.y)) / 2;\n            },\n            towards: function(b, friction) {\n                friction = friction || 0.125;\n                this.x += (b.x - this.x) * friction;\n                this.y += (b.y - this.y) * friction;\n                return this;\n            },\n            add: function(b) {\n                this.x += b.x;\n                this.y += b.y;\n                return this;\n            },\n            friction: function(b) {\n                this.x *= b;\n                this.y *= b;\n                return this;\n            },\n            copy: function(b) {\n                return new Vector(this.x, this.y);\n            },\n            toString: function() {\n                return '{' + this.x + ',' + this.y + '}';\n            },\n        };\n        return Vector;\n    });\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('Hash', [function() {\n        var pools = {};\n\n        function Hash(key, pool) {\n            key = key || 'id';\n            pool = pool ? Hash.get(pool) : {};\n            Object.defineProperties(this, {\n                key: {\n                    value: key,\n                    enumerable: false,\n                    writable: false\n                },\n                pool: {\n                    value: pool,\n                    enumerable: false,\n                    writable: false\n                },\n                length: {\n                    value: 0,\n                    enumerable: false,\n                    writable: true\n                }\n            });\n        }\n        Hash.get = function(pool) {\n            return (pools[pool] = pools[pool] || {});\n        };\n        Hash.prototype = new Array;\n        Hash.prototype.has = has;\n        Hash.prototype.getId = getId;\n        Hash.prototype.get = get;\n        Hash.prototype.set = set;\n        Hash.prototype.add = add;\n        Hash.prototype.remove = remove;\n        Hash.prototype.each = each;\n        Hash.prototype.addMany = addMany;\n        Hash.prototype.removeMany = removeMany;\n        Hash.prototype.removeAll = removeAll;\n        Hash.prototype.forward = forward;\n        Hash.prototype.backward = backward;\n        Hash.prototype.differs = differs;\n        Hash.prototype.updatePool = updatePool;\n        return Hash;\n\n        function has(id) {\n            return this.pool[id] !== undefined;\n        }\n\n        function getId(id) {\n            return this.pool[id];\n        }\n\n        function get(item) {\n            var hash = this,\n                key = this.key;\n            return item ? hash.getId(item[key]) : null;\n        }\n\n        function set(item) {\n            var hash = this,\n                pool = this.pool,\n                key = this.key;\n            pool[item[key]] = item;\n            hash.push(item);\n            return item;\n        }\n\n        function add(newItem) {\n            var hash = this;\n            var item = hash.get(newItem);\n            if (item) {\n                for (var i = 0, keys = Object.keys(newItem), p; i < keys.length; i++) {\n                    p = keys[i];\n                    item[p] = newItem[p];\n                }\n            } else {\n                item = hash.set(newItem);\n            }\n            return item;\n        }\n\n        function remove(oldItem) {\n            var hash = this,\n                pool = this.pool,\n                key = this.key;\n            var item = hash.get(oldItem);\n            if (item) {\n                var index = hash.indexOf(item);\n                if (index !== -1) {\n                    hash.splice(index, 1);\n                }\n                delete pool[item[key]];\n            }\n            return hash;\n        }\n\n        function addMany(items) {\n            var hash = this;\n            if (!items) {\n                return hash;\n            }\n            var i = 0;\n            while (i < items.length) {\n                hash.add(items[i]);\n                i++;\n            }\n            return hash;\n        }\n\n        function removeMany(items) {\n            var hash = this;\n            if (!items) {\n                return hash;\n            }\n            var i = 0;\n            while (i < items.length) {\n                hash.remove(items[i]);\n                i++;\n            }\n            return hash;\n        }\n\n        function removeAll() {\n            var hash = this,\n                key = hash.key,\n                pool = hash.pool;\n            var i = 0,\n                t = hash.length,\n                item;\n            while (hash.length) {\n                item = hash.shift();\n                delete pool[item[key]];\n                i++;\n            }\n            return hash;\n        }\n\n        function each(callback) {\n            var hash = this;\n            if (callback) {\n                var i = 0;\n                while (i < hash.length) {\n                    callback(hash[i], i);\n                    i++;\n                }\n            }\n            return hash;\n        }\n\n        function forward(key, reverse) {\n            var hash = this;\n            key = (key || this.key);\n            hash.sort(function(c, d) {\n                var a = reverse ? d : c;\n                var b = reverse ? c : d;\n                return a[key] - b[key];\n            });\n            return hash;\n        }\n\n        function backward(key) {\n            return this.forward(key, true);\n        }\n\n        function differs(hash) {\n            if (hash.key !== this.key || hash.length !== this.length) {\n                return true;\n            } else {\n                var differs = false,\n                    i = 0,\n                    t = this.length,\n                    key = this.key;\n                while (differs && i < t) {\n                    differs = this[i][key] !== hash[i][key];\n                    i++;\n                }\n            }\n        }\n\n        function updatePool() {\n            var hash = this,\n                pool = this.pool,\n                key = this.key;\n            Object.keys(pool).forEach(function(key) {\n                delete pool[key];\n            });\n            angular.forEach(hash, function(item) {\n                pool[item[key]] = item;\n            });\n        }\n\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('$promise', ['$q', function($q) {\n        function $promise(callback) {\n            if (typeof callback !== 'function') {\n                throw ('promise resolve callback missing');\n            }\n            var deferred = $q.defer();\n            callback(deferred);\n            return deferred.promise;\n        }\n        var statics = {\n            all: function(promises) {\n                return $q.all(promises);\n            },\n        };\n        angular.extend($promise, statics);\n        return $promise;\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('State', ['$timeout', function($timeout) {\n        var DELAY = 2000;\n\n        function State() {\n            this.errors = [];\n            this.isReady = false;\n            this.idle();\n        }\n\n        State.prototype = {\n            idle: function() {\n                var state = this;\n                state.isBusy = false;\n                state.isError = false;\n                state.isErroring = false;\n                state.isSuccess = false;\n                state.isSuccessing = false;\n                state.button = null;\n                state.errors = [];\n            },\n            busy: function() {\n                var state = this;\n                if (!state.isBusy) {\n                    state.isBusy = true;\n                    state.isError = false;\n                    state.isErroring = false;\n                    state.isSuccess = false;\n                    state.isSuccessing = false;\n                    state.errors = [];\n                    return true;\n                } else {\n                    return false;\n                }\n            },\n            error: function error(error) {\n                console.log('State.error', error);\n                var state = this;\n                state.isBusy = false;\n                state.isError = true;\n                state.isErroring = true;\n                state.isSuccess = false;\n                state.isSuccessing = false;\n                state.errors.push(error);\n                $timeout(function() {\n                    state.isErroring = false;\n                }, DELAY);\n            },\n            ready: function ready() {\n                var state = this;\n                state.idle();\n                state.isReady = true;\n            },\n            success: function success() {\n                var state = this;\n                state.isBusy = false;\n                state.isError = false;\n                state.isErroring = false;\n                state.isSuccess = true;\n                state.isSuccessing = true;\n                state.errors = [];\n                $timeout(function() {\n                    state.isSuccessing = false;\n                }, DELAY);\n            },\n            enabled: function enabled() {\n                var state = this;\n                return !state.isBusy && !state.isErroring && !state.isSuccessing;\n            },\n            errorMessage: function errorMessage() {\n                var state = this;\n                return state.isError ? state.errors[state.errors.length - 1] : null;\n            },\n            submitClass: function submitClass() {\n                var state = this;\n                return {\n                    busy: state.isBusy,\n                    ready: state.isReady,\n                    successing: state.isSuccessing,\n                    success: state.isSuccess,\n                    errorring: state.isErroring,\n                    error: state.isError,\n                };\n            },\n            labels: function labels(addons) {\n                var state = this;\n                var defaults = {\n                    ready: 'submit',\n                    busy: 'sending',\n                    error: 'error',\n                    success: 'success',\n                };\n                if (addons) {\n                    angular.extend(defaults, addons);\n                }\n                var label = defaults.ready;\n                if (state.isBusy) {\n                    label = defaults.busy;\n                } else if (state.isSuccess) {\n                    label = defaults.success;\n                } else if (state.isError) {\n                    label = defaults.error;\n                }\n                return label;\n            },\n            classes: function classes(addons) {\n                var state = this,\n                    classes = null;\n                classes = {\n                    ready: state.isReady,\n                    busy: state.isBusy,\n                    successing: state.isSuccessing,\n                    success: state.isSuccess,\n                    errorring: state.isErroring,\n                    error: state.isError,\n                };\n                if (addons) {\n                    angular.forEach(addons, function(value, key) {\n                        classes[value] = classes[key];\n                    });\n                }\n                return classes;\n            }\n        };\n\n        return State;\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar transformProperty = detectTransformProperty();\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Style', [function () {\n\t\tfunction Style() {\n\t\t\tthis.props = {\n\t\t\t\tscale: 1,\n\t\t\t\thoverScale: 1,\n\t\t\t\tcurrentScale: 1,\n\t\t\t};\n\t\t}\n\n\t\tStyle.prototype = {\n\t\t\tset: function (element) {\n\t\t\t\tvar styles = [];\n\t\t\t\tfor (var key in this) {\n\t\t\t\t\tif (key !== 'props') {\n\t\t\t\t\t\tstyles.push(key + ':' + this[key]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telement.style.cssText = styles.join(';') + ';';\n\t\t\t},\n\t\t\ttransform: function (transform) {\n\t\t\t\tthis[transformProperty] = transform;\n\t\t\t},\n\t\t\ttransformOrigin: function (x, y) {\n\t\t\t\tthis[transformProperty + '-origin-x'] = (Math.round(x * 1000) / 1000) + '%';\n\t\t\t\tthis[transformProperty + '-origin-y'] = (Math.round(y * 1000) / 1000) + '%';\n\t\t\t},\n\t\t};\n\n\t\treturn Style;\n    }]);\n\n\tfunction detectTransformProperty() {\n\t\tvar transformProperty = 'transform',\n\t\t\tsafariPropertyHack = 'webkitTransform';\n\t\tvar div = document.createElement(\"DIV\");\n\t\tif (typeof div.style[transformProperty] !== 'undefined') {\n            ['webkit', 'moz', 'o', 'ms'].every(function (prefix) {\n\t\t\t\tvar e = '-' + prefix + '-transform';\n\t\t\t\tif (typeof div.style[e] !== 'undefined') {\n\t\t\t\t\ttransformProperty = e;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t} else if (typeof div.style[safariPropertyHack] !== 'undefined') {\n\t\t\ttransformProperty = '-webkit-transform';\n\t\t} else {\n\t\t\ttransformProperty = undefined;\n\t\t}\n\t\treturn transformProperty;\n\t}\n\n}());\n\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.service('Utils', ['$compile', '$controller', 'Vector', function ($compile, $controller, Vector) {\n\n\t\tthis.ua = getUA();\n\t\tthis.reverseSortOn = reverseSortOn;\n\t\tthis.getTouch = getTouch;\n\t\tthis.getRelativeTouch = getRelativeTouch;\n\t\tthis.getClosest = getClosest;\n\t\tthis.getClosestElement = getClosestElement;\n\t\tthis.getParents = getParents;\n\t\tthis.getDocumentNode = getDocumentNode;\n\t\tthis.indexOf = indexOf;\n\t\tthis.removeValue = removeValue;\n\t\tthis.throttle = throttle;\n\t\tthis.where = where;\n\t\tthis.format = format;\n\t\tthis.compileController = compileController;\n\t\tthis.reducer = reducer;\n\t\tthis.reducerSetter = reducerSetter;\n\t\tthis.reducerAdder = reducerAdder;\n\t\tthis.downloadFile = downloadFile;\n\t\tthis.serverDownload = serverDownload;\n\t\tthis.toMd5 = toMd5;\n\n\t\tvar getNow = Date.now || function () {\n\t\t\treturn new Date().getTime();\n\t\t};\n\n\t\tfunction getUA() {\n\t\t\tvar agent = window.navigator.userAgent.toLowerCase();\n\t\t\tvar safari = agent.indexOf('safari') !== -1 && agent.indexOf('chrome') === -1;\n\t\t\tvar msie = agent.indexOf('trident') !== -1 || agent.indexOf('edge') !== -1 || agent.indexOf('msie') !== -1;\n\t\t\tvar chrome = !safari && !msie && agent.indexOf('chrome') !== -1;\n\t\t\tvar mobile = agent.indexOf('mobile') !== -1;\n\t\t\tvar mac = agent.indexOf('macintosh') !== -1;\n\t\t\tvar ua = {\n\t\t\t\tagent: agent,\n\t\t\t\tsafari: safari,\n\t\t\t\tmsie: msie,\n\t\t\t\tchrome: chrome,\n\t\t\t\tmobile: mobile,\n\t\t\t\tmac: mac,\n\t\t\t};\n\t\t\tangular.forEach(ua, function (value, key) {\n\t\t\t\tif (value) {\n\t\t\t\t\tangular.element(document.getElementsByTagName('body')).addClass(key);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ua;\n\t\t}\n\n\t\tfunction toMd5(string) {\n\t\t\t// return Md5.encode(string);\n\t\t}\n\n\t\tvar _isTouch;\n\n\t\tfunction isTouch() {\n\t\t\tif (!_isTouch) {\n\t\t\t\t_isTouch = {\n\t\t\t\t\tvalue: ('ontouchstart' in window || 'onmsgesturechange' in window)\n\t\t\t\t};\n\t\t\t}\n\t\t\t// console.log(_isTouch);\n\t\t\treturn _isTouch.value;\n\t\t}\n\n\t\tfunction getTouch(e, previous) {\n\t\t\tvar t = new Vector();\n\t\t\tif (e.type === 'touchstart' || e.type === 'touchmove' || e.type === 'touchend' || e.type === 'touchcancel') {\n\t\t\t\tvar touch = null;\n\t\t\t\tvar event = e.originalEvent ? e.originalEvent : e;\n\t\t\t\tvar touches = event.touches.length ? event.touches : event.changedTouches;\n\t\t\t\tif (touches && touches.length) {\n\t\t\t\t\ttouch = touches[0];\n\t\t\t\t}\n\t\t\t\tif (touch) {\n\t\t\t\t\tt.x = touch.pageX;\n\t\t\t\t\tt.y = touch.pageY;\n\t\t\t\t}\n\t\t\t} else if (e.type === 'click' || e.type === 'mousedown' || e.type === 'mouseup' || e.type === 'mousemove' || e.type === 'mouseover' || e.type === 'mouseout' || e.type === 'mouseenter' || e.type === 'mouseleave' || e.type === 'contextmenu') {\n\t\t\t\tt.x = e.pageX;\n\t\t\t\tt.y = e.pageY;\n\t\t\t}\n\t\t\tif (previous) {\n\t\t\t\tt.s = Vector.difference(t, previous);\n\t\t\t}\n\t\t\tt.type = e.type;\n\t\t\treturn t;\n\t\t}\n\n\t\tfunction getRelativeTouch(node, point) {\n\t\t\tvar element = angular.element(node); // passing through jqlite for accepting both\n\t\t\tnode = element[0];\n\t\t\tvar rect = node.getBoundingClientRect();\n\t\t\t// var e = new Vector(rect.left + node.scrollLeft, rect.top + node.scrollTop);\n\t\t\tvar e = new Vector(rect.left, rect.top);\n\t\t\treturn Vector.difference(point, e);\n\t\t}\n\n\t\tfunction getClosest(el, selector) {\n\t\t\tvar matchesFn, parent;\n            ['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector', 'oMatchesSelector'].some(function (fn) {\n\t\t\t\tif (typeof document.body[fn] == 'function') {\n\t\t\t\t\tmatchesFn = fn;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t\tif (el[matchesFn](selector)) {\n\t\t\t\treturn el;\n\t\t\t}\n\t\t\twhile (el !== null) {\n\t\t\t\tparent = el.parentElement;\n\t\t\t\tif (parent !== null && parent[matchesFn](selector)) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tel = parent;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tfunction getClosestElement(el, target) {\n\t\t\tvar matchesFn, parent;\n\t\t\tif (el === target) {\n\t\t\t\treturn el;\n\t\t\t}\n\t\t\twhile (el !== null) {\n\t\t\t\tparent = el.parentElement;\n\t\t\t\tif (parent !== null && parent === target) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tel = parent;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tfunction getDocumentNode() {\n\t\t\tvar documentNode = (document.documentElement || document.body.parentNode || document.body);\n\t\t\treturn documentNode;\n\t\t}\n\n\t\tfunction getParents(node, topParentNode) {\n\t\t\t// if no topParentNode defined will bubble up all the way to *document*\n\t\t\ttopParentNode = topParentNode || getDocumentNode();\n\t\t\tvar parents = [];\n\t\t\tif (node) {\n\t\t\t\tparents.push(node);\n\t\t\t\tvar parentNode = node.parentNode;\n\t\t\t\twhile (parentNode !== topParentNode) {\n\t\t\t\t\tparents.push(parentNode);\n\t\t\t\t\tparentNode = parentNode.parentNode;\n\t\t\t\t}\n\t\t\t\tparents.push(topParentNode); // push that topParentNode you wanted to stop at\n\t\t\t}\n\t\t\treturn parents;\n\t\t}\n\n\t\tfunction indexOf(array, object, key) {\n\t\t\tkey = key || 'id';\n\t\t\tvar index = -1;\n\t\t\tif (array) {\n\t\t\t\tvar i = 0,\n\t\t\t\t\tt = array.length;\n\t\t\t\twhile (i < t) {\n\t\t\t\t\tif (array[i] && array[i][key] === object[key]) {\n\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn index;\n\t\t}\n\n\t\tfunction removeValue(array, value) {\n\t\t\tvar index = -1;\n\t\t\tif (array) {\n\t\t\t\tvar i = 0,\n\t\t\t\t\tt = array.length;\n\t\t\t\twhile (i < t) {\n\t\t\t\t\tif (array[i] === value) {\n\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (index !== -1) {\n\t\t\t\tarray.splice(index, 1);\n\t\t\t\treturn value;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\tfunction throttle(func, wait, options) {\n\t\t\t// Returns a function, that, when invoked, will only be triggered at most once\n\t\t\t// during a given window of time. Normally, the throttled function will run\n\t\t\t// as much as it can, without ever going more than once per `wait` duration;\n\t\t\t// but if you'd like to disable the execution on the leading edge, pass\n\t\t\t// `{leading: false}`. To disable execution on the trailing edge, ditto.\n\t\t\tvar context, args, result;\n\t\t\tvar timeout = null;\n\t\t\tvar previous = 0;\n\t\t\tif (!options) options = {};\n\t\t\tvar later = function () {\n\t\t\t\tprevious = options.leading === false ? 0 : getNow();\n\t\t\t\ttimeout = null;\n\t\t\t\tresult = func.apply(context, args);\n\t\t\t\tif (!timeout) context = args = null;\n\t\t\t};\n\t\t\treturn function () {\n\t\t\t\tvar now = getNow();\n\t\t\t\tif (!previous && options.leading === false) previous = now;\n\t\t\t\tvar remaining = wait - (now - previous);\n\t\t\t\tcontext = this;\n\t\t\t\targs = arguments;\n\t\t\t\tif (remaining <= 0 || remaining > wait) {\n\t\t\t\t\tif (timeout) {\n\t\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\t\ttimeout = null;\n\t\t\t\t\t}\n\t\t\t\t\tprevious = now;\n\t\t\t\t\tresult = func.apply(context, args);\n\t\t\t\t\tif (!timeout) context = args = null;\n\t\t\t\t} else if (!timeout && options.trailing !== false) {\n\t\t\t\t\ttimeout = setTimeout(later, remaining);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t};\n\t\t}\n\n\t\tfunction where(array, query) {\n\t\t\tvar found = null;\n\t\t\tif (array) {\n\t\t\t\tangular.forEach(array, function (item) {\n\t\t\t\t\tvar has = true;\n\t\t\t\t\tangular.forEach(query, function (value, key) {\n\t\t\t\t\t\thas = has && item[key] === value;\n\t\t\t\t\t});\n\t\t\t\t\tif (has) {\n\t\t\t\t\t\tfound = item;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn found;\n\t\t}\n\n\t\tfunction compileController(scope, element, html, data) {\n\t\t\t// console.log('Utils.compileController', element);\n\t\t\telement.html(html);\n\t\t\tvar link = $compile(element.contents());\n\t\t\tif (data.controller) {\n\t\t\t\tvar $scope = scope.$new();\n\t\t\t\tangular.extend($scope, data);\n\t\t\t\tvar controller = $controller(data.controller, {\n\t\t\t\t\t$scope: $scope\n\t\t\t\t});\n\t\t\t\tif (data.controllerAs) {\n\t\t\t\t\tscope[data.controllerAs] = controller;\n\t\t\t\t}\n\t\t\t\telement.data('$ngControllerController', controller);\n\t\t\t\telement.children().data('$ngControllerController', controller);\n\t\t\t\tscope = $scope;\n\t\t\t}\n\t\t\tlink(scope);\n\t\t}\n\n\t\tfunction reverseSortOn(key) {\n\t\t\treturn function (a, b) {\n\t\t\t\tif (a[key] < b[key]) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\tif (a[key] > b[key]) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\t// a must be equal to b\n\t\t\t\treturn 0;\n\t\t\t};\n\t\t}\n\n\t\tfunction format(string, prepend, expression) {\n\t\t\tstring = string || '';\n\t\t\tprepend = prepend || '';\n\t\t\tvar splitted = string.split(',');\n\t\t\tif (splitted.length > 1) {\n\t\t\t\tvar formatted = splitted.shift();\n\t\t\t\tangular.forEach(splitted, function (value, index) {\n\t\t\t\t\tif (expression) {\n\t\t\t\t\t\tformatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tformatted = formatted.split('{' + index + '}').join(prepend + value);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (expression) {\n\t\t\t\t\treturn '\\'' + formatted + '\\'';\n\t\t\t\t} else {\n\t\t\t\t\treturn formatted;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn prepend + string;\n\t\t\t}\n\t\t}\n\n\t\tfunction reducer(o, key) {\n\t\t\treturn o[key];\n\t\t}\n\n\t\tfunction reducerSetter(o, key, value) {\n\t\t\tif (typeof key == 'string') {\n\t\t\t\treturn reducerSetter(o, key.split('.'), value);\n\t\t\t} else if (key.length == 1 && value !== undefined) {\n\t\t\t\treturn (o[key[0]] = value);\n\t\t\t} else if (key.length === 0) {\n\t\t\t\treturn o;\n\t\t\t} else {\n\t\t\t\treturn reducerSetter(o[key[0]], key.slice(1), value);\n\t\t\t}\n\t\t}\n\n\t\tfunction reducerAdder(o, key, value) {\n\t\t\tif (typeof key == 'string') {\n\t\t\t\treturn reducerAdder(o, key.split('.'), value);\n\t\t\t} else if (key.length == 1 && value !== undefined) {\n\t\t\t\treturn (o[key[0]] += value);\n\t\t\t} else if (key.length === 0) {\n\t\t\t\treturn o;\n\t\t\t} else {\n\t\t\t\treturn reducerAdder(o[key[0]], key.slice(1), value);\n\t\t\t}\n\t\t}\n\n\t\tfunction downloadFile(content, name, type) {\n\t\t\ttype = type || 'application/octet-stream';\n\t\t\tvar base64 = null;\n\t\t\tvar blob = new Blob([content], {\n\t\t\t\ttype: type\n\t\t\t});\n\t\t\tvar reader = new window.FileReader();\n\t\t\treader.readAsDataURL(blob);\n\t\t\treader.onloadend = function () {\n\t\t\t\tbase64 = reader.result;\n\t\t\t\tdownload();\n\t\t\t};\n\n\t\t\tfunction download() {\n\t\t\t\t// If in Chrome or Safari - download via virtual link click\n\t\t\t\t// if (isChrome || isSafari) {\n\t\t\t\t//Creating new link node.\n\t\t\t\tif (document.createEvent) {\n\t\t\t\t\tvar anchor = document.createElement('a');\n\t\t\t\t\tanchor.href = base64;\n\t\t\t\t\tif (anchor.download !== undefined) {\n\t\t\t\t\t\t//Set HTML5 download attribute. This will prevent file from opening if supported.\n\t\t\t\t\t\tvar downloadName = name || base64.substring(base64.lastIndexOf('/') + 1, base64.length);\n\t\t\t\t\t\tanchor.download = downloadName;\n\t\t\t\t\t}\n\t\t\t\t\t//Dispatching click event.\n\t\t\t\t\tvar event = document.createEvent('MouseEvents');\n\t\t\t\t\tevent.initEvent('click', true, true);\n\t\t\t\t\tanchor.dispatchEvent(event);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\t// }\n\t\t\t\t// Force file download (whether supported by server).\n\t\t\t\tvar query = '?download';\n\t\t\t\twindow.open(base64.indexOf('?') > -1 ? base64 : base64 + query, '_self');\n\t\t\t}\n\n\t\t\tfunction __download() {\n\t\t\t\tvar supportsDownloadAttribute = 'download' in document.createElement('a');\n\t\t\t\tif (supportsDownloadAttribute) {\n\t\t\t\t\tvar anchor = document.createElement('a');\n\t\t\t\t\tanchor.href = 'data:attachment/text;base64,' + encodeURI(window.btoa(content));\n\t\t\t\t\tanchor.target = '_blank';\n\t\t\t\t\tanchor.download = name;\n\t\t\t\t\t//Dispatching click event.\n\t\t\t\t\tif (document.createEvent) {\n\t\t\t\t\t\tvar event = document.createEvent('MouseEvents');\n\t\t\t\t\t\tevent.initEvent('click', true, true);\n\t\t\t\t\t\tanchor.dispatchEvent(event);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t} else if (window.Blob !== undefined && window.saveAs !== undefined) {\n\t\t\t\t\tvar blob = new Blob([content], {\n\t\t\t\t\t\ttype: type\n\t\t\t\t\t});\n\t\t\t\t\tsaveAs(blob, filename);\n\t\t\t\t} else {\n\t\t\t\t\twindow.open('data:attachment/text;charset=utf-8,' + encodeURI(content));\n\t\t\t\t}\n\t\t\t}\n\t\t\t/*\n\t\t\tvar headers = response.headers();\n\t\t\t// console.log(response);\n\t\t\tvar blob = new Blob([response.data], { type: \"application/octet-stream\" }); // { type: headers['content-type'] });\n\t\t\tvar windowUrl = (window.URL || window.webkitURL);\n\t\t\tvar downloadUrl = windowUrl.createObjectURL(blob);\n\t\t\tvar anchor = document.createElement(\"a\");\n\t\t\tanchor.href = downloadUrl;\n\t\t\tvar fileNamePattern = /filename[^;=\\n]*=((['\"]).*?\\2|[^;\\n]*)/;\n\t\t\tanchor.download = fileNamePattern.exec(headers['content-disposition'])[1];\n\t\t\tdocument.body.appendChild(anchor);\n\t\t\tanchor.click();\n\t\t\twindowUrl.revokeObjectURL(blob);\n\t\t\tanchor.remove();\n\t\t\t*/\n\t\t\t/*\n\t\t\t//Dispatching click event.\n\t\t\tif (document.createEvent) {\n\t\t\t    var e = document.createEvent('MouseEvents');\n\t\t\t    e.initEvent('click', true, true);\n\t\t\t    link.dispatchEvent(e);\n\t\t\t    return true;\n\t\t\t}\n\t\t\t*/\n\t\t}\n\n\t\tfunction serverDownload(options) {\n\t\t\tvar defaults = {\n\t\t\t\turi: '/api/reports/download',\n\t\t\t\tname: 'Filename',\n\t\t\t\textension: 'txt',\n\t\t\t\ttype: 'text/plain',\n\t\t\t\tcontent: 'Hello!',\n\t\t\t};\n\t\t\toptions = angular.extend(defaults, options);\n\t\t\tvar content = JSON.stringify(options); // unescape(encodeURIComponent(JSON.stringify(download)));\n\t\t\tvar form = document.createElement('form');\n\t\t\tvar input = document.createElement('input');\n\t\t\tinput.name = 'download';\n\t\t\tinput.value = content;\n\t\t\tform.appendChild(input);\n\t\t\tform.action = options.uri;\n\t\t\tform.method = 'POST';\n\t\t\tform.target = 'ProjectDownloads';\n\t\t\tform.enctype = 'application/x-www-form-urlencoded';\n\t\t\t// form.enctype = 'multipart/form-data';\n\t\t\t// form.enctype = 'text/plain';\n\t\t\tdocument.body.appendChild(form);\n\t\t\tform.submit();\n\t\t\tsetTimeout(function () {\n\t\t\t\tdocument.body.removeChild(form);\n\t\t\t}, 100);\n\t\t\t// angular.element(form).find('button')[0].click();\n\t\t\treturn Utils;\n\t\t}\n    }]);\n\n\t(function () {\n\t\t// POLYFILL Array.prototype.reduce\n\t\t// Production steps of ECMA-262, Edition 5, 15.4.4.21\n\t\t// Reference: http://es5.github.io/#x15.4.4.21\n\t\t// https://tc39.github.io/ecma262/#sec-array.prototype.reduce\n\t\tif (!Array.prototype.reduce) {\n\t\t\tObject.defineProperty(Array.prototype, 'reduce', {\n\t\t\t\tvalue: function (callback) { // , initialvalue\n\t\t\t\t\tif (this === null) {\n\t\t\t\t\t\tthrow new TypeError('Array.prototype.reduce called on null or undefined');\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof callback !== 'function') {\n\t\t\t\t\t\tthrow new TypeError(callback + ' is not a function');\n\t\t\t\t\t}\n\t\t\t\t\tvar o = Object(this);\n\t\t\t\t\tvar len = o.length >>> 0;\n\t\t\t\t\tvar k = 0;\n\t\t\t\t\tvar value;\n\t\t\t\t\tif (arguments.length == 2) {\n\t\t\t\t\t\tvalue = arguments[1];\n\t\t\t\t\t} else {\n\t\t\t\t\t\twhile (k < len && !(k in o)) {\n\t\t\t\t\t\t\tk++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (k >= len) {\n\t\t\t\t\t\t\tthrow new TypeError('Reduce of empty array with no initial value');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvalue = o[k++];\n\t\t\t\t\t}\n\t\t\t\t\twhile (k < len) {\n\t\t\t\t\t\tif (k in o) {\n\t\t\t\t\t\t\tvalue = callback(value, o[k], k, o);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tk++;\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}());\n\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.factory('Doc', ['Api', '$promise', function(Api, $promise) {\r\n        function Doc(item) {\r\n            if (item) {\r\n                angular.extend(this, item);\r\n            }\r\n        }\r\n\r\n        Doc.prototype = {\r\n\r\n        };\r\n\r\n        var statics = {};\r\n\r\n        angular.extend(Doc, statics);\r\n\r\n        return Doc;\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.factory('View', ['Api', '$promise', '$location', '$routeParams', 'environment', 'Doc', function(Api, $promise, $location, $routeParams, environment, Doc) {\r\n        function View(doc) {\r\n            var url = $location.path(),\r\n                params = $routeParams;\r\n            var view = {\r\n                environment: environment,\r\n                route: {\r\n                    url: url,\r\n                    params: params,\r\n                },\r\n                doc: doc,\r\n            };\r\n            angular.extend(this, view);\r\n        }\r\n\r\n        View.prototype = {\r\n\r\n        };\r\n\r\n        var statics = {\r\n            current: function() {\r\n                return $promise(function(promise) {\r\n                    var url = $location.path();\r\n                    console.log('View.current', url);\r\n                    Api.docs.url(url).then(function(response) {\r\n                        var doc = new Doc(response);\r\n                        var view = new View(doc);\r\n                        promise.resolve(view);\r\n\r\n                    }, function(error) {\r\n                        promise.reject(error);\r\n\r\n                    });\r\n                    /*\r\n                    Api.navs.main().then(function(items) {\r\n                        var doc = null,\r\n                            url = $location.path(),\r\n                            pool = getPool(items);\r\n                        var item = pool[url];\r\n                        if (item) {\r\n                            doc = new Doc(item);\r\n                        }\r\n                        promise.resolve(doc);\r\n\r\n                    }, function(error) {\r\n                        promise.reject(error);\r\n\r\n                    });\r\n                    */\r\n                });\r\n            }\r\n        };\r\n\r\n        angular.extend(View, statics);\r\n\r\n        function getPool(items) {\r\n            var pool = {};\r\n\r\n            function _getPool(items) {\r\n                if (items) {\r\n                    angular.forEach(items, function(item) {\r\n                        pool[item.url] = item;\r\n                        _getPool(item.items);\r\n                    });\r\n                }\r\n            }\r\n            _getPool(items);\r\n            return pool;\r\n        }\r\n\r\n        return View;\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.service('WebApi', ['$http', '$promise', '$timeout', 'environment',\r\n        function($http, $promise, $timeout, environment) {\r\n\r\n            function $httpPromise(method, url, data) {\r\n                return $promise(function(promise) {\r\n\r\n                    $http[method](environment.urls.api + url, data).then(function(response) {\r\n                        promise.resolve(response.data);\r\n\r\n                    }, function(e, status) {\r\n                        var error = (e && e.data) ? e.data : {};\r\n                        error.status = e.status;\r\n                        promise.reject(error);\r\n\r\n                    });\r\n                });\r\n            }\r\n\r\n            function $get(url) {\r\n                return $httpPromise('get', url);\r\n            }\r\n\r\n            function $post(url, data) {\r\n                return $httpPromise('post', url, data);\r\n            }\r\n\r\n            function $put(url, data) {\r\n                return $httpPromise('put', url, data);\r\n            }\r\n\r\n            function $patch(url, data) {\r\n                return $httpPromise('patch', url, data);\r\n            }\r\n\r\n            function $delete(url) {\r\n                return $httpPromise('delete', url);\r\n            }\r\n\r\n            function $fake(data) {\r\n                var deferred = $q.defer();\r\n                $timeout(function() {\r\n                    deferred.resolve({ data: data });\r\n                }, 1000);\r\n                return deferred.promise;\r\n            }\r\n\r\n            this.get = $get;\r\n            this.post = $post;\r\n            this.put = $put;\r\n            this.patch = $patch;\r\n            this.delete = $delete;\r\n            this.fake = $fake;\r\n\r\n        }\r\n    ]);\r\n\r\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.service('Router', ['$location', '$timeout', function($location, $timeout) {\n\n        var service = this;\n        service.redirect = redirect;\n        service.path = path;\n        service.apply = apply;\n\n        function redirect(path, msecs) {\n            function doRedirect() {\n                $location.$$lastRequestedPath = $location.path();\n                $location.path(path);\n            }\n            if (msecs) {\n                $timeout(function() {\n                    doRedirect();\n                }, msecs);\n            } else {\n                doRedirect();\n            }\n        }\n\n        function path(path, msecs) {\n            function doRetry() {\n                path = $location.$$lastRequestedPath || path;\n                $location.$$lastRequestedPath = null;\n                $location.path(path);\n            }\n            if (msecs) {\n                $timeout(function() {\n                    doRetry();\n                }, msecs);\n            } else {\n                doRetry();\n            }\n        }\n\n        function apply(path, msecs) {\n            function doRetry() {\n                $location.path(path);\n            }\n            if (msecs) {\n                $timeout(function() {\n                    doRetry();\n                }, msecs);\n            } else {\n                $timeout(function() {\n                    doRetry();\n                });\n            }\n        }\n\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('$silent', ['$rootScope', '$location', function($rootScope, $location) {\n        function $silent() {}\n\n        var $path;\n\n        function unlink() {\n            var listeners = $rootScope.$$listeners.$locationChangeSuccess;\n            angular.forEach(listeners, function(value, name) {\n                if (value === listener) {\n                    return;\n                }\n\n                function relink() {\n                    listeners[name] = value;\n                }\n                listeners[name] = relink; // temporary unlinking\n            });\n        }\n\n        function listener(e) {\n            // console.log('onLocationChangeSuccess', e);\n            if ($path === $location.path()) {\n                unlink();\n            }\n            $path = null;\n        }\n\n        var statics = {\n            silent: function(path, replace) {\n                // this.prev = $location.path(); ???\n                var location = $location.url(path);\n                if (replace) {\n                    location.replace();\n                }\n                $path = $location.path();\n            },\n            path: function(path) {\n                return $location.path(path);\n            },\n        };\n\n        angular.extend($silent, statics);\n        $rootScope.$$listeners.$locationChangeSuccess.unshift(listener);\n        // console.log('$rootScope.$$listeners.$locationChangeSuccess', $rootScope.$$listeners.$locationChangeSuccess);\n        return $silent;\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('Cookie', ['$q', '$window', function($q, $window) {\n        function Cookie() {}\n        Cookie.TIMEOUT = 5 * 60 * 1000; // five minutes\n        Cookie._set = function(name, value, days) {\n            var expires;\n            if (days) {\n                var date = new Date();\n                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n                expires = '; expires=' + date.toGMTString();\n            } else {\n                expires = '';\n            }\n            $window.document.cookie = name + '=' + value + expires + '; path=/';\n        };\n        Cookie.exists = function(name) {\n            return $window.document.cookie.indexOf(';' + name + '=') !== -1 || $window.document.cookie.indexOf(name + '=') === 0;\n        };\n        Cookie.get = function(name) {\n            var cookieName = name + \"=\";\n            var ca = $window.document.cookie.split(';');\n            for (var i = 0; i < ca.length; i++) {\n                var c = ca[i];\n                while (c.charAt(0) == ' ') {\n                    c = c.substring(1, c.length);\n                }\n                if (c.indexOf(cookieName) === 0) {\n                    var value = c.substring(cookieName.length, c.length);\n                    var model = null;\n                    try {\n                        model = JSON.parse(decodeURIComponent(atob(value)));\n                    } catch (e) {\n                        console.log('Cookie.get.error parsing', key, e);\n                    }\n                    return model;\n                }\n            }\n            return null;\n        };\n        Cookie.set = function(name, value, days) {\n            try {\n                var cache = [];\n                var json = JSON.stringify(value, function(key, value) {\n                    if (key === 'pool') {\n                        return;\n                    }\n                    if (typeof value === 'object' && value !== null) {\n                        if (cache.indexOf(value) !== -1) {\n                            // Circular reference found, discard key\n                            return;\n                        }\n                        cache.push(value);\n                    }\n                    return value;\n                });\n                cache = null;\n                Cookie._set(name, btoa(encodeURIComponent(json)), days);\n            } catch (e) {\n                console.log('Cookie.set.error serializing', name, value, e);\n            }\n        };\n        Cookie.delete = function(name) {\n            Cookie._set(name, \"\", -1);\n        };\n        Cookie.on = function(name) {\n            var deferred = $q.defer();\n            var i, interval = 1000,\n                elapsed = 0,\n                timeout = Cookie.TIMEOUT;\n\n            function checkCookie() {\n                if (elapsed > timeout) {\n                    deferred.reject('timeout');\n                } else {\n                    var c = Cookie.get(name);\n                    if (c) {\n                        deferred.resolve(c);\n                    } else {\n                        elapsed += interval;\n                        i = setTimeout(checkCookie, interval);\n                    }\n                }\n            }\n            checkCookie();\n            return deferred.promise;\n        };\n        return Cookie;\n    }]);\n\n    app.factory('LocalStorage', ['$q', '$window', 'Cookie', function($q, $window, Cookie) {\n        function LocalStorage() {}\n\n        function isLocalStorageSupported() {\n            var supported = false;\n            try {\n                supported = 'localStorage' in $window && $window.localStorage !== null;\n                if (supported) {\n                    $window.localStorage.setItem('test', '1');\n                    $window.localStorage.removeItem('test');\n                } else {\n                    supported = false;\n                }\n            } catch (e) {\n                supported = false;\n            }\n            return supported;\n        }\n        LocalStorage.isSupported = isLocalStorageSupported();\n        if (LocalStorage.isSupported) {\n            LocalStorage.exists = function(name) {\n                return $window.localStorage[name] !== undefined;\n            };\n            LocalStorage.get = function(name) {\n                var value = null;\n                if ($window.localStorage[name] !== undefined) {\n                    try {\n                        value = JSON.parse($window.localStorage[name]);\n                    } catch (e) {\n                        console.log('LocalStorage.get.error parsing', name, e);\n                    }\n                }\n                return value;\n            };\n            LocalStorage.set = function(name, value) {\n                try {\n                    var cache = [];\n                    var json = JSON.stringify(value, function(key, value) {\n                        if (key === 'pool') {\n                            return;\n                        }\n                        if (typeof value === 'object' && value !== null) {\n                            if (cache.indexOf(value) !== -1) {\n                                // Circular reference found, discard key\n                                return;\n                            }\n                            cache.push(value);\n                        }\n                        return value;\n                    });\n                    cache = null;\n                    $window.localStorage.setItem(name, json);\n                } catch (e) {\n                    console.log('LocalStorage.set.error serializing', name, value, e);\n                }\n            };\n            LocalStorage.delete = function(name) {\n                $window.localStorage.removeItem(name);\n            };\n            LocalStorage.on = function(name) {\n                var deferred = $q.defer();\n                var i, timeout = Cookie.TIMEOUT;\n\n                function storageEvent(e) {\n                    // console.log('LocalStorage.on', name, e);\n                    clearTimeout(i);\n                    if (e.originalEvent.key == name) {\n                        try {\n                            var value = JSON.parse(e.originalEvent.newValue); // , e.originalEvent.oldValue\n                            deferred.resolve(value);\n                        } catch (error) {\n                            console.log('LocalStorage.on.error parsing', name, error);\n                            deferred.reject('error parsing ' + name);\n                        }\n                    }\n                }\n                angular.element($window).on('storage', storageEvent);\n                i = setTimeout(function() {\n                    deferred.reject('timeout');\n                }, timeout);\n                return deferred.promise;\n            };\n        } else {\n            console.log('LocalStorage.unsupported switching to cookies');\n            LocalStorage.exists = Cookie.exists;\n            LocalStorage.set = Cookie.set;\n            LocalStorage.get = Cookie.get;\n            LocalStorage.delete = Cookie.delete;\n            LocalStorage.on = Cookie.on;\n        }\n        return LocalStorage;\n    }]);\n\n    app.factory('SessionStorage', ['$q', '$window', 'Cookie', function($q, $window, Cookie) {\n        function SessionStorage() {}\n\n        function isSessionStorageSupported() {\n            var supported = false;\n            try {\n                supported = 'sessionStorage' in $window && $window.sessionStorage !== undefined;\n                if (supported) {\n                    $window.sessionStorage.setItem('test', '1');\n                    $window.sessionStorage.removeItem('test');\n                } else {\n                    supported = false;\n                }\n            } catch (e) {\n                supported = false;\n            }\n            return supported;\n        }\n        SessionStorage.isSupported = isSessionStorageSupported();\n        if (SessionStorage.isSupported) {\n            SessionStorage.exists = function(name) {\n                return $window.sessionStorage[name] !== undefined;\n            };\n            SessionStorage.get = function(name) {\n                var value = null;\n                if ($window.sessionStorage[name] !== undefined) {\n                    try {\n                        value = JSON.parse($window.sessionStorage[name]);\n                    } catch (e) {\n                        console.log('SessionStorage.get.error parsing', name, e);\n                    }\n                }\n                return value;\n            };\n            SessionStorage.set = function(name, value) {\n                try {\n                    var cache = [];\n                    var json = JSON.stringify(value, function(key, value) {\n                        if (key === 'pool') {\n                            return;\n                        }\n                        if (typeof value === 'object' && value !== null) {\n                            if (cache.indexOf(value) !== -1) {\n                                // Circular reference found, discard key\n                                return;\n                            }\n                            cache.push(value);\n                        }\n                        return value;\n                    });\n                    cache = null;\n                    $window.sessionStorage.setItem(name, json);\n                } catch (e) {\n                    console.log('SessionStorage.set.error serializing', name, value, e);\n                }\n            };\n            SessionStorage.delete = function(name) {\n                $window.sessionStorage.removeItem(name);\n            };\n            SessionStorage.on = function(name) {\n                var deferred = $q.defer();\n                var i, timeout = Cookie.TIMEOUT;\n\n                function storageEvent(e) {\n                    // console.log('SessionStorage.on', name, e);\n                    clearTimeout(i);\n                    if (e.originalEvent.key === name) {\n                        try {\n                            var value = JSON.parse(e.originalEvent.newValue); // , e.originalEvent.oldValue\n                            deferred.resolve(value);\n                        } catch (error) {\n                            console.log('SessionStorage.on.error parsing', name, error);\n                            deferred.reject('error parsing ' + name);\n                        }\n                    }\n                }\n                angular.element($window).on('storage', storageEvent);\n                i = setTimeout(function() {\n                    deferred.reject('timeout');\n                }, timeout);\n                return deferred.promise;\n            };\n        } else {\n            console.log('SessionStorage.unsupported switching to cookies');\n            SessionStorage.exists = Cookie.exists;\n            SessionStorage.set = Cookie.set;\n            SessionStorage.get = Cookie.get;\n            SessionStorage.delete = Cookie.delete;\n            SessionStorage.on = Cookie.on;\n        }\n        return SessionStorage;\n    }]);\n\n}());\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Color', [function () {\n\t\tfunction Color(r, g, b, a) {\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tthis.r = (r || r === 0) ? r : 0;\n\t\t\t\tthis.g = (g || g === 0) ? g : 0;\n\t\t\t\tthis.b = (b || b === 0) ? b : 0;\n\t\t\t\tthis.a = (a || a === 0) ? a : 255;\n\t\t\t} else {\n\t\t\t\tvar uint = r || '0xffffff';\n\t\t\t\tuint = parseInt(uint);\n\t\t\t\tif (r.length > 8) {\n\t\t\t\t\tthis.r = uint >> 24 & 0xff;\n\t\t\t\t\tthis.g = uint >> 16 & 0xff;\n\t\t\t\t\tthis.b = uint >> 8 & 0xff;\n\t\t\t\t\tthis.a = uint >> 0 & 0xff;\n\t\t\t\t} else {\n\t\t\t\t\tthis.r = uint >> 16 & 0xff;\n\t\t\t\t\tthis.g = uint >> 8 & 0xff;\n\t\t\t\t\tthis.b = uint >> 0 & 0xff;\n\t\t\t\t\tthis.a = 255;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tColor.componentToHex = function (c) {\n\t\t\tvar hex = c.toString(16);\n\t\t\treturn hex.length == 1 ? '0' + hex : hex;\n\t\t};\n\t\tColor.luma = function (color) {\n\t\t\t// var luma = color.dot({ r: 54.213, g: 182.376, b: 18.411 });\n\t\t\tvar luma = color.dot({\n\t\t\t\tr: 95,\n\t\t\t\tg: 100,\n\t\t\t\tb: 60\n\t\t\t});\n\t\t\treturn luma;\n\t\t};\n\t\tColor.contrast = function (color) {\n\t\t\tvar luma = Color.luma(color);\n\t\t\tif (luma > 0.6) {\n\t\t\t\treturn new Color('0x000000');\n\t\t\t} else {\n\t\t\t\treturn new Color('0xffffff');\n\t\t\t}\n\t\t};\n\t\tColor.darker = function (color, pow, min) {\n\t\t\tmin = min || 0;\n\t\t\tvar r = Math.max(Math.floor(color.r * min), Math.floor(color.r - 255 * pow));\n\t\t\tvar g = Math.max(Math.floor(color.g * min), Math.floor(color.g - 255 * pow));\n\t\t\tvar b = Math.max(Math.floor(color.b * min), Math.floor(color.b - 255 * pow));\n\t\t\treturn new Color(r, g, b, color.a);\n\t\t};\n\t\tColor.lighter = function (color, pow, max) {\n\t\t\tmax = max || 1;\n\t\t\tvar r = Math.min(color.r + Math.floor((255 - color.r) * max), Math.floor(color.r + 255 * pow));\n\t\t\tvar g = Math.min(color.g + Math.floor((255 - color.g) * max), Math.floor(color.g + 255 * pow));\n\t\t\tvar b = Math.min(color.b + Math.floor((255 - color.b) * max), Math.floor(color.b + 255 * pow));\n\t\t\treturn new Color(r, g, b, color.a);\n\t\t};\n\t\t/*\n\t\tColor.rgbaToHex = function (rgba) {\n\t\t    rgba = rgba.match(/^rgba?[\\s+]?\\([\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?/i);\n\t\t    return (rgba && rgba.length === 4) ? \"#\" +\n\t\t        (\"0\" + parseInt(rgba[1], 10).toString(16)).slice(-2) +\n\t\t        (\"0\" + parseInt(rgba[2], 10).toString(16)).slice(-2) +\n\t\t        (\"0\" + parseInt(rgba[3], 10).toString(16)).slice(-2) : '';\n\t\t}\n\t\t*/\n\t\tColor.prototype = {\n\t\t\ttoUint: function () {\n\t\t\t\treturn (this.r << 24) + (this.g << 16) + (this.b << 8) + (this.a);\n\t\t\t},\n\t\t\ttoHex: function () {\n\t\t\t\treturn '#' + Color.componentToHex(this.r) + Color.componentToHex(this.g) + Color.componentToHex(this.b) + Color.componentToHex(this.a);\n\t\t\t},\n\t\t\ttoRgba: function () {\n\t\t\t\treturn 'rgba(' + this.r + ',' + this.g + ',' + this.b + ',' + (this.a / 255).toFixed(3) + ')';\n\t\t\t},\n\t\t\tdot: function (color) {\n\t\t\t\treturn ((this.r / 255) * (color.r / 255) + (this.g / 255) * (color.g / 255) + (this.b / 255) * (color.b / 255));\n\t\t\t},\n\t\t\talpha: function (pow, min, max) {\n\t\t\t\tmin = min || 0;\n\t\t\t\tmax = max || 1;\n\t\t\t\tthis.a = Math.floor((min + (pow * (max - min))) * 255);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tmakeSet: function () {\n\t\t\t\tthis.foreground = Color.contrast(this);\n\t\t\t\tthis.border = Color.darker(this, 0.3);\n\t\t\t\tthis.light = Color.lighter(this, 0.3);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t};\n\t\treturn Color;\n    }]);\n\n\tapp.factory('Shape', [function () {\n\t\tfunction Shape() {}\n\t\tShape.shapeCircle = function (p, cx, cy, r, sa, ea) {\n\t\t\tsa = sa || 0;\n\t\t\tea = ea || 2 * Math.PI;\n\t\t\tp.ctx.arc(cx, cy, r, sa, ea, false);\n\t\t};\n\t\tShape.shapeStar = function (p, cx, cy, or, ir, steps) {\n\t\t\tvar x, y;\n\t\t\tvar angle = Math.PI / 2 * 3;\n\t\t\tvar step = Math.PI / steps;\n\t\t\tvar ctx = p.ctx;\n\t\t\tctx.moveTo(cx, cy - or);\n\t\t\tfor (i = 0; i < steps; i++) {\n\t\t\t\tx = cx + Math.cos(angle) * or;\n\t\t\t\ty = cy + Math.sin(angle) * or;\n\t\t\t\tctx.lineTo(x, y);\n\t\t\t\tangle += step;\n\t\t\t\tx = cx + Math.cos(angle) * ir;\n\t\t\t\ty = cy + Math.sin(angle) * ir;\n\t\t\t\tctx.lineTo(x, y);\n\t\t\t\tangle += step;\n\t\t\t}\n\t\t\tctx.lineTo(cx, cy - or);\n\t\t};\n\t\tShape.shapeRoundRect = function (p, rect, r) {\n\t\t\tvar ctx = p.ctx,\n\t\t\t\tx = rect.x,\n\t\t\t\ty = rect.y,\n\t\t\t\tw = rect.w,\n\t\t\t\th = rect.h;\n\t\t\tif (typeof r === undefined) {\n\t\t\t\tr = 4;\n\t\t\t}\n\t\t\tif (typeof r === 'number') {\n\t\t\t\tr = {\n\t\t\t\t\ttl: r,\n\t\t\t\t\ttr: r,\n\t\t\t\t\tbr: r,\n\t\t\t\t\tbl: r\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tvar defaultRadius = {\n\t\t\t\t\ttl: 0,\n\t\t\t\t\ttr: 0,\n\t\t\t\t\tbr: 0,\n\t\t\t\t\tbl: 0\n\t\t\t\t};\n\t\t\t\tfor (var key in defaultRadius) {\n\t\t\t\t\tr[key] = r[key] || defaultRadius[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\tctx.moveTo(x + r.tl, y);\n\t\t\tctx.lineTo(x + w - r.tr, y);\n\t\t\tctx.quadraticCurveTo(x + w, y, x + w, y + r.tr);\n\t\t\tctx.lineTo(x + w, y + h - r.br);\n\t\t\tctx.quadraticCurveTo(x + w, y + h, x + w - r.br, y + h);\n\t\t\tctx.lineTo(x + r.bl, y + h);\n\t\t\tctx.quadraticCurveTo(x, y + h, x, y + h - r.bl);\n\t\t\tctx.lineTo(x, y + r.tl);\n\t\t\tctx.quadraticCurveTo(x, y, x + r.tl, y);\n\t\t};\n\t\tShape.circle = function () {\n\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\tvar ctx = params[0].ctx;\n\t\t\tctx.beginPath();\n\t\t\tShape.shapeCircle.apply(this, params);\n\t\t\tctx.closePath();\n\t\t};\n\t\tShape.star = function () {\n\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\tvar ctx = params[0].ctx;\n\t\t\tctx.beginPath();\n\t\t\tShape.shapeStar.apply(this, params);\n\t\t\tctx.closePath();\n\t\t};\n\t\tShape.roundRect = function () {\n\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\tvar ctx = params[0].ctx;\n\t\t\tctx.beginPath();\n\t\t\tShape.shapeRoundRect.apply(this, params);\n\t\t\tctx.closePath();\n\t\t};\n\t\treturn Shape;\n    }]);\n\n\tapp.constant('PainterColors', {\n\t\t/*\n\t\tblack: new Color('0x111111'),\n\t\twhite: new Color('0xffffff'),\n\t\tred: new Color('0xff0000'),\n\t\tgreen: new Color('0x00ff00'),\n\t\tblue: new Color('0x0000ff'),\n\t\tyellow: new Color('0xffff00'),\n\t\tcyan: new Color('0x00ffff'),\n\t\tpurple: new Color('0xff00ff'),\n\t\t*/\n\t\tblack: '0x14191e',\n\t\twhite: '0xffffff',\n\t\tblue: '0x0023FF',\n\t\tred: '0xF21500',\n\t\tlightBlue: '0x79ccf2',\n\t\tlightYellow: '0xfff79a',\n\t\tgreyLighter: '0xf8f8f8',\n\t\tgreyLight: '0xeeeeee',\n\t\tgreyMedium: '0xcccccc',\n\t\tgrey: '0x90939b',\n\t\tmap: '0x24292e',\n\t});\n\n\tapp.factory('Palette', ['$q', 'Painter', 'Rect', function ($q, Painter, Rect) {\n\t\tfunction Palette() {\n\t\t\tthis.painter = new Painter().setSize(0, 0);\n\t\t\tthis.buffer = new Painter().setSize(0, 0);\n\t\t\tthis.size = {\n\t\t\t\tw: 0,\n\t\t\t\th: 0\n\t\t\t};\n\t\t\tthis.pool = {};\n\t\t\tthis.rows = {};\n\t\t}\n\t\tPalette.prototype = {\n\t\t\tgetRect: function (w, h) {\n\t\t\t\tvar p = this.painter,\n\t\t\t\t\tsize = this.size,\n\t\t\t\t\trows = this.rows,\n\t\t\t\t\tr = new Rect(0, 0, w, h),\n\t\t\t\t\trow = rows[h] || {\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: size.h\n\t\t\t\t\t};\n\t\t\t\tsize.w = Math.max(size.w, row.x + w);\n\t\t\t\tsize.h = Math.max(size.h, row.y + h);\n\t\t\t\tif (!p.canvas.width && !p.canvas.height) {\n\t\t\t\t\tp.setSize(size.w, size.h);\n\t\t\t\t} else if (size.w > p.canvas.width || size.h > p.canvas.height) {\n\t\t\t\t\t// var img = new Image();\n\t\t\t\t\t// img.src = p.toDataURL();\n\t\t\t\t\t// document.body.appendChild(canvas);\n\t\t\t\t\t// console.log(p.canvas.width, p.canvas.height);\n\t\t\t\t\t// var data = p.ctx.getImageData(0, 0, p.canvas.width, p.canvas.height);\n\t\t\t\t\tvar canvas = p.canvas;\n\t\t\t\t\tp.setCanvas(document.createElement('canvas'));\n\t\t\t\t\tp.setSize(size.w, size.h);\n\t\t\t\t\tp.ctx.drawImage(canvas, 0, 0);\n\t\t\t\t\t// p.ctx.putImageData(data, 0, 0);\n\t\t\t\t\t// p.ctx.drawImage(img, 0, 0);\n\t\t\t\t\t// document.body.removeChild(canvas);\n\t\t\t\t}\n\t\t\t\tr.x = row.x;\n\t\t\t\tr.y = row.y;\n\t\t\t\trow.x += w;\n\t\t\t\trows[h] = row;\n\t\t\t\treturn r;\n\t\t\t},\n\t\t\tadd: function (key, path) {\n\t\t\t\tvar palette = this;\n\t\t\t\tif (angular.isString(path)) {\n\t\t\t\t\tvar deferred = $q.defer();\n\t\t\t\t\tvar img = new Image();\n\t\t\t\t\timg.onload = function () {\n\t\t\t\t\t\tpalette.addShape(key, img.width, img.height, function (p, rect) {\n\t\t\t\t\t\t\tp.ctx.drawImage(img, 0, 0);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdeferred.resolve(img);\n\t\t\t\t\t};\n\t\t\t\t\timg.onerror = function () {\n\t\t\t\t\t\tdeferred.reject('connot load ' + path);\n\t\t\t\t\t};\n\t\t\t\t\timg.src = path;\n\t\t\t\t\treturn deferred.promise;\n\t\t\t\t} else {\n\t\t\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\t\t\treturn palette.addShape.apply(palette, params);\n\t\t\t\t}\n\t\t\t},\n\t\t\taddShape: function (key, w, h, callback) {\n\t\t\t\tvar p = this.painter,\n\t\t\t\t\tr = this.getRect(w, h);\n\t\t\t\tp.ctx.save();\n\t\t\t\tp.ctx.rect(r.x, r.y, r.w, r.h);\n\t\t\t\t// p.ctx.stroke();\n\t\t\t\tp.ctx.clip();\n\t\t\t\tp.ctx.translate(r.x, r.y);\n\t\t\t\tcallback.call(p, p, r.clone().setPos(0, 0));\n\t\t\t\tp.ctx.restore();\n\t\t\t\tthis.pool[key] = r;\n\t\t\t\t// console.log('Painter.add', r);\n\t\t\t},\n\t\t\tdraw: function (target, key, x, y, pre) {\n\t\t\t\tvar r = this.pool[key];\n\t\t\t\tif (r) {\n\t\t\t\t\t// var ctx = target.ctx;\n\t\t\t\t\t// ctx.save();\n\t\t\t\t\ttarget.drawRect(this.painter.canvas, r, {\n\t\t\t\t\t\tx: x,\n\t\t\t\t\t\ty: y,\n\t\t\t\t\t\tw: r.w,\n\t\t\t\t\t\th: r.h\n\t\t\t\t\t}, pre);\n\t\t\t\t\t// target.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, x - r.w / 2, y - r.h / 2, r.w, r.h);\n\t\t\t\t\t// ctx.restore();\n\t\t\t\t}\n\t\t\t},\n\t\t\ttint: function (target, key, x, y, color, pre) {\n\t\t\t\tvar r = this.pool[key];\n\t\t\t\tif (r) {\n\t\t\t\t\tvar p = this.painter,\n\t\t\t\t\t\tb = this.buffer.setSize(r.w, r.h);\n\t\t\t\t\tb.save();\n\t\t\t\t\tb.setFill(color);\n\t\t\t\t\tb.fillRect();\n\t\t\t\t\tb.ctx.globalCompositeOperation = \"destination-atop\";\n\t\t\t\t\tb.ctx.drawImage(p.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n\t\t\t\t\tb.restore();\n\t\t\t\t\tconsole.log(x, y, b.canvas, target.canvas);\n\t\t\t\t\ttarget.draw(b.canvas, {\n\t\t\t\t\t\tx: x,\n\t\t\t\t\t\ty: y\n\t\t\t\t\t}, pre);\n\t\t\t\t}\n\t\t\t},\n\t\t\tpattern: function (target, key, x, y, w, h, color) {\n\t\t\t\tfunction drawPattern(pattern) {\n\t\t\t\t\tvar ctx = target.ctx;\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\t// draw\n\t\t\t\t\t// ctx.beginPath();\n\t\t\t\t\t// ctx.rect(-x, -y, w, h);\n\t\t\t\t\tctx.fillStyle = pattern;\n\t\t\t\t\tctx.fillRect(-x, -y, w, h);\n\t\t\t\t\tctx.translate(-x, -y);\n\t\t\t\t\t// ctx.fill();\n\t\t\t\t\tctx.restore();\n\t\t\t\t}\n\t\t\t\tvar r = this.pool[key];\n\t\t\t\tif (r) {\n\t\t\t\t\tvar img = r.img,\n\t\t\t\t\t\tpattern;\n\t\t\t\t\tif (!img || r.color != color) {\n\t\t\t\t\t\tvar b = this.buffer.setSize(r.w, r.h);\n\t\t\t\t\t\tif (color) {\n\t\t\t\t\t\t\tr.color = color;\n\t\t\t\t\t\t\tb.save();\n\t\t\t\t\t\t\tb.setFill(color);\n\t\t\t\t\t\t\tb.fillRect();\n\t\t\t\t\t\t\tb.ctx.globalCompositeOperation = \"destination-atop\";\n\t\t\t\t\t\t\tb.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n\t\t\t\t\t\t\tb.restore();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tb.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n\t\t\t\t\t\t}\n\t\t\t\t\t\timg = new Image();\n\t\t\t\t\t\timg.onload = function () {\n\t\t\t\t\t\t\tr.img = img;\n\t\t\t\t\t\t\tpattern = target.ctx.createPattern(img, \"repeat\");\n\t\t\t\t\t\t\tdrawPattern(pattern);\n\t\t\t\t\t\t};\n\t\t\t\t\t\timg.src = b.toDataURL();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpattern = target.ctx.createPattern(img, \"repeat\");\n\t\t\t\t\t\tdrawPattern(pattern);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t\treturn Palette;\n    }]);\n\n\tapp.factory('Painter', ['Shape', 'Rect', 'Color', 'PainterColors', function (Shape, Rect, Color, PainterColors) {\n\t\tfunction Painter(canvas) {\n\t\t\tcanvas = canvas || document.createElement('canvas');\n\t\t\tthis.rect = new Rect();\n\t\t\tthis.drawingRect = new Rect();\n\t\t\tthis.setColors();\n\t\t\tthis.setCanvas(canvas);\n\t\t}\n\t\tPainter.colors = {};\n\t\tangular.forEach(PainterColors, function (value, key) {\n\t\t\tPainter.colors[key] = new Color(value).makeSet();\n\t\t});\n\t\tvar colors = Painter.colors;\n\t\tPainter.prototype = {\n\t\t\tcolors: Painter.colors,\n\t\t\tsetColors: function () {\n\t\t\t\tvar colors = this.colors;\n\t\t\t\tangular.forEach(PainterColors, function (value, key) {\n\t\t\t\t\tcolors[key] = new Color(value).makeSet();\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCanvas: function (canvas) {\n\t\t\t\tthis.canvas = canvas;\n\t\t\t\tthis.setSize(canvas.offsetWidth, canvas.offsetHeight);\n\t\t\t\tvar ctx = canvas.getContext('2d');\n\t\t\t\tctx.lineCap = 'square';\n\t\t\t\tthis.ctx = ctx;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetSize: function (w, h) {\n\t\t\t\tthis.canvas.width = w;\n\t\t\t\tthis.canvas.height = h;\n\t\t\t\tthis.rect.w = w;\n\t\t\t\tthis.rect.h = h;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tcopy: function (canvas) {\n\t\t\t\tthis.ctx.drawImage(canvas, 0, 0);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tclear: function () {\n\t\t\t\tthis.resize();\n\t\t\t\t// this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tresize: function () {\n\t\t\t\tthis.setSize(this.canvas.offsetWidth, this.canvas.offsetHeight);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetText: function (font, align, verticalAlign, color) {\n\t\t\t\tfont = font || '11px monospace';\n\t\t\t\talign = align || 'center';\n\t\t\t\tverticalAlign = verticalAlign || 'middle';\n\t\t\t\tcolor = color || this.colors.black;\n\t\t\t\tvar ctx = this.ctx;\n\t\t\t\tctx.font = font;\n\t\t\t\tctx.textAlign = align;\n\t\t\t\tctx.textBaseline = verticalAlign;\n\t\t\t\tctx.fillStyle = color.toRgba();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetFill: function (color) {\n\t\t\t\tcolor = color || this.colors.black;\n\t\t\t\tvar ctx = this.ctx;\n\t\t\t\t/*\n\t\t\t\tvar my_gradient = ctx.createLinearGradient(0, 0, 0, 170);\n\t\t\t\tmy_gradient.addColorStop(0, \"black\");\n\t\t\t\tmy_gradient.addColorStop(1, \"white\");\n\t\t\t\tctx.fillStyle = my_gradient;\n\t\t\t\t*/\n\t\t\t\tctx.fillStyle = color.toRgba();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetStroke: function (color, size) {\n\t\t\t\tcolor = color || this.colors.black;\n\t\t\t\tvar ctx = this.ctx;\n\t\t\t\tsize = size || 1;\n\t\t\t\t/*\n\t\t\t\tvar gradient=ctx.createLinearGradient(0,0,170,0);\n\t\t\t\tgradient.addColorStop(\"0\",\"magenta\");\n\t\t\t\tgradient.addColorStop(\"0.5\",\"blue\");\n\t\t\t\tgradient.addColorStop(\"1.0\",\"red\");\n\t\t\t\tctx.strokeStyle = gradient;\n\t\t\t\t*/\n\t\t\t\t// Fill with gradient\n\t\t\t\tctx.strokeStyle = color.toRgba();\n\t\t\t\tctx.lineWidth = size;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t/*\n\t\t\tdrawRoundRect: function (rect, r) {\n\t\t\t    rect = rect || this.rect;\n\t\t\t    Shape.roundRect(this, rect, r);\n\t\t\t    return this;\n\t\t\t},\n\t\t\t*/\n\t\t\tfillText: function (text, point, width, post, maxLength) {\n\t\t\t\tif (width) {\n\t\t\t\t\tpost = post || '';\n\t\t\t\t\tmaxLength = maxLength || Math.floor(width / 8);\n\t\t\t\t\tif (text.length > maxLength) {\n\t\t\t\t\t\ttext = text.substr(0, Math.min(text.length, maxLength)).trim() + post;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.ctx.fillText(text, point.x, point.y);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tfillRect: function (rect) {\n\t\t\t\trect = rect || this.rect;\n\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\tx = rect.x,\n\t\t\t\t\ty = rect.y,\n\t\t\t\t\tw = rect.w,\n\t\t\t\t\th = rect.h;\n\t\t\t\tctx.fillRect(x, y, w, h);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tstrokeRect: function (rect) {\n\t\t\t\trect = rect || this.rect;\n\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\tx = rect.x,\n\t\t\t\t\ty = rect.y,\n\t\t\t\t\tw = rect.w,\n\t\t\t\t\th = rect.h;\n\t\t\t\tctx.strokeRect(x, y, w, h);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tfill: function () {\n\t\t\t\tthis.ctx.fill();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tstroke: function () {\n\t\t\t\tthis.ctx.stroke();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tbegin: function () {\n\t\t\t\tthis.ctx.beginPath();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tclose: function () {\n\t\t\t\tthis.ctx.closePath();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsave: function () {\n\t\t\t\tthis.ctx.save();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\trestore: function () {\n\t\t\t\tthis.ctx.restore();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\trotate: function (angle) {\n\t\t\t\tthis.ctx.rotate(angle * Math.PI / 180);\n\t\t\t},\n\t\t\ttranslate: function (xy) {\n\t\t\t\tthis.ctx.translate(xy.x, xy.y);\n\t\t\t},\n\t\t\ttoDataURL: function () {\n\t\t\t\treturn this.canvas.toDataURL();\n\t\t\t},\n\t\t\tdraw: function (image, t, pre) {\n\t\t\t\tif (image) {\n\t\t\t\t\tt.w = t.w || image.width;\n\t\t\t\t\tt.h = t.h || image.height;\n\t\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\t\trect = this.drawingRect,\n\t\t\t\t\t\tx = rect.x = t.x - t.w / 2,\n\t\t\t\t\t\ty = rect.y = t.y - t.h / 2,\n\t\t\t\t\t\tw = rect.w = t.w,\n\t\t\t\t\t\th = rect.h = t.h;\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\tif (pre) {\n\t\t\t\t\t\tpre.call(this);\n\t\t\t\t\t}\n\t\t\t\t\tctx.drawImage(image, 0, 0);\n\t\t\t\t\tctx.restore();\n\t\t\t\t\t// console.log('painter.draw', x, y, w, h);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tdrawRect: function (image, s, t, pre) {\n\t\t\t\tif (image) {\n\t\t\t\t\ts.w = s.w || image.width;\n\t\t\t\t\ts.h = s.h || image.height;\n\t\t\t\t\tt.w = t.w || image.width;\n\t\t\t\t\tt.h = t.h || image.height;\n\t\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\t\trect = this.drawingRect,\n\t\t\t\t\t\tx = rect.x = t.x - s.w / 2,\n\t\t\t\t\t\ty = rect.y = t.y - s.h / 2,\n\t\t\t\t\t\tw = rect.w = t.w,\n\t\t\t\t\t\th = rect.h = t.h;\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\tif (pre) {\n\t\t\t\t\t\tpre.call(this);\n\t\t\t\t\t}\n\t\t\t\t\tctx.drawImage(image, s.x, s.y, s.w, s.h, 0, 0, t.w, t.h);\n\t\t\t\t\tctx.restore();\n\t\t\t\t\t// console.log('painter.drawRect', x, y, w, h);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tflip: function (scale) {\n\t\t\t\tscale = scale || {\n\t\t\t\t\tx: 1,\n\t\t\t\t\ty: -1\n\t\t\t\t};\n\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\trect = this.drawingRect;\n\t\t\t\tctx.translate(scale.x === -1 ? rect.w : 0, scale.y === -1 ? rect.h : 0);\n\t\t\t\tctx.scale(scale.x, scale.y);\n\t\t\t},\n\t\t};\n\t\treturn Painter;\n    }]);\n\n}());\n\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.directive('controlMessages', [function() {\n        return {\n            restrict: 'E',\n            templateUrl: 'artisan/forms/messages',\n            transclude: {\n                'message': '?messageItems',\n            },\n            link: function(scope, element, attributes, model) {}\n        };\n    }]);\n\n    app.directive('control', ['$parse', function($parse) {\n        function formatLabel(string, prepend, expression) {\n            string = string || '';\n            prepend = prepend || '';\n            var splitted = string.split(',');\n            if (splitted.length > 1) {\n                var formatted = splitted.shift();\n                angular.forEach(splitted, function(value, index) {\n                    if (expression) {\n                        formatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n                    } else {\n                        formatted = formatted.split('{' + index + '}').join(prepend + value);\n                    }\n                });\n                if (expression) {\n                    return '\\'' + formatted + '\\'';\n                } else {\n                    return formatted;\n                }\n            } else {\n                return prepend + string;\n            }\n        }\n        var uniqueId = 0;\n        return {\n            restrict: 'A',\n            templateUrl: function(element, attributes) {\n                var template = 'artisan/forms/text';\n                switch (attributes.control) {\n                    case 'select':\n                        template = 'artisan/forms/select';\n                        break;\n                }\n                return template;\n            },\n            scope: {\n                ngModel: '=',\n                required: '=',\n                form: '@',\n                title: '@',\n                placeholder: '@',\n                source: '=?',\n                key: '@?',\n                label: '@?',\n            },\n            require: 'ngModel',\n            transclude: true,\n            link: {\n                pre: function preLink(scope, element, attributes, controller, transclude) {\n                    var label = scope.label = (scope.label ? scope.label : 'name');\n                    var key = scope.key = (scope.key ? scope.key : 'id');\n                    if (attributes.control === 'select') {\n                        var filter = (attributes.filter ? '| ' + attributes.filter : '');\n                        var optionLabel = formatLabel(label, 'item.', true);\n                        scope.getOptions = function() {\n                            return attributes.number ?\n                                'item.' + key + ' as ' + optionLabel + ' disable when item.disabled for item in source ' + filter :\n                                optionLabel + ' disable when item.disabled for item in source ' + filter + ' track by item.' + key;\n                        };\n                    }\n                    var type = scope.type = attributes.control;\n                    var form = scope.form = scope.form || 'form';\n                    var title = scope.title = scope.title || 'untitled';\n                    var placeholder = scope.placeholder = scope.placeholder || title;\n                    var field = scope.field = title.replace(/[^0-9a-zA-Z]/g, \"\").split(' ').join('') + (++uniqueId);\n                    scope.format = attributes.format || null;\n                    scope.precision = attributes.precision || null;\n                    scope.validate = attributes.validate || attributes.control;\n                    scope.minLength = attributes.minLength || 0;\n                    scope.maxLength = attributes.maxLength || Number.POSITIVE_INFINITY;\n                    scope.min = attributes.min || null;\n                    scope.max = attributes.max || null;\n                    scope.options = $parse(attributes.options)(scope) || {};\n                    scope.focus = false;\n                    scope.visible = false;\n                    scope.onChange = function(model) {\n                        $parse(attributes.onChange)(scope.$parent);\n                    };\n                    scope.onFilter = function(model) {\n                        $parse(attributes.onFilter)(scope.$parent);\n                    };\n                    scope.getType = function() {\n                        var type = 'text';\n                        switch (attributes.control) {\n                            case 'password':\n                                type = scope.visible ? 'text' : 'password';\n                                break;\n                            default:\n                                type = attributes.control;\n                        }\n                        return type;\n                    };\n                    scope.getClasses = function() {\n                        var form = $parse(scope.form)(scope.$parent);\n                        var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                        return {\n                            'control-focus': scope.focus,\n                            'control-success': field.$valid,\n                            'control-error': field.$invalid && (form.$submitted || field.$touched),\n                            'control-empty': !field.$viewValue\n                        };\n                    };\n                    scope.getMessages = function() {\n                        var form = $parse(scope.form)(scope.$parent);\n                        var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                        return (form.$submitted || field.$touched) && field.$error;\n                    };\n                    scope.toggleVisibility = function() {\n                        scope.visible = !scope.visible;\n                    };\n                },\n            },\n        };\n    }]);\n\n    app.directive('_control', ['$http', '$templateCache', '$compile', '$parse', function($http, $templateCache, $compile, $parse) {\n        function formatLabel(string, prepend, expression) {\n            string = string || '';\n            prepend = prepend || '';\n            var splitted = string.split(',');\n            if (splitted.length > 1) {\n                var formatted = splitted.shift();\n                angular.forEach(splitted, function(value, index) {\n                    if (expression) {\n                        formatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n                    } else {\n                        formatted = formatted.split('{' + index + '}').join(prepend + value);\n                    }\n                });\n                if (expression) {\n                    return '\\'' + formatted + '\\'';\n                } else {\n                    return formatted;\n                }\n            } else {\n                return prepend + string;\n            }\n        }\n        var uniqueId = 0;\n        return {\n            restrict: 'A',\n            templateUrl: function(element, attributes) {\n                var template = 'artisan/forms/text';\n                switch (attributes.control) {\n                    case 'select':\n                        template = 'artisan/forms/select';\n                        break;\n                }\n                return template;\n            },\n            scope: {\n                ngModel: '=',\n                required: '=',\n                form: '@',\n                title: '@',\n                placeholder: '@',\n            },\n            require: 'ngModel',\n            /*\n            link: function(scope, element, attributes, model) {\n            },\n            */\n            compile: function(element, attributes) {\n                    return {\n                        pre: function(scope, element, attributes) {\n                            if (attributes.control === 'select') {\n                                var label = (attributes.label ? attributes.label : 'name');\n                                var key = (attributes.key ? attributes.key : 'id');\n                                var filter = (attributes.min ? ' | filter:gte(\\'' + key + '\\', ' + attributes.min + ')' : '');\n                                var optionLabel = formatLabel(label, 'item.', true);\n                                scope.options = attributes.number ?\n                                    'item.' + key + ' as ' + optionLabel + ' disable when item.disabled for item in ' + attributes.source + filter :\n                                    optionLabel + ' disable when item.disabled for item in ' + attributes.source + filter + ' track by item.' + key;\n                                console.log('control.compile.pre', scope.options);\n                            }\n                            var type = scope.type = attributes.control;\n                            var form = scope.form = scope.form || 'form';\n                            var title = scope.title = scope.title || 'untitled';\n                            var placeholder = scope.placeholder = scope.placeholder || title;\n                            var field = scope.field = title.replace(/[^0-9a-zA-Z]/g, \"\").split(' ').join('') + (++uniqueId);\n                            scope.validate = attributes.validate || attributes.control;\n                            scope.format = attributes.format || null;\n                            scope.precision = attributes.precision || null;\n                            scope.validate = attributes.validate || attributes.control;\n                            scope.minLength = attributes.min || 0;\n                            scope.maxLength = attributes.max || Number.POSITIVE_INFINITY;\n                            scope.options = $parse(attributes.options)(scope) || {};\n                            scope.focus = false;\n                            scope.visible = false;\n                            scope.getType = function() {\n                                var type = 'text';\n                                switch (attributes.control) {\n                                    case 'password':\n                                        // var form = $parse(scope.form)(scope.$parent);\n                                        // var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                        type = scope.visible ? 'text' : 'password';\n                                        break;\n                                    default:\n                                        type = attributes.control;\n                                }\n                                // console.log('control.getType', type);\n                                return type;\n                            };\n                            scope.getClasses = function() {\n                                var form = $parse(scope.form)(scope.$parent);\n                                var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                return {\n                                    'control-focus': scope.focus,\n                                    'control-success': field.$valid,\n                                    'control-error': field.$invalid && (form.$submitted || field.$touched),\n                                    'control-empty': !field.$viewValue\n                                };\n                            };\n                            scope.getMessages = function() {\n                                var form = $parse(scope.form)(scope.$parent);\n                                var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                return (form.$submitted || field.$touched) && field.$error;\n                            };\n                        },\n                        // post: function (scope, element, attributes) { }\n                    };\n                }\n                /*\n                compile: function(element, attributes) {\n                    element.removeAttr('my-dir'); \n                    element.attr('ng-hide', 'true');\n                    return function(scope) {\n                        $compile(element)(scope);\n                    };\n                },\n                */\n        };\n    }]);\n\n    app.directive('numberPicker', ['$parse', '$timeout', function($parse, $timeout) {\n        return {\n            restrict: 'A',\n            template: '<div class=\"input-group\">' +\n                '   <span class=\"input-group-btn\"><button class=\"btn btn-outline-primary\" type=\"button\">-</button></span>' +\n                '   <div ng-transclude></div>' +\n                '   <span class=\"input-group-btn\"><button class=\"btn btn-outline-primary\" type=\"button\">+</button></span>' +\n                '</div>',\n            replace: true,\n            transclude: true,\n            link: function(scope, element, attributes, model) {\n                var node = element[0];\n                var nodeRemove = node.querySelectorAll('.input-group-btn > .btn')[0];\n                var nodeAdd = node.querySelectorAll('.input-group-btn > .btn')[1];\n\n                function onRemove(e) {\n                    var min = $parse(attributes.min)(scope);\n                    var getter = $parse(attributes.numberPicker);\n                    var setter = getter.assign;\n                    $timeout(function() {\n                        setter(scope, Math.max(min, getter(scope) - 1));\n                    });\n                    // console.log('numberPicker.onRemove', min);\n                }\n\n                function onAdd(e) {\n                    var max = $parse(attributes.max)(scope);\n                    var getter = $parse(attributes.numberPicker);\n                    var setter = getter.assign;\n                    $timeout(function() {\n                        setter(scope, Math.min(max, getter(scope) + 1));\n                    });\n                    // console.log('numberPicker.onAdd', max);\n                }\n\n                function addListeners() {\n                    angular.element(nodeRemove).on('touchstart mousedown', onRemove);\n                    angular.element(nodeAdd).on('touchstart mousedown', onAdd);\n                }\n\n                function removeListeners() {\n                    angular.element(nodeRemove).off('touchstart mousedown', onRemove);\n                    angular.element(nodeAdd).off('touchstart mousedown', onAdd);\n                }\n                scope.$on('$destroy', function() {\n                    removeListeners();\n                });\n                addListeners();\n            }\n        };\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.directive('validate', ['$filter', function($filter) {\n        return {\n            require: 'ngModel',\n            link: function(scope, element, attributes, model) {\n                var type = attributes.validate;\n                var format = attributes.format || '';\n                var precision = attributes.precision || 2;\n                var focus = false;\n                // console.log('validate', type);\n                switch (type) {\n                    case 'date':\n                    case 'datetime':\n                    case 'datetime-local':\n                        model.$formatters.push(function(value) {\n                            if (value) {\n                                return $filter('date')(value, format);\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                    case 'number':\n                        model.$parsers.unshift(function(value) {\n                            var valid = false;\n                            if (value !== undefined && value !== \"\") {\n                                valid = String(value).indexOf(Number(value).toString()) !== -1; // isFinite(value); // \n                                value = Number(value);\n                                model.$setValidity('number', valid);\n                                if (valid) {\n                                    model.$setValidity('positive', value >= 0.01);\n                                    if (attributes.min !== undefined) {\n                                        model.$setValidity('range', value >= Number(attributes.min));\n                                    }\n                                    if (attributes.max !== undefined) {\n                                        model.$setValidity('range', value <= Number(attributes.max));\n                                    }\n                                }\n                            } else {\n                                valid = true;\n                                value = Number(value);\n                                model.$setValidity('number', true);\n                                model.$setValidity('positive', true);\n                                if (attributes.min !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                                if (attributes.max !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                            }\n                            return value;\n                        });\n                        model.$formatters.push(function(value) {\n                            if (value) {\n                                return $filter('number')(value, precision) + ' ' + format;\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                    case 'anynumber':\n                        model.$parsers.unshift(function(value) {\n                            var valid = false;\n                            if (value !== undefined && value !== \"\") {\n                                valid = String(value).indexOf(Number(value).toString()) !== -1; // isFinite(value); // \n                                value = Number(value);\n                                model.$setValidity('number', valid);\n                                if (valid) {\n                                    if (attributes.min !== undefined) {\n                                        model.$setValidity('range', value >= Number(attributes.min));\n                                    }\n                                    if (attributes.max !== undefined) {\n                                        model.$setValidity('range', value <= Number(attributes.max));\n                                    }\n                                }\n                            } else {\n                                valid = true;\n                                value = Number(value);\n                                model.$setValidity('number', true);\n                                if (attributes.min !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                                if (attributes.max !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                            }\n                            return value;\n                        });\n                        model.$formatters.push(function(value) {\n                            if (value || value === 0) {\n                                return $filter('number')(value, precision) + ' ' + format;\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                }\n\n                function onFocus() {\n                    focus = true;\n                    if (format) {\n                        element[0].value = model.$modelValue || null;\n                        if (!model.$modelValue) {\n                            model.$setViewValue(null);\n                        }\n                    }\n                }\n\n                function doBlur() {\n                    if (format && !model.$invalid) {\n                        switch (type) {\n                            case 'date':\n                            case 'datetime':\n                            case 'datetime-local':\n                                element[0].value = model.$modelValue ? $filter('date')(model.$modelValue, format) : ' ';\n                                break;\n                            default:\n                                element[0].value = model.$modelValue ? $filter('number')(model.$modelValue, precision) + ' ' + format : ' ';\n                                break;\n                        }\n                    }\n                }\n\n                function onBlur() {\n                    focus = false;\n                    doBlur();\n                }\n\n                function addListeners() {\n                    element.on('focus', onFocus);\n                    element.on('blur', onBlur);\n                }\n\n                function removeListeners() {\n                    element.off('focus', onFocus);\n                    element.off('blur', onBlur);\n                }\n                scope.$on('$destroy', function() {\n                    removeListeners();\n                });\n                addListeners();\n            }\n        };\n    }]);\n\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.directive('modalView', ['$parse', '$templateRequest', '$compile', '$controller', 'Utils', function($parse, $templateRequest, $compile, $controller, Utils) {\r\n\r\n        function compileController(scope, element, html, data) {\r\n            // console.log('modalView.compileController', element);\r\n            element.html(html);\r\n            var link = $compile(element.contents());\r\n            if (data.controller) {\r\n                var $scope = scope.$new();\r\n                angular.extend($scope, data);\r\n                var controller = $controller(data.controller, { $scope: $scope });\r\n                if (data.controllerAs) {\r\n                    scope[data.controllerAs] = controller;\r\n                }\r\n                element.data('$ngControllerController', controller);\r\n                element.children().data('$ngControllerController', controller);\r\n                scope = $scope;\r\n            }\r\n            link(scope);\r\n        }\r\n\r\n        return {\r\n            restrict: 'A',\r\n            priority: -400,\r\n            link: function(scope, element, attributes, model) {\r\n                var modal = $parse(attributes.modalView);\r\n                modal = modal(scope);\r\n                modal.templateUrl = modal.templateUrl || 'artisan/modals/modal';\r\n                $templateRequest(modal.templateUrl).then(function(html) {\r\n                    compileController(scope, element, html, modal);\r\n                });\r\n                /*\r\n                // window.scrollTo(0, element[0].offsetTop - 100);\r\n                function onClick(e) {\r\n                    var closest = Utils.getClosestElement(e.target, element[0]);\r\n                    if (closest === null) {\r\n                        modal.reject(null);\r\n                    }\r\n                    // console.log('onClick', closest);\r\n                }\r\n                function addListeners() {\r\n                    angular.element(window).on('click', onClick);\r\n                }\r\n                function removeListeners() {\r\n                    angular.element(window).off('click', onClick);\r\n                }\r\n                scope.$on('destroy', function () {\r\n                    removeListeners();\r\n                });\r\n                setTimeout(function () {\r\n                    addListeners();\r\n                }, 500);\r\n                */\r\n            }\r\n        };\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.provider('$modal', [function $modalProvider() {\r\n\r\n        var modals = [];\r\n        var routes = {};\r\n\r\n        this.modals = modals;\r\n        this.routes = routes;\r\n        this.when = when;\r\n\r\n        function when(path, modal) {\r\n            routes[path] = modal;\r\n            return this;\r\n        }\r\n\r\n        this.$get = ['$q', '$timeout', function modalFactory($q, $timeout) {\r\n\r\n            function popModal(modal) {\r\n                // console.log('modalProvider.popModal', modal);                \r\n                var index = -1;\r\n                angular.forEach(modals, function(m, i) {\r\n                    if (m === modal) {\r\n                        index = i;\r\n                    }\r\n                });\r\n                if (index !== -1) {\r\n                    $timeout(function() {\r\n                        modal.active = false;\r\n                        modals.splice(index, 1);\r\n                        if (modals.length) {\r\n                            modals[modals.length - 1].active = true;\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n\r\n            function closeModal(modal) {\r\n                // console.log('modalProvider.closeModal', modal);                \r\n                var index = -1;\r\n                angular.forEach(modals, function(m, i) {\r\n                    if (m === modal) {\r\n                        index = i;\r\n                    }\r\n                });\r\n                if (index !== -1) {\r\n                    modal.active = false;\r\n                    $timeout(function() {\r\n                        while (modals.length) {\r\n                            modals.splice(modals.length - 1, 1);\r\n                        }\r\n                    }, 500);\r\n                }\r\n            }\r\n\r\n            function addModal(path, params) {\r\n                // console.log('modalProvider.addModal', path, params);\r\n                var deferred = $q.defer();\r\n                params = params || null;\r\n                var modal = {\r\n                    title: 'Untitled',\r\n                    controller: null,\r\n                    templateUrl: null,\r\n                    params: params,\r\n                };\r\n                var current = routes[path];\r\n                if (current) {\r\n                    angular.extend(modal, current);\r\n                }\r\n                modal.deferred = deferred;\r\n                modal.back = function(data) {\r\n                    popModal(this);\r\n                    modal.deferred.resolve(data, modal);\r\n                }\r\n                modal.resolve = function(data) {\r\n                    closeModal(this);\r\n                    modal.deferred.resolve(data, modal);\r\n                }\r\n                modal.reject = function() {\r\n                    closeModal(this);\r\n                    modal.deferred.reject(modal);\r\n                }\r\n                modals.push(modal);\r\n                angular.forEach(modals, function(m, i) {\r\n                    m.active = false;\r\n                });\r\n                if (modals.length) {\r\n                    modal.active = true;\r\n                } else {\r\n                    $timeout(function() {\r\n                        modal.active = true;\r\n                        // window.scrollTo(0, 0);\r\n                    }, 500);\r\n                }\r\n                return deferred.promise;\r\n            }\r\n\r\n            return {\r\n                modals: modals,\r\n                addModal: addModal,\r\n            };\r\n        }];\r\n\r\n    }]);\r\n\r\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.directive('nav', ['$parse', 'Nav', function ($parse, Nav) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\treturn attributes.template || 'artisan/nav/nav';\n\t\t\t},\n\t\t\tscope: {\n\t\t\t\titems: '=nav',\n\t\t\t},\n\t\t\tlink: function (scope, element, attributes, model) {\n\t\t\t\tscope.$watch('items', function (value) {\n\t\t\t\t\t// console.log(value instanceof Nav, value);\n\t\t\t\t\tif (value) {\n\t\t\t\t\t\tif (angular.isArray(value)) {\n\t\t\t\t\t\t\tvar onLink = $parse(attributes.onLink)(scope.$parent);\n\t\t\t\t\t\t\tvar onNav = $parse(attributes.onNav)(scope.$parent);\n\t\t\t\t\t\t\tvar nav = new Nav({\n\t\t\t\t\t\t\t\tonLink: onLink,\n\t\t\t\t\t\t\t\tonNav: onNav\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tnav.setItems(value);\n\t\t\t\t\t\t\tscope.item = nav;\n\n\t\t\t\t\t\t} else if (value instanceof Nav) {\n\t\t\t\t\t\t\tscope.item = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n    }]);\n\n\tapp.directive('navItem', ['$timeout', function ($timeout) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\treturn attributes.template || 'artisan/nav/nav-item';\n\t\t\t},\n\t\t\tscope: {\n\t\t\t\titem: '=navItem',\n\t\t\t},\n\t\t\tlink: function (scope, element, attributes, model) {\n\t\t\t\tvar navItem = angular.element(element[0].querySelector('.nav-link'));\n\n\t\t\t\tvar output;\n\n\t\t\t\tfunction itemOpen(item, immediate) {\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tstate.active = true;\n\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tstate.immediate = immediate;\n\t\t\t\t\t\tstate.closed = state.closing = false;\n\t\t\t\t\t\tstate.opening = true;\n\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\tstate.opening = false;\n\t\t\t\t\t\t\tstate.opened = true;\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction itemClose(item, immediate) {\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tstate.active = false;\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tstate.immediate = immediate;\n\t\t\t\t\t\tstate.opened = state.opening = false;\n\t\t\t\t\t\tstate.closing = true;\n\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\tstate.closing = false;\n\t\t\t\t\t\t\tstate.closed = true;\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tif (item.items) {\n\t\t\t\t\t\tangular.forEach(item.items, function (o) {\n\t\t\t\t\t\t\titemClose(o, true);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction itemToggle(item) {\n\t\t\t\t\t// console.log('itemToggle', item);\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tstate.active = item.items ? !state.active : true;\n\t\t\t\t\tif (state.active) {\n\t\t\t\t\t\tif (item.$nav.parent) {\n\t\t\t\t\t\t\tangular.forEach(item.$nav.parent.items, function (o) {\n\t\t\t\t\t\t\t\tif (o !== item) {\n\t\t\t\t\t\t\t\t\titemClose(o, true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\titemOpen(item);\n\t\t\t\t\t} else {\n\t\t\t\t\t\titemClose(item);\n\t\t\t\t\t}\n\t\t\t\t\t// console.log(state);\n\t\t\t\t}\n\n\t\t\t\tfunction onTap(e) {\n\t\t\t\t\tvar item = scope.item;\n\t\t\t\t\t// console.log('Item.onTap', item);\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tif (state.active) {\n\t\t\t\t\t\toutput = false;\n\t\t\t\t\t\ttrigger();\n\t\t\t\t\t} else if (item.$nav.onNav) {\n\t\t\t\t\t\tvar promise = item.$nav.onNav(item, item.$nav);\n\t\t\t\t\t\tif (promise && typeof promise.then === 'function') {\n\t\t\t\t\t\t\tpromise.then(function (resolved) {\n\t\t\t\t\t\t\t\t// go on\n\t\t\t\t\t\t\t\ttrigger();\n\t\t\t\t\t\t\t}, function (rejected) {\n\t\t\t\t\t\t\t\t// do nothing\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\toutput = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\toutput = promise;\n\t\t\t\t\t\t\ttrigger();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction trigger() {\n\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\titemToggle(item);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onTouchStart(e) {\n\t\t\t\t\t// console.log('Item.onTouchStart', e);\n\t\t\t\t\tonTap(e);\n\t\t\t\t\tnavItem\n\t\t\t\t\t\t.off('mousedown', onMouseDown);\n\t\t\t\t\t// return r || prevent(e);\n\t\t\t\t}\n\n\t\t\t\tfunction onMouseDown(e) {\n\t\t\t\t\t// console.log('Item.onMouseDown', e);\n\t\t\t\t\tonTap(e);\n\t\t\t\t\tnavItem\n\t\t\t\t\t\t.off('touchstart', onTouchStart);\n\t\t\t\t\t// return r || prevent(e);\n\t\t\t\t}\n\n\t\t\t\tfunction onClick(e) {\n\t\t\t\t\t// console.log('Item.onClick', e);\n\t\t\t\t\treturn prevent(e);\n\t\t\t\t}\n\n\t\t\t\tfunction prevent(e) {\n\t\t\t\t\tif (output === false) {\n\t\t\t\t\t\t// console.log('Item.prevent', e);\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t// e.stopPropagation();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction addListeners() {\n\t\t\t\t\tnavItem\n\t\t\t\t\t\t.on('touchstart', onTouchStart)\n\t\t\t\t\t\t.on('mousedown', onMouseDown)\n\t\t\t\t\t\t.on('click', onClick);\n\t\t\t\t}\n\n\t\t\t\tfunction removeListeners() {\n\t\t\t\t\tnavItem\n\t\t\t\t\t\t.off('touchstart', onTouchStart)\n\t\t\t\t\t\t.off('mousedown', onMouseDown)\n\t\t\t\t\t\t.off('click', onClick);\n\t\t\t\t}\n\n\t\t\t\taddListeners();\n\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tremoveListeners();\n\t\t\t\t});\n\t\t\t}\n\t\t};\n    }]);\n\n}());\n\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('Nav', ['$silent', function($silent) {\n        function Nav(options) {\n            var nav = this;\n            var defaults = {\n                items: [],\n            }\n            angular.extend(nav, defaults);\n            if (options) {\n                angular.extend(nav, options);\n            }\n            nav.setNav(nav, null);\n        }\n        Nav.prototype = {\n            setItems: function(items) {\n                var nav = this;\n                nav.path = $silent.path();\n                nav.items = items;\n                nav.setNavs(items, nav);\n            },\n            setNavs: function(items, parent) {\n                var nav = this;\n                if (items) {\n                    angular.forEach(items, function(item) {\n                        nav.setNav(item, parent);\n                        nav.setNavs(item.items, item);\n                    });\n                }\n            },\n            setNav: function(item, parent) {\n                var nav = this;\n                var $nav = {\n                    parent: parent || null,\n                    level: parent ? parent.$nav.level + 1 : 0,\n                    state: {},\n                    addItems: function(x) {\n                        nav.addItems(x, item);\n                    },\n                    onNav: nav.onNav,\n                };\n                item.$nav = $nav;\n                $nav.link = nav.getLink(item);\n                if ($nav.link === nav.path) {\n                    $nav.state.active = true;\n                    $nav.state.opened = true;\n                    while ($nav.parent) {\n                        $nav = $nav.parent.$nav;\n                        $nav.state.active = true;\n                        $nav.state.opened = true;\n                    }\n                }\n            },\n            addItems: function(itemOrItems, parent) {\n                var nav = this;\n                if (angular.isArray(itemOrItems)) {\n                    angular.forEach(itemOrItems, function(item) {\n                        nav.addItem(item, parent);\n                    });\n                } else {\n                    nav.addItem(itemOrItems, parent);\n                }\n            },\n            addItem: function(item, parent) {\n                var nav = this,\n                    onLink = nav.onLink,\n                    onNav = nav.onNav;\n                nav.setNav(item, parent);\n                if (parent) {\n                    parent.items = parent.items || [];\n                    parent.items.push(item);\n                }\n            },\n            getLink: function(item) {\n                var link = null;\n                if (this.onLink) {\n                    link = this.onLink(item, item.$nav);\n                } else {\n                    link = item.link;\n                }\n                return link;\n            },\n        };\n        var statics = {\n            silent: function(path) {\n                $silent.silent(path);\n            },\n            path: function(path) {\n                $silent.path(path);\n            },\n        };\n        angular.extend(Nav, statics);\n        return Nav;\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\twindow.ondragstart = function () {\n\t\treturn false;\n\t};\n\n\tvar app = angular.module('artisan');\n\n\tapp.directive('scrollableX', ['$parse', '$compile', '$window', '$timeout', 'Scrollable', 'Animate', 'Style', 'Events', 'Utils', function ($parse, $compile, $window, $timeout, Scrollable, Animate, Style, Events, Utils) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplate: '<div class=\"content\" ng-transclude></div>',\n\t\t\ttransclude: true,\n\t\t\tlink: function (scope, element, attributes, model) {\n\n\t\t\t\tvar onLeft, onRight, showIndicatorFor, scrollableWhen;\n\t\t\t\tif (attributes.onLeft) {\n\t\t\t\t\tonLeft = $parse(attributes.onLeft);\n\t\t\t\t}\n\t\t\t\tif (attributes.onRight) {\n\t\t\t\t\tonRight = $parse(attributes.onRight);\n\t\t\t\t}\n\t\t\t\tif (attributes.showIndicatorFor) {\n\t\t\t\t\tshowIndicatorFor = $parse(attributes.showIndicatorFor);\n\t\t\t\t}\n\t\t\t\tif (attributes.scrollableWhen) {\n\t\t\t\t\tscrollableWhen = $parse(attributes.scrollableWhen);\n\t\t\t\t}\n\n\t\t\t\t// ELEMENTS & STYLESHEETS;\n\t\t\t\telement.attr('unselectable', 'on').addClass('unselectable');\n\t\t\t\tvar containerNode = element[0];\n\t\t\t\tvar contentNode = containerNode.querySelector('.content');\n\t\t\t\tvar content = angular.element(content);\n\t\t\t\tvar contentStyle = new Style();\n\n\t\t\t\tvar animate = new Animate(render);\n\n\t\t\t\tvar scrollable = attributes.scrollableX ? $parse(attributes.scrollableX)(scope) : new Scrollable();\n\t\t\t\tlink(scrollable);\n\n\t\t\t\tfunction link(scrollable) {\n\t\t\t\t\tscrollable.link({\n\t\t\t\t\t\tgetItems: function () {\n\t\t\t\t\t\t\tif (attributes.scrollableItem) {\n\t\t\t\t\t\t\t\tvar items = containerNode.querySelectorAll(attributes.scrollableItem);\n\t\t\t\t\t\t\t\treturn items;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tprev: function () {\n\t\t\t\t\t\t\tscrollable.scrollPrev();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnext: function () {\n\t\t\t\t\t\t\tscrollable.scrollNext();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\treset: function () {\n\t\t\t\t\t\t\tscrollable.doReset();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonLeft: onLeft,\n\t\t\t\t\t\tonRight: onRight,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t/*\n\t\t\t\tscope.$watch(attributes.scrollableX, function (newValue) {\n\t\t\t\t\tconsole.log(newValue);\n\t\t\t\t});\n\t\t\t\t*/\n\n\t\t\t\t/*\n\t\t\t\tvar indicator = null,\n\t\t\t\t\tindicatorNode = null,\n\t\t\t\t\tindicatorStyle;\n\t\t\t\tshowIndicatorFor = false;\n\t\t\t\tif (showIndicatorFor) {\n\t\t\t\t\tindicator = angular.element('<div class=\"indicator\"></div>');\n\t\t\t\t\tindicatorNode = indicator[0];\n\t\t\t\t\tindicatorStyle = new Style();\n\t\t\t\t\telement.append(indicator);\n\t\t\t\t\t$compile(indicator.contents())(scope);\n\t\t\t\t\tvar i = scrollbar.getIndicator();\n\t\t\t\t\tindicatorStyle.transform('translate3d(' + i.x.toFixed(2) + 'px,' + i.y.toFixed(2) + 'px,0)');\n\t\t\t\t\tindicatorStyle.set(indicatorNode);\n\t\t\t\t}\n\t\t\t\t*/\n\n\t\t\t\tfunction render(time) {\n\t\t\t\t\tscrollable.setContainer(containerNode);\n\t\t\t\t\tscrollable.setContent(contentNode);\n\t\t\t\t\tscrollable.setEnabled(isEnabled());\n\t\t\t\t\tvar animating = scrollable.renderX();\n\t\t\t\t\tif (!animating) {\n\t\t\t\t\t\t// animate.pause();\n\t\t\t\t\t}\n\t\t\t\t\tvar current = scrollable.getCurrent();\n\t\t\t\t\tcontentStyle.transform('translate3d(' + current.x.toFixed(2) + 'px,0,0)');\n\t\t\t\t\tcontentStyle.set(contentNode);\n\t\t\t\t\t/*\n\t\t\t\t\tif (showIndicatorFor) {\n\t\t\t\t\t\tif (dragging || wheeling || speed) {\n\t\t\t\t\t\t\tvar percent = c.x / (containerNode.offsetWidth - contentNode.offsetWidth);\n\t\t\t\t\t\t\tpercent = Math.max(0, Math.min(1, percent));\n\t\t\t\t\t\t\ti.x = (containerNode.offsetWidth - indicatorNode.offsetWidth) * (percent);\n\t\t\t\t\t\t\ti.y += (0 - i.y) / 4;\n\t\t\t\t\t\t\t// var count = Math.round(contentNode.offsetWidth / 315);\n\t\t\t\t\t\t\tvar index = Math.max(1, Math.round(percent * showIndicatorFor.rows.length));\n\t\t\t\t\t\t\tindicator.html(index + '/' + showIndicatorFor.count);\n\t\t\t\t\t\t\t// indicator.html((percent * 100).toFixed(2).toString());\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ti.y += (45 - i.y) / 4;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tindicatorStyle.transform('translate3d(' + i.x.toFixed(2) + 'px,' + i.y.toFixed(2) + 'px,0)');\n\t\t\t\t\t\tindicatorStyle.set(indicatorNode);\n\t\t\t\t\t}\n\t\t\t\t\t*/\n\t\t\t\t}\n\n\t\t\t\tfunction undrag() {\n\t\t\t\t\tscrollable.off();\n\t\t\t\t\tdragOff();\n\t\t\t\t}\n\n\t\t\t\tfunction onDown(event) {\n\t\t\t\t\tif (scrollable.dragStart(event.absolute)) {\n\t\t\t\t\t\tdragOn();\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onMove(event) {\n\t\t\t\t\tscrollable.dragMove(event.absolute);\n\t\t\t\t\tvar drag = scrollable.getDrag();\n\t\t\t\t\tif (Math.abs(drag.y) > Math.abs(drag.x)) {\n\t\t\t\t\t\tonUp(event);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onUp(event) {\n\t\t\t\t\tscrollable.dragEnd(event.absolute);\n\t\t\t\t\tevent.stop();\n\t\t\t\t\tdragOff();\n\t\t\t\t}\n\n\t\t\t\tfunction _onScrollX(dir, interval) {\n\t\t\t\t\treturn scrollable.wheelX(dir, interval);\n\t\t\t\t}\n\n\t\t\t\tvar onScrollX = _onScrollX;\n\t\t\t\t// var onScrollX = Utils.throttle(_onScrollX, 25);\n\n\t\t\t\tfunction onWheel(event) {\n\t\t\t\t\tconsole.log('onWheelX', event.dir, scrollable.wheelXCheck(event.dir));\n\t\t\t\t\tif (scrollable.wheelXCheck(event.dir)) {\n\t\t\t\t\t\tonScrollX(event.dir, event.interval);\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction off() {\n\t\t\t\t\tdragOff();\n\t\t\t\t\t// animate.pause();\n\t\t\t\t\tscrollable.off();\n\t\t\t\t}\n\n\t\t\t\tfunction isEnabled() {\n\t\t\t\t\tvar enabled = true;\n\t\t\t\t\tif (scrollableWhen) {\n\t\t\t\t\t\tenabled = enabled && scrollableWhen(scope);\n\t\t\t\t\t}\n\t\t\t\t\tenabled = enabled && $window.innerWidth >= 1024;\n\t\t\t\t\tenabled = enabled && (containerNode.offsetWidth < contentNode.offsetWidth);\n\t\t\t\t\treturn enabled;\n\t\t\t\t}\n\n\t\t\t\tfunction onResize() {\n\t\t\t\t\tvar enabled = isEnabled();\n\t\t\t\t\tif (!enabled) {\n\t\t\t\t\t\toff();\n\t\t\t\t\t}\n\t\t\t\t\trender();\n\t\t\t\t}\n\n\t\t\t\tscope.$watch(function () {\n\t\t\t\t\treturn contentNode.offsetWidth;\n\t\t\t\t}, function (newValue, oldValue) {\n\t\t\t\t\tonResize();\n\t\t\t\t});\n\n\t\t\t\tconsole.log('registeX');\n\n\t\t\t\tvar events = new Events(element).add({\n\t\t\t\t\tdown: onDown,\n\t\t\t\t\twheel: onWheel,\n\t\t\t\t}, scope);\n\n\t\t\t\tvar windowEvents = new Events($window).add({\n\t\t\t\t\tresize: onResize,\n\t\t\t\t}, scope);\n\n\t\t\t\tfunction dragOn() {\n\t\t\t\t\twindowEvents.add({\n\t\t\t\t\t\tmove: onMove,\n\t\t\t\t\t\tup: onUp,\n\t\t\t\t\t}, scope);\n\t\t\t\t}\n\n\t\t\t\tfunction dragOff() {\n\t\t\t\t\twindowEvents.remove({\n\t\t\t\t\t\tmove: onMove,\n\t\t\t\t\t\tup: onUp,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tanimate.pause();\n\t\t\t\t});\n\n\t\t\t},\n\t\t};\n    }]);\n\n\tapp.directive('scrollableY', ['$parse', '$compile', '$window', '$timeout', 'Scrollable', 'Animate', 'Style', 'Events', 'Utils', function ($parse, $compile, $window, $timeout, Scrollable, Animate, Style, Events, Utils) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplate: '<div class=\"content\" ng-transclude></div>',\n\t\t\ttransclude: true,\n\t\t\tlink: function (scope, element, attributes, model) {\n\n\t\t\t\tvar onTop, onBottom, showIndicatorFor, scrollableWhen;\n\t\t\t\tif (attributes.onTop) {\n\t\t\t\t\tonTop = $parse(attributes.onTop);\n\t\t\t\t}\n\t\t\t\tif (attributes.onBottom) {\n\t\t\t\t\tonBottom = $parse(attributes.onBottom);\n\t\t\t\t}\n\t\t\t\tif (attributes.showIndicatorFor) {\n\t\t\t\t\tshowIndicatorFor = $parse(attributes.showIndicatorFor);\n\t\t\t\t}\n\t\t\t\tif (attributes.scrollableWhen) {\n\t\t\t\t\tscrollableWhen = $parse(attributes.scrollableWhen);\n\t\t\t\t}\n\n\t\t\t\t// ELEMENTS & STYLESHEETS;\n\t\t\t\telement.attr('unselectable', 'on').addClass('unselectable');\n\t\t\t\tvar containerNode = element[0];\n\t\t\t\tvar contentNode = containerNode.querySelector('.content');\n\t\t\t\tvar content = angular.element(content);\n\t\t\t\tvar contentStyle = new Style();\n\n\t\t\t\tvar animate = new Animate(render);\n\n\t\t\t\tvar scrollable = attributes.scrollableY ? $parse(attributes.scrollableY)(scope) : new Scrollable();\n\t\t\t\tlink(scrollable);\n\n\t\t\t\tfunction link(scrollable) {\n\t\t\t\t\tscrollable.link({\n\t\t\t\t\t\tgetItems: function () {\n\t\t\t\t\t\t\tif (attributes.scrollableItem) {\n\t\t\t\t\t\t\t\tvar items = containerNode.querySelectorAll(attributes.scrollableItem);\n\t\t\t\t\t\t\t\treturn items;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tprev: function () {\n\t\t\t\t\t\t\tscrollable.scrollPrev();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnext: function () {\n\t\t\t\t\t\t\tscrollable.scrollNext();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\treset: function () {\n\t\t\t\t\t\t\tscrollable.doReset();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonTop: onTop,\n\t\t\t\t\t\tonBottom: onBottom,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction render(time) {\n\t\t\t\t\tscrollable.setContainer(containerNode);\n\t\t\t\t\tscrollable.setContent(contentNode);\n\t\t\t\t\tscrollable.setEnabled(isEnabled());\n\t\t\t\t\tvar animating = scrollable.renderY();\n\t\t\t\t\tif (!animating) {\n\t\t\t\t\t\t// animate.pause();\n\t\t\t\t\t}\n\t\t\t\t\tvar current = scrollable.getCurrent();\n\t\t\t\t\tcontentStyle.transform('translate3d(0,' + current.y.toFixed(2) + 'px,0)');\n\t\t\t\t\tcontentStyle.set(contentNode);\n\t\t\t\t}\n\n\t\t\t\tfunction undrag() {\n\t\t\t\t\tscrollable.off();\n\t\t\t\t\tdragOff();\n\t\t\t\t}\n\n\t\t\t\tfunction onDown(event) {\n\t\t\t\t\tif (scrollable.dragStart(event.absolute)) {\n\t\t\t\t\t\tdragOn();\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onMove(event) {\n\t\t\t\t\tscrollable.dragMove(event.absolute);\n\t\t\t\t\tvar drag = scrollable.getDrag();\n\t\t\t\t\tif (Math.abs(drag.x) > Math.abs(drag.y)) {\n\t\t\t\t\t\tonUp(event);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onUp(event) {\n\t\t\t\t\tscrollable.dragEnd(event.absolute);\n\t\t\t\t\tevent.stop();\n\t\t\t\t\tdragOff();\n\t\t\t\t}\n\n\t\t\t\tfunction _onScrollY(dir, interval) {\n\t\t\t\t\treturn scrollable.wheelY(dir, interval);\n\t\t\t\t}\n\n\t\t\t\tvar onScrollY = _onScrollY;\n\t\t\t\t// var onScrollY = Utils.throttle(_onScrollY, 25);\n\n\t\t\t\tfunction onWheel(event) {\n\t\t\t\t\tconsole.log('onWheelY', event.dir, scrollable.wheelYCheck(event.dir));\n\t\t\t\t\tif (scrollable.wheelYCheck(event.dir)) {\n\t\t\t\t\t\tonScrollY(event.dir, event.interval);\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction off() {\n\t\t\t\t\tdragOff();\n\t\t\t\t\t// animate.pause();\n\t\t\t\t\tscrollable.off();\n\t\t\t\t}\n\n\t\t\t\tfunction isEnabled() {\n\t\t\t\t\tvar enabled = true;\n\t\t\t\t\tif (scrollableWhen) {\n\t\t\t\t\t\tenabled = enabled && scrollableWhen(scope);\n\t\t\t\t\t}\n\t\t\t\t\tenabled = enabled && $window.innerWidth >= 1024;\n\t\t\t\t\tenabled = enabled && (containerNode.offsetHeight < contentNode.offsetHeight);\n\t\t\t\t\treturn enabled;\n\t\t\t\t}\n\n\t\t\t\tfunction onResize() {\n\t\t\t\t\tvar enabled = isEnabled();\n\t\t\t\t\tif (!enabled) {\n\t\t\t\t\t\toff();\n\t\t\t\t\t}\n\t\t\t\t\trender();\n\t\t\t\t}\n\n\t\t\t\tscope.$watch(function () {\n\t\t\t\t\treturn contentNode.offsetHeight;\n\t\t\t\t}, function (newValue, oldValue) {\n\t\t\t\t\tonResize();\n\t\t\t\t});\n\n\t\t\t\tconsole.log('registeY');\n\n\t\t\t\tvar events = new Events(element).add({\n\t\t\t\t\tdown: onDown,\n\t\t\t\t\twheel: onWheel,\n\t\t\t\t}, scope);\n\n\t\t\t\tvar windowEvents = new Events($window).add({\n\t\t\t\t\tresize: onResize,\n\t\t\t\t}, scope);\n\n\t\t\t\tfunction dragOn() {\n\t\t\t\t\twindowEvents.add({\n\t\t\t\t\t\tmove: onMove,\n\t\t\t\t\t\tup: onUp,\n\t\t\t\t\t}, scope);\n\t\t\t\t}\n\n\t\t\t\tfunction dragOff() {\n\t\t\t\t\twindowEvents.remove({\n\t\t\t\t\t\tmove: onMove,\n\t\t\t\t\t\tup: onUp,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tanimate.pause();\n\t\t\t\t});\n\n\t\t\t},\n\t\t};\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Scrollable', ['Utils', 'Point', 'Rect', function (Utils, Point, Rect) {\n\n\t\tfunction Scrollable() {\n\n\t\t\tvar padding = 150;\n\t\t\tvar enabled, snappable, busy, dragging, wheeling, down, move, prev;\n\t\t\tvar currentIndex = 0;\n\n\t\t\tsnappable = true;\n\n\t\t\tvar start = new Point(),\n\t\t\t\tend = new Point(),\n\t\t\t\tcurrent = new Point(),\n\t\t\t\tdrag = new Point(),\n\t\t\t\tindicator = new Point(),\n\t\t\t\toffset = new Point(),\n\t\t\t\tspeed = new Point(),\n\t\t\t\tcontainer = new Rect(),\n\t\t\t\tcontent = new Rect(),\n\t\t\t\toverflow = new Rect();\n\n\t\t\tvar scrollable = {\n\t\t\t\t// properties\n\t\t\t\tstart: start,\n\t\t\t\tend: end,\n\t\t\t\tcurrent: current,\n\t\t\t\tindicator: indicator,\n\t\t\t\tspeed: speed,\n\t\t\t\toverflow: overflow,\n\t\t\t\tcontainer: container,\n\t\t\t\tcontent: content,\n\t\t\t\t// methods\n\t\t\t\tsetContainer: setContainer,\n\t\t\t\tsetContent: setContent,\n\t\t\t\tsetEnabled: setEnabled,\n\t\t\t\tgetCurrent: getCurrent,\n\t\t\t\tgetDrag: getDrag,\n\t\t\t\tgetIndicator: getIndicator,\n\t\t\t\tscrollToIndex: scrollToIndex,\n\t\t\t\tscrollPrev: scrollPrev,\n\t\t\t\tscrollNext: scrollNext,\n\t\t\t\tdragStart: dragStart,\n\t\t\t\tdragMove: dragMove,\n\t\t\t\tdragEnd: dragEnd,\n\t\t\t\tdoReset: doReset,\n\t\t\t\toff: off,\n\t\t\t\t// x direction\n\t\t\t\tdoLeft: doLeft,\n\t\t\t\tdoRight: doRight,\n\t\t\t\trenderX: renderX,\n\t\t\t\tscrollToX: scrollToX,\n\t\t\t\twheelX: wheelX,\n\t\t\t\twheelXCheck: wheelXCheck,\n\t\t\t\t// y direction\n\t\t\t\tdoTop: doTop,\n\t\t\t\tdoBottom: doBottom,\n\t\t\t\trenderY: renderY,\n\t\t\t\tscrollToY: scrollToY,\n\t\t\t\twheelY: wheelY,\n\t\t\t\twheelYCheck: wheelYCheck,\n\t\t\t};\n\n\t\t\tangular.extend(this, scrollable);\n\n\t\t\tscrollable = this;\n\n\t\t\tfunction setContainer(node) {\n\t\t\t\tcontainer.width = node.offsetWidth;\n\t\t\t\tcontainer.height = node.offsetHeight;\n\t\t\t}\n\n\t\t\tfunction setContent(node) {\n\t\t\t\tcontent.width = node.offsetWidth;\n\t\t\t\tcontent.height = node.offsetHeight;\n\t\t\t}\n\n\t\t\tfunction setEnabled(flag) {\n\t\t\t\tenabled = flag;\n\t\t\t}\n\n\t\t\tfunction getCurrent() {\n\t\t\t\treturn current;\n\t\t\t}\n\n\t\t\tfunction getDrag() {\n\t\t\t\treturn drag;\n\t\t\t}\n\n\t\t\tfunction getIndicator() {\n\t\t\t\treturn indicator;\n\t\t\t}\n\n\t\t\tfunction scrollToIndex(index) {\n\t\t\t\tif (index !== currentIndex) {\n\t\t\t\t\tcurrentIndex = index;\n\t\t\t\t\tvar item = getItemAtIndex(index);\n\t\t\t\t\tif (item) {\n\t\t\t\t\t\toffset.x = item.offsetLeft;\n\t\t\t\t\t\toffset.y = item.offsetTop;\n\t\t\t\t\t\t// console.log('scrollToIndex', index, offset);\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction dragStart(point) {\n\t\t\t\tif (!busy) {\n\t\t\t\t\tstart.x = end.x = current.x;\n\t\t\t\t\tstart.y = end.y = current.y;\n\t\t\t\t\tspeed.x = 0;\n\t\t\t\t\tspeed.y = 0;\n\t\t\t\t\tdown = point;\n\t\t\t\t\tcurrentIndex = -1;\n\t\t\t\t\twheeling = false;\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction dragMove(point) {\n\t\t\t\tprev = move;\n\t\t\t\tmove = point;\n\t\t\t\tdrag.x = move.x - down.x;\n\t\t\t\tdrag.y = move.y - down.y;\n\t\t\t\tdragging = true;\n\t\t\t}\n\n\t\t\tfunction dragEnd() {\n\t\t\t\tif (move && prev) {\n\t\t\t\t\tspeed.x += (move.x - prev.x) * 4;\n\t\t\t\t\tspeed.y += (move.y - prev.y) * 4;\n\t\t\t\t}\n\t\t\t\tstart.x = end.x = current.x;\n\t\t\t\tstart.y = end.y = current.y;\n\t\t\t\tdragging = false;\n\t\t\t\tmove = null;\n\t\t\t\tdown = null;\n\t\t\t\tprev = null;\n\t\t\t}\n\n\t\t\tfunction getItemAtIndex(index) {\n\t\t\t\tvar item = null;\n\t\t\t\tvar items = scrollable.getItems();\n\t\t\t\tif (items) {\n\t\t\t\t\tif (index >= 0 && index < items.length) {\n\t\t\t\t\t\titem = items[index];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// console.log('getItemAtIndex', index, items.length, item);\n\t\t\t\treturn item;\n\t\t\t}\n\n\t\t\tfunction scrollPrev() {\n\t\t\t\tvar index = Math.max(0, currentIndex - 1);\n\t\t\t\t// console.log('scrollPrev', index);\n\t\t\t\tscrollToIndex(index);\n\t\t\t}\n\n\t\t\tfunction scrollNext() {\n\t\t\t\tvar items = scrollable.getItems();\n\t\t\t\tvar index = Math.min(items.length - 1, currentIndex + 1);\n\t\t\t\t// console.log('scrollNext', index);\n\t\t\t\tscrollToIndex(index);\n\t\t\t}\n\n\t\t\tfunction doReset() {\n\t\t\t\tend.x = current.x = 0;\n\t\t\t}\n\n\t\t\tfunction off() {\n\t\t\t\tdragging = false;\n\t\t\t\twheeling = false;\n\t\t\t\tmove = null;\n\t\t\t\tdown = null;\n\t\t\t}\n\n\t\t\t// x - direction\n\n\t\t\tfunction doLeft(scope) {\n\t\t\t\tif (busy) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!scrollable.onLeft) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tbusy = true;\n\t\t\t\tscrollable.onLeft(scope).then().finally(function () {\n\t\t\t\t\tscrollToX(0);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction doRight(scope) {\n\t\t\t\tif (busy) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!scrollable.onRight) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tbusy = true;\n\t\t\t\tscrollable.onRight(scope).then().finally(function () {\n\t\t\t\t\tvar right = container.width - content.width;\n\t\t\t\t\tif (right > overflow.width) {\n\t\t\t\t\t\tstart.x = end.x = overflow.width;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstart.x = end.x = overflow.width + padding;\n\t\t\t\t\t}\n\t\t\t\t\tscrollToX(0);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction renderX() {\n\t\t\t\tvar animating = true;\n\t\t\t\tif (enabled) {\n\t\t\t\t\toverflow.x = 0;\n\t\t\t\t\toverflow.width = container.width - content.width;\n\t\t\t\t\tif (dragging) {\n\t\t\t\t\t\tend.x = start.x + move.x - down.x;\n\t\t\t\t\t\tif (extendX()) {\n\t\t\t\t\t\t\tstart.x = end.x;\n\t\t\t\t\t\t\tdown.x = move.x;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (speed.x) {\n\t\t\t\t\t\tend.x += speed.x;\n\t\t\t\t\t\tspeed.x *= 0.75;\n\t\t\t\t\t\tif (wheeling) {\n\t\t\t\t\t\t\textendX();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (Math.abs(speed.x) < 2.05) {\n\t\t\t\t\t\t\tspeed.x = 0;\n\t\t\t\t\t\t\tscrollable.wheeling = wheeling = false;\n\t\t\t\t\t\t\tsnapToNearestX();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (offset.x) {\n\t\t\t\t\t\tend.x = -offset.x;\n\t\t\t\t\t\toffset.x = 0;\n\t\t\t\t\t}\n\t\t\t\t\tend.x = Math.round(end.x * 10000) / 10000;\n\t\t\t\t\tend.x = Math.min(overflow.x, end.x);\n\t\t\t\t\tend.x = Math.max(overflow.width, end.x);\n\t\t\t\t\tcurrent.x += (end.x - current.x) / 4;\n\t\t\t\t\tif (speed.x === 0 && Math.abs(end.x - current.x) < 0.05) {\n\t\t\t\t\t\tcurrent.x = end.x;\n\t\t\t\t\t\tif (!snapToNearestX()) {\n\t\t\t\t\t\t\tanimating = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// console.log('renderX', current.x, end.x, overflow.x);\n\t\t\t\t} else {\n\t\t\t\t\tcurrent.x = end.x = 0;\n\t\t\t\t\tanimating = false;\n\t\t\t\t}\n\t\t\t\treturn animating;\n\t\t\t}\n\n\t\t\tfunction extendX() {\n\t\t\t\tvar extending = false;\n\t\t\t\toverflow.x += padding;\n\t\t\t\toverflow.width -= padding;\n\t\t\t\tif (end.x > overflow.x) {\n\t\t\t\t\textending = true;\n\t\t\t\t\tdoLeft();\n\t\t\t\t} else if (end.x < overflow.width) {\n\t\t\t\t\textending = true;\n\t\t\t\t\tdoRight();\n\t\t\t\t}\n\t\t\t\treturn extending;\n\t\t\t}\n\n\t\t\tfunction snapToNearestX() {\n\t\t\t\tvar items = scrollable.getItems();\n\t\t\t\tif (items) {\n\t\t\t\t\tvar index = -1;\n\t\t\t\t\tvar min = Number.POSITIVE_INFINITY;\n\t\t\t\t\tangular.forEach(items, function (item, i) {\n\t\t\t\t\t\tvar distance = Math.abs((end.x + speed.x) - (item.offsetLeft * -1));\n\t\t\t\t\t\tif (distance < min) {\n\t\t\t\t\t\t\tmin = distance;\n\t\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\tif (snappable) { // && !Utils.ua.mac) {\n\t\t\t\t\t\t\treturn scrollToIndex(index);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcurrentIndex = index;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction wheelXCheck(dir) {\n\t\t\t\t// console.log('wheelYCheck', dir < 0 ? (end.x - overflow.width) : (end.x - overflow.x));\n\t\t\t\tif (!busy && enabled) {\n\t\t\t\t\tif (dir < 0) {\n\t\t\t\t\t\treturn end.x - overflow.width;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn end.x - overflow.x;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction wheelXIncrement(dir, interval) {\n\t\t\t\tvar increment = 100;\n\t\t\t\tif (snappable) {\n\t\t\t\t\tvar items = scrollable.getItems();\n\t\t\t\t\tif (items) {\n\t\t\t\t\t\tvar index = Math.max(0, Math.min(items.length - 1, currentIndex + dir));\n\t\t\t\t\t\tincrement = items[index].offsetWidth;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn increment / 1000 * interval;\n\t\t\t}\n\n\t\t\tfunction wheelX(dir, interval) {\n\t\t\t\t// end.x += dir * wheelXIncrement(dir, interval);\n\t\t\t\tend.x += dir * 200 / 1000 * interval;\n\t\t\t\tspeed.x += dir * 200 / 1000 * interval;\n\t\t\t\twheeling = true;\n\t\t\t}\n\n\t\t\tfunction scrollToX(value) {\n\t\t\t\tstart.x = end.x = value;\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\toff();\n\t\t\t\t\tbusy = false;\n\t\t\t\t}, 500);\n\t\t\t}\n\n\t\t\t// y - direction\n\n\t\t\tfunction doTop(scope) {\n\t\t\t\tif (busy) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!scrollable.onTop) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tbusy = true;\n\t\t\t\tscrollable.onTop(scope).then().finally(function () {\n\t\t\t\t\tscrollToY(0);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction doBottom(scope) {\n\t\t\t\tif (busy) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!scrollable.onBottom) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tbusy = true;\n\t\t\t\tscrollable.onBottom(scope).then().finally(function () {\n\t\t\t\t\tvar bottom = container.height - content.height;\n\t\t\t\t\tif (bottom > overflow.height) {\n\t\t\t\t\t\tstart.y = end.y = overflow.height;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstart.y = end.y = overflow.height + padding;\n\t\t\t\t\t}\n\t\t\t\t\tscrollToY(0);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction renderY() {\n\t\t\t\tvar animating = true;\n\t\t\t\tif (enabled) {\n\t\t\t\t\toverflow.y = 0;\n\t\t\t\t\toverflow.height = container.height - content.height;\n\t\t\t\t\tif (dragging) {\n\t\t\t\t\t\tend.y = start.y + move.y - down.y;\n\t\t\t\t\t\tif (extendY()) {\n\t\t\t\t\t\t\tstart.y = end.y;\n\t\t\t\t\t\t\tdown.y = move.y;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (speed.y) {\n\t\t\t\t\t\tend.y += speed.y;\n\t\t\t\t\t\tspeed.y *= 0.75;\n\t\t\t\t\t\tif (wheeling) {\n\t\t\t\t\t\t\textendY();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (Math.abs(speed.y) < 2.05) {\n\t\t\t\t\t\t\tspeed.y = 0;\n\t\t\t\t\t\t\tscrollable.wheeling = wheeling = false;\n\t\t\t\t\t\t\tsnapToNearestY();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (offset.y) {\n\t\t\t\t\t\tend.y = -offset.y;\n\t\t\t\t\t\toffset.y = 0;\n\t\t\t\t\t}\n\t\t\t\t\tend.y = Math.round(end.y * 10000) / 10000;\n\t\t\t\t\tend.y = Math.min(overflow.y, end.y);\n\t\t\t\t\tend.y = Math.max(overflow.height, end.y);\n\t\t\t\t\tcurrent.y += (end.y - current.y) / 4;\n\t\t\t\t\tif (speed.y === 0 && Math.abs(end.y - current.y) < 0.05) {\n\t\t\t\t\t\tcurrent.y = end.y;\n\t\t\t\t\t\tanimating = false;\n\t\t\t\t\t\tif (!snapToNearestY()) {\n\t\t\t\t\t\t\tanimating = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// console.log(parseFloat(current.y.toFixed(6)), end.y, overflow.y);\n\t\t\t\t\t// console.log(dragging, wheeling, end.y, speed.y, Math.abs(end.y - current.y));\n\t\t\t\t} else {\n\t\t\t\t\tcurrent.y = end.y = 0;\n\t\t\t\t\tanimating = false;\n\t\t\t\t}\n\t\t\t\treturn animating;\n\t\t\t}\n\n\t\t\tfunction extendY() {\n\t\t\t\tvar extending = false;\n\t\t\t\toverflow.y += padding;\n\t\t\t\toverflow.height -= padding;\n\t\t\t\tif (end.y > overflow.y) {\n\t\t\t\t\textending = true;\n\t\t\t\t\tdoTop();\n\t\t\t\t} else if (end.y < overflow.height) {\n\t\t\t\t\textending = true;\n\t\t\t\t\tdoBottom();\n\t\t\t\t}\n\t\t\t\treturn extending;\n\t\t\t}\n\n\t\t\tfunction snapToNearestY() {\n\t\t\t\tvar items = scrollable.getItems();\n\t\t\t\tif (items) {\n\t\t\t\t\tvar index = -1;\n\t\t\t\t\tvar min = Number.POSITIVE_INFINITY;\n\t\t\t\t\tangular.forEach(items, function (item, i) {\n\t\t\t\t\t\tvar distance = Math.abs((end.y + speed.y) - (item.offsetTop * -1));\n\t\t\t\t\t\tif (distance < min) {\n\t\t\t\t\t\t\tmin = distance;\n\t\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\tif (snappable) { // && !Utils.ua.mac) {\n\t\t\t\t\t\t\treturn scrollToIndex(index);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcurrentIndex = index;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction wheelYCheck(dir) {\n\t\t\t\t// console.log('wheelYCheck', dir < 0 ? (end.y - overflow.height) : (end.y - overflow.y));\n\t\t\t\tif (!busy && enabled) {\n\t\t\t\t\tif (dir < 0) {\n\t\t\t\t\t\treturn end.y - overflow.height;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn end.y - overflow.y;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction wheelYIncrement(dir, interval) {\n\t\t\t\tvar increment = 100;\n\t\t\t\tif (snappable) {\n\t\t\t\t\tvar items = scrollable.getItems();\n\t\t\t\t\tif (items) {\n\t\t\t\t\t\tvar index = Math.max(0, Math.min(items.length - 1, currentIndex + dir));\n\t\t\t\t\t\tincrement = items[index].offsetHeight;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn increment / 1000 * interval;\n\t\t\t}\n\n\t\t\tfunction wheelY(dir, interval) {\n\t\t\t\t// end.y += dir * wheelYIncrement(dir, interval);\n\t\t\t\tend.y += dir * 200 / 1000 * interval;\n\t\t\t\tspeed.y += dir * 200 / 1000 * interval;\n\t\t\t\twheeling = true;\n\t\t\t}\n\n\t\t\tfunction scrollToY(value) {\n\t\t\t\tstart.y = end.y = value;\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\toff();\n\t\t\t\t\tbusy = false;\n\t\t\t\t}, 500);\n\t\t\t}\n\n\t\t}\n\n\t\tfunction link(methods) {\n\t\t\tangular.extend(this, methods);\n\t\t}\n\n\t\tScrollable.prototype = {\n\t\t\tlink: link,\n\t\t\tgetItems: function () {\n\t\t\t\treturn [content];\n\t\t\t},\n\t\t};\n\t\treturn Scrollable;\n\t\t}]);\n\n}());\n/* global angular */\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    // micro interactions\n\n    function tap(Events) {\n        return {\n            restrict: 'A',\n            priority: 0,\n            link: link\n        };\n\n        function link(scope, element, attributes, model) {\n            if (attributes.ngBind) {\n                return;\n            }\n            if (attributes.href === '#' && !attributes.ngHref && !attributes.ngClick) {\n                return;\n            }\n\n            element.addClass('interaction-tap');\n            var node = document.createElement('interaction');\n            element[0].appendChild(node);\n\n            function onDown(e) {\n                element.removeClass('interaction-animate');\n                void element.offsetWidth;\n                // node.style.animationPlayState = \"paused\";\n                node.style.left = e.relative.x + 'px';\n                node.style.top = e.relative.y + 'px';\n                setTimeout(function() {\n                    element.addClass('interaction-animate');\n                    setTimeout(function() {\n                        element.removeClass('interaction-animate');\n                    }, 1000);\n                }, 10);\n\n                // console.log('tap.onDown', node, node.parentElement);\n            }\n            var listeners = { // down, move, up, click\n                down: onDown,\n            };\n            var events = new Events(element).add(listeners, scope); // passing scope to add remove listeners automatically on $destroy\n        }\n    }\n    app.directive('href', ['Events', tap]);\n    app.directive('ngClick', ['Events', tap]);\n\n}());"]}