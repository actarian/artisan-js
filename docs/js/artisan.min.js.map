{"version":3,"sources":["docs/js/artisan.js"],"names":["angular","module","service","$promise","environment","Facebook","promise","undefined","window","FB","resolve","FacebookInit","then","success","error","reject","FacebookStatus","response","init","authResponse","status","FacebookGetMe","fields","config","FacebookLogin","facebook","console","log","api","FacebookGetMyPicture","size","width","height","type","login","scope","FacebookLogout","logout","fbAsyncInit","appId","app_id","cookie","xfbml","version","d","s","id","js","fjs","getElementsByTagName","getElementById","createElement","src","language","culture","parentNode","insertBefore","document","this","statics","getMe","getMyPicture","extend","addons","trhow","directive","$timeout","$compile","GoogleMaps","restrict","link","element","attributes","Init","maps","updateMarkers","addMarker","item","markerImg","latLng","google","LatLng","place","position","latitude","longitude","categoryKey","filters","category","key","imgPath","categories","marker","Marker","icon","url","scaledSize","Size","origin","Point","anchor","map","contentString","onClick","selectedBlog","html","infowindow","setContent","open","addListener","bounds","items","forEach","markers","setMap","LatLngBounds","filter","has","month","indexOf","isEmpty","fitBounds","options","cssClass","imagePath","MarkerClusterer","center","Map","zoom","mapTypeId","MapTypeId","ROADMAP","scrollwheel","disableDefaultUI","styles","elementType","stylers","color","visibility","featureType","InfoWindow","maxWidth","pixelOffset","event","outer","$","background","prev","children","css","display","parent","left","attr","i","find","close","next","overflow","right","top","z-index","cursor","opacity","transform","mouseout","$on","$scope","blog","setZoom","setCenter","$watchCollection","newValue","$filters","$q","$http","_init","__googleMapsInit","script","setAttribute","_key","body","appendChild","geocoder","deferred","defer","_geocoder","Geocoder","getType","types","street","number","locality","postalCode","city","province","region","country","label","address_components","c","t","long_name","parse","results","length","name","formatted_address","lng","geometry","location","lat","app","MapBox","model","mapboxgl","accessToken","getMap","navToCenter","$watch","sources","addMarkers","jumpToMarker","flyToMarker","addClusters","on","addSource","data","cluster","clusterMaxZoom","clusterRadius","addLayer","source","paint","circle-color","property","stops","circle-radius","layout","text-field","text-font","text-size","circle-stroke-width","circle-stroke-color","getOptions","copy","defaults","getMarker","$new","node","className","area","code","INFO","offset","setLngLat","addTo","markerElement","e","$emit","remove","push","flyTo","jumpTo","container","style","interactive","logoPosition","canvas","getCanvasContainer","parseFloat","pitch","bearing","get","DOCUMENT","EVENT","speed","curve","template","MapBoxGet","mapbox","all","MapBoxScript","MapBoxLink","addEventListener","rel","href","provider","$locationProvider","$httpProvider","EnvironmentSetHttp","headers","common","withCredentials","http","interceptors","apply","EnvironmentSetLocation","html5Mode","html5","hashPrefix","hash","EnvironmentAdd","merge","EnvironmentSet","value","EnvironmentGet","global","EnvironmentUse","paths","add","use","iso","$get","factory","Animate","callback","ticks","pause","animate","cancelAnimationFrame","play","loop","time","requestAnimationFrame","toggle","methods","prototype","lastTime","vendors","x","currTime","Date","getTime","timeToCall","Math","max","setTimeout","clearTimeout","Rect","getBoundRect","getNode","getDocumentNode","getBoundingClientRect","getClosest","selector","matchesFn","some","fn","parentElement","getClosestNode","target","getDelta","original","originalEvent","delta","deltaX","wheelDeltaX","deltaY","wheelDeltaY","abs","dir","documentElement","getElement","isArray","getNodeOffset","nodeType","offsetLeft","y","offsetTop","getPageScroll","scroll","documentNode","pageXOffset","scrollLeft","pageYOffset","scrollTop","getParents","topParentNode","parents","getView","view","innerWidth","innerHeight","clientWidth","clientHeight","getPointInView","point","TOUCH_EVENTS","touch","touches","changedTouches","pageX","pageY","MOUSE_EVENTS","compileController","contents","controller","$controller","controllerAs","downloadFile","content","download","createEvent","base64","downloadName","substring","lastIndexOf","initEvent","dispatchEvent","blob","Blob","reader","FileReader","readAsDataURL","onloadend","result","ua","agent","navigator","userAgent","toLowerCase","safari","msie","chrome","mobile","mac","addClass","EventsService","Dom","Event","rect","absolute","relative","timestamp","stop","stopPropagation","preventDefault","Events","setTimestamp","interval","min","events","listeners","click","onMouseDown","down","removeTouchEvents","onMouseMove","move","onMouseUp","up","onMouseWheel","wheel","removeScrollEvents","onMouseScroll","removeWheelEvents","onResize","resize","onTouchStart","removeStandardEvents","onTouchMove","onTouchEnd","standardEvents","touchEvents","wheelEvents","scrollEvents","standard","windowElement","listener","off","mouseEvents","getTouch","previous","difference","getRelativeTouch","hasPassiveEvents","supported","Object","defineProperty","passive","capture","EventTarget","modified","call","onScroll","scrollWidth","firefox","$filter","array","PointDifference","a","b","PointMultiply","clone","mult","setPos","setX","setY","toString","multiply","w","h","RectMultiply","bottom","bottomLeft","bottomRight","expand","expandRect","intersect","reduce","reduceRect","offsetRect","setH","setSize","setW","topLeft","topRight","Vector","VectorCross","VectorDifference","VectorDistance","sqrt","VectorIncidence","atan2","VectorMake","VectorNormalize","l","VectorPower","VectorSize","cross","distance","friction","incidence","normalize","power","towards","make","Hash","pool","HashGet","defineProperties","enumerable","writable","pools","getId","set","newItem","p","keys","oldItem","index","splice","addMany","removeMany","removeAll","shift","each","forward","reverse","sort","backward","differs","updatePool","Array","$promiseAll","promises","State","errors","isReady","idle","busy","state","isBusy","isError","isErroring","isSuccess","isSuccessing","classes","ready","successing","errorring","enabled","DELAY","errorMessage","button","labels","submitClass","transformProperty","div","every","prefix","Style","props","scale","hoverScale","currentScale","cssText","join","transformOrigin","round","format","string","prepend","expression","splitted","split","formatted","object","reducer","o","reducerAdder","slice","reducerSetter","removeValue","reverseSortOn","throttle","func","wait","context","args","timeout","later","leading","getNow","now","remaining","arguments","trailing","toMd5","where","query","found","TypeError","len","k","Api","Doc","$location","$routeParams","View","doc","path","params","route","ViewCurrent","docs","current","HttpUrl","HttpPromise","method","HttpGet","HttpPost","HttpPut","HttpPatch","HttpDelete","HttpFake","post","put","patch","delete","fake","$rootScope","RouterSetControllers","$previousController","$previous","$currentController","$current","$nextController","$next","RouterOnChangeStart","$$route","RouterOnChangeSuccess","RouterOnChangeError","rejection","RouterOnUpdate","RouterIsController","RouterRedirectTo","$$lastRequestedPath","RouterRetryLastRequestedPath","RouterRedirect","msecs","RouterPath","RouterApply","isController","redirect","SilentUnlink","$$listeners","$locationChangeSuccess","relink","SilentListener","$path","SilentSilent","replace","SilentPath","silent","unshift","CookieDelete","CookieSetter","CookieExists","CookieGet","cookieName","ca","charAt","JSON","decodeURIComponent","atob","CookieOn","checkCookie","elapsed","Cookie","TIMEOUT","CookieSet","days","cache","json","stringify","btoa","encodeURIComponent","expires","date","setTime","toGMTString","exist","LocalExists","localStorage","LocalGet","LocalSet","setItem","LocalDelete","removeItem","LocalOn","storageEvent","sessionStorage","$sce","TrustGetValue","values","trustedValues","TrustSetValue","trustedValue","TrustGetOrSet","TrustHtml","trustAsHtml","TrustResource","trustAsResourceUrl","TrustUrl","resource","Color","r","g","uint","parseInt","componentToHex","hex","luma","dot","contrast","darker","pow","floor","lighter","toUint","toHex","toRgba","toFixed","alpha","makeSet","foreground","border","light","Shape","shapeCircle","cx","cy","sa","ea","PI","ctx","arc","shapeStar","or","ir","steps","angle","step","moveTo","cos","sin","lineTo","shapeRoundRect","tl","tr","br","bl","defaultRadius","quadraticCurveTo","circle","beginPath","closePath","star","roundRect","constant","black","white","blue","red","lightBlue","lightYellow","greyLighter","greyLight","greyMedium","grey","Painter","Palette","painter","buffer","rows","getRect","row","setCanvas","drawImage","palette","isString","img","Image","onload","addShape","onerror","save","clip","translate","restore","draw","pre","drawRect","tint","setFill","fillRect","globalCompositeOperation","pattern","drawPattern","fillStyle","createPattern","toDataURL","PainterColors","drawingRect","setColors","colors","offsetWidth","offsetHeight","getContext","lineCap","clear","setText","font","align","verticalAlign","textAlign","textBaseline","setStroke","strokeStyle","lineWidth","fillText","text","maxLength","substr","trim","strokeRect","fill","stroke","begin","rotate","xy","image","flip","templateUrl","transclude","message","$parse","formatLabel","uniqueId","control","ngModel","required","form","title","placeholder","require","optionLabel","field","precision","validate","minLength","Number","POSITIVE_INFINITY","focus","visible","onChange","$parent","onFilter","getClasses","control-focus","control-success","$valid","control-error","$invalid","$submitted","$touched","control-empty","$viewValue","getMessages","$error","toggleVisibility","$templateCache","compile","onRemove","getter","numberPicker","setter","assign","onAdd","removeListeners","nodeRemove","nodeAdd","querySelectorAll","onFocus","$modelValue","$setViewValue","doBlur","onBlur","$formatters","$parsers","valid","String","$setValidity","$templateRequest","priority","modal","modalView","when","routes","modals","popModal","m","active","closeModal","addModal","back","Nav","onLink","onNav","nav","setItems","itemOpen","immediate","$nav","closed","closing","opening","opened","itemClose","itemToggle","onDown","trigger","output","resolved","rejected","navItem","querySelector","navTo","Silent","setNav","NavSilent","NavPath","setNavs","level","addItems","getLink","itemOrItems","addItem","ondragstart","Scrollable","Utils","render","scrollable","setContainer","containerNode","contentNode","setEnabled","isEnabled","renderX","getCurrent","contentStyle","dragStart","dragOn","onMove","dragMove","drag","getDrag","onUp","dragEnd","dragOff","_onScrollX","wheelX","onWheel","wheelXCheck","onScrollX","scrollableWhen","windowEvents","onLeft","onRight","showIndicatorFor","scrollableX","getItems","scrollableItem","scrollPrev","scrollNext","reset","doReset","oldValue","renderY","_onScrollY","wheelY","wheelYCheck","onScrollY","onTop","onBottom","scrollableY","flag","getIndicator","indicator","getIndex","currentIndex","scrollToIndex","getItemAtIndex","start","end","wheeling","dragging","doLeft","finally","scrollToX","doRight","padding","animating","extendX","snapToNearestX","extending","snappable","doTop","scrollToY","doBottom","extendY","snapToNearestY","playing","video","onPlaying","onPause","onEnded","onProgress","infos","buffered","onTimeUpdate","duration","currentTime","progressTime","videoElement","native","tap","removeClass","ngBind"],"mappings":"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","file":"artisan.min.js","sourcesContent":["/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan', ['ng', 'ngRoute', 'ngMessages']);\r\n\r\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.service('FacebookService', ['$promise', 'environment', function ($promise, environment) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\tlogin: FacebookLogin,\n\t\t\tlogout: FacebookLogout,\n\t\t\tstatus: FacebookStatus,\n\t\t\tgetMe: FacebookGetMe,\n\t\t\tgetMyPicture: FacebookGetMyPicture,\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\t// private vars\n\n\t\tif (!environment.addons || !environment.addons.facebook) {\n\t\t\ttrhow('FacebookService.error missing config object in environment.addons.facebook');\n\t\t}\n\n\t\tvar config = environment.addons.facebook;\n\n\t\t// statics methods\n\n\t\t/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n\t\t *  calling facebook initializer on page load to avoid popup blockers via asyncronous loading  *\n\t\t * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\n\n\t\tFacebook();\n\n\t\tfunction Facebook() {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tif (window.FB !== undefined) {\n\t\t\t\t\tpromise.resolve(window.FB);\n\t\t\t\t} else {\n\t\t\t\t\tFacebookInit().then(function (success) {\n\t\t\t\t\t\tpromise.resolve(window.FB);\n\t\t\t\t\t}, function (error) {\n\t\t\t\t\t\tpromise.reject(error);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tfunction FacebookStatus(response, promise, init) {\n\t\t\tservice.authResponse = null;\n\t\t\tif (response.status === 'connected') {\n\t\t\t\tservice.authResponse = response.authResponse;\n\t\t\t\tpromise.resolve(response);\n\t\t\t} else if (response.status === 'not_authorized') {\n\t\t\t\tif (init) {\n\t\t\t\t\tpromise.resolve(response);\n\t\t\t\t} else {\n\t\t\t\t\tpromise.reject(response);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tpromise.reject(response);\n\t\t\t}\n\t\t}\n\n\t\tfunction FacebookGetMe(fields) {\n\t\t\tfields = fields || config.fields;\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tFacebookLogin().then(function (facebook) {\n\t\t\t\t\tconsole.log('FacebookGetMe', facebook);\n\t\t\t\t\tfacebook.api('/me', {\n\t\t\t\t\t\tfields: fields\n\t\t\t\t\t}, function (response) {\n\t\t\t\t\t\tif (!response || response.error) {\n\t\t\t\t\t\t\tpromise.reject('Error occured');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpromise.resolve(response);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tfunction FacebookGetMyPicture(size) {\n\t\t\tsize = size || 300;\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tFacebookLogin().then(function (facebook) {\n\t\t\t\t\tfacebook.api('/me/picture', {\n\t\t\t\t\t\twidth: size,\n\t\t\t\t\t\theight: size,\n\t\t\t\t\t\ttype: 'square'\n\t\t\t\t\t}, function (response) {\n\t\t\t\t\t\tif (!response || response.error) {\n\t\t\t\t\t\t\tpromise.reject('Error occured');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpromise.resolve(response);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tfunction FacebookLogin() {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tFacebook().then(function (facebook) {\n\t\t\t\t\tconsole.log('FacebookLogin', facebook);\n\t\t\t\t\tfacebook.login(function (response) {\n\t\t\t\t\t\tFacebookStatus(response, promise);\n\t\t\t\t\t}, {\n\t\t\t\t\t\tscope: config.scope\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tfunction FacebookLogout() {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tFacebook().then(function (facebook) {\n\t\t\t\t\tfacebook.logout(function (response) {\n\t\t\t\t\t\tpromise.resolve(response);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tfunction FacebookInit() {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\twindow.fbAsyncInit = function () {\n\t\t\t\t\tconsole.log('FacebookInit.fbAsyncInit', window.FB);\n\t\t\t\t\twindow.FB.init({\n\t\t\t\t\t\tappId: config.app_id,\n\t\t\t\t\t\tstatus: true,\n\t\t\t\t\t\tcookie: true,\n\t\t\t\t\t\txfbml: true,\n\t\t\t\t\t\tversion: config.version,\n\t\t\t\t\t});\n\t\t\t\t\tpromise.resolve(window.FB);\n\t\t\t\t\t// window.fbAsyncInit = null;\n\t\t\t\t};\n\t\t\t\ttry {\n\t\t\t\t\t(function (d, s, id) {\n\t\t\t\t\t\tvar js, fjs = d.getElementsByTagName(s)[0];\n\t\t\t\t\t\tif (d.getElementById(id)) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tjs = d.createElement(s);\n\t\t\t\t\t\tjs.id = id;\n\t\t\t\t\t\tjs.src = '//connect.facebook.net/' + environment.language.culture + '/sdk.js';\n\t\t\t\t\t\tfjs.parentNode.insertBefore(js, fjs);\n\t\t\t\t\t}(document, 'script', 'facebook-jssdk'));\n\t\t\t\t} catch (error) {\n\t\t\t\t\tpromise.reject(error);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\t// todo !!!\n\n\tapp.directive('googleMaps', ['$timeout', '$compile', 'GoogleMaps', function ($timeout, $compile, GoogleMaps) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tlink: function (scope, element, attributes) {\n\n\t\t\t\tvar filters = {};\n\n\t\t\t\tGoogleMaps.maps().then(function (maps) {\n\t\t\t\t\tInit(maps);\n\t\t\t\t});\n\n\t\t\t\tfunction Init(maps) {\n\t\t\t\t\tvar center = new google.maps.LatLng(22.106445, 14.630445);\n\n\t\t\t\t\tvar map = new google.maps.Map(element[0], {\n\t\t\t\t\t\tzoom: 3,\n\t\t\t\t\t\tcenter: center,\n\t\t\t\t\t\tmapTypeId: google.maps.MapTypeId.ROADMAP,\n\t\t\t\t\t\tscrollwheel: true,\n\t\t\t\t\t\tdisableDefaultUI: true,\n\t\t\t\t\t\tstyles: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"elementType\": \"geometry\",\n\t\t\t\t\t\t\t\t\"stylers\": [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\"color\": \"#f5f5f5\"\n                                    }\n                                ]\n                            },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"elementType\": \"labels.icon\",\n\t\t\t\t\t\t\t\t\"stylers\": [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\"visibility\": \"off\"\n                                    }\n                                ]\n                            },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"elementType\": \"labels.text.fill\",\n\t\t\t\t\t\t\t\t\"stylers\": [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\"color\": \"#616161\"\n                                    }\n                                ]\n                            },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"elementType\": \"labels.text.stroke\",\n\t\t\t\t\t\t\t\t\"stylers\": [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\"color\": \"#f5f5f5\"\n                                    }\n                                ]\n                            },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"featureType\": \"administrative.land_parcel\",\n\t\t\t\t\t\t\t\t\"elementType\": \"labels.text.fill\",\n\t\t\t\t\t\t\t\t\"stylers\": [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\"color\": \"#bdbdbd\"\n                                    }\n                                ]\n                            },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"featureType\": \"poi\",\n\t\t\t\t\t\t\t\t\"elementType\": \"geometry\",\n\t\t\t\t\t\t\t\t\"stylers\": [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\"color\": \"#eeeeee\"\n                                    }\n                                ]\n                            },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"featureType\": \"poi\",\n\t\t\t\t\t\t\t\t\"elementType\": \"labels.text.fill\",\n\t\t\t\t\t\t\t\t\"stylers\": [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\"color\": \"#757575\"\n                                    }\n                                ]\n                            },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"featureType\": \"poi.park\",\n\t\t\t\t\t\t\t\t\"elementType\": \"geometry\",\n\t\t\t\t\t\t\t\t\"stylers\": [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\"color\": \"#e5e5e5\"\n                                    }\n                                ]\n                            },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"featureType\": \"poi.park\",\n\t\t\t\t\t\t\t\t\"elementType\": \"labels.text.fill\",\n\t\t\t\t\t\t\t\t\"stylers\": [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\"color\": \"#9e9e9e\"\n                                    }\n                                ]\n                            },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"featureType\": \"road\",\n\t\t\t\t\t\t\t\t\"elementType\": \"geometry\",\n\t\t\t\t\t\t\t\t\"stylers\": [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\"color\": \"#ffffff\"\n                                    }\n                                ]\n                            },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"featureType\": \"road.arterial\",\n\t\t\t\t\t\t\t\t\"elementType\": \"labels.text.fill\",\n\t\t\t\t\t\t\t\t\"stylers\": [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\"color\": \"#757575\"\n                                    }\n                                ]\n                            },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"featureType\": \"road.highway\",\n\t\t\t\t\t\t\t\t\"elementType\": \"geometry\",\n\t\t\t\t\t\t\t\t\"stylers\": [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\"color\": \"#dadada\"\n                                    }\n                                ]\n                            },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"featureType\": \"road.highway\",\n\t\t\t\t\t\t\t\t\"elementType\": \"labels.text.fill\",\n\t\t\t\t\t\t\t\t\"stylers\": [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\"color\": \"#616161\"\n                                    }\n                                ]\n                            },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"featureType\": \"road.local\",\n\t\t\t\t\t\t\t\t\"elementType\": \"labels.text.fill\",\n\t\t\t\t\t\t\t\t\"stylers\": [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\"color\": \"#9e9e9e\"\n                                    }\n                                ]\n                            },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"featureType\": \"transit.line\",\n\t\t\t\t\t\t\t\t\"elementType\": \"geometry\",\n\t\t\t\t\t\t\t\t\"stylers\": [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\"color\": \"#e5e5e5\"\n                                    }\n                                ]\n                            },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"featureType\": \"transit.station\",\n\t\t\t\t\t\t\t\t\"elementType\": \"geometry\",\n\t\t\t\t\t\t\t\t\"stylers\": [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\"color\": \"#eeeeee\"\n                                    }\n                                ]\n                            },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"featureType\": \"water\",\n\t\t\t\t\t\t\t\t\"elementType\": \"geometry\",\n\t\t\t\t\t\t\t\t\"stylers\": [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\"color\": \"#b8b8b8\"\n                                    }\n                                ]\n                            },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"featureType\": \"water\",\n\t\t\t\t\t\t\t\t\"elementType\": \"labels.text.fill\",\n\t\t\t\t\t\t\t\t\"stylers\": [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\"color\": \"#9e9e9e\"\n                                    }\n                                ]\n                            }\n                        ]\n\t\t\t\t\t});\n\n\t\t\t\t\tvar infowindow = getInfoWindow();\n\t\t\t\t\tvar items = [];\n\t\t\t\t\tvar markers = [];\n\n\t\t\t\t\tfunction updateMarkers() {\n\t\t\t\t\t\tif (!items) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tangular.forEach(markers, function (marker) {\n\t\t\t\t\t\t\tmarker.setMap(null);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tvar imgPath = '/contrib/themes/GioacchinoRossiniTheme/img/gmap/';\n\t\t\t\t\t\tvar bounds = new google.maps.LatLngBounds();\n\n\t\t\t\t\t\tmarkers = items.filter(function (item) {\n\t\t\t\t\t\t\tvar has = true;\n\t\t\t\t\t\t\tif (filters.month) {\n\t\t\t\t\t\t\t\thas = has && filters.month.items.has(item.id);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (filters.category) {\n\t\t\t\t\t\t\t\thas = has && item.categories.indexOf(filters.category.key) !== -1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn has;\n\t\t\t\t\t\t}).map(function (item) {\n\t\t\t\t\t\t\treturn addMarker(item);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tfunction addMarker(item) {\n\t\t\t\t\t\t\tvar latLng = new google.maps.LatLng(\n\t\t\t\t\t\t\t\titem.place.position.latitude,\n\t\t\t\t\t\t\t\titem.place.position.longitude\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tvar markerImg;\n\t\t\t\t\t\t\tvar categoryKey = filters.category ? filters.category.key : 'all';\n\t\t\t\t\t\t\tif (categoryKey === 'all') {\n\t\t\t\t\t\t\t\tmarkerImg = imgPath + item.categories[0] + '.png';\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmarkerImg = imgPath + categoryKey + '.png';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvar marker = new google.maps.Marker({\n\t\t\t\t\t\t\t\tposition: latLng,\n\t\t\t\t\t\t\t\titem: item,\n\t\t\t\t\t\t\t\ticon: {\n\t\t\t\t\t\t\t\t\turl: markerImg,\n\t\t\t\t\t\t\t\t\tscaledSize: new google.maps.Size(25, 25),\n\t\t\t\t\t\t\t\t\torigin: new google.maps.Point(0, 0),\n\t\t\t\t\t\t\t\t\tanchor: new google.maps.Point(0, 0)\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tmap: map,\n\t\t\t\t\t\t\t\tcontentString: '<div id=\"iw-container\">' +\n\t\t\t\t\t\t\t\t\t'<div class=\"iw-image\" ng-style=\"{ \\'background-image\\': cssUrl(selectedBlog.image.url) }\"></div>' +\n\t\t\t\t\t\t\t\t\t'<div class=\"iw-title\" ng-bind=\"selectedBlog.title\"></div>' +\n\t\t\t\t\t\t\t\t\t'<div class=\"iw-cta\"><button type=\"button\" class=\"iw-link\" ng-click=\"openBlog(selectedBlog)\">Details</button></div>' +\n\t\t\t\t\t\t\t\t\t'</div>'\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tmarker.onClick = function () {\n\t\t\t\t\t\t\t\tvar marker = this;\n\t\t\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\t\t\tscope.selectedBlog = marker.item;\n\t\t\t\t\t\t\t\t\tvar html = $compile(marker.contentString)(scope);\n\t\t\t\t\t\t\t\t\tinfowindow.setContent(html[0]);\n\t\t\t\t\t\t\t\t\tinfowindow.open(map, marker);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tmarker.addListener('click', marker.onClick);\n\n\t\t\t\t\t\t\tbounds.extend(latLng);\n\n\t\t\t\t\t\t\treturn marker;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!bounds.isEmpty()) {\n\t\t\t\t\t\t\tmap.fitBounds(bounds);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar options = {\n\t\t\t\t\t\t\tcssClass: 'cluster',\n\t\t\t\t\t\t\timagePath: '/contrib/themes/GioacchinoRossiniTheme/img/gmap/m'\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tvar markerCluster = new MarkerClusterer(map, markers, options);\n\t\t\t\t\t}\n\n\t\t\t\t\tscope.$on('onSetBlog', function ($scope, blog) {\n\t\t\t\t\t\tangular.forEach(markers, function (marker) {\n\t\t\t\t\t\t\tif (marker.item === blog) {\n\t\t\t\t\t\t\t\tmap.setZoom(12);\n\t\t\t\t\t\t\t\tmap.setCenter(marker.position);\n\t\t\t\t\t\t\t\tmarker.onClick();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\tfunction getInfoWindow() {\n\t\t\t\t\t\tvar infowindow = new google.maps.InfoWindow({\n\t\t\t\t\t\t\tmaxWidth: 350,\n\t\t\t\t\t\t\tpixelOffset: new google.maps.Size(0, 15),\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tgoogle.maps.event.addListener(infowindow, 'domready', function () {\n\t\t\t\t\t\t\tvar outer = $('.gm-style-iw');\n\t\t\t\t\t\t\tvar background = outer.prev();\n\t\t\t\t\t\t\tbackground.children(':nth-child(2)').css({\n\t\t\t\t\t\t\t\t'display': 'none'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbackground.children(':nth-child(4)').css({\n\t\t\t\t\t\t\t\t'display': 'none'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\touter.parent().parent().css({\n\t\t\t\t\t\t\t\tleft: '115px'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbackground.children(':nth-child(1)').attr('style', function (i, s) {\n\t\t\t\t\t\t\t\treturn s + 'display: none!important';\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbackground.children(':nth-child(3)').attr('style', function (i, s) {\n\t\t\t\t\t\t\t\treturn s + 'display: none!important';\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbackground.children(':nth-child(3)').find('div').children().attr('style', function (i, s) {\n\t\t\t\t\t\t\t\treturn s + 'opacity: 0!important;';\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tvar close = outer.next();\n\t\t\t\t\t\t\tclose.css({\n\t\t\t\t\t\t\t\t'width': '13px',\n\t\t\t\t\t\t\t\t'height': '13px',\n\t\t\t\t\t\t\t\t'overflow': 'hidden',\n\t\t\t\t\t\t\t\t'position': 'absolute',\n\t\t\t\t\t\t\t\t'right': '56px',\n\t\t\t\t\t\t\t\t'top': '17px',\n\t\t\t\t\t\t\t\t'z-index': '10000',\n\t\t\t\t\t\t\t\t'cursor': 'pointer',\n\t\t\t\t\t\t\t\t'opacity': 1,\n\t\t\t\t\t\t\t\t'transform': 'scale(0.8)'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tclose.mouseout(function () {\n\t\t\t\t\t\t\t\t$(this).css({\n\t\t\t\t\t\t\t\t\topacity: '1'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn infowindow;\n\t\t\t\t\t}\n\n\t\t\t\t\tscope.$watchCollection(attributes.map, function (newValue) {\n\t\t\t\t\t\titems = newValue;\n\t\t\t\t\t\tconsole.log('map.items', items);\n\t\t\t\t\t\tupdateMarkers();\n\t\t\t\t\t});\n\n\t\t\t\t\tscope.$on('onSetFilters', function ($scope, $filters) {\n\t\t\t\t\t\tfilters = $filters;\n\t\t\t\t\t\tupdateMarkers();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\t// todo !!!\n\n\tapp.service('GoogleMaps', ['$q', '$http', '$promise', function ($q, $http, $promise) {\n\n\t\tvar _key = 'AIzaSyBlgTatREkeIDKEKYL_dtaaDx1yYxmx_iM';\n\t\tvar _init = false;\n\n\t\tthis.maps = maps;\n\t\tthis.geocoder = geocoder;\n\t\tthis.parse = parse;\n\n\t\tfunction maps() {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tif (_init) {\n\t\t\t\t\tpromise.resolve(window.google.maps);\n\t\t\t\t} else {\n\t\t\t\t\twindow.__googleMapsInit = function () {\n\t\t\t\t\t\tpromise.resolve(window.google.maps);\n\t\t\t\t\t\twindow.__googleMapsInit = null;\n\t\t\t\t\t\t_init = true;\n\t\t\t\t\t};\n\t\t\t\t\tvar script = document.createElement('script');\n\t\t\t\t\tscript.setAttribute('async', null);\n\t\t\t\t\tscript.setAttribute('defer', null);\n\t\t\t\t\tscript.setAttribute('src', 'https://maps.googleapis.com/maps/api/js?key=' + _key + '&callback=__googleMapsInit');\n\t\t\t\t\tdocument.body.appendChild(script);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tfunction geocoder() {\n\t\t\tvar service = this;\n\t\t\tvar deferred = $q.defer();\n\t\t\tmaps().then(function (maps) {\n\t\t\t\tvar _geocoder = new maps.Geocoder();\n\t\t\t\tdeferred.resolve(_geocoder);\n\t\t\t}, function (error) {\n\t\t\t\tdeferred.reject(error);\n\t\t\t});\n\t\t\treturn deferred.promise;\n\t\t}\n\n\t\tfunction getType(type, item) {\n\t\t\tvar types = {\n\t\t\t\tstreet: 'route',\n\t\t\t\tnumber: 'street_number',\n\t\t\t\tlocality: 'locality',\n\t\t\t\tpostalCode: 'postal_code',\n\t\t\t\tcity: 'administrative_area_level_3',\n\t\t\t\tprovince: 'administrative_area_level_2',\n\t\t\t\tregion: 'administrative_area_level_1',\n\t\t\t\tcountry: 'country',\n\t\t\t};\n\t\t\tvar label = null;\n\t\t\tangular.forEach(item.address_components, function (c) {\n\t\t\t\tangular.forEach(c.types, function (t) {\n\t\t\t\t\tif (t === types[type]) {\n\t\t\t\t\t\tlabel = c.long_name;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\t// console.log('googleMaps.getType', type, item, label);\n\t\t\treturn label;\n\t\t}\n\n\t\tfunction parse(results) {\n\t\t\tvar items = null;\n\t\t\tif (results.length) {\n\t\t\t\titems = results.filter(function (item) {\n\t\t\t\t\treturn true; // item.geometry.location_type === 'ROOFTOP' ||\n\t\t\t\t\t// item.geometry.location_type === 'RANGE_INTERPOLATED' ||\n\t\t\t\t\t// item.geometry.location_type === 'GEOMETRIC_CENTER';\n\t\t\t\t}).map(function (item) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tname: item.formatted_address,\n\t\t\t\t\t\tstreet: getType('street', item),\n\t\t\t\t\t\tnumber: getType('number', item),\n\t\t\t\t\t\tlocality: getType('locality', item),\n\t\t\t\t\t\tpostalCode: getType('postalCode', item),\n\t\t\t\t\t\tcity: getType('city', item),\n\t\t\t\t\t\tprovince: getType('province', item),\n\t\t\t\t\t\tregion: getType('region', item),\n\t\t\t\t\t\tcountry: getType('country', item),\n\t\t\t\t\t\tposition: {\n\t\t\t\t\t\t\tlng: item.geometry.location.lng(),\n\t\t\t\t\t\t\tlat: item.geometry.location.lat(),\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t\t/*\n\t\t\t\tvar first = response.data.results[0];\n\t\t\t\tscope.model.position = first.geometry.location;\n\t\t\t\tconsole.log(scope.model);\n\t\t\t\tsetLocation();\n\t\t\t\t*/\n\t\t\t}\n\t\t\tconsole.log('googleMaps.parse', results, items);\n\t\t\treturn items;\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.directive('mapbox', ['$http', '$timeout', '$compile', 'MapBox', function($http, $timeout, $compile, MapBox) {\n\n        var position = {\n            lng: 11.411248,\n            lat: 44.515702,\n        };\n\n        var defaults = {\n            center: [position.lng, position.lat],\n            zoom: 17.63,\n            pitch: 53,\n            bearing: -11.68,\n            speed: 1.5,\n            curve: 1,\n        };\n\n        return {\n            restrict: 'A',\n            scope: {\n                sources: '=mapbox',\n            },\n            link: link,\n        };\n\n        function link(scope, element, attributes, model) {\n            var map, markers, marker, geocoder, bounds, canvas, dragging, overing;\n\n            MapBox.get().then(function(mapboxgl) {\n                Init(mapboxgl);\n            });\n\n            function Init(mapboxgl) {\n                mapboxgl.accessToken = 'pk.eyJ1IjoiZmljb3dzZGV2IiwiYSI6ImNqNXJzajVobTB5cW8yd25tejhqcjN2c3kifQ.CsUfBV2eN2ftVELq0xwlGA'; // 'pk.eyJ1IjoiYWN0YXJpYW4iLCJhIjoiY2lqNWU3MnBzMDAyZndnbTM1cjMyd2N2MiJ9.CbuEGSvOAfIYggQv854pRQ';\t\t\t\n                map = getMap();\n                navToCenter();\n                scope.$watch('sources', function(sources) {\n                    if (sources) {\n                        // connect methods;\n                        sources.addMarkers = addMarkers;\n                        sources.jumpToMarker = jumpToMarker;\n                        sources.flyToMarker = flyToMarker;\n                    }\n                });\n                addClusters();\n            }\n\n            function addClusters() {\n\n                map.on('load', function() {\n                    // Add a new source from our GeoJSON data and set the\n                    // 'cluster' option to true. GL-JS will add the point_count property to your source data.\n                    map.addSource(\"earthquakes\", {\n                        type: \"geojson\",\n                        // Point to GeoJSON data. This example visualizes all M1.0+ earthquakes\n                        // from 12/22/15 to 1/21/16 as logged by USGS' Earthquake hazards program.\n                        data: \"/api/maps/earthquakes.geojson.js\",\n                        cluster: true,\n                        clusterMaxZoom: 14, // Max zoom to cluster points on\n                        clusterRadius: 50 // Radius of each cluster when clustering points (defaults to 50)\n                    });\n\n                    map.addLayer({\n                        id: \"clusters\",\n                        type: \"circle\",\n                        source: \"earthquakes\",\n                        filter: [\"has\", \"point_count\"],\n                        paint: {\n                            \"circle-color\": {\n                                property: \"point_count\",\n                                type: \"interval\",\n                                stops: [\n                                    [0, \"#51bbd6\"],\n                                    [100, \"#f1f075\"],\n                                    [750, \"#f28cb1\"],\n                                ]\n                            },\n                            \"circle-radius\": {\n                                property: \"point_count\",\n                                type: \"interval\",\n                                stops: [\n                                    [0, 20],\n                                    [100, 30],\n                                    [750, 40]\n                                ]\n                            }\n                        }\n                    });\n\n                    map.addLayer({\n                        id: \"cluster-count\",\n                        type: \"symbol\",\n                        source: \"earthquakes\",\n                        filter: [\"has\", \"point_count\"],\n                        layout: {\n                            \"text-field\": \"{point_count_abbreviated}\",\n                            \"text-font\": [\"DIN Offc Pro Medium\", \"Arial Unicode MS Bold\"],\n                            \"text-size\": 12\n                        }\n                    });\n\n                    map.addLayer({\n                        id: \"unclustered-point\",\n                        type: \"circle\",\n                        source: \"earthquakes\",\n                        filter: [\"!has\", \"point_count\"],\n                        paint: {\n                            \"circle-color\": \"#11b4da\",\n                            \"circle-radius\": 4,\n                            \"circle-stroke-width\": 1,\n                            \"circle-stroke-color\": \"#fff\"\n                        }\n                    });\n                });\n            }\n\n            var types = {\n                DOCUMENT: 1,\n                EVENT: 2,\n                INFO: 3,\n            };\n\n            /*\n            googleMaps.geocoder().then(function (response) {\n                geocoder = response;\n                init();\n            });\n            */\n\n            function getOptions(options) {\n                return angular.extend(angular.copy(defaults), options);\n            }\n\n            function getMarker(item) {\n                var $scope = scope.$new(true);\n                $scope.item = item;\n                var node = document.createElement('div');\n                node.id = 'point';\n                node.className = 'marker ' + item.area.code;\n                node.className += item.type === types.INFO ? ' info' : '';\n                node.setAttribute('marker', 'item');\n                var marker = new mapboxgl.Marker(node, {\n                        offset: [-10, -10]\n                    })\n                    .setLngLat([item.position.lng, item.position.lat])\n                    .addTo(map);\n                var markerElement = angular.element(node);\n                markerElement.on('click', function(e) {\n                    // console.log('marker.click', item);\n                    scope.$emit('onMarkerClicked', item);\n                });\n                $compile(markerElement)($scope); // Compiling marker\n                return marker;\n            }\n\n            function addMarkers(items) {\n                if (markers) {\n                    angular.forEach(markers, function(item) {\n                        item.remove();\n                    });\n                }\n                markers = [];\n                if (items) {\n                    angular.forEach(items, function(item) {\n                        marker = getMarker(item);\n                        markers.push(marker);\n                    });\n                }\n            }\n\n            function flyTo(position) {\n                var options = getOptions({\n                    center: [position.lng, position.lat],\n                    zoom: 20,\n                });\n                map.flyTo(options);\n            }\n\n            function jumpTo(position) {\n                var options = getOptions({\n                    center: [position.lng, position.lat],\n                    zoom: 20,\n                });\n                map.jumpTo(options);\n            }\n\n            function flyToMarker(item) {\n                // console.log(item);\n                flyTo(item.position);\n            }\n\n            function jumpToMarker(item) {\n                jumpTo(item.position);\n            }\n\n            function getMap() {\n                var map = new mapboxgl.Map({\n                    container: element[0],\n                    style: 'mapbox://styles/ficowsdev/cj8cztc3r8nv32sl5npfr1yip', // 'mapbox://styles/ficowsdev/cj5rsloo232ad2sq9capz9atk', // 'mapbox://styles/mapbox/light-v9', // 'mapbox://styles/actarian/cj5nwbngd1p2z2sqh74l5qwlq',\n                    interactive: true,\n                    logoPosition: 'bottom-right',\n                    center: [position.lng, position.lat],\n                    zoom: 6,\n                });\n\n                canvas = map.getCanvasContainer();\n\n                /*\n                scope.map.setAddress = function (item) {\n                    // console.log('setAddress', item);\n                    scope.map.results = null;\n                    flyTo(item.position);\n                };\n                scope.map.search = function () {\n                    // console.log('address', scope.map.address);\n                    scope.map.results = null;\n                    geocodeAddress(scope.map.address);\n                    return true;\n                };\n                scope.map.styles = {\n                    FICO: 1,\n                    SATELLITE: 2,\n                };\n                scope.map.style = scope.map.styles.FICO;\n                scope.map.styleToggle = function () {\n                    if (scope.map.style === scope.map.styles.FICO) {\n                        scope.map.style = scope.map.styles.SATELLITE;\n                        map.setStyle('mapbox://styles/mapbox/satellite-v9');\n                    } else {\n                        scope.map.style = scope.map.styles.FICO;\n                        map.setStyle('mapbox://styles/mapbox/streets-v9');\n                    }\n                };\n                scope.map.setStyle = function (style) {\n                    scope.map.style = style;\n                    if (scope.map.style === scope.map.styles.FICO) {\n                        map.setStyle('mapbox://styles/mapbox/streets-v9');\n                    } else {\n                        map.setStyle('mapbox://styles/mapbox/satellite-v9');\n                    }\n                };                \n                */\n                return map;\n            }\n\n            function geocodeAddress(address) {\n                geocoder.geocode({\n                    'address': address\n                }, function(results, status) {\n                    $timeout(function() {\n                        if (status === 'OK') {\n                            sources.results = googleMaps.parse(results);\n                        } else {\n                            alert('Geocode was not successful for the following reason: ' + status);\n                        }\n                    });\n                });\n            }\n\n            function reverseGeocode(position) {\n                // console.log('reverseGeocode', position);\n                geocoder.geocode({\n                    'location': position\n                }, function(results, status) {\n                    $timeout(function() {\n                        if (status === 'OK') {\n                            sources.results = googleMaps.parse(results);\n                        } else {\n                            console.log('Geocoder failed due to: ' + status);\n                        }\n                    });\n                });\n            }\n\n            function geolocalize() {\n                if (navigator.geolocation) {\n                    navigator.geolocation.getCurrentPosition(function(p) {\n                        $timeout(function() {\n                            position = {\n                                lat: p.coords.latitude,\n                                lng: p.coords.longitude\n                            };\n                            flyTo(position);\n                            reverseGeocode(position);\n                        });\n                    }, function(e) {\n                        console.log('error', e);\n                    });\n                } else {\n                    console.log('error', 'Browser doesn\\'t support Geolocation');\n                }\n            }\n\n            function flyToFico() {\n                var position = {\n                    lng: 11.411248,\n                    lat: 44.515702,\n                };\n                map.flyTo({\n                    center: [\n                        parseFloat(position.lng),\n                        parseFloat(position.lat)\n                    ],\n                    zoom: 17.63,\n                    pitch: 53,\n                    bearing: -11.68,\n                    speed: 1.5,\n                    curve: 1,\n\n                });\n            }\n\n            function navToCenter() {\n                var position = {\n                    lng: 11.411248,\n                    lat: 44.515702,\n                };\n                map.jumpTo({\n                    center: [\n                        parseFloat(position.lng),\n                        parseFloat(position.lat)\n                    ],\n                    zoom: 17.63,\n                    pitch: 53,\n                    bearing: -11.68,\n                });\n            }\n\n            /*\n            function flyTo(position) {\n                map.flyTo({\n                    center: [\n                        parseFloat(position.lng),\n                        parseFloat(position.lat)\n                    ],\n                    zoom: 15,\n                    speed: 1.5,\n                    curve: 1,\n                });\n            }\n            */\n\n            function fitBounds(bounds) {\n                map.fitBounds(bounds, {\n                    speed: 1.5,\n                    curve: 1,\n                    padding: 30,\n                    linear: false,\n                    maxZoom: 8,\n                });\n            }\n        }\n    }]);\n\n    app.directive('marker', ['$http', '$timeout', function($http, $timeout) {\n        return {\n            restrict: 'A',\n            scope: {\n                item: '=marker',\n            },\n            template: '<div class=\"inner\">' +\n                '   <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"40\" height=\"40\" viewBox=\"0 0 24 24\">' +\n                '       <path d=\"M12 0c-5.522 0-10 4.395-10 9.815 0 5.505 4.375 9.268 10 14.185 5.625-4.917 10-8.68 10-14.185 0-5.42-4.478-9.815-10-9.815zm0 18c-4.419 0-8-3.582-8-8s3.581-8 8-8 8 3.582 8 8-3.581 8-8 8z\"/>' +\n                '   </svg>' +\n                '   <span ng-bind=\"item.code\"></span>' +\n                '</div>',\n            link: link,\n        };\n\n        function link(scope, element, attributes, model) {\n            // console.log('marker', scope.item);\n        }\n\n    }]);\n\n    /*\n\tapp.service('GoogleMaps', ['$q', '$http', function ($q, $http) {\n\t\tvar _key = 'AIzaSyAYuhIEO-41YT_GdYU6c1N7DyylT_OcMSY';\n\t\tvar _init = false;\n\n\t\tthis.maps = maps;\n\t\tthis.geocoder = geocoder;\n\t\tthis.parse = parse;\n\n\t\tfunction maps() {\n\t\t\tvar deferred = $q.defer();\n\t\t\tif (_init) {\n\t\t\t\tdeferred.resolve(window.google.maps);\n\t\t\t} else {\n\t\t\t\twindow.googleMapsInit = function () {\n\t\t\t\t\tdeferred.resolve(window.google.maps);\n\t\t\t\t\twindow.googleMapsInit = null;\n\t\t\t\t\t_init = true;\n\t\t\t\t};\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('async', null);\n\t\t\t\tscript.setAttribute('defer', null);\n\t\t\t\tscript.setAttribute('src', 'https://maps.googleapis.com/maps/api/js?key=' + _key + '&callback=googleMapsInit');\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t}\n\t\t\treturn deferred.promise;\n\t\t}\n\n\t\tfunction geocoder() {\n\t\t\tvar service = this;\n\t\t\tvar deferred = $q.defer();\n\t\t\tmaps().then(function (maps) {\n\t\t\t\tvar _geocoder = new maps.Geocoder();\n\t\t\t\tdeferred.resolve(_geocoder);\n\t\t\t}, function (error) {\n\t\t\t\tdeferred.reject(error);\n\t\t\t});\n\t\t\treturn deferred.promise;\n\t\t}\n\n\t\tfunction getType(type, item) {\n\t\t\tvar types = {\n\t\t\t\tstreet: 'route',\n\t\t\t\tnumber: 'street_number',\n\t\t\t\tlocality: 'locality',\n\t\t\t\tpostalCode: 'postal_code',\n\t\t\t\tcity: 'administrative_area_level_3',\n\t\t\t\tprovince: 'administrative_area_level_2',\n\t\t\t\tregion: 'administrative_area_level_1',\n\t\t\t\tcountry: 'country',\n\t\t\t};\n\t\t\tvar label = null;\n\t\t\tangular.forEach(item.address_components, function (c) {\n\t\t\t\tangular.forEach(c.types, function (t) {\n\t\t\t\t\tif (t === types[type]) {\n\t\t\t\t\t\tlabel = c.long_name;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\t// console.log('googleMaps.getType', type, item, label);\n\t\t\treturn label;\n\t\t}\n\n\t\tfunction parse(results) {\n\t\t\tvar items = null;\n\t\t\tif (results.length) {\n\t\t\t\titems = results.filter(function (item) {\n\t\t\t\t\treturn true; // item.geometry.location_type === 'ROOFTOP' ||\n\t\t\t\t\t// item.geometry.location_type === 'RANGE_INTERPOLATED' ||\n\t\t\t\t\t// item.geometry.location_type === 'GEOMETRIC_CENTER';\n\t\t\t\t}).map(function (item) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tname: item.formatted_address,\n\t\t\t\t\t\tstreet: getType('street', item),\n\t\t\t\t\t\tnumber: getType('number', item),\n\t\t\t\t\t\tlocality: getType('locality', item),\n\t\t\t\t\t\tpostalCode: getType('postalCode', item),\n\t\t\t\t\t\tcity: getType('city', item),\n\t\t\t\t\t\tprovince: getType('province', item),\n\t\t\t\t\t\tregion: getType('region', item),\n\t\t\t\t\t\tcountry: getType('country', item),\n\t\t\t\t\t\tposition: {\n\t\t\t\t\t\t\tlng: item.geometry.location.lng(),\n\t\t\t\t\t\t\tlat: item.geometry.location.lat(),\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t}\n\t\t\tconsole.log('googleMaps.parse', results, items);\n\t\t\treturn items;\n\t\t}\n\n    }]);\n    */\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.service('MapBox', ['$q', '$http', '$promise', function($q, $http, $promise) {\n\n        var service = this;\n\n        var statics = {\n            get: MapBoxGet,\n        };\n\n        angular.extend(service, statics);\n\n        function MapBoxGet() {\n            return $promise(function(promise) {\n                if (window.mapboxgl) {\n                    promise.resolve(window.mapbox);\n                } else {\n                    $promise.all([\n                        MapBoxScript('//api.tiles.mapbox.com/mapbox-gl-js/v0.42.0/mapbox-gl.js'),\n                        MapBoxLink('//api.tiles.mapbox.com/mapbox-gl-js/v0.42.0/mapbox-gl.css'),\n                    ]).then(function() {\n                        promise.resolve(window.mapboxgl);\n                    }, function(error) {\n                        promise.reject(error);\n                    });\n                }\n            });\n        }\n\n        function MapBoxScript(url) {\n            return $promise(function(promise) {\n                try {\n                    var id = 'mapboxscript';\n                    var script = document.getElementsByTagName('script')[0];\n                    if (document.getElementById(id)) {\n                        return;\n                    }\n                    var node = document.createElement('script');\n                    node.id = id;\n                    node.src = url;\n                    node.addEventListener('load', promise.resolve);\n                    node.addEventListener('error', promise.reject);\n                    script.parentNode.insertBefore(node, script);\n                } catch (error) {\n                    promise.reject(error);\n                }\n                /*\n                var node = document.createElement('script');\n                node.src = url;\n                node.addEventListener('load', promise.resolve);\n                node.addEventListener('error', promise.reject);\n                document.body.appendChild(node);\n                */\n            });\n        }\n\n        function MapBoxLink(url) {\n            return $promise(function(promise) {\n                try {\n                    var id = 'mapboxstyle';\n                    var link = document.getElementsByTagName('link')[0];\n                    if (document.getElementById(id)) {\n                        return;\n                    }\n                    var node = document.createElement('link');\n                    node.id = id;\n                    node.rel = 'stylesheet';\n                    node.href = url;\n                    node.addEventListener('load', promise.resolve);\n                    node.addEventListener('error', promise.reject);\n                    link.parentNode.insertBefore(node, link);\n                } catch (error) {\n                    promise.reject(error);\n                }\n                /*\n                var node = document.createElement('link');\n                node.rel = 'stylesheet';\n                node.href = url;\n                node.addEventListener('load', promise.resolve);\n                node.addEventListener('error', promise.reject);\n                document.body.appendChild(node);\n                */\n            });\n        }\n\n    }]);\n\n    app.service('___GoogleMaps', ['$q', '$http', '$promise', function($q, $http, $promise) {\n\n        var _key = 'AIzaSyBlgTatREkeIDKEKYL_dtaaDx1yYxmx_iM';\n        var _init = false;\n\n        this.maps = maps;\n        this.geocoder = geocoder;\n        this.parse = parse;\n\n        function maps() {\n            return $promise(function(promise) {\n                if (_init) {\n                    promise.resolve(window.google.maps);\n                } else {\n                    window.__googleMapsInit = function() {\n                        promise.resolve(window.google.maps);\n                        window.__googleMapsInit = null;\n                        _init = true;\n                    };\n                    var script = document.createElement('script');\n                    script.setAttribute('async', null);\n                    script.setAttribute('defer', null);\n                    script.setAttribute('src', 'https://maps.googleapis.com/maps/api/js?key=' + _key + '&callback=__googleMapsInit');\n                    document.body.appendChild(script);\n                }\n            });\n        }\n\n        function geocoder() {\n            var service = this;\n            var deferred = $q.defer();\n            maps().then(function(maps) {\n                var _geocoder = new maps.Geocoder();\n                deferred.resolve(_geocoder);\n            }, function(error) {\n                deferred.reject(error);\n            });\n            return deferred.promise;\n        }\n\n        function getType(type, item) {\n            var types = {\n                street: 'route',\n                number: 'street_number',\n                locality: 'locality',\n                postalCode: 'postal_code',\n                city: 'administrative_area_level_3',\n                province: 'administrative_area_level_2',\n                region: 'administrative_area_level_1',\n                country: 'country',\n            };\n            var label = null;\n            angular.forEach(item.address_components, function(c) {\n                angular.forEach(c.types, function(t) {\n                    if (t === types[type]) {\n                        label = c.long_name;\n                    }\n                });\n            });\n            // console.log('googleMaps.getType', type, item, label);\n            return label;\n        }\n\n        function parse(results) {\n            var items = null;\n            if (results.length) {\n                items = results.filter(function(item) {\n                    return true; // item.geometry.location_type === 'ROOFTOP' ||\n                    // item.geometry.location_type === 'RANGE_INTERPOLATED' ||\n                    // item.geometry.location_type === 'GEOMETRIC_CENTER';\n                }).map(function(item) {\n                    return {\n                        name: item.formatted_address,\n                        street: getType('street', item),\n                        number: getType('number', item),\n                        locality: getType('locality', item),\n                        postalCode: getType('postalCode', item),\n                        city: getType('city', item),\n                        province: getType('province', item),\n                        region: getType('region', item),\n                        country: getType('country', item),\n                        position: {\n                            lng: item.geometry.location.lng(),\n                            lat: item.geometry.location.lat(),\n                        }\n                    };\n                });\n                /*\n                var first = response.data.results[0];\n                scope.model.position = first.geometry.location;\n                console.log(scope.model);\n                setLocation();\n                */\n            }\n            console.log('googleMaps.parse', results, items);\n            return items;\n        }\n\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.provider('environment', ['$locationProvider', '$httpProvider', function($locationProvider, $httpProvider) {\n\n        var provider = this;\n\n        var statics = {\n            add: EnvironmentAdd,\n            use: EnvironmentUse,\n        };\n\n        angular.extend(provider, statics);\n\n        var defaults = {\n            paths: {\n\n            },\n            location: {\n                html5: false,\n                hash: '!',\n            },\n            http: {\n                withCredentials: false,\n                interceptors: [], // ['AuthInterceptorService'],\n            },\n            addons: {\n                facebook: {\n                    app_id: 340008479796111,\n                    scope: 'public_profile, email', // publish_stream\n                    fields: 'id,name,first_name,last_name,email,gender,picture,cover,link',\n                    version: 'v2.10',\n                }\n            },\n            language: {\n                code: 'en',\n                culture: 'en_US',\n                name: 'English',\n                iso: 'ENU',\n            },\n        };\n\n        var global = {};\n\n        if (window.environment) {\n            angular.merge(global, window.environment);\n        }\n\n        var config = {};\n\n        var environment = angular.copy(defaults);\n        angular.merge(environment, global);\n\n        function EnvironmentSetHttp() {\n            $httpProvider.defaults.headers.common[\"Accept-Language\"] = environment.language.code;\n            $httpProvider.defaults.withCredentials = environment.http.withCredentials;\n            $httpProvider.interceptors.push.apply($httpProvider.interceptors, environment.http.interceptors);\n        }\n\n        function EnvironmentSetLocation() {\n            $locationProvider.html5Mode(environment.location.html5);\n            $locationProvider.hashPrefix(environment.location.hash);\n        }\n\n        function EnvironmentAdd(key, data) {\n            config[key] = config[key] ? angular.merge(config[key], data) : data;\n            EnvironmentSet();\n        }\n\n        function EnvironmentSet() {\n            environment = angular.copy(defaults);\n            var value = EnvironmentGet();\n            if (value) {\n                angular.merge(environment, value);\n            }\n            angular.merge(environment, global);\n            EnvironmentSetHttp();\n            EnvironmentSetLocation();\n        }\n\n        function EnvironmentUse(key) {\n            if (config[key]) {\n                environment = angular.copy(defaults);\n                angular.merge(environment, config[key]);\n                angular.merge(environment, global);\n                EnvironmentSetHttp();\n                EnvironmentSetLocation();\n            }\n        }\n\n        function EnvironmentGet() {\n            for (var key in config) {\n                var value = config[key];\n                if (value.paths && window.location.href.indexOf(value.paths.app) !== -1) {\n                    return value;\n                }\n            }\n        }\n\n        provider.$get = function() {\n            return environment;\n        };\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Animate', [function () {\n\n\t\tfunction Animate(callback) {\n\t\t\tthis.callback = callback;\n\t\t\tthis.key = null;\n\t\t\tthis.ticks = 0;\n\t\t}\n\n\t\tvar statics = {};\n\n\t\tvar methods = {\n\t\t\tpause: pause,\n\t\t\tplay: play,\n\t\t\ttoggle: toggle,\n\t\t};\n\n\t\tangular.extend(Animate, statics);\n\t\tangular.extend(Animate.prototype, methods);\n\n\t\treturn Animate;\n\n\t\t// static methods\n\n\t\t// prototype methods\n\n\t\tfunction pause() {\n\t\t\tvar animate = this;\n\t\t\tif (animate.key) {\n\t\t\t\twindow.cancelAnimationFrame(animate.key);\n\t\t\t\tanimate.key = null;\n\t\t\t}\n\t\t}\n\n\t\tfunction play() {\n\t\t\tvar animate = this;\n\n\t\t\tfunction loop(time) {\n\t\t\t\tanimate.ticks++;\n\t\t\t\tanimate.callback(time, animate.ticks);\n\t\t\t\tanimate.key = window.requestAnimationFrame(loop);\n\t\t\t}\n\t\t\tif (!animate.key) {\n\t\t\t\tloop();\n\t\t\t}\n\t\t}\n\n\t\tfunction toggle() {\n\t\t\tvar animate = this;\n\t\t\tif (animate.key) {\n\t\t\t\tanimate.pause();\n\t\t\t} else {\n\t\t\t\tanimate.play();\n\t\t\t}\n\t\t}\n\n    }]);\n\n\t(function () {\n\t\tvar lastTime = 0;\n\t\tvar vendors = ['ms', 'moz', 'webkit', 'o'];\n\t\tfor (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n\t\t\twindow.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\n\t\t\twindow.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] ||\n\t\t\t\twindow[vendors[x] + 'CancelRequestAnimationFrame'];\n\t\t}\n\t\tif (!window.requestAnimationFrame) {\n\t\t\twindow.requestAnimationFrame = function (callback, element) {\n\t\t\t\tvar currTime = new Date().getTime();\n\t\t\t\tvar timeToCall = Math.max(0, 16 - (currTime - lastTime));\n\t\t\t\tvar id = window.setTimeout(function () {\n\t\t\t\t\tcallback(currTime + timeToCall);\n\t\t\t\t}, timeToCall);\n\t\t\t\tlastTime = currTime + timeToCall;\n\t\t\t\treturn id;\n\t\t\t};\n\t\t}\n\t\tif (!window.cancelAnimationFrame) {\n\t\t\twindow.cancelAnimationFrame = function (id) {\n\t\t\t\tclearTimeout(id);\n\t\t\t};\n\t\t}\n\t}());\n\n}());\n/*\n// handle transition on resizing\nvar resizingTimeout;\n$(window).on('resize', function () {\n    clearTimeout(resizingTimeout);\n    $('body').addClass('resizing');\n    resizingTimeout = setTimeout(function () {\n        $('body').removeClass('resizing');\n    }, 100);\n})\n*/\n\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.service('Dom', ['Point', 'Rect', function (Point, Rect) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\tgetBoundRect: getBoundRect,\n\t\t\tgetClosest: getClosest,\n\t\t\tgetClosestNode: getClosestNode,\n\t\t\tgetDelta: getDelta,\n\t\t\tgetDocumentNode: getDocumentNode,\n\t\t\tgetElement: getElement,\n\t\t\tgetNode: getNode,\n\t\t\tgetNodeOffset: getNodeOffset,\n\t\t\tgetPageScroll: getPageScroll,\n\t\t\tgetParents: getParents,\n\t\t\tgetView: getView,\n\t\t\tgetPointInView: getPointInView,\n\t\t\tcompileController: compileController,\n\t\t\tdownloadFile: downloadFile,\n\t\t\tua: getUA(),\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\t// return node element BoundingClientRect\n\t\tfunction getBoundRect(node) {\n\t\t\tnode = getNode(node);\n\t\t\tif (node === window) {\n\t\t\t\tnode = getDocumentNode();\n\t\t\t}\n\t\t\tvar rect = node.getBoundingClientRect();\n\t\t\treturn rect;\n\t\t}\n\n\t\t// return closest parent node that match a selector\n\t\tfunction getClosest(node, selector) {\n\t\t\tvar matchesFn, parent;\n            ['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector', 'oMatchesSelector'].some(function (fn) {\n\t\t\t\tif (typeof document.body[fn] == 'function') {\n\t\t\t\t\tmatchesFn = fn;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t\tif (node[matchesFn](selector)) {\n\t\t\t\treturn node;\n\t\t\t}\n\t\t\twhile (node !== null) {\n\t\t\t\tparent = node.parentElement;\n\t\t\t\tif (parent !== null && parent[matchesFn](selector)) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tnode = parent;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\t// return closest parent node that math a target node\n\t\tfunction getClosestNode(node, target) {\n\t\t\tvar parent = null;\n\t\t\tif (node === target) {\n\t\t\t\treturn node;\n\t\t\t}\n\t\t\twhile (node !== null) {\n\t\t\t\tparent = node.parentElement;\n\t\t\t\tif (parent !== null && parent === target) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tnode = parent;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\t// return wheel delta\n\t\tfunction getDelta(event) {\n\t\t\tvar original = event.originalEvent ? event.originalEvent : event;\n\t\t\tvar type = original.type;\n\t\t\tvar delta = null;\n\t\t\tif (type === 'wheel' || type === 'mousewheel' || type === 'DOMMouseScroll') {\n\t\t\t\tvar deltaX = original.deltaX || original.wheelDeltaX;\n\t\t\t\tvar deltaY = original.deltaY || original.wheelDeltaY;\n\t\t\t\tdelta = new Point(deltaX, deltaY);\n\t\t\t\tif (Math.abs(deltaX) > Math.abs(deltaY)) {\n\t\t\t\t\tdelta.dir = deltaX < 0 ? 1 : -1;\n\t\t\t\t} else {\n\t\t\t\t\tdelta.dir = deltaY < 0 ? 1 : -1;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn delta;\n\t\t}\n\n\t\t// return document element node\n\t\tfunction getDocumentNode() {\n\t\t\tvar documentNode = (document.documentElement || document.body.parentNode || document.body);\n\t\t\treturn documentNode;\n\t\t}\n\n\t\t// return an angular element\n\t\tfunction getElement(element) {\n\t\t\treturn angular.isArray(element) ? element : angular.element(element);\n\t\t}\n\n\t\t// return a native html node\n\t\tfunction getNode(element) {\n\t\t\treturn angular.isArray(element) ? element[0] : element;\n\t\t}\n\n\t\t// return a node offset point\n\t\tfunction getNodeOffset(node) {\n\t\t\tvar offset = new Point();\n\t\t\tnode = getNode(node);\n\t\t\tif (node && node.nodeType === 1) {\n\t\t\t\toffset.x = node.offsetLeft;\n\t\t\t\toffset.y = node.offsetTop;\n\t\t\t}\n\t\t\treturn offset;\n\t\t}\n\n\t\t// return the current page scroll\n\t\tfunction getPageScroll() {\n\t\t\tvar scroll = new Point();\n\t\t\tvar documentNode = getDocumentNode();\n\t\t\tscroll.x = window.pageXOffset || documentNode.scrollLeft;\n\t\t\tscroll.y = window.pageYOffset || documentNode.scrollTop;\n\t\t\treturn scroll;\n\t\t}\n\n\t\t// return an array of node parants\n\t\tfunction getParents(node, topParentNode) {\n\t\t\t// if no topParentNode defined will bubble up all the way to *document*\n\t\t\ttopParentNode = topParentNode || getDocumentNode();\n\t\t\tvar parents = [];\n\t\t\tif (node) {\n\t\t\t\tparents.push(node);\n\t\t\t\tvar parentNode = node.parentNode;\n\t\t\t\twhile (parentNode !== topParentNode) {\n\t\t\t\t\tparents.push(parentNode);\n\t\t\t\t\tparentNode = parentNode.parentNode;\n\t\t\t\t}\n\t\t\t\tparents.push(topParentNode); // push that topParentNode you wanted to stop at\n\t\t\t}\n\t\t\treturn parents;\n\t\t}\n\n\t\t// return the view rect\n\t\tfunction getView() {\n\t\t\tvar view = new Rect();\n\t\t\tif (window.innerWidth !== undefined) {\n\t\t\t\tview.width = window.innerWidth;\n\t\t\t\tview.height = window.innerHeight;\n\t\t\t} else {\n\t\t\t\tvar documentNode = getDocumentNode();\n\t\t\t\tview.width = documentNode.clientWidth;\n\t\t\t\tview.height = documentNode.clientHeight;\n\t\t\t}\n\t\t\treturn view;\n\t\t}\n\n\t\t// add to constant\n\t\tvar MOUSE_EVENTS = ['click', 'mousedown', 'mouseup', 'mousemove', 'mouseover', 'mouseout', 'mouseenter', 'mouseleave', 'contextmenu'];\n\t\tvar TOUCH_EVENTS = ['touchstart', 'touchmove', 'touchend', 'touchcancel'];\n\n\t\tfunction getPointInView(event) {\n\t\t\tvar original = event.originalEvent ? event.originalEvent : event;\n\t\t\tvar type = original.type;\n\t\t\tvar point = null;\n\t\t\tif (TOUCH_EVENTS.indexOf(type) !== -1) {\n\t\t\t\tvar touch = null;\n\t\t\t\tvar touches = original.touches.length ? original.touches : original.changedTouches;\n\t\t\t\tif (touches && touches.length) {\n\t\t\t\t\ttouch = touches[0];\n\t\t\t\t}\n\t\t\t\tif (touch) {\n\t\t\t\t\tpoint = new Point();\n\t\t\t\t\tpoint.x = touch.pageX;\n\t\t\t\t\tpoint.y = touch.pageY;\n\t\t\t\t}\n\t\t\t} else if (MOUSE_EVENTS.indexOf(type) !== -1) {\n\t\t\t\tpoint = new Point();\n\t\t\t\tpoint.x = original.pageX;\n\t\t\t\tpoint.y = original.pageY;\n\t\t\t}\n\t\t\treturn point;\n\t\t}\n\n\t\tfunction getUA() {\n\t\t\tvar agent = window.navigator.userAgent.toLowerCase();\n\t\t\tvar safari = agent.indexOf('safari') !== -1 && agent.indexOf('chrome') === -1;\n\t\t\tvar msie = agent.indexOf('trident') !== -1 || agent.indexOf('edge') !== -1 || agent.indexOf('msie') !== -1;\n\t\t\tvar chrome = !safari && !msie && agent.indexOf('chrome') !== -1;\n\t\t\tvar mobile = agent.indexOf('mobile') !== -1;\n\t\t\tvar mac = agent.indexOf('macintosh') !== -1;\n\t\t\tvar ua = {\n\t\t\t\tagent: agent,\n\t\t\t\tsafari: safari,\n\t\t\t\tmsie: msie,\n\t\t\t\tchrome: chrome,\n\t\t\t\tmobile: mobile,\n\t\t\t\tmac: mac,\n\t\t\t};\n\t\t\tangular.forEach(ua, function (value, key) {\n\t\t\t\tif (value) {\n\t\t\t\t\tangular.element(document.getElementsByTagName('body')).addClass(key);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ua;\n\t\t}\n\n\t\t/*\n    function mobilecheck() {\n        var check = false;\n        (function(a) { if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4))) check = true; })(navigator.userAgent || navigator.vendor || window.opera);\n        return check;\n    }\n\n    // For those wishing to include tablets in this test (though arguably, you shouldn't), you can use the following function:\n    function mobileAndTabletcheck() {\n        var check = false;\n        (function(a) { if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4))) check = true; })(navigator.userAgent || navigator.vendor || window.opera);\n        return check;\n    }\n\n    var isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n    var isMobile = mobilecheck();\n    var isMobileAndTabled = mobileAndTabletcheck();\n\t\t*/\n\n\t\tfunction compileController(scope, element, html, data) {\n\t\t\t// console.log('Dom.compileController', element);\n\t\t\telement = getElement(element);\n\t\t\telement.html(html);\n\t\t\tvar link = $compile(element.contents());\n\t\t\tif (data.controller) {\n\t\t\t\tvar $scope = scope.$new();\n\t\t\t\tangular.extend($scope, data);\n\t\t\t\tvar controller = $controller(data.controller, {\n\t\t\t\t\t$scope: $scope\n\t\t\t\t});\n\t\t\t\tif (data.controllerAs) {\n\t\t\t\t\tscope[data.controllerAs] = controller;\n\t\t\t\t}\n\t\t\t\telement.data('$ngControllerController', controller);\n\t\t\t\telement.children().data('$ngControllerController', controller);\n\t\t\t\tscope = $scope;\n\t\t\t}\n\t\t\tlink(scope);\n\t\t}\n\n\t\tfunction downloadFile(content, name, type) {\n\t\t\ttype = type || 'application/octet-stream';\n\t\t\tvar base64 = null;\n\t\t\tvar blob = new Blob([content], {\n\t\t\t\ttype: type\n\t\t\t});\n\t\t\tvar reader = new window.FileReader();\n\t\t\treader.readAsDataURL(blob);\n\t\t\treader.onloadend = function () {\n\t\t\t\tbase64 = reader.result;\n\t\t\t\tdownload();\n\t\t\t};\n\n\t\t\tfunction download() {\n\t\t\t\tif (document.createEvent) {\n\t\t\t\t\tvar anchor = document.createElement('a');\n\t\t\t\t\tanchor.href = base64;\n\t\t\t\t\tif (anchor.download !== undefined) {\n\t\t\t\t\t\tvar downloadName = name || base64.substring(base64.lastIndexOf('/') + 1, base64.length);\n\t\t\t\t\t\tanchor.download = downloadName;\n\t\t\t\t\t}\n\t\t\t\t\tvar event = document.createEvent('MouseEvents');\n\t\t\t\t\tevent.initEvent('click', true, true);\n\t\t\t\t\tanchor.dispatchEvent(event);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tvar query = '?download';\n\t\t\t\twindow.open(base64.indexOf('?') > -1 ? base64 : base64 + query, '_self');\n\t\t\t}\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Event', ['EventsService', 'Dom', 'Point', 'Rect', function (EventsService, Dom, Point, Rect) {\n\n\t\tfunction Event(event, element) {\n\t\t\ttry {\n\t\t\t\tevent = event || window.event;\n\t\t\t\tvar type = event.type;\n\t\t\t\tvar originalEvent = event.originalEvent ? event.originalEvent : event;\n\t\t\t\tvar node = element[0]; // Dom.getNode(element);\n\t\t\t\tvar offset = Dom.getNodeOffset(node);\n\t\t\t\tvar rect = Dom.getBoundRect(node);\n\t\t\t\tvar view = Dom.getView();\n\t\t\t\tvar scroll = Dom.getPageScroll();\n\t\t\t\tvar point = Dom.getPointInView(event);\n\t\t\t\tif (point) {\n\t\t\t\t\tvar absolute = new Point(point.x - scroll.x, point.y - scroll.y);\n\t\t\t\t\tvar relative = new Point(absolute.x - rect.left, absolute.y - rect.top);\n\t\t\t\t\tthis.point = point;\n\t\t\t\t\tthis.absolute = absolute;\n\t\t\t\t\tthis.relative = relative;\n\t\t\t\t}\n\t\t\t\tvar delta = Dom.getDelta(event);\n\t\t\t\tif (delta) {\n\t\t\t\t\tthis.delta = delta;\n\t\t\t\t\tthis.dir = delta.dir;\n\t\t\t\t}\n\t\t\t\tthis.event = event;\n\t\t\t\tthis.type = type;\n\t\t\t\tthis.originalEvent = originalEvent;\n\t\t\t\tthis.element = element;\n\t\t\t\tthis.node = node;\n\t\t\t\tthis.offset = offset;\n\t\t\t\tthis.rect = rect;\n\t\t\t\tthis.view = view;\n\t\t\t\tthis.scroll = scroll;\n\t\t\t\tthis.timestamp = new Date().getTime();\n\t\t\t} catch (error) {\n\t\t\t\tconsole.log('Event.error', error);\n\t\t\t}\n\t\t}\n\n\t\tvar methods = {\n\t\t\tstop: stop,\n\t\t};\n\n\t\tvar statics = {};\n\n\t\tangular.extend(Event.prototype, methods);\n\t\tangular.extend(Event, statics);\n\t\treturn Event;\n\n\t\t// prototype methods\n\n\t\tfunction stop() {\n\t\t\tthis.event.stopPropagation();\n\t\t\tthis.event.preventDefault();\n\t\t}\n\n\t}]);\n\n\tapp.factory('Events', ['EventsService', 'Event', 'Dom', function (EventsService, Event, Dom) {\n\n\t\tfunction Events(element) {\n\t\t\tvar events = this;\n\n\t\t\tthis.element = Dom.getElement(element);\n\t\t\tthis.listeners = {};\n\t\t\tthis.standardEvents = {\n\t\t\t\tclick: {\n\t\t\t\t\tkey: 'click',\n\t\t\t\t\tcallback: onClick\n\t\t\t\t},\n\t\t\t\tdown: {\n\t\t\t\t\tkey: 'mousedown',\n\t\t\t\t\tcallback: onMouseDown\n\t\t\t\t},\n\t\t\t\tmove: {\n\t\t\t\t\tkey: 'mousemove',\n\t\t\t\t\tcallback: onMouseMove\n\t\t\t\t},\n\t\t\t\tup: {\n\t\t\t\t\tkey: 'mouseup',\n\t\t\t\t\tcallback: onMouseUp\n\t\t\t\t},\n\t\t\t\tresize: {\n\t\t\t\t\tkey: 'resize',\n\t\t\t\t\tcallback: onResize\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.touchEvents = {\n\t\t\t\tdown: {\n\t\t\t\t\tkey: 'touchstart',\n\t\t\t\t\tcallback: onTouchStart\n\t\t\t\t},\n\t\t\t\tmove: {\n\t\t\t\t\tkey: 'touchmove',\n\t\t\t\t\tcallback: onTouchMove\n\t\t\t\t},\n\t\t\t\tup: {\n\t\t\t\t\tkey: 'touchend',\n\t\t\t\t\tcallback: onTouchEnd\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.wheelEvents = {\n\t\t\t\twheel: {\n\t\t\t\t\tkey: 'mousewheel',\n\t\t\t\t\tcallback: onMouseWheel\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.scrollEvents = {\n\t\t\t\twheel: {\n\t\t\t\t\tkey: 'DOMMouseScroll',\n\t\t\t\t\tcallback: onMouseScroll\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.timestamp = new Date().getTime();\n\t\t\tthis.setTimestamp = setTimestamp;\n\n\t\t\tfunction setTimestamp(event) {\n\t\t\t\tif (event) {\n\t\t\t\t\tevent.interval = Math.min(250, event.timestamp - events.timestamp);\n\t\t\t\t\t// console.log(event.interval, event.timestamp, events.timestamp);\n\t\t\t\t}\n\t\t\t\tevents.timestamp = new Date().getTime();\n\t\t\t}\n\n\t\t\tfunction onClick(e) {\n\t\t\t\t// console.log('onClick', e, events);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.click.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onMouseDown(e) {\n\t\t\t\t// console.log('onMouseDown', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.down.apply(this, [event]);\n\t\t\t\tevents.removeTouchEvents();\n\t\t\t}\n\n\t\t\tfunction onMouseMove(e) {\n\t\t\t\t// console.log('onMouseMove', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.move.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onMouseUp(e) {\n\t\t\t\t// console.log('onMouseUp', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.up.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onMouseWheel(e) {\n\t\t\t\t// console.log('onMouseWheel', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.wheel.apply(this, [event]);\n\t\t\t\tevents.removeScrollEvents();\n\t\t\t}\n\n\t\t\tfunction onMouseScroll(e) {\n\t\t\t\t// console.log('onMouseScroll', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.wheel.apply(this, [event]);\n\t\t\t\tevents.removeWheelEvents();\n\t\t\t}\n\n\t\t\tfunction onResize(e) {\n\t\t\t\t// console.log('onResize', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.resize.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onTouchStart(e) {\n\t\t\t\t// console.log('onTouchStart', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.down.apply(this, [event]);\n\t\t\t\tevents.removeStandardEvents();\n\t\t\t}\n\n\t\t\tfunction onTouchMove(e) {\n\t\t\t\t// console.log('onTouchMove', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.move.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onTouchEnd(e) {\n\t\t\t\t// console.log('onTouchEnd', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.up.apply(this, [event]);\n\t\t\t}\n\t\t}\n\n\t\tvar methods = {\n\t\t\tadd: add,\n\t\t\tremove: remove,\n\t\t\tremoveStandardEvents: removeStandardEvents,\n\t\t\tremoveTouchEvents: removeTouchEvents,\n\t\t\tremoveWheelEvents: removeWheelEvents,\n\t\t\tremoveScrollEvents: removeScrollEvents,\n\t\t};\n\n\t\tvar statics = {\n\t\t\tgetTouch: getTouch,\n\t\t\tgetRelativeTouch: getRelativeTouch,\n\t\t};\n\n\t\tangular.extend(Events.prototype, methods);\n\t\tangular.extend(Events, statics);\n\t\treturn Events;\n\n\t\t// prototype methods\n\n\t\tfunction add(listeners, scope) {\n\t\t\tvar events = this,\n\t\t\t\tstandard = this.standardEvents,\n\t\t\t\ttouch = this.touchEvents,\n\t\t\t\twheel = this.wheelEvents,\n\t\t\t\tscroll = this.scrollEvents;\n\t\t\tvar element = this.element,\n\t\t\t\twindowElement = angular.element(window);\n\n\t\t\tangular.forEach(listeners, function (callback, key) {\n\t\t\t\tif (events.listeners[key]) {\n\t\t\t\t\tvar listener = {};\n\t\t\t\t\tlistener[key] = events.listeners[key];\n\t\t\t\t\tremove(listener);\n\t\t\t\t}\n\t\t\t\tevents.listeners[key] = callback;\n\t\t\t\tif (standard[key]) {\n\t\t\t\t\tif (key === 'resize') {\n\t\t\t\t\t\twindowElement.on(standard[key].key, standard[key].callback);\n\t\t\t\t\t} else {\n\t\t\t\t\t\telement.on(standard[key].key, standard[key].callback);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (touch[key]) {\n\t\t\t\t\telement.on(touch[key].key, touch[key].callback);\n\t\t\t\t}\n\t\t\t\tif (wheel[key]) {\n\t\t\t\t\telement.on(wheel[key].key, wheel[key].callback);\n\t\t\t\t}\n\t\t\t\tif (scroll[key]) {\n\t\t\t\t\telement.on(scroll[key].key, scroll[key].callback);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (scope) {\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tevents.remove(listeners);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn events;\n\t\t}\n\n\t\tfunction remove(listeners) {\n\t\t\tvar events = this,\n\t\t\t\tstandard = this.standardEvents,\n\t\t\t\ttouch = this.touchEvents,\n\t\t\t\twheel = this.wheelEvents,\n\t\t\t\tscroll = this.scrollEvents;\n\t\t\tvar element = this.element,\n\t\t\t\twindowElement = angular.element(window);\n\t\t\tangular.forEach(listeners, function (callback, key) {\n\t\t\t\tif (standard[key]) {\n\t\t\t\t\tif (key === 'resize') {\n\t\t\t\t\t\twindowElement.off(standard[key].key, standard[key].callback);\n\t\t\t\t\t} else {\n\t\t\t\t\t\telement.off(standard[key].key, standard[key].callback);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (touch[key]) {\n\t\t\t\t\telement.off(touch[key].key, touch[key].callback);\n\t\t\t\t}\n\t\t\t\tif (wheel[key]) {\n\t\t\t\t\telement.off(wheel[key].key, wheel[key].callback);\n\t\t\t\t}\n\t\t\t\tif (scroll[key]) {\n\t\t\t\t\telement.off(scroll[key].key, scroll[key].callback);\n\t\t\t\t}\n\t\t\t\tevents.listeners[key] = null;\n\t\t\t});\n\t\t\treturn events;\n\t\t}\n\n\t\tfunction removeStandardEvents() {\n\t\t\tvar events = this,\n\t\t\t\tstandard = events.standardEvents,\n\t\t\t\ttouch = events.touchEvents;\n\t\t\tvar element = events.element;\n\t\t\telement.off('mousedown', standard.down.callback);\n\t\t\telement.off('mousemove', standard.move.callback);\n\t\t\telement.off('mouseup', standard.up.callback);\n\t\t}\n\n\t\tfunction removeTouchEvents() {\n\t\t\tvar events = this,\n\t\t\t\tstandard = events.standardEvents,\n\t\t\t\ttouch = events.touchEvents;\n\t\t\tvar element = events.element;\n\t\t\telement.off('touchstart', touch.down.callback);\n\t\t\telement.off('touchmove', touch.move.callback);\n\t\t\telement.off('touchend', touch.up.callback);\n\t\t}\n\n\t\tfunction removeWheelEvents() {\n\t\t\tvar events = this;\n\t\t\tvar element = events.element;\n\t\t\telement.off('mousewheel', events.mouseEvents.wheel.callback);\n\t\t}\n\n\t\tfunction removeScrollEvents() {\n\t\t\tvar events = this;\n\t\t\tvar element = events.element;\n\t\t\telement.off('DOMMouseScroll', events.scrollEvents.wheel.callback);\n\t\t}\n\n\t\t// statics methods\n\n\t\tfunction getTouch(e, previous) {\n\t\t\tvar point = new Point();\n\t\t\tif (e.type === 'touchstart' || e.type === 'touchmove' || e.type === 'touchend' || e.type === 'touchcancel') {\n\t\t\t\tvar touch = null;\n\t\t\t\tvar event = e.originalEvent ? e.originalEvent : e;\n\t\t\t\tvar touches = event.touches.length ? event.touches : event.changedTouches;\n\t\t\t\tif (touches && touches.length) {\n\t\t\t\t\ttouch = touches[0];\n\t\t\t\t}\n\t\t\t\tif (touch) {\n\t\t\t\t\tpoint.x = touch.pageX;\n\t\t\t\t\tpoint.y = touch.pageY;\n\t\t\t\t}\n\t\t\t} else if (e.type === 'click' || e.type === 'mousedown' || e.type === 'mouseup' || e.type === 'mousemove' || e.type === 'mouseover' || e.type === 'mouseout' || e.type === 'mouseenter' || e.type === 'mouseleave' || e.type === 'contextmenu') {\n\t\t\t\tpoint.x = e.pageX;\n\t\t\t\tpoint.y = e.pageY;\n\t\t\t}\n\t\t\tif (previous) {\n\t\t\t\tpoint.s = Point.difference(t, previous);\n\t\t\t}\n\t\t\tpoint.type = e.type;\n\t\t\treturn point;\n\t\t}\n\n\t\tfunction getRelativeTouch(node, point) {\n\t\t\tnode = angular.isArray(node) ? node[0] : node;\n\t\t\treturn Point.difference(point, {\n\t\t\t\tx: node.offsetLeft,\n\t\t\t\ty: node.offsetTop\n\t\t\t});\n\t\t}\n\n    }]);\n\n\tapp.service('EventsService', ['Dom', function (Dom) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\thasPassiveEvents: hasPassiveEvents,\n\t\t\taddEventListener: getAddEventListener(),\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\t// prevent history back on mac os\n\n\t\tpreventHistoryNavigation();\n\n\t\t// static methods\n\n\t\tfunction hasPassiveEvents() {\n\t\t\tvar supported = false;\n\t\t\tif (window.addEventListener) {\n\t\t\t\ttry {\n\t\t\t\t\tvar options = Object.defineProperty({}, 'passive', {\n\t\t\t\t\t\tget: function () {\n\t\t\t\t\t\t\tsupported = true;\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\twindow.addEventListener('test', null, options);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log('getAddEventListener.isSupprted', e);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn supported;\n\t\t}\n\n\t\tfunction getAddEventListener() {\n\t\t\tvar supported = hasPassiveEvents();\n\t\t\tif (!supported) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar defaults = {\n\t\t\t\tpassive: false,\n\t\t\t\tcapture: false,\n\t\t\t};\n\n\t\t\tfunction getModifiedAddEventListener(original) {\n\t\t\t\tfunction addEventListener(type, listener, options) {\n\t\t\t\t\tif (typeof options !== 'object') {\n\t\t\t\t\t\tvar capture = options === true;\n\t\t\t\t\t\toptions = angular.copy(defaults);\n\t\t\t\t\t\toptions.capture = capture;\n\t\t\t\t\t} else {\n\t\t\t\t\t\toptions = angular.extend(angular.copy(defaults), options);\n\t\t\t\t\t}\n\t\t\t\t\toriginal.call(this, type, listener, options);\n\t\t\t\t}\n\t\t\t\treturn addEventListener;\n\t\t\t}\n\n\t\t\tvar original = EventTarget.prototype.addEventListener;\n\t\t\tvar modified = getModifiedAddEventListener(original);\n\t\t\tEventTarget.prototype.addEventListener = modified;\n\t\t\treturn modified;\n\t\t}\n\n\t\tfunction preventHistoryNavigation() {\n\t\t\tif (!Dom.ua.mac) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (Dom.ua.chrome || Dom.ua.safari || Dom.ua.firefox) {\n\t\t\t\twindow.addEventListener('mousewheel', onScroll, {\n\t\t\t\t\tpassive: false\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction onScroll(e) {\n\t\t\t\tif (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\t(e.deltaX < 0 && (Dom.getParents(e.target).filter(function (node) {\n\t\t\t\t\t\treturn node.scrollLeft > 0;\n\t\t\t\t\t}).length === 0)) ||\n\t\t\t\t\t(e.deltaX > 0 && (Dom.getParents(e.target).filter(function (node) {\n\t\t\t\t\t\treturn node.scrollWidth - node.scrollLeft > node.clientWidth;\n\t\t\t\t\t}).length === 0))\n\t\t\t\t) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n    }]);\n\n}());\n/* global angular, app, Autolinker */\r\n(function () {\r\n\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.filter('notIn', ['$filter', function ($filter) {\r\n\r\n\t\treturn function (array, filters, element) {\r\n\t\t\tif (filters) {\r\n\t\t\t\treturn $filter(\"filter\")(array, function (item) {\r\n\t\t\t\t\tfor (var i = 0; i < filters.length; i++) {\r\n\t\t\t\t\t\tif (filters[i][element] === item[element]) return false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\r\n    }]);\r\n\r\n}());\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Point', [function () {\n\n\t\tfunction Point(x, y) {\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\t\t}\n\n\t\tvar statics = {\n\t\t\tdifference: PointDifference,\n\t\t\tmultiply: PointMultiply,\n\t\t};\n\n\t\tvar methods = {\n\t\t\tclone: clone,\n\t\t\tcopy: copy,\n\t\t\tdifference: difference,\n\t\t\tmult: mult,\n\t\t\toffset: offset,\n\t\t\tsetPos: setPos,\n\t\t\tsetX: setX,\n\t\t\tsetY: setY,\n\t\t\ttoString: toString,\n\t\t};\n\n\t\tangular.extend(Point, statics);\n\t\tangular.extend(Point.prototype, methods);\n\n\t\treturn Point;\n\n\t\t// static methods\n\n\t\tfunction PointDifference(a, b) {\n\t\t\treturn new Point(a.x - b.x, a.y - b.y);\n\t\t}\n\n\t\tfunction PointMultiply(point, value) {\n\t\t\tpoint.x *= value;\n\t\t\tpoint.y *= value;\n\t\t\treturn point;\n\t\t}\n\n\t\t// prototype methods\n\n\t\tfunction clone() {\n\t\t\treturn new Point(this.x, this.y);\n\t\t}\n\n\t\tfunction copy(point) {\n\t\t\tthis.x = point.x;\n\t\t\tthis.y = point.y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction difference(b) {\n\t\t\treturn PointDifference(this, b);\n\t\t}\n\n\t\tfunction mult(value) {\n\t\t\treturn PointMultiply(this, value);\n\t\t}\n\n\t\tfunction offset(x, y) {\n\t\t\tthis.x += x;\n\t\t\tthis.y += y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setPos(x, y) {\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setX(x) {\n\t\t\tthis.x = x;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setY(y) {\n\t\t\tthis.y = y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction toString() {\n\t\t\treturn '{' + this.x + ',' + this.y + '}';\n\t\t}\n\n    }]);\n\n}());\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Rect', [function () {\n\n\t\tfunction Rect(x, y, w, h) {\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\t\t\tthis.w = w || 0;\n\t\t\tthis.h = h || 0;\n\t\t}\n\n\t\tvar statics = {\n\t\t\tmult: RectMultiply,\n\t\t};\n\n\t\tvar methods = {\n\t\t\tbottom: bottom,\n\t\t\tbottomLeft: bottomLeft,\n\t\t\tbottomRight: bottomRight,\n\t\t\tcenter: center,\n\t\t\tclone: clone,\n\t\t\tcopy: copy,\n\t\t\texpand: expand,\n\t\t\texpandRect: expandRect,\n\t\t\tintersect: intersect,\n\t\t\tleft: left,\n\t\t\tmult: mult,\n\t\t\toffset: offset,\n\t\t\treduce: reduce,\n\t\t\treduceRect: reduceRect,\n\t\t\tright: right,\n\t\t\tsetH: setH,\n\t\t\tsetPos: setPos,\n\t\t\tsetSize: setSize,\n\t\t\tsetX: setX,\n\t\t\tsetY: setY,\n\t\t\tsetW: setW,\n\t\t\ttop: top,\n\t\t\ttopLeft: topLeft,\n\t\t\ttopRight: topRight,\n\t\t\ttoString: toString,\n\t\t};\n\n\t\tangular.extend(Rect, statics);\n\t\tangular.extend(Rect.prototype, methods);\n\n\t\treturn Rect;\n\n\t\t// static methods\n\n\t\tfunction RectMultiply(rect, value) {\n\t\t\trect.x *= value;\n\t\t\trect.y *= value;\n\t\t\trect.w *= value;\n\t\t\trect.h *= value;\n\t\t\treturn rect;\n\t\t}\n\n\t\t// prototype methods\n\n\t\tfunction bottom() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w / 2,\n\t\t\t\ty: y + h\n\t\t\t};\n\t\t}\n\n\t\tfunction bottomLeft() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x,\n\t\t\t\ty: y + h\n\t\t\t};\n\t\t}\n\n\t\tfunction bottomRight() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w,\n\t\t\t\ty: y + h\n\t\t\t};\n\t\t}\n\n\t\tfunction center() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w / 2,\n\t\t\t\ty: y + h / 2\n\t\t\t};\n\t\t}\n\n\t\tfunction clone() {\n\t\t\treturn new Rect(this.x, this.y, this.w, this.h);\n\t\t}\n\n\t\tfunction copy(rect) {\n\t\t\tthis.x = rect.x;\n\t\t\tthis.y = rect.y;\n\t\t\tthis.w = rect.w;\n\t\t\tthis.h = rect.h;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction expand(size) {\n\t\t\treturn this.expandRect({\n\t\t\t\tx: size,\n\t\t\t\ty: size,\n\t\t\t\tw: size * 2,\n\t\t\t\th: size * 2\n\t\t\t});\n\t\t}\n\n\t\tfunction expandRect(rect) {\n\t\t\tthis.x -= rect.x || 0;\n\t\t\tthis.y -= rect.y || 0;\n\t\t\tthis.w += rect.w || 0;\n\t\t\tthis.h += rect.h || 0;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction intersect(rect) {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn !(rect.x > x + w || rect.x + rect.w < x || rect.y > y + h || rect.y + rect.h < y);\n\t\t}\n\n\t\tfunction left() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x,\n\t\t\t\ty: y + h / 2\n\t\t\t};\n\t\t}\n\n\t\tfunction mult(value) {\n\t\t\treturn RectMultiply(this, value);\n\t\t}\n\n\t\tfunction offset(x, y) {\n\t\t\tthis.x += x;\n\t\t\tthis.y += y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction reduce(size) {\n\t\t\treturn this.offset(-size);\n\t\t}\n\n\t\tfunction reduceRect(rect) {\n\t\t\treturn this.offsetRect(RectMultiply(rect, -1));\n\t\t}\n\n\t\tfunction right() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w,\n\t\t\t\ty: y + h / 2\n\t\t\t};\n\t\t}\n\n\t\tfunction setH(h) {\n\t\t\tthis.h = h;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setPos(x, y) {\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setSize(w, h) {\n\t\t\tthis.w = w;\n\t\t\tthis.h = h;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setX(x) {\n\t\t\tthis.x = x;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setY(y) {\n\t\t\tthis.y = y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setW(w) {\n\t\t\tthis.w = w;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction top() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w / 2,\n\t\t\t\ty: y\n\t\t\t};\n\t\t}\n\n\t\tfunction topLeft() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x,\n\t\t\t\ty: y\n\t\t\t};\n\t\t}\n\n\t\tfunction topRight() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w,\n\t\t\t\ty: y\n\t\t\t};\n\t\t}\n\n\t\tfunction toString() {\n\t\t\treturn '{' + this.x + ',' + this.y + ',' + this.w + ',' + this.h + '}';\n\t\t}\n\n    }]);\n\n}());\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Vector', function () {\n\t\tfunction Vector(x, y) {\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\t\t}\n\n\t\tvar statics = {\n\t\t\tcross: VectorCross,\n\t\t\tdifference: VectorDifference,\n\t\t\tdistance: VectorDistance,\n\t\t\tincidence: VectorIncidence,\n\t\t\tmake: VectorMake,\n\t\t\tnormalize: VectorNormalize,\n\t\t\tpower: VectorPower,\n\t\t\tsize: VectorSize,\n\t\t};\n\n\t\tvar methods = {\n\t\t\tadd: add,\n\t\t\tcopy: copy,\n\t\t\tcross: cross,\n\t\t\tdifference: difference,\n\t\t\tdistance: distance,\n\t\t\tfriction: friction,\n\t\t\tincidence: incidence,\n\t\t\tnormalize: normalize,\n\t\t\tpower: power,\n\t\t\tsize: size,\n\t\t\ttowards: towards,\n\t\t\ttoString: toString,\n\t\t};\n\n\t\tangular.extend(Vector, statics);\n\t\tangular.extend(Vector.prototype, methods);\n\n\t\treturn Vector;\n\n\t\t// statics methods\n\n\t\tfunction VectorCross(a, b) {\n\t\t\treturn (a.x * b.y) - (a.y * b.x);\n\t\t}\n\n\t\tfunction VectorDifference(a, b) {\n\t\t\treturn new Vector(a.x - b.x, a.y - b.y);\n\t\t}\n\n\t\tfunction VectorDistance(a, b) {\n\t\t\treturn Math.sqrt((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));\n\t\t}\n\n\t\tfunction VectorIncidence(a, b) {\n\t\t\tvar angle = Math.atan2(b.y, b.x) - Math.atan2(a.y, a.x);\n\t\t\treturn angle;\n\t\t}\n\n\t\tfunction VectorMake(a, b) {\n\t\t\treturn new Vector(b.x - a.x, b.y - a.y);\n\t\t}\n\n\t\tfunction VectorNormalize(a) {\n\t\t\tvar l = Vector.size(a);\n\t\t\ta.x /= l;\n\t\t\ta.y /= l;\n\t\t\treturn a;\n\t\t}\n\n\t\tfunction VectorPower(a, b) {\n\t\t\tvar x = Math.abs(b.x - a.x);\n\t\t\tvar y = Math.abs(b.y - a.y);\n\t\t\treturn (x + y) / 2;\n\t\t}\n\n\t\tfunction VectorSize(a) {\n\t\t\treturn Math.sqrt(a.x * a.x + a.y * a.y);\n\t\t}\n\n\t\t// prototype methods\n\n\t\tfunction add(b) {\n\t\t\tthis.x += b.x;\n\t\t\tthis.y += b.y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction copy(b) {\n\t\t\treturn new Vector(this.x, this.y);\n\t\t}\n\n\t\tfunction cross(b) {\n\t\t\treturn VectorCross(this, b);\n\t\t}\n\n\t\tfunction difference(b) {\n\t\t\treturn VectorDifference(this, b);\n\t\t}\n\n\t\tfunction distance(b) {\n\t\t\treturn VectorDistance(this, b);\n\t\t}\n\n\t\tfunction friction(b) {\n\t\t\tthis.x *= b;\n\t\t\tthis.y *= b;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction incidence(b) {\n\t\t\treturn VectorIncidence(this, b);\n\t\t}\n\n\t\tfunction normalize() {\n\t\t\treturn VectorNormalize(this);\n\t\t}\n\n\t\tfunction power() {\n\t\t\treturn (Math.abs(this.x) + Math.abs(this.y)) / 2;\n\t\t}\n\n\t\tfunction size() {\n\t\t\treturn VectorSize(this);\n\t\t}\n\n\t\tfunction towards(b, friction) {\n\t\t\tfriction = friction || 0.125;\n\t\t\tthis.x += (b.x - this.x) * friction;\n\t\t\tthis.y += (b.y - this.y) * friction;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction toString() {\n\t\t\treturn '{' + this.x + ',' + this.y + '}';\n\t\t}\n\n\t});\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Hash', [function () {\n\n\t\tfunction Hash(key, pool) {\n\t\t\tkey = key || 'id';\n\t\t\tpool = pool ? HashGet(pool) : {};\n\t\t\tObject.defineProperties(this, {\n\t\t\t\tkey: {\n\t\t\t\t\tvalue: key,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\twritable: false\n\t\t\t\t},\n\t\t\t\tpool: {\n\t\t\t\t\tvalue: pool,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\twritable: false\n\t\t\t\t},\n\t\t\t\tlength: {\n\t\t\t\t\tvalue: 0,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\twritable: true\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tvar pools = {};\n\n\t\tvar statics = {\n\t\t\tget: HashGet,\n\t\t};\n\n\t\tvar methods = {\n\t\t\thas: has,\n\t\t\tgetId: getId,\n\t\t\tget: get,\n\t\t\tset: set,\n\t\t\tadd: add,\n\t\t\tremove: remove,\n\t\t\teach: each,\n\t\t\taddMany: addMany,\n\t\t\tremoveMany: removeMany,\n\t\t\tremoveAll: removeAll,\n\t\t\tforward: forward,\n\t\t\tbackward: backward,\n\t\t\tdiffers: differs,\n\t\t\tupdatePool: updatePool,\n\t\t};\n\n\t\tHash.prototype = new Array;\n\n\t\tangular.extend(Hash, statics);\n\t\tangular.extend(Hash.prototype, methods);\n\n\t\treturn Hash;\n\n\t\t// static methods\n\n\t\tfunction HashGet(pool) {\n\t\t\treturn (pools[pool] = pools[pool] || {});\n\t\t}\n\n\t\tfunction has(id) {\n\t\t\treturn this.pool[id] !== undefined;\n\t\t}\n\n\t\tfunction getId(id) {\n\t\t\treturn this.pool[id];\n\t\t}\n\n\t\tfunction get(item) {\n\t\t\tvar hash = this,\n\t\t\t\tkey = this.key;\n\t\t\treturn item ? hash.getId(item[key]) : null;\n\t\t}\n\n\t\tfunction set(item) {\n\t\t\tvar hash = this,\n\t\t\t\tpool = this.pool,\n\t\t\t\tkey = this.key;\n\t\t\tpool[item[key]] = item;\n\t\t\thash.push(item);\n\t\t\treturn item;\n\t\t}\n\n\t\tfunction add(newItem) {\n\t\t\tvar hash = this;\n\t\t\tvar item = hash.get(newItem);\n\t\t\tif (item) {\n\t\t\t\tfor (var i = 0, keys = Object.keys(newItem), p; i < keys.length; i++) {\n\t\t\t\t\tp = keys[i];\n\t\t\t\t\titem[p] = newItem[p];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\titem = hash.set(newItem);\n\t\t\t}\n\t\t\treturn item;\n\t\t}\n\n\t\tfunction remove(oldItem) {\n\t\t\tvar hash = this,\n\t\t\t\tpool = this.pool,\n\t\t\t\tkey = this.key;\n\t\t\tvar item = hash.get(oldItem);\n\t\t\tif (item) {\n\t\t\t\tvar index = hash.indexOf(item);\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\thash.splice(index, 1);\n\t\t\t\t}\n\t\t\t\tdelete pool[item[key]];\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction addMany(items) {\n\t\t\tvar hash = this;\n\t\t\tif (!items) {\n\t\t\t\treturn hash;\n\t\t\t}\n\t\t\tvar i = 0;\n\t\t\twhile (i < items.length) {\n\t\t\t\thash.add(items[i]);\n\t\t\t\ti++;\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction removeMany(items) {\n\t\t\tvar hash = this;\n\t\t\tif (!items) {\n\t\t\t\treturn hash;\n\t\t\t}\n\t\t\tvar i = 0;\n\t\t\twhile (i < items.length) {\n\t\t\t\thash.remove(items[i]);\n\t\t\t\ti++;\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction removeAll() {\n\t\t\tvar hash = this,\n\t\t\t\tkey = hash.key,\n\t\t\t\tpool = hash.pool;\n\t\t\tvar i = 0,\n\t\t\t\tt = hash.length,\n\t\t\t\titem;\n\t\t\twhile (hash.length) {\n\t\t\t\titem = hash.shift();\n\t\t\t\tdelete pool[item[key]];\n\t\t\t\ti++;\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction each(callback) {\n\t\t\tvar hash = this;\n\t\t\tif (callback) {\n\t\t\t\tvar i = 0;\n\t\t\t\twhile (i < hash.length) {\n\t\t\t\t\tcallback(hash[i], i);\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction forward(key, reverse) {\n\t\t\tvar hash = this;\n\t\t\tkey = (key || this.key);\n\t\t\thash.sort(function (c, d) {\n\t\t\t\tvar a = reverse ? d : c;\n\t\t\t\tvar b = reverse ? c : d;\n\t\t\t\treturn a[key] - b[key];\n\t\t\t});\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction backward(key) {\n\t\t\treturn this.forward(key, true);\n\t\t}\n\n\t\tfunction differs(hash) {\n\t\t\tif (hash.key !== this.key || hash.length !== this.length) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tvar differs = false,\n\t\t\t\t\ti = 0,\n\t\t\t\t\tt = this.length,\n\t\t\t\t\tkey = this.key;\n\t\t\t\twhile (differs && i < t) {\n\t\t\t\t\tdiffers = this[i][key] !== hash[i][key];\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction updatePool() {\n\t\t\tvar hash = this,\n\t\t\t\tpool = this.pool,\n\t\t\t\tkey = this.key;\n\t\t\tObject.keys(pool).forEach(function (key) {\n\t\t\t\tdelete pool[key];\n\t\t\t});\n\t\t\tangular.forEach(hash, function (item) {\n\t\t\t\tpool[item[key]] = item;\n\t\t\t});\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('$promise', ['$q', function ($q) {\n\n\t\tfunction $promise(callback) {\n\t\t\tif (typeof callback !== 'function') {\n\t\t\t\tthrow ('promise resolve callback missing');\n\t\t\t}\n\t\t\tvar deferred = $q.defer();\n\t\t\tcallback(deferred);\n\t\t\treturn deferred.promise;\n\t\t}\n\n\t\tvar statics = {\n\t\t\tall: $promiseAll,\n\t\t};\n\n\t\tvar methods = {};\n\n\t\tangular.extend($promise, statics);\n\t\tangular.extend($promise.prototype, methods);\n\n\t\treturn $promise;\n\n\t\tfunction $promiseAll(promises) {\n\t\t\treturn $q.all(promises);\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('State', ['$timeout', function ($timeout) {\n\n\t\tfunction State() {\n\t\t\tthis.errors = [];\n\t\t\tthis.isReady = false;\n\t\t\tthis.idle();\n\t\t}\n\n\t\tvar DELAY = 2000;\n\n\t\tvar statics = {};\n\n\t\tvar methods = {\n\t\t\tbusy: busy,\n\t\t\tclasses: classes,\n\t\t\tenabled: enabled,\n\t\t\terror: error,\n\t\t\terrorMessage: errorMessage,\n\t\t\tidle: idle,\n\t\t\tlabels: labels,\n\t\t\tready: ready,\n\t\t\tsubmitClass: submitClass,\n\t\t\tsuccess: success,\n\t\t};\n\n\t\tangular.extend(State, statics);\n\t\tangular.extend(State.prototype, methods);\n\n\t\treturn State;\n\n\t\t// static methods\n\n\t\t// prototype methods\n\n\t\tfunction busy() {\n\t\t\tvar state = this;\n\t\t\tif (!state.isBusy) {\n\t\t\t\tstate.isBusy = true;\n\t\t\t\tstate.isError = false;\n\t\t\t\tstate.isErroring = false;\n\t\t\t\tstate.isSuccess = false;\n\t\t\t\tstate.isSuccessing = false;\n\t\t\t\tstate.errors = [];\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfunction classes(addons) {\n\t\t\tvar state = this,\n\t\t\t\tclasses = null;\n\t\t\tclasses = {\n\t\t\t\tready: state.isReady,\n\t\t\t\tbusy: state.isBusy,\n\t\t\t\tsuccessing: state.isSuccessing,\n\t\t\t\tsuccess: state.isSuccess,\n\t\t\t\terrorring: state.isErroring,\n\t\t\t\terror: state.isError,\n\t\t\t};\n\t\t\tif (addons) {\n\t\t\t\tangular.forEach(addons, function (value, key) {\n\t\t\t\t\tclasses[value] = classes[key];\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn classes;\n\t\t}\n\n\t\tfunction enabled() {\n\t\t\tvar state = this;\n\t\t\treturn !state.isBusy && !state.isErroring && !state.isSuccessing;\n\t\t}\n\n\t\tfunction error(error) {\n\t\t\tconsole.log('State.error', error);\n\t\t\tvar state = this;\n\t\t\tstate.isBusy = false;\n\t\t\tstate.isError = true;\n\t\t\tstate.isErroring = true;\n\t\t\tstate.isSuccess = false;\n\t\t\tstate.isSuccessing = false;\n\t\t\tstate.errors.push(error);\n\t\t\t$timeout(function () {\n\t\t\t\tstate.isErroring = false;\n\t\t\t}, DELAY);\n\t\t}\n\n\t\tfunction errorMessage() {\n\t\t\tvar state = this;\n\t\t\treturn state.isError ? state.errors[state.errors.length - 1] : null;\n\t\t}\n\n\t\tfunction idle() {\n\t\t\tvar state = this;\n\t\t\tstate.isBusy = false;\n\t\t\tstate.isError = false;\n\t\t\tstate.isErroring = false;\n\t\t\tstate.isSuccess = false;\n\t\t\tstate.isSuccessing = false;\n\t\t\tstate.button = null;\n\t\t\tstate.errors = [];\n\t\t}\n\n\t\tfunction labels(addons) {\n\t\t\tvar state = this;\n\t\t\tvar defaults = {\n\t\t\t\tready: 'submit',\n\t\t\t\tbusy: 'sending',\n\t\t\t\terror: 'error',\n\t\t\t\tsuccess: 'success',\n\t\t\t};\n\t\t\tif (addons) {\n\t\t\t\tangular.extend(defaults, addons);\n\t\t\t}\n\t\t\tvar label = defaults.ready;\n\t\t\tif (state.isBusy) {\n\t\t\t\tlabel = defaults.busy;\n\t\t\t} else if (state.isSuccess) {\n\t\t\t\tlabel = defaults.success;\n\t\t\t} else if (state.isError) {\n\t\t\t\tlabel = defaults.error;\n\t\t\t}\n\t\t\treturn label;\n\t\t}\n\n\t\tfunction ready() {\n\t\t\tvar state = this;\n\t\t\tstate.idle();\n\t\t\tstate.isReady = true;\n\t\t}\n\n\t\tfunction submitClass() {\n\t\t\tvar state = this;\n\t\t\treturn {\n\t\t\t\tbusy: state.isBusy,\n\t\t\t\tready: state.isReady,\n\t\t\t\tsuccessing: state.isSuccessing,\n\t\t\t\tsuccess: state.isSuccess,\n\t\t\t\terrorring: state.isErroring,\n\t\t\t\terror: state.isError,\n\t\t\t};\n\t\t}\n\n\t\tfunction success() {\n\t\t\tvar state = this;\n\t\t\tstate.isBusy = false;\n\t\t\tstate.isError = false;\n\t\t\tstate.isErroring = false;\n\t\t\tstate.isSuccess = true;\n\t\t\tstate.isSuccessing = true;\n\t\t\tstate.errors = [];\n\t\t\t$timeout(function () {\n\t\t\t\tstate.isSuccessing = false;\n\t\t\t}, DELAY);\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar transformProperty = detectTransformProperty();\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Style', [function () {\n\n\t\tfunction Style() {\n\t\t\tthis.props = {\n\t\t\t\tscale: 1,\n\t\t\t\thoverScale: 1,\n\t\t\t\tcurrentScale: 1,\n\t\t\t};\n\t\t}\n\n\t\tvar statics = {};\n\n\t\tvar methods = {\n\t\t\tset: set,\n\t\t\ttransform: transform,\n\t\t\ttransformOrigin: transformOrigin,\n\t\t};\n\n\t\tangular.extend(Style, statics);\n\t\tangular.extend(Style.prototype, methods);\n\n\t\treturn Style;\n\n\t\t// static methods\n\n\t\t// prototype methods\n\n\t\tfunction set(element) {\n\t\t\tvar styles = [];\n\t\t\tfor (var key in this) {\n\t\t\t\tif (key !== 'props') {\n\t\t\t\t\tstyles.push(key + ':' + this[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telement.style.cssText = styles.join(';') + ';';\n\t\t}\n\n\t\tfunction transform(transform) {\n\t\t\tthis[transformProperty] = transform;\n\t\t}\n\n\t\tfunction transformOrigin(x, y) {\n\t\t\tthis[transformProperty + '-origin-x'] = (Math.round(x * 1000) / 1000) + '%';\n\t\t\tthis[transformProperty + '-origin-y'] = (Math.round(y * 1000) / 1000) + '%';\n\t\t}\n\n    }]);\n\n\tfunction detectTransformProperty() {\n\t\tvar transformProperty = 'transform',\n\t\t\tsafariPropertyHack = 'webkitTransform';\n\t\tvar div = document.createElement(\"DIV\");\n\t\tif (typeof div.style[transformProperty] !== 'undefined') {\n            ['webkit', 'moz', 'o', 'ms'].every(function (prefix) {\n\t\t\t\tvar e = '-' + prefix + '-transform';\n\t\t\t\tif (typeof div.style[e] !== 'undefined') {\n\t\t\t\t\ttransformProperty = e;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t} else if (typeof div.style[safariPropertyHack] !== 'undefined') {\n\t\t\ttransformProperty = '-webkit-transform';\n\t\t} else {\n\t\t\ttransformProperty = undefined;\n\t\t}\n\t\treturn transformProperty;\n\t}\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.service('Utils', ['$compile', '$controller', 'Vector', function ($compile, $controller, Vector) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\tcompileController: compileController,\n\t\t\tformat: format,\n\t\t\tindexOf: indexOf,\n\t\t\treducer: reducer,\n\t\t\treducerAdder: reducerAdder,\n\t\t\treducerSetter: reducerSetter,\n\t\t\tremoveValue: removeValue,\n\t\t\treverseSortOn: reverseSortOn,\n\t\t\tthrottle: throttle,\n\t\t\ttoMd5: toMd5,\n\t\t\twhere: where,\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\tvar getNow = Date.now || function () {\n\t\t\treturn new Date().getTime();\n\t\t};\n\n\t\tfunction compileController(scope, element, html, data) {\n\t\t\t// console.log('Utils.compileController', element);\n\t\t\telement.html(html);\n\t\t\tvar link = $compile(element.contents());\n\t\t\tif (data.controller) {\n\t\t\t\tvar $scope = scope.$new();\n\t\t\t\tangular.extend($scope, data);\n\t\t\t\tvar controller = $controller(data.controller, {\n\t\t\t\t\t$scope: $scope\n\t\t\t\t});\n\t\t\t\tif (data.controllerAs) {\n\t\t\t\t\tscope[data.controllerAs] = controller;\n\t\t\t\t}\n\t\t\t\telement.data('$ngControllerController', controller);\n\t\t\t\telement.children().data('$ngControllerController', controller);\n\t\t\t\tscope = $scope;\n\t\t\t}\n\t\t\tlink(scope);\n\t\t}\n\n\t\tfunction format(string, prepend, expression) {\n\t\t\tstring = string || '';\n\t\t\tprepend = prepend || '';\n\t\t\tvar splitted = string.split(',');\n\t\t\tif (splitted.length > 1) {\n\t\t\t\tvar formatted = splitted.shift();\n\t\t\t\tangular.forEach(splitted, function (value, index) {\n\t\t\t\t\tif (expression) {\n\t\t\t\t\t\tformatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tformatted = formatted.split('{' + index + '}').join(prepend + value);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (expression) {\n\t\t\t\t\treturn '\\'' + formatted + '\\'';\n\t\t\t\t} else {\n\t\t\t\t\treturn formatted;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn prepend + string;\n\t\t\t}\n\t\t}\n\n\t\tfunction indexOf(array, object, key) {\n\t\t\tkey = key || 'id';\n\t\t\tvar index = -1;\n\t\t\tif (array) {\n\t\t\t\tvar i = 0,\n\t\t\t\t\tt = array.length;\n\t\t\t\twhile (i < t) {\n\t\t\t\t\tif (array[i] && array[i][key] === object[key]) {\n\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn index;\n\t\t}\n\n\t\tfunction reducer(o, key) {\n\t\t\treturn o[key];\n\t\t}\n\n\t\tfunction reducerAdder(o, key, value) {\n\t\t\tif (typeof key == 'string') {\n\t\t\t\treturn reducerAdder(o, key.split('.'), value);\n\t\t\t} else if (key.length == 1 && value !== undefined) {\n\t\t\t\treturn (o[key[0]] += value);\n\t\t\t} else if (key.length === 0) {\n\t\t\t\treturn o;\n\t\t\t} else {\n\t\t\t\treturn reducerAdder(o[key[0]], key.slice(1), value);\n\t\t\t}\n\t\t}\n\n\t\tfunction reducerSetter(o, key, value) {\n\t\t\tif (typeof key == 'string') {\n\t\t\t\treturn reducerSetter(o, key.split('.'), value);\n\t\t\t} else if (key.length == 1 && value !== undefined) {\n\t\t\t\treturn (o[key[0]] = value);\n\t\t\t} else if (key.length === 0) {\n\t\t\t\treturn o;\n\t\t\t} else {\n\t\t\t\treturn reducerSetter(o[key[0]], key.slice(1), value);\n\t\t\t}\n\t\t}\n\n\t\tfunction removeValue(array, value) {\n\t\t\tvar index = -1;\n\t\t\tif (array) {\n\t\t\t\tvar i = 0,\n\t\t\t\t\tt = array.length;\n\t\t\t\twhile (i < t) {\n\t\t\t\t\tif (array[i] === value) {\n\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (index !== -1) {\n\t\t\t\tarray.splice(index, 1);\n\t\t\t\treturn value;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\tfunction reverseSortOn(key) {\n\t\t\treturn function (a, b) {\n\t\t\t\tif (a[key] < b[key]) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\tif (a[key] > b[key]) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\t// a must be equal to b\n\t\t\t\treturn 0;\n\t\t\t};\n\t\t}\n\n\t\tfunction throttle(func, wait, options) {\n\t\t\t// Returns a function, that, when invoked, will only be triggered at most once\n\t\t\t// during a given window of time. Normally, the throttled function will run\n\t\t\t// as much as it can, without ever going more than once per `wait` duration;\n\t\t\t// but if you'd like to disable the execution on the leading edge, pass\n\t\t\t// `{leading: false}`. To disable execution on the trailing edge, ditto.\n\t\t\tvar context, args, result;\n\t\t\tvar timeout = null;\n\t\t\tvar previous = 0;\n\t\t\tif (!options) options = {};\n\t\t\tvar later = function () {\n\t\t\t\tprevious = options.leading === false ? 0 : getNow();\n\t\t\t\ttimeout = null;\n\t\t\t\tresult = func.apply(context, args);\n\t\t\t\tif (!timeout) context = args = null;\n\t\t\t};\n\t\t\treturn function () {\n\t\t\t\tvar now = getNow();\n\t\t\t\tif (!previous && options.leading === false) previous = now;\n\t\t\t\tvar remaining = wait - (now - previous);\n\t\t\t\tcontext = this;\n\t\t\t\targs = arguments;\n\t\t\t\tif (remaining <= 0 || remaining > wait) {\n\t\t\t\t\tif (timeout) {\n\t\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\t\ttimeout = null;\n\t\t\t\t\t}\n\t\t\t\t\tprevious = now;\n\t\t\t\t\tresult = func.apply(context, args);\n\t\t\t\t\tif (!timeout) context = args = null;\n\t\t\t\t} else if (!timeout && options.trailing !== false) {\n\t\t\t\t\ttimeout = setTimeout(later, remaining);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t};\n\t\t}\n\n\t\tfunction toMd5(string) {\n\t\t\t// return Md5.encode(string);\n\t\t}\n\n\t\tfunction where(array, query) {\n\t\t\tvar found = null;\n\t\t\tif (array) {\n\t\t\t\tangular.forEach(array, function (item) {\n\t\t\t\t\tvar has = true;\n\t\t\t\t\tangular.forEach(query, function (value, key) {\n\t\t\t\t\t\thas = has && item[key] === value;\n\t\t\t\t\t});\n\t\t\t\t\tif (has) {\n\t\t\t\t\t\tfound = item;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn found;\n\t\t}\n\n    }]);\n\n\t(function () {\n\t\t// POLYFILL Array.prototype.reduce\n\t\t// Production steps of ECMA-262, Edition 5, 15.4.4.21\n\t\t// Reference: http://es5.github.io/#x15.4.4.21\n\t\t// https://tc39.github.io/ecma262/#sec-array.prototype.reduce\n\t\tif (!Array.prototype.reduce) {\n\t\t\tObject.defineProperty(Array.prototype, 'reduce', {\n\t\t\t\tvalue: function (callback) { // , initialvalue\n\t\t\t\t\tif (this === null) {\n\t\t\t\t\t\tthrow new TypeError('Array.prototype.reduce called on null or undefined');\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof callback !== 'function') {\n\t\t\t\t\t\tthrow new TypeError(callback + ' is not a function');\n\t\t\t\t\t}\n\t\t\t\t\tvar o = Object(this);\n\t\t\t\t\tvar len = o.length >>> 0;\n\t\t\t\t\tvar k = 0;\n\t\t\t\t\tvar value;\n\t\t\t\t\tif (arguments.length == 2) {\n\t\t\t\t\t\tvalue = arguments[1];\n\t\t\t\t\t} else {\n\t\t\t\t\t\twhile (k < len && !(k in o)) {\n\t\t\t\t\t\t\tk++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (k >= len) {\n\t\t\t\t\t\t\tthrow new TypeError('Reduce of empty array with no initial value');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvalue = o[k++];\n\t\t\t\t\t}\n\t\t\t\t\twhile (k < len) {\n\t\t\t\t\t\tif (k in o) {\n\t\t\t\t\t\t\tvalue = callback(value, o[k], k, o);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tk++;\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}());\n\n}());\n/* global angular */\r\n\r\n(function () {\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.factory('Doc', ['Api', '$promise', function (Api, $promise) {\r\n\r\n\t\tfunction Doc(item) {\r\n\t\t\tif (item) {\r\n\t\t\t\tangular.extend(this, item);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar statics = {};\r\n\r\n\t\tvar methods = {};\r\n\r\n\t\tangular.extend(Doc, statics);\r\n\t\tangular.extend(Doc.prototype, methods);\r\n\r\n\t\treturn Doc;\r\n\r\n\t\t// static methods\r\n\r\n\t\t// prototype methods\r\n\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function () {\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.factory('View', ['Api', '$promise', '$location', '$routeParams', 'environment', 'Doc', function (Api, $promise, $location, $routeParams, environment, Doc) {\r\n\r\n\t\tfunction View(doc) {\r\n\t\t\tvar url = $location.path(),\r\n\t\t\t\tparams = $routeParams;\r\n\t\t\tvar view = {\r\n\t\t\t\tenvironment: environment,\r\n\t\t\t\troute: {\r\n\t\t\t\t\turl: url,\r\n\t\t\t\t\tparams: params,\r\n\t\t\t\t},\r\n\t\t\t\tdoc: doc,\r\n\t\t\t};\r\n\t\t\tangular.extend(this, view);\r\n\t\t}\r\n\r\n\t\tvar statics = {\r\n\t\t\tcurrent: ViewCurrent,\r\n\t\t};\r\n\r\n\t\tvar methods = {};\r\n\r\n\t\tangular.extend(View, statics);\r\n\t\tangular.extend(View.prototype, methods);\r\n\r\n\t\treturn View;\r\n\r\n\t\t// static methods\r\n\r\n\t\tfunction ViewCurrent() {\r\n\t\t\treturn $promise(function (promise) {\r\n\t\t\t\tvar url = $location.path();\r\n\t\t\t\tconsole.log('View.current', url);\r\n\t\t\t\tApi.docs.url(url).then(function (response) {\r\n\t\t\t\t\tvar doc = new Doc(response);\r\n\t\t\t\t\tvar view = new View(doc);\r\n\t\t\t\t\tpromise.resolve(view);\r\n\r\n\t\t\t\t}, function (error) {\r\n\t\t\t\t\tpromise.reject(error);\r\n\r\n\t\t\t\t});\r\n\t\t\t\t/*\r\n\t\t\t\tApi.navs.main().then(function(items) {\r\n\t\t\t\t    var doc = null,\r\n\t\t\t\t        url = $location.path(),\r\n\t\t\t\t        pool = getPool(items);\r\n\t\t\t\t    var item = pool[url];\r\n\t\t\t\t    if (item) {\r\n\t\t\t\t        doc = new Doc(item);\r\n\t\t\t\t    }\r\n\t\t\t\t    promise.resolve(doc);\r\n\r\n\t\t\t\t}, function(error) {\r\n\t\t\t\t    promise.reject(error);\r\n\r\n\t\t\t\t});\r\n\t\t\t\t*/\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfunction ViewPool(items) {\r\n\t\t\tvar pool = {};\r\n\r\n\t\t\tfunction _getPool(items) {\r\n\t\t\t\tif (items) {\r\n\t\t\t\t\tangular.forEach(items, function (item) {\r\n\t\t\t\t\t\tpool[item.url] = item;\r\n\t\t\t\t\t\t_getPool(item.items);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t_getPool(items);\r\n\t\t\treturn pool;\r\n\t\t}\r\n\r\n\t\t// prototype methods\r\n\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.service('Http', ['$http', '$promise', '$timeout', 'environment', function($http, $promise, $timeout, environment) {\r\n\r\n        var service = this;\r\n\r\n        var statics = {\r\n            get: HttpGet,\r\n            post: HttpPost,\r\n            put: HttpPut,\r\n            patch: HttpPatch,\r\n            'delete': HttpDelete,\r\n            fake: HttpFake,\r\n        };\r\n\r\n        angular.extend(service, statics);\r\n\r\n        // statics methods\r\n\r\n        function HttpUrl(url) {\r\n            return environment.paths.api + url;\r\n        }\r\n\r\n        function HttpPromise(method, url, data) {\r\n            return $promise(function(promise) {\r\n                $http[method](HttpUrl(url), data).then(function(response) {\r\n                    promise.resolve(response.data);\r\n\r\n                }, function(e, status) {\r\n                    var error = (e && e.data) ? e.data : {};\r\n                    error.status = e.status;\r\n                    promise.reject(error);\r\n\r\n                });\r\n            });\r\n        }\r\n\r\n        function HttpGet(url) {\r\n            return HttpPromise('get', url);\r\n        }\r\n\r\n        function HttpPost(url, data) {\r\n            return HttpPromise('post', url, data);\r\n        }\r\n\r\n        function HttpPut(url, data) {\r\n            return HttpPromise('put', url, data);\r\n        }\r\n\r\n        function HttpPatch(url, data) {\r\n            return HttpPromise('patch', url, data);\r\n        }\r\n\r\n        function HttpDelete(url) {\r\n            return HttpPromise('delete', url);\r\n        }\r\n\r\n        function HttpFake(data) {\r\n            var deferred = $q.defer();\r\n            $timeout(function() {\r\n                deferred.resolve({\r\n                    data: data\r\n                });\r\n            }, 1000);\r\n            return deferred.promise;\r\n        }\r\n\r\n    }]);\r\n\r\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.service('Router', ['$rootScope', '$location', '$timeout', function($rootScope, $location, $timeout) {\n\n        var service = this;\n\n        var statics = {\n            isController: RouterIsController,\n            redirect: RouterRedirect,\n            path: RouterPath,\n            apply: RouterApply,\n        };\n\n        angular.extend(service, statics);\n\n        $rootScope.$on('$routeChangeStart', RouterOnChangeStart);\n        $rootScope.$on('$routeChangeSuccess', RouterOnChangeSuccess);\n        $rootScope.$on('$routeChangeError', RouterOnChangeError);\n        $rootScope.$on('$routeUpdate', RouterOnUpdate);\n\n        var $previous, $current, $next;\n        var $previousController, $currentController, $nextController;\n\n        function RouterSetControllers() {\n            $previousController = $previous ? $previous.controller : null;\n            $currentController = $current ? $current.controller : null;\n            $nextController = $next ? $next.controller : null;\n        }\n\n        /*\n        $routeChangeStart\n        Broadcasted before a route change. At this point the route services starts resolving all of the dependencies needed for the route change to occur. Typically this involves fetching the view template as well as any dependencies defined in resolve route property. Once all of the dependencies are resolved $routeChangeSuccess is fired.\n        The route change (and the $location change that triggered it) can be prevented by calling preventDefault method of the event. See $rootScope.Scope for more details about event object.\n        */\n        function RouterOnChangeStart(event, next, current) {\n            $previous = null;\n            $current = current ? current.$$route : null;\n            $next = next ? next.$$route : null;\n            RouterSetControllers();\n            console.log('Router.RouterOnChangeStart', '$previous', $previous, '$current', $current, '$next', $next);\n        }\n\n        /*\n        $routeChangeSuccess\n        Broadcasted after a route change has happened successfully. The resolve dependencies are now available in the current.locals property.\n        */\n        function RouterOnChangeSuccess(event, current, previous) {\n            $previous = previous ? previous.$$route : null;\n            $current = current ? current.$$route : null;\n            $next = null;\n            RouterSetControllers();\n            console.log('Router.RouterOnChangeSuccess', '$previous', $previous, '$current', $current, '$next', $next);\n        }\n\n        /*\n        $routeChangeError\n        Broadcasted if a redirection function fails or any redirection or resolve promises are rejected.\n        */\n        function RouterOnChangeError(event, current, previous, rejection) {\n            $previous = null;\n            $current = previous.$$route || null;\n            $next = null;\n            RouterSetControllers();\n            console.log('Router.RouterOnChangeError', '$previous', $previous, '$current', $current, '$next', $next);\n        }\n\n        /*\n        $routeUpdate\n        The reloadOnSearch property has been set to false, and we are reusing the same instance of the Controller.\n        */\n        function RouterOnUpdate(event, current) {\n            $previous = current ? current.$$route : null;\n            $current = current ? current.$$route : null;\n            $next = null;\n            RouterSetControllers();\n            console.log('Router.RouterOnUpdate', '$previous', $previous, '$current', $current, '$next', $next);\n        }\n\n        function RouterIsController(controller) {\n            return $currentController === controller;\n        }\n\n        // navigation\n\n        function RouterRedirectTo(path) {\n            $location.$$lastRequestedPath = $location.path();\n            $location.path(path);\n        }\n\n        function RouterRetryLastRequestedPath(path) {\n            path = $location.$$lastRequestedPath || path;\n            $location.$$lastRequestedPath = null;\n            $location.path(path);\n        }\n\n        function RouterRedirect(path, msecs) {\n            if (msecs) {\n                $timeout(function() {\n                    RouterRedirectTo(path);\n                }, msecs);\n            } else {\n                RouterRedirectTo(path);\n            }\n        }\n\n        function RouterPath(path, msecs) {\n            if (msecs) {\n                $timeout(function() {\n                    RouterRetryLastRequestedPath(path);\n                }, msecs);\n            } else {\n                RouterRetryLastRequestedPath(path);\n            }\n        }\n\n        function RouterApply(path, msecs) {\n            if (msecs) {\n                $timeout(function() {\n                    $location.path(path);\n                }, msecs);\n            } else {\n                $timeout(function() {\n                    $location.path(path);\n                });\n            }\n        }\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.service('Silent', ['$rootScope', '$location', function ($rootScope, $location) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\tsilent: SilentSilent,\n\t\t\tpath: SilentPath,\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\t$rootScope.$$listeners.$locationChangeSuccess.unshift(SilentListener);\n\t\t// console.log('$rootScope.$$listeners.$locationChangeSuccess', $rootScope.$$listeners.$locationChangeSuccess);\n\n\t\t// private vars\n\n\t\tvar $path;\n\n\t\t// static methods\n\n\t\tfunction SilentGetDomain() {\n\t\t\tvar currentDomain = window.location.protocol + '//' + window.location.hostname + (window.location.port ? ':' + window.location.port : '');\n\t\t\treturn currentDomain;\n\t\t}\n\n\t\tfunction SilentUnlink() {\n\t\t\tvar listeners = $rootScope.$$listeners.$locationChangeSuccess;\n\t\t\tangular.forEach(listeners, function (value, name) {\n\t\t\t\tif (value === listener) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfunction relink() {\n\t\t\t\t\tlisteners[name] = value;\n\t\t\t\t}\n\t\t\t\tlisteners[name] = relink; // temporary unlinking\n\t\t\t});\n\t\t}\n\n\t\tfunction SilentListener(e) {\n\t\t\t// console.log('onLocationChangeSuccess', e);\n\t\t\tif ($path === $location.path()) {\n\t\t\t\tSilentUnlink();\n\t\t\t}\n\t\t\t$path = null;\n\t\t}\n\n\t\tfunction SilentSilent(path, replace) {\n\t\t\t// this.prev = $location.path(); ???\n\t\t\tvar location = $location.url(path);\n\t\t\tif (replace) {\n\t\t\t\tlocation.replace();\n\t\t\t}\n\t\t\t$path = $location.path();\n\t\t}\n\n\t\tfunction SilentPath(path) {\n\t\t\treturn $location.path(path);\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tvar TIMEOUT = 5 * 60 * 1000; // five minutes\n\n\tapp.service('Cookie', ['$promise', function ($promise) {\n\n\t\tvar service = {\n\t\t\tTIMEOUT: TIMEOUT,\n\t\t\tdelete: CookieDelete,\n\t\t\texist: CookieExists,\n\t\t\tget: CookieGet,\n\t\t\ton: CookieOn,\n\t\t\tset: CookieSet,\n\t\t};\n\n\t\tangular.extend(this, service);\n\n\t\tfunction CookieDelete(name) {\n\t\t\tCookieSetter(name, \"\", -1);\n\t\t}\n\n\t\tfunction CookieExists(name) {\n\t\t\treturn document.cookie.indexOf(';' + name + '=') !== -1 || document.cookie.indexOf(name + '=') === 0;\n\t\t}\n\n\t\tfunction CookieGet(name) {\n\t\t\tvar cookieName = name + \"=\";\n\t\t\tvar ca = document.cookie.split(';');\n\t\t\tfor (var i = 0; i < ca.length; i++) {\n\t\t\t\tvar c = ca[i];\n\t\t\t\twhile (c.charAt(0) == ' ') {\n\t\t\t\t\tc = c.substring(1, c.length);\n\t\t\t\t}\n\t\t\t\tif (c.indexOf(cookieName) === 0) {\n\t\t\t\t\tvar value = c.substring(cookieName.length, c.length);\n\t\t\t\t\tvar model = null;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tmodel = JSON.parse(decodeURIComponent(atob(value)));\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tconsole.log('Cookie.get.error parsing', key, e);\n\t\t\t\t\t}\n\t\t\t\t\treturn model;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tfunction CookieOn(name) {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tvar i, interval = 1000,\n\t\t\t\t\telapsed = 0,\n\t\t\t\t\ttimeout = Cookie.TIMEOUT;\n\n\t\t\t\tfunction checkCookie() {\n\t\t\t\t\tif (elapsed > timeout) {\n\t\t\t\t\t\tpromise.reject('timeout');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar c = CookieGet(name);\n\t\t\t\t\t\tif (c) {\n\t\t\t\t\t\t\tpromise.resolve(c);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\telapsed += interval;\n\t\t\t\t\t\t\ti = setTimeout(checkCookie, interval);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcheckCookie();\n\t\t\t});\n\t\t}\n\n\t\tfunction CookieSet(name, value, days) {\n\t\t\ttry {\n\t\t\t\tvar cache = [];\n\t\t\t\tvar json = JSON.stringify(value, function (key, value) {\n\t\t\t\t\tif (key === 'pool') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t\t// Circular reference found, discard key\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcache.push(value);\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t\tcache = null;\n\t\t\t\tCookieSetter(name, btoa(encodeURIComponent(json)), days);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('CookieSet.error serializing', name, value, e);\n\t\t\t}\n\t\t}\n\n\t\tfunction CookieSetter(name, value, days) {\n\t\t\tvar expires;\n\t\t\tif (days) {\n\t\t\t\tvar date = new Date();\n\t\t\t\tdate.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n\t\t\t\texpires = '; expires=' + date.toGMTString();\n\t\t\t} else {\n\t\t\t\texpires = '';\n\t\t\t}\n\t\t\tdocument.cookie = name + '=' + value + expires + '; path=/';\n\t\t}\n\n    }]);\n\n\tapp.service('LocalStorage', ['$promise', 'Cookie', function ($promise, Cookie) {\n\n\t\tvar service = {\n\t\t\tTIMEOUT: TIMEOUT,\n\t\t\tdelete: LocalDelete,\n\t\t\texist: LocalExists,\n\t\t\tget: LocalGet,\n\t\t\ton: LocalOn,\n\t\t\tset: LocalSet,\n\t\t};\n\n\t\tvar supported = LocalSupported();\n\n\t\tif (supported) {\n\t\t\tangular.extend(this, service);\n\t\t} else {\n\t\t\tangular.extend(this, Cookie);\n\t\t}\n\n\t\tthis.supported = supported;\n\n\t\tfunction LocalSupported() {\n\t\t\tvar supported = false;\n\t\t\ttry {\n\t\t\t\tsupported = 'localStorage' in window && window.localStorage !== null;\n\t\t\t\tif (supported) {\n\t\t\t\t\twindow.localStorage.setItem('test', '1');\n\t\t\t\t\twindow.localStorage.removeItem('test');\n\t\t\t\t} else {\n\t\t\t\t\tsupported = false;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tsupported = false;\n\t\t\t}\n\t\t\treturn supported;\n\t\t}\n\n\t\tfunction LocalExists(name) {\n\t\t\treturn window.localStorage[name] !== undefined;\n\t\t}\n\n\t\tfunction LocalGet(name) {\n\t\t\tvar value = null;\n\t\t\tif (window.localStorage[name] !== undefined) {\n\t\t\t\ttry {\n\t\t\t\t\tvalue = JSON.parse(window.localStorage[name]);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log('LocalStorage.get.error parsing', name, e);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn value;\n\t\t}\n\n\t\tfunction LocalSet(name, value) {\n\t\t\ttry {\n\t\t\t\tvar cache = [];\n\t\t\t\tvar json = JSON.stringify(value, function (key, value) {\n\t\t\t\t\tif (key === 'pool') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t\t// Circular reference found, discard key\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcache.push(value);\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t\tcache = null;\n\t\t\t\twindow.localStorage.setItem(name, json);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('LocalStorage.set.error serializing', name, value, e);\n\t\t\t}\n\t\t}\n\n\t\tfunction LocalDelete(name) {\n\t\t\twindow.localStorage.removeItem(name);\n\t\t}\n\n\t\tfunction LocalOn(name) {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tvar i, timeout = Cookie.TIMEOUT;\n\n\t\t\t\tfunction storageEvent(e) {\n\t\t\t\t\t// console.log('LocalStorage.on', name, e);\n\t\t\t\t\tif (i) {\n\t\t\t\t\t\tclearTimeout(i);\n\t\t\t\t\t}\n\t\t\t\t\tif (e.originalEvent.key == name) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvar value = JSON.parse(e.originalEvent.newValue); // , e.originalEvent.oldValue\n\t\t\t\t\t\t\tpromise.resolve(value);\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tconsole.log('LocalStorage.on.error parsing', name, error);\n\t\t\t\t\t\t\tpromise.reject('error parsing ' + name);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tangular.element(window).on('storage', storageEvent);\n\t\t\t\ti = setTimeout(function () {\n\t\t\t\t\tpromise.reject('timeout');\n\t\t\t\t}, timeout);\n\t\t\t});\n\t\t}\n\n    }]);\n\n\tapp.factory('SessionStorage', ['$promise', 'Cookie', function ($promise, Cookie) {\n\n\t\tvar service = {\n\t\t\tTIMEOUT: TIMEOUT,\n\t\t\tdelete: LocalDelete,\n\t\t\texist: LocalExists,\n\t\t\tget: LocalGet,\n\t\t\ton: LocalOn,\n\t\t\tset: LocalSet,\n\t\t};\n\n\t\tvar supported = SessionSupported();\n\n\t\tif (supported) {\n\t\t\tangular.extend(this, service);\n\t\t} else {\n\t\t\tangular.extend(this, Cookie);\n\t\t}\n\n\t\tthis.supported = supported;\n\n\t\tfunction SessionSupported() {\n\t\t\tvar supported = false;\n\t\t\ttry {\n\t\t\t\tsupported = 'sessionStorage' in window && window.sessionStorage !== undefined;\n\t\t\t\tif (supported) {\n\t\t\t\t\twindow.sessionStorage.setItem('test', '1');\n\t\t\t\t\twindow.sessionStorage.removeItem('test');\n\t\t\t\t} else {\n\t\t\t\t\tsupported = false;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tsupported = false;\n\t\t\t}\n\t\t\treturn supported;\n\t\t}\n\n\t\tfunction SessionExists(name) {\n\t\t\treturn window.sessionStorage[name] !== undefined;\n\t\t}\n\n\t\tfunction SessionGet(name) {\n\t\t\tvar value = null;\n\t\t\tif (window.sessionStorage[name] !== undefined) {\n\t\t\t\ttry {\n\t\t\t\t\tvalue = JSON.parse(window.sessionStorage[name]);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log('SessionStorage.get.error parsing', name, e);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn value;\n\t\t}\n\n\t\tfunction SessionSet(name, value) {\n\t\t\ttry {\n\t\t\t\tvar cache = [];\n\t\t\t\tvar json = JSON.stringify(value, function (key, value) {\n\t\t\t\t\tif (key === 'pool') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t\t// Circular reference found, discard key\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcache.push(value);\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t\tcache = null;\n\t\t\t\twindow.sessionStorage.setItem(name, json);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('SessionStorage.set.error serializing', name, value, e);\n\t\t\t}\n\t\t}\n\n\t\tfunction SessionDelete(name) {\n\t\t\twindow.sessionStorage.removeItem(name);\n\t\t}\n\n\t\tfunction SessionOn(name) {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tvar i, timeout = Cookie.TIMEOUT;\n\n\t\t\t\tfunction storageEvent(e) {\n\t\t\t\t\t// console.log('SessionStorage.on', name, e);\n\t\t\t\t\tif (i) {\n\t\t\t\t\t\tclearTimeout(i);\n\t\t\t\t\t}\n\t\t\t\t\tif (e.originalEvent.key === name) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvar value = JSON.parse(e.originalEvent.newValue); // , e.originalEvent.oldValue\n\t\t\t\t\t\t\tpromise.resolve(value);\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tconsole.log('SessionStorage.on.error parsing', name, error);\n\t\t\t\t\t\t\tpromise.reject('error parsing ' + name);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tangular.element(window).on('storage', storageEvent);\n\t\t\t\ti = setTimeout(function () {\n\t\t\t\t\tpromise.reject('timeout');\n\t\t\t\t}, timeout);\n\t\t\t});\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.service('Trust', ['$sce', function ($sce) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\thtml: TrustHtml,\n\t\t\tresource: TrustResource,\n\t\t\turl: TrustUrl,\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\t// private vars\n\n\t\tvar values = [],\n\t\t\ttrustedValues = [];\n\n\t\tfunction TrustGetValue(value) {\n\t\t\tvar index = values.indexOf(value);\n\t\t\tif (index !== -1) {\n\t\t\t\treturn trustedValues[index];\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\tfunction TrustSetValue(value, trustedValue) {\n\t\t\tvalues.push(value);\n\t\t\tvalues.push(trustedValue);\n\t\t}\n\n\t\tfunction TrustGetOrSet(value, callback) {\n\t\t\tvar trustedValue = TrustGetValue(value);\n\t\t\tif (!trustedValue) {\n\t\t\t\ttrustedValue = callback();\n\t\t\t\tTrustSetValue(value, trustedValue);\n\t\t\t}\n\t\t\treturn trustedValue;\n\t\t}\n\n\t\tfunction TrustHtml(value) {\n\t\t\treturn TrustGetOrSet(value, function () {\n\t\t\t\treturn $sce.trustAsHtml(value);\n\t\t\t});\n\t\t}\n\n\t\tfunction TrustResource(value) {\n\t\t\treturn TrustGetOrSet(value, function () {\n\t\t\t\treturn $sce.trustAsResourceUrl(value);\n\t\t\t});\n\t\t}\n\n\t\tfunction TrustUrl(value) {\n\t\t\treturn TrustGetOrSet(value, function () {\n\t\t\t\treturn 'url(\\'' + value + '\\')';\n\t\t\t});\n\t\t}\n\n    }]);\n\n}());\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Color', [function () {\n\t\tfunction Color(r, g, b, a) {\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tthis.r = (r || r === 0) ? r : 0;\n\t\t\t\tthis.g = (g || g === 0) ? g : 0;\n\t\t\t\tthis.b = (b || b === 0) ? b : 0;\n\t\t\t\tthis.a = (a || a === 0) ? a : 255;\n\t\t\t} else {\n\t\t\t\tvar uint = r || '0xffffff';\n\t\t\t\tuint = parseInt(uint);\n\t\t\t\tif (r.length > 8) {\n\t\t\t\t\tthis.r = uint >> 24 & 0xff;\n\t\t\t\t\tthis.g = uint >> 16 & 0xff;\n\t\t\t\t\tthis.b = uint >> 8 & 0xff;\n\t\t\t\t\tthis.a = uint >> 0 & 0xff;\n\t\t\t\t} else {\n\t\t\t\t\tthis.r = uint >> 16 & 0xff;\n\t\t\t\t\tthis.g = uint >> 8 & 0xff;\n\t\t\t\t\tthis.b = uint >> 0 & 0xff;\n\t\t\t\t\tthis.a = 255;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tColor.componentToHex = function (c) {\n\t\t\tvar hex = c.toString(16);\n\t\t\treturn hex.length == 1 ? '0' + hex : hex;\n\t\t};\n\t\tColor.luma = function (color) {\n\t\t\t// var luma = color.dot({ r: 54.213, g: 182.376, b: 18.411 });\n\t\t\tvar luma = color.dot({\n\t\t\t\tr: 95,\n\t\t\t\tg: 100,\n\t\t\t\tb: 60\n\t\t\t});\n\t\t\treturn luma;\n\t\t};\n\t\tColor.contrast = function (color) {\n\t\t\tvar luma = Color.luma(color);\n\t\t\tif (luma > 0.6) {\n\t\t\t\treturn new Color('0x000000');\n\t\t\t} else {\n\t\t\t\treturn new Color('0xffffff');\n\t\t\t}\n\t\t};\n\t\tColor.darker = function (color, pow, min) {\n\t\t\tmin = min || 0;\n\t\t\tvar r = Math.max(Math.floor(color.r * min), Math.floor(color.r - 255 * pow));\n\t\t\tvar g = Math.max(Math.floor(color.g * min), Math.floor(color.g - 255 * pow));\n\t\t\tvar b = Math.max(Math.floor(color.b * min), Math.floor(color.b - 255 * pow));\n\t\t\treturn new Color(r, g, b, color.a);\n\t\t};\n\t\tColor.lighter = function (color, pow, max) {\n\t\t\tmax = max || 1;\n\t\t\tvar r = Math.min(color.r + Math.floor((255 - color.r) * max), Math.floor(color.r + 255 * pow));\n\t\t\tvar g = Math.min(color.g + Math.floor((255 - color.g) * max), Math.floor(color.g + 255 * pow));\n\t\t\tvar b = Math.min(color.b + Math.floor((255 - color.b) * max), Math.floor(color.b + 255 * pow));\n\t\t\treturn new Color(r, g, b, color.a);\n\t\t};\n\t\t/*\n\t\tColor.rgbaToHex = function (rgba) {\n\t\t    rgba = rgba.match(/^rgba?[\\s+]?\\([\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?/i);\n\t\t    return (rgba && rgba.length === 4) ? \"#\" +\n\t\t        (\"0\" + parseInt(rgba[1], 10).toString(16)).slice(-2) +\n\t\t        (\"0\" + parseInt(rgba[2], 10).toString(16)).slice(-2) +\n\t\t        (\"0\" + parseInt(rgba[3], 10).toString(16)).slice(-2) : '';\n\t\t}\n\t\t*/\n\t\tColor.prototype = {\n\t\t\ttoUint: function () {\n\t\t\t\treturn (this.r << 24) + (this.g << 16) + (this.b << 8) + (this.a);\n\t\t\t},\n\t\t\ttoHex: function () {\n\t\t\t\treturn '#' + Color.componentToHex(this.r) + Color.componentToHex(this.g) + Color.componentToHex(this.b) + Color.componentToHex(this.a);\n\t\t\t},\n\t\t\ttoRgba: function () {\n\t\t\t\treturn 'rgba(' + this.r + ',' + this.g + ',' + this.b + ',' + (this.a / 255).toFixed(3) + ')';\n\t\t\t},\n\t\t\tdot: function (color) {\n\t\t\t\treturn ((this.r / 255) * (color.r / 255) + (this.g / 255) * (color.g / 255) + (this.b / 255) * (color.b / 255));\n\t\t\t},\n\t\t\talpha: function (pow, min, max) {\n\t\t\t\tmin = min || 0;\n\t\t\t\tmax = max || 1;\n\t\t\t\tthis.a = Math.floor((min + (pow * (max - min))) * 255);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tmakeSet: function () {\n\t\t\t\tthis.foreground = Color.contrast(this);\n\t\t\t\tthis.border = Color.darker(this, 0.3);\n\t\t\t\tthis.light = Color.lighter(this, 0.3);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t};\n\t\treturn Color;\n    }]);\n\n\tapp.factory('Shape', [function () {\n\t\tfunction Shape() {}\n\t\tShape.shapeCircle = function (p, cx, cy, r, sa, ea) {\n\t\t\tsa = sa || 0;\n\t\t\tea = ea || 2 * Math.PI;\n\t\t\tp.ctx.arc(cx, cy, r, sa, ea, false);\n\t\t};\n\t\tShape.shapeStar = function (p, cx, cy, or, ir, steps) {\n\t\t\tvar x, y;\n\t\t\tvar angle = Math.PI / 2 * 3;\n\t\t\tvar step = Math.PI / steps;\n\t\t\tvar ctx = p.ctx;\n\t\t\tctx.moveTo(cx, cy - or);\n\t\t\tfor (i = 0; i < steps; i++) {\n\t\t\t\tx = cx + Math.cos(angle) * or;\n\t\t\t\ty = cy + Math.sin(angle) * or;\n\t\t\t\tctx.lineTo(x, y);\n\t\t\t\tangle += step;\n\t\t\t\tx = cx + Math.cos(angle) * ir;\n\t\t\t\ty = cy + Math.sin(angle) * ir;\n\t\t\t\tctx.lineTo(x, y);\n\t\t\t\tangle += step;\n\t\t\t}\n\t\t\tctx.lineTo(cx, cy - or);\n\t\t};\n\t\tShape.shapeRoundRect = function (p, rect, r) {\n\t\t\tvar ctx = p.ctx,\n\t\t\t\tx = rect.x,\n\t\t\t\ty = rect.y,\n\t\t\t\tw = rect.w,\n\t\t\t\th = rect.h;\n\t\t\tif (typeof r === undefined) {\n\t\t\t\tr = 4;\n\t\t\t}\n\t\t\tif (typeof r === 'number') {\n\t\t\t\tr = {\n\t\t\t\t\ttl: r,\n\t\t\t\t\ttr: r,\n\t\t\t\t\tbr: r,\n\t\t\t\t\tbl: r\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tvar defaultRadius = {\n\t\t\t\t\ttl: 0,\n\t\t\t\t\ttr: 0,\n\t\t\t\t\tbr: 0,\n\t\t\t\t\tbl: 0\n\t\t\t\t};\n\t\t\t\tfor (var key in defaultRadius) {\n\t\t\t\t\tr[key] = r[key] || defaultRadius[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\tctx.moveTo(x + r.tl, y);\n\t\t\tctx.lineTo(x + w - r.tr, y);\n\t\t\tctx.quadraticCurveTo(x + w, y, x + w, y + r.tr);\n\t\t\tctx.lineTo(x + w, y + h - r.br);\n\t\t\tctx.quadraticCurveTo(x + w, y + h, x + w - r.br, y + h);\n\t\t\tctx.lineTo(x + r.bl, y + h);\n\t\t\tctx.quadraticCurveTo(x, y + h, x, y + h - r.bl);\n\t\t\tctx.lineTo(x, y + r.tl);\n\t\t\tctx.quadraticCurveTo(x, y, x + r.tl, y);\n\t\t};\n\t\tShape.circle = function () {\n\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\tvar ctx = params[0].ctx;\n\t\t\tctx.beginPath();\n\t\t\tShape.shapeCircle.apply(this, params);\n\t\t\tctx.closePath();\n\t\t};\n\t\tShape.star = function () {\n\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\tvar ctx = params[0].ctx;\n\t\t\tctx.beginPath();\n\t\t\tShape.shapeStar.apply(this, params);\n\t\t\tctx.closePath();\n\t\t};\n\t\tShape.roundRect = function () {\n\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\tvar ctx = params[0].ctx;\n\t\t\tctx.beginPath();\n\t\t\tShape.shapeRoundRect.apply(this, params);\n\t\t\tctx.closePath();\n\t\t};\n\t\treturn Shape;\n    }]);\n\n\tapp.constant('PainterColors', {\n\t\t/*\n\t\tblack: new Color('0x111111'),\n\t\twhite: new Color('0xffffff'),\n\t\tred: new Color('0xff0000'),\n\t\tgreen: new Color('0x00ff00'),\n\t\tblue: new Color('0x0000ff'),\n\t\tyellow: new Color('0xffff00'),\n\t\tcyan: new Color('0x00ffff'),\n\t\tpurple: new Color('0xff00ff'),\n\t\t*/\n\t\tblack: '0x14191e',\n\t\twhite: '0xffffff',\n\t\tblue: '0x0023FF',\n\t\tred: '0xF21500',\n\t\tlightBlue: '0x79ccf2',\n\t\tlightYellow: '0xfff79a',\n\t\tgreyLighter: '0xf8f8f8',\n\t\tgreyLight: '0xeeeeee',\n\t\tgreyMedium: '0xcccccc',\n\t\tgrey: '0x90939b',\n\t\tmap: '0x24292e',\n\t});\n\n\tapp.factory('Palette', ['$q', 'Painter', 'Rect', function ($q, Painter, Rect) {\n\t\tfunction Palette() {\n\t\t\tthis.painter = new Painter().setSize(0, 0);\n\t\t\tthis.buffer = new Painter().setSize(0, 0);\n\t\t\tthis.size = {\n\t\t\t\tw: 0,\n\t\t\t\th: 0\n\t\t\t};\n\t\t\tthis.pool = {};\n\t\t\tthis.rows = {};\n\t\t}\n\t\tPalette.prototype = {\n\t\t\tgetRect: function (w, h) {\n\t\t\t\tvar p = this.painter,\n\t\t\t\t\tsize = this.size,\n\t\t\t\t\trows = this.rows,\n\t\t\t\t\tr = new Rect(0, 0, w, h),\n\t\t\t\t\trow = rows[h] || {\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: size.h\n\t\t\t\t\t};\n\t\t\t\tsize.w = Math.max(size.w, row.x + w);\n\t\t\t\tsize.h = Math.max(size.h, row.y + h);\n\t\t\t\tif (!p.canvas.width && !p.canvas.height) {\n\t\t\t\t\tp.setSize(size.w, size.h);\n\t\t\t\t} else if (size.w > p.canvas.width || size.h > p.canvas.height) {\n\t\t\t\t\t// var img = new Image();\n\t\t\t\t\t// img.src = p.toDataURL();\n\t\t\t\t\t// document.body.appendChild(canvas);\n\t\t\t\t\t// console.log(p.canvas.width, p.canvas.height);\n\t\t\t\t\t// var data = p.ctx.getImageData(0, 0, p.canvas.width, p.canvas.height);\n\t\t\t\t\tvar canvas = p.canvas;\n\t\t\t\t\tp.setCanvas(document.createElement('canvas'));\n\t\t\t\t\tp.setSize(size.w, size.h);\n\t\t\t\t\tp.ctx.drawImage(canvas, 0, 0);\n\t\t\t\t\t// p.ctx.putImageData(data, 0, 0);\n\t\t\t\t\t// p.ctx.drawImage(img, 0, 0);\n\t\t\t\t\t// document.body.removeChild(canvas);\n\t\t\t\t}\n\t\t\t\tr.x = row.x;\n\t\t\t\tr.y = row.y;\n\t\t\t\trow.x += w;\n\t\t\t\trows[h] = row;\n\t\t\t\treturn r;\n\t\t\t},\n\t\t\tadd: function (key, path) {\n\t\t\t\tvar palette = this;\n\t\t\t\tif (angular.isString(path)) {\n\t\t\t\t\tvar deferred = $q.defer();\n\t\t\t\t\tvar img = new Image();\n\t\t\t\t\timg.onload = function () {\n\t\t\t\t\t\tpalette.addShape(key, img.width, img.height, function (p, rect) {\n\t\t\t\t\t\t\tp.ctx.drawImage(img, 0, 0);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdeferred.resolve(img);\n\t\t\t\t\t};\n\t\t\t\t\timg.onerror = function () {\n\t\t\t\t\t\tdeferred.reject('connot load ' + path);\n\t\t\t\t\t};\n\t\t\t\t\timg.src = path;\n\t\t\t\t\treturn deferred.promise;\n\t\t\t\t} else {\n\t\t\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\t\t\treturn palette.addShape.apply(palette, params);\n\t\t\t\t}\n\t\t\t},\n\t\t\taddShape: function (key, w, h, callback) {\n\t\t\t\tvar p = this.painter,\n\t\t\t\t\tr = this.getRect(w, h);\n\t\t\t\tp.ctx.save();\n\t\t\t\tp.ctx.rect(r.x, r.y, r.w, r.h);\n\t\t\t\t// p.ctx.stroke();\n\t\t\t\tp.ctx.clip();\n\t\t\t\tp.ctx.translate(r.x, r.y);\n\t\t\t\tcallback.call(p, p, r.clone().setPos(0, 0));\n\t\t\t\tp.ctx.restore();\n\t\t\t\tthis.pool[key] = r;\n\t\t\t\t// console.log('Painter.add', r);\n\t\t\t},\n\t\t\tdraw: function (target, key, x, y, pre) {\n\t\t\t\tvar r = this.pool[key];\n\t\t\t\tif (r) {\n\t\t\t\t\t// var ctx = target.ctx;\n\t\t\t\t\t// ctx.save();\n\t\t\t\t\ttarget.drawRect(this.painter.canvas, r, {\n\t\t\t\t\t\tx: x,\n\t\t\t\t\t\ty: y,\n\t\t\t\t\t\tw: r.w,\n\t\t\t\t\t\th: r.h\n\t\t\t\t\t}, pre);\n\t\t\t\t\t// target.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, x - r.w / 2, y - r.h / 2, r.w, r.h);\n\t\t\t\t\t// ctx.restore();\n\t\t\t\t}\n\t\t\t},\n\t\t\ttint: function (target, key, x, y, color, pre) {\n\t\t\t\tvar r = this.pool[key];\n\t\t\t\tif (r) {\n\t\t\t\t\tvar p = this.painter,\n\t\t\t\t\t\tb = this.buffer.setSize(r.w, r.h);\n\t\t\t\t\tb.save();\n\t\t\t\t\tb.setFill(color);\n\t\t\t\t\tb.fillRect();\n\t\t\t\t\tb.ctx.globalCompositeOperation = \"destination-atop\";\n\t\t\t\t\tb.ctx.drawImage(p.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n\t\t\t\t\tb.restore();\n\t\t\t\t\tconsole.log(x, y, b.canvas, target.canvas);\n\t\t\t\t\ttarget.draw(b.canvas, {\n\t\t\t\t\t\tx: x,\n\t\t\t\t\t\ty: y\n\t\t\t\t\t}, pre);\n\t\t\t\t}\n\t\t\t},\n\t\t\tpattern: function (target, key, x, y, w, h, color) {\n\t\t\t\tfunction drawPattern(pattern) {\n\t\t\t\t\tvar ctx = target.ctx;\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\t// draw\n\t\t\t\t\t// ctx.beginPath();\n\t\t\t\t\t// ctx.rect(-x, -y, w, h);\n\t\t\t\t\tctx.fillStyle = pattern;\n\t\t\t\t\tctx.fillRect(-x, -y, w, h);\n\t\t\t\t\tctx.translate(-x, -y);\n\t\t\t\t\t// ctx.fill();\n\t\t\t\t\tctx.restore();\n\t\t\t\t}\n\t\t\t\tvar r = this.pool[key];\n\t\t\t\tif (r) {\n\t\t\t\t\tvar img = r.img,\n\t\t\t\t\t\tpattern;\n\t\t\t\t\tif (!img || r.color != color) {\n\t\t\t\t\t\tvar b = this.buffer.setSize(r.w, r.h);\n\t\t\t\t\t\tif (color) {\n\t\t\t\t\t\t\tr.color = color;\n\t\t\t\t\t\t\tb.save();\n\t\t\t\t\t\t\tb.setFill(color);\n\t\t\t\t\t\t\tb.fillRect();\n\t\t\t\t\t\t\tb.ctx.globalCompositeOperation = \"destination-atop\";\n\t\t\t\t\t\t\tb.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n\t\t\t\t\t\t\tb.restore();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tb.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n\t\t\t\t\t\t}\n\t\t\t\t\t\timg = new Image();\n\t\t\t\t\t\timg.onload = function () {\n\t\t\t\t\t\t\tr.img = img;\n\t\t\t\t\t\t\tpattern = target.ctx.createPattern(img, \"repeat\");\n\t\t\t\t\t\t\tdrawPattern(pattern);\n\t\t\t\t\t\t};\n\t\t\t\t\t\timg.src = b.toDataURL();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpattern = target.ctx.createPattern(img, \"repeat\");\n\t\t\t\t\t\tdrawPattern(pattern);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t\treturn Palette;\n    }]);\n\n\tapp.factory('Painter', ['Shape', 'Rect', 'Color', 'PainterColors', function (Shape, Rect, Color, PainterColors) {\n\t\tfunction Painter(canvas) {\n\t\t\tcanvas = canvas || document.createElement('canvas');\n\t\t\tthis.rect = new Rect();\n\t\t\tthis.drawingRect = new Rect();\n\t\t\tthis.setColors();\n\t\t\tthis.setCanvas(canvas);\n\t\t}\n\t\tPainter.colors = {};\n\t\tangular.forEach(PainterColors, function (value, key) {\n\t\t\tPainter.colors[key] = new Color(value).makeSet();\n\t\t});\n\t\tvar colors = Painter.colors;\n\t\tPainter.prototype = {\n\t\t\tcolors: Painter.colors,\n\t\t\tsetColors: function () {\n\t\t\t\tvar colors = this.colors;\n\t\t\t\tangular.forEach(PainterColors, function (value, key) {\n\t\t\t\t\tcolors[key] = new Color(value).makeSet();\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCanvas: function (canvas) {\n\t\t\t\tthis.canvas = canvas;\n\t\t\t\tthis.setSize(canvas.offsetWidth, canvas.offsetHeight);\n\t\t\t\tvar ctx = canvas.getContext('2d');\n\t\t\t\tctx.lineCap = 'square';\n\t\t\t\tthis.ctx = ctx;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetSize: function (w, h) {\n\t\t\t\tthis.canvas.width = w;\n\t\t\t\tthis.canvas.height = h;\n\t\t\t\tthis.rect.w = w;\n\t\t\t\tthis.rect.h = h;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tcopy: function (canvas) {\n\t\t\t\tthis.ctx.drawImage(canvas, 0, 0);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tclear: function () {\n\t\t\t\tthis.resize();\n\t\t\t\t// this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tresize: function () {\n\t\t\t\tthis.setSize(this.canvas.offsetWidth, this.canvas.offsetHeight);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetText: function (font, align, verticalAlign, color) {\n\t\t\t\tfont = font || '11px monospace';\n\t\t\t\talign = align || 'center';\n\t\t\t\tverticalAlign = verticalAlign || 'middle';\n\t\t\t\tcolor = color || this.colors.black;\n\t\t\t\tvar ctx = this.ctx;\n\t\t\t\tctx.font = font;\n\t\t\t\tctx.textAlign = align;\n\t\t\t\tctx.textBaseline = verticalAlign;\n\t\t\t\tctx.fillStyle = color.toRgba();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetFill: function (color) {\n\t\t\t\tcolor = color || this.colors.black;\n\t\t\t\tvar ctx = this.ctx;\n\t\t\t\t/*\n\t\t\t\tvar my_gradient = ctx.createLinearGradient(0, 0, 0, 170);\n\t\t\t\tmy_gradient.addColorStop(0, \"black\");\n\t\t\t\tmy_gradient.addColorStop(1, \"white\");\n\t\t\t\tctx.fillStyle = my_gradient;\n\t\t\t\t*/\n\t\t\t\tctx.fillStyle = color.toRgba();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetStroke: function (color, size) {\n\t\t\t\tcolor = color || this.colors.black;\n\t\t\t\tvar ctx = this.ctx;\n\t\t\t\tsize = size || 1;\n\t\t\t\t/*\n\t\t\t\tvar gradient=ctx.createLinearGradient(0,0,170,0);\n\t\t\t\tgradient.addColorStop(\"0\",\"magenta\");\n\t\t\t\tgradient.addColorStop(\"0.5\",\"blue\");\n\t\t\t\tgradient.addColorStop(\"1.0\",\"red\");\n\t\t\t\tctx.strokeStyle = gradient;\n\t\t\t\t*/\n\t\t\t\t// Fill with gradient\n\t\t\t\tctx.strokeStyle = color.toRgba();\n\t\t\t\tctx.lineWidth = size;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t/*\n\t\t\tdrawRoundRect: function (rect, r) {\n\t\t\t    rect = rect || this.rect;\n\t\t\t    Shape.roundRect(this, rect, r);\n\t\t\t    return this;\n\t\t\t},\n\t\t\t*/\n\t\t\tfillText: function (text, point, width, post, maxLength) {\n\t\t\t\tif (width) {\n\t\t\t\t\tpost = post || '';\n\t\t\t\t\tmaxLength = maxLength || Math.floor(width / 8);\n\t\t\t\t\tif (text.length > maxLength) {\n\t\t\t\t\t\ttext = text.substr(0, Math.min(text.length, maxLength)).trim() + post;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.ctx.fillText(text, point.x, point.y);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tfillRect: function (rect) {\n\t\t\t\trect = rect || this.rect;\n\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\tx = rect.x,\n\t\t\t\t\ty = rect.y,\n\t\t\t\t\tw = rect.w,\n\t\t\t\t\th = rect.h;\n\t\t\t\tctx.fillRect(x, y, w, h);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tstrokeRect: function (rect) {\n\t\t\t\trect = rect || this.rect;\n\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\tx = rect.x,\n\t\t\t\t\ty = rect.y,\n\t\t\t\t\tw = rect.w,\n\t\t\t\t\th = rect.h;\n\t\t\t\tctx.strokeRect(x, y, w, h);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tfill: function () {\n\t\t\t\tthis.ctx.fill();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tstroke: function () {\n\t\t\t\tthis.ctx.stroke();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tbegin: function () {\n\t\t\t\tthis.ctx.beginPath();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tclose: function () {\n\t\t\t\tthis.ctx.closePath();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsave: function () {\n\t\t\t\tthis.ctx.save();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\trestore: function () {\n\t\t\t\tthis.ctx.restore();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\trotate: function (angle) {\n\t\t\t\tthis.ctx.rotate(angle * Math.PI / 180);\n\t\t\t},\n\t\t\ttranslate: function (xy) {\n\t\t\t\tthis.ctx.translate(xy.x, xy.y);\n\t\t\t},\n\t\t\ttoDataURL: function () {\n\t\t\t\treturn this.canvas.toDataURL();\n\t\t\t},\n\t\t\tdraw: function (image, t, pre) {\n\t\t\t\tif (image) {\n\t\t\t\t\tt.w = t.w || image.width;\n\t\t\t\t\tt.h = t.h || image.height;\n\t\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\t\trect = this.drawingRect,\n\t\t\t\t\t\tx = rect.x = t.x - t.w / 2,\n\t\t\t\t\t\ty = rect.y = t.y - t.h / 2,\n\t\t\t\t\t\tw = rect.w = t.w,\n\t\t\t\t\t\th = rect.h = t.h;\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\tif (pre) {\n\t\t\t\t\t\tpre.call(this);\n\t\t\t\t\t}\n\t\t\t\t\tctx.drawImage(image, 0, 0);\n\t\t\t\t\tctx.restore();\n\t\t\t\t\t// console.log('painter.draw', x, y, w, h);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tdrawRect: function (image, s, t, pre) {\n\t\t\t\tif (image) {\n\t\t\t\t\ts.w = s.w || image.width;\n\t\t\t\t\ts.h = s.h || image.height;\n\t\t\t\t\tt.w = t.w || image.width;\n\t\t\t\t\tt.h = t.h || image.height;\n\t\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\t\trect = this.drawingRect,\n\t\t\t\t\t\tx = rect.x = t.x - s.w / 2,\n\t\t\t\t\t\ty = rect.y = t.y - s.h / 2,\n\t\t\t\t\t\tw = rect.w = t.w,\n\t\t\t\t\t\th = rect.h = t.h;\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\tif (pre) {\n\t\t\t\t\t\tpre.call(this);\n\t\t\t\t\t}\n\t\t\t\t\tctx.drawImage(image, s.x, s.y, s.w, s.h, 0, 0, t.w, t.h);\n\t\t\t\t\tctx.restore();\n\t\t\t\t\t// console.log('painter.drawRect', x, y, w, h);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tflip: function (scale) {\n\t\t\t\tscale = scale || {\n\t\t\t\t\tx: 1,\n\t\t\t\t\ty: -1\n\t\t\t\t};\n\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\trect = this.drawingRect;\n\t\t\t\tctx.translate(scale.x === -1 ? rect.w : 0, scale.y === -1 ? rect.h : 0);\n\t\t\t\tctx.scale(scale.x, scale.y);\n\t\t\t},\n\t\t};\n\t\treturn Painter;\n    }]);\n\n}());\n\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.directive('controlMessages', [function() {\n        return {\n            restrict: 'E',\n            templateUrl: 'artisan/forms/messages',\n            transclude: {\n                'message': '?messageItems',\n            },\n            link: function(scope, element, attributes, model) {}\n        };\n    }]);\n\n    app.directive('control', ['$parse', function($parse) {\n        function formatLabel(string, prepend, expression) {\n            string = string || '';\n            prepend = prepend || '';\n            var splitted = string.split(',');\n            if (splitted.length > 1) {\n                var formatted = splitted.shift();\n                angular.forEach(splitted, function(value, index) {\n                    if (expression) {\n                        formatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n                    } else {\n                        formatted = formatted.split('{' + index + '}').join(prepend + value);\n                    }\n                });\n                if (expression) {\n                    return '\\'' + formatted + '\\'';\n                } else {\n                    return formatted;\n                }\n            } else {\n                return prepend + string;\n            }\n        }\n        var uniqueId = 0;\n        return {\n            restrict: 'A',\n            templateUrl: function(element, attributes) {\n                var template = 'artisan/forms/text';\n                switch (attributes.control) {\n                    case 'select':\n                        template = 'artisan/forms/select';\n                        break;\n                }\n                return template;\n            },\n            scope: {\n                ngModel: '=',\n                required: '=',\n                form: '@',\n                title: '@',\n                placeholder: '@',\n                source: '=?',\n                key: '@?',\n                label: '@?',\n            },\n            require: 'ngModel',\n            transclude: true,\n            link: {\n                pre: function preLink(scope, element, attributes, controller, transclude) {\n                    var label = scope.label = (scope.label ? scope.label : 'name');\n                    var key = scope.key = (scope.key ? scope.key : 'id');\n                    if (attributes.control === 'select') {\n                        var filter = (attributes.filter ? '| ' + attributes.filter : '');\n                        var optionLabel = formatLabel(label, 'item.', true);\n                        scope.getOptions = function() {\n                            return attributes.number ?\n                                'item.' + key + ' as ' + optionLabel + ' disable when item.disabled for item in source ' + filter :\n                                optionLabel + ' disable when item.disabled for item in source ' + filter + ' track by item.' + key;\n                        };\n                    }\n                    var type = scope.type = attributes.control;\n                    var form = scope.form = scope.form || 'form';\n                    var title = scope.title = scope.title || 'untitled';\n                    var placeholder = scope.placeholder = scope.placeholder || title;\n                    var field = scope.field = title.replace(/[^0-9a-zA-Z]/g, \"\").split(' ').join('') + (++uniqueId);\n                    scope.format = attributes.format || null;\n                    scope.precision = attributes.precision || null;\n                    scope.validate = attributes.validate || attributes.control;\n                    scope.minLength = attributes.minLength || 0;\n                    scope.maxLength = attributes.maxLength || Number.POSITIVE_INFINITY;\n                    scope.min = attributes.min || null;\n                    scope.max = attributes.max || null;\n                    scope.options = $parse(attributes.options)(scope) || {};\n                    scope.focus = false;\n                    scope.visible = false;\n                    scope.onChange = function(model) {\n                        $parse(attributes.onChange)(scope.$parent);\n                    };\n                    scope.onFilter = function(model) {\n                        $parse(attributes.onFilter)(scope.$parent);\n                    };\n                    scope.getType = function() {\n                        var type = 'text';\n                        switch (attributes.control) {\n                            case 'password':\n                                type = scope.visible ? 'text' : 'password';\n                                break;\n                            default:\n                                type = attributes.control;\n                        }\n                        return type;\n                    };\n                    scope.getClasses = function() {\n                        var form = $parse(scope.form)(scope.$parent);\n                        var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                        return {\n                            'control-focus': scope.focus,\n                            'control-success': field.$valid,\n                            'control-error': field.$invalid && (form.$submitted || field.$touched),\n                            'control-empty': !field.$viewValue\n                        };\n                    };\n                    scope.getMessages = function() {\n                        var form = $parse(scope.form)(scope.$parent);\n                        var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                        return (form.$submitted || field.$touched) && field.$error;\n                    };\n                    scope.toggleVisibility = function() {\n                        scope.visible = !scope.visible;\n                    };\n                },\n            },\n        };\n    }]);\n\n    app.directive('_control', ['$http', '$templateCache', '$compile', '$parse', function($http, $templateCache, $compile, $parse) {\n        function formatLabel(string, prepend, expression) {\n            string = string || '';\n            prepend = prepend || '';\n            var splitted = string.split(',');\n            if (splitted.length > 1) {\n                var formatted = splitted.shift();\n                angular.forEach(splitted, function(value, index) {\n                    if (expression) {\n                        formatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n                    } else {\n                        formatted = formatted.split('{' + index + '}').join(prepend + value);\n                    }\n                });\n                if (expression) {\n                    return '\\'' + formatted + '\\'';\n                } else {\n                    return formatted;\n                }\n            } else {\n                return prepend + string;\n            }\n        }\n        var uniqueId = 0;\n        return {\n            restrict: 'A',\n            templateUrl: function(element, attributes) {\n                var template = 'artisan/forms/text';\n                switch (attributes.control) {\n                    case 'select':\n                        template = 'artisan/forms/select';\n                        break;\n                }\n                return template;\n            },\n            scope: {\n                ngModel: '=',\n                required: '=',\n                form: '@',\n                title: '@',\n                placeholder: '@',\n            },\n            require: 'ngModel',\n            /*\n            link: function(scope, element, attributes, model) {\n            },\n            */\n            compile: function(element, attributes) {\n                    return {\n                        pre: function(scope, element, attributes) {\n                            if (attributes.control === 'select') {\n                                var label = (attributes.label ? attributes.label : 'name');\n                                var key = (attributes.key ? attributes.key : 'id');\n                                var filter = (attributes.min ? ' | filter:gte(\\'' + key + '\\', ' + attributes.min + ')' : '');\n                                var optionLabel = formatLabel(label, 'item.', true);\n                                scope.options = attributes.number ?\n                                    'item.' + key + ' as ' + optionLabel + ' disable when item.disabled for item in ' + attributes.source + filter :\n                                    optionLabel + ' disable when item.disabled for item in ' + attributes.source + filter + ' track by item.' + key;\n                                console.log('control.compile.pre', scope.options);\n                            }\n                            var type = scope.type = attributes.control;\n                            var form = scope.form = scope.form || 'form';\n                            var title = scope.title = scope.title || 'untitled';\n                            var placeholder = scope.placeholder = scope.placeholder || title;\n                            var field = scope.field = title.replace(/[^0-9a-zA-Z]/g, \"\").split(' ').join('') + (++uniqueId);\n                            scope.validate = attributes.validate || attributes.control;\n                            scope.format = attributes.format || null;\n                            scope.precision = attributes.precision || null;\n                            scope.validate = attributes.validate || attributes.control;\n                            scope.minLength = attributes.min || 0;\n                            scope.maxLength = attributes.max || Number.POSITIVE_INFINITY;\n                            scope.options = $parse(attributes.options)(scope) || {};\n                            scope.focus = false;\n                            scope.visible = false;\n                            scope.getType = function() {\n                                var type = 'text';\n                                switch (attributes.control) {\n                                    case 'password':\n                                        // var form = $parse(scope.form)(scope.$parent);\n                                        // var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                        type = scope.visible ? 'text' : 'password';\n                                        break;\n                                    default:\n                                        type = attributes.control;\n                                }\n                                // console.log('control.getType', type);\n                                return type;\n                            };\n                            scope.getClasses = function() {\n                                var form = $parse(scope.form)(scope.$parent);\n                                var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                return {\n                                    'control-focus': scope.focus,\n                                    'control-success': field.$valid,\n                                    'control-error': field.$invalid && (form.$submitted || field.$touched),\n                                    'control-empty': !field.$viewValue\n                                };\n                            };\n                            scope.getMessages = function() {\n                                var form = $parse(scope.form)(scope.$parent);\n                                var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                return (form.$submitted || field.$touched) && field.$error;\n                            };\n                        },\n                        // post: function (scope, element, attributes) { }\n                    };\n                }\n                /*\n                compile: function(element, attributes) {\n                    element.removeAttr('my-dir'); \n                    element.attr('ng-hide', 'true');\n                    return function(scope) {\n                        $compile(element)(scope);\n                    };\n                },\n                */\n        };\n    }]);\n\n    app.directive('numberPicker', ['$parse', '$timeout', function($parse, $timeout) {\n        return {\n            restrict: 'A',\n            template: '<div class=\"input-group\">' +\n                '   <span class=\"input-group-btn\"><button class=\"btn btn-outline-primary\" type=\"button\">-</button></span>' +\n                '   <div ng-transclude></div>' +\n                '   <span class=\"input-group-btn\"><button class=\"btn btn-outline-primary\" type=\"button\">+</button></span>' +\n                '</div>',\n            replace: true,\n            transclude: true,\n            link: function(scope, element, attributes, model) {\n                var node = element[0];\n                var nodeRemove = node.querySelectorAll('.input-group-btn > .btn')[0];\n                var nodeAdd = node.querySelectorAll('.input-group-btn > .btn')[1];\n\n                function onRemove(e) {\n                    var min = $parse(attributes.min)(scope);\n                    var getter = $parse(attributes.numberPicker);\n                    var setter = getter.assign;\n                    $timeout(function() {\n                        setter(scope, Math.max(min, getter(scope) - 1));\n                    });\n                    // console.log('numberPicker.onRemove', min);\n                }\n\n                function onAdd(e) {\n                    var max = $parse(attributes.max)(scope);\n                    var getter = $parse(attributes.numberPicker);\n                    var setter = getter.assign;\n                    $timeout(function() {\n                        setter(scope, Math.min(max, getter(scope) + 1));\n                    });\n                    // console.log('numberPicker.onAdd', max);\n                }\n\n                function addListeners() {\n                    angular.element(nodeRemove).on('touchstart mousedown', onRemove);\n                    angular.element(nodeAdd).on('touchstart mousedown', onAdd);\n                }\n\n                function removeListeners() {\n                    angular.element(nodeRemove).off('touchstart mousedown', onRemove);\n                    angular.element(nodeAdd).off('touchstart mousedown', onAdd);\n                }\n                scope.$on('$destroy', function() {\n                    removeListeners();\n                });\n                addListeners();\n            }\n        };\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.directive('validate', ['$filter', function($filter) {\n        return {\n            require: 'ngModel',\n            link: function(scope, element, attributes, model) {\n                var type = attributes.validate;\n                var format = attributes.format || '';\n                var precision = attributes.precision || 2;\n                var focus = false;\n                // console.log('validate', type);\n                switch (type) {\n                    case 'date':\n                    case 'datetime':\n                    case 'datetime-local':\n                        model.$formatters.push(function(value) {\n                            if (value) {\n                                return $filter('date')(value, format);\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                    case 'number':\n                        model.$parsers.unshift(function(value) {\n                            var valid = false;\n                            if (value !== undefined && value !== \"\") {\n                                valid = String(value).indexOf(Number(value).toString()) !== -1; // isFinite(value); // \n                                value = Number(value);\n                                model.$setValidity('number', valid);\n                                if (valid) {\n                                    model.$setValidity('positive', value >= 0.01);\n                                    if (attributes.min !== undefined) {\n                                        model.$setValidity('range', value >= Number(attributes.min));\n                                    }\n                                    if (attributes.max !== undefined) {\n                                        model.$setValidity('range', value <= Number(attributes.max));\n                                    }\n                                }\n                            } else {\n                                valid = true;\n                                value = Number(value);\n                                model.$setValidity('number', true);\n                                model.$setValidity('positive', true);\n                                if (attributes.min !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                                if (attributes.max !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                            }\n                            return value;\n                        });\n                        model.$formatters.push(function(value) {\n                            if (value) {\n                                return $filter('number')(value, precision) + ' ' + format;\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                    case 'anynumber':\n                        model.$parsers.unshift(function(value) {\n                            var valid = false;\n                            if (value !== undefined && value !== \"\") {\n                                valid = String(value).indexOf(Number(value).toString()) !== -1; // isFinite(value); // \n                                value = Number(value);\n                                model.$setValidity('number', valid);\n                                if (valid) {\n                                    if (attributes.min !== undefined) {\n                                        model.$setValidity('range', value >= Number(attributes.min));\n                                    }\n                                    if (attributes.max !== undefined) {\n                                        model.$setValidity('range', value <= Number(attributes.max));\n                                    }\n                                }\n                            } else {\n                                valid = true;\n                                value = Number(value);\n                                model.$setValidity('number', true);\n                                if (attributes.min !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                                if (attributes.max !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                            }\n                            return value;\n                        });\n                        model.$formatters.push(function(value) {\n                            if (value || value === 0) {\n                                return $filter('number')(value, precision) + ' ' + format;\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                }\n\n                function onFocus() {\n                    focus = true;\n                    if (format) {\n                        element[0].value = model.$modelValue || null;\n                        if (!model.$modelValue) {\n                            model.$setViewValue(null);\n                        }\n                    }\n                }\n\n                function doBlur() {\n                    if (format && !model.$invalid) {\n                        switch (type) {\n                            case 'date':\n                            case 'datetime':\n                            case 'datetime-local':\n                                element[0].value = model.$modelValue ? $filter('date')(model.$modelValue, format) : ' ';\n                                break;\n                            default:\n                                element[0].value = model.$modelValue ? $filter('number')(model.$modelValue, precision) + ' ' + format : ' ';\n                                break;\n                        }\n                    }\n                }\n\n                function onBlur() {\n                    focus = false;\n                    doBlur();\n                }\n\n                function addListeners() {\n                    element.on('focus', onFocus);\n                    element.on('blur', onBlur);\n                }\n\n                function removeListeners() {\n                    element.off('focus', onFocus);\n                    element.off('blur', onBlur);\n                }\n                scope.$on('$destroy', function() {\n                    removeListeners();\n                });\n                addListeners();\n            }\n        };\n    }]);\n\n}());\n/* global angular */\r\n\r\n(function () {\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.directive('modalView', ['$parse', '$templateRequest', '$compile', '$controller', 'Dom', function ($parse, $templateRequest, $compile, $controller, Dom) {\r\n\r\n\t\tfunction compileController(scope, element, html, data) {\r\n\t\t\t// console.log('modalView.compileController', element);\r\n\t\t\telement.html(html);\r\n\t\t\tvar link = $compile(element.contents());\r\n\t\t\tif (data.controller) {\r\n\t\t\t\tvar $scope = scope.$new();\r\n\t\t\t\tangular.extend($scope, data);\r\n\t\t\t\tvar controller = $controller(data.controller, {\r\n\t\t\t\t\t$scope: $scope\r\n\t\t\t\t});\r\n\t\t\t\tif (data.controllerAs) {\r\n\t\t\t\t\tscope[data.controllerAs] = controller;\r\n\t\t\t\t}\r\n\t\t\t\telement.data('$ngControllerController', controller);\r\n\t\t\t\telement.children().data('$ngControllerController', controller);\r\n\t\t\t\tscope = $scope;\r\n\t\t\t}\r\n\t\t\tlink(scope);\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\trestrict: 'A',\r\n\t\t\tpriority: -400,\r\n\t\t\tlink: function (scope, element, attributes, model) {\r\n\t\t\t\tvar modal = $parse(attributes.modalView);\r\n\t\t\t\tmodal = modal(scope);\r\n\t\t\t\tmodal.templateUrl = modal.templateUrl || 'artisan/modals/modal';\r\n\t\t\t\t$templateRequest(modal.templateUrl).then(function (html) {\r\n\t\t\t\t\tcompileController(scope, element, html, modal);\r\n\t\t\t\t});\r\n\t\t\t\t/*\r\n\t\t\t\t// window.scrollTo(0, element[0].offsetTop - 100);\r\n\t\t\t\tfunction onClick(e) {\r\n\t\t\t\t    var closest = Dom.getClosestNode(e.target, element[0]);\r\n\t\t\t\t    if (closest === null) {\r\n\t\t\t\t        modal.reject(null);\r\n\t\t\t\t    }\r\n\t\t\t\t    // console.log('onClick', closest);\r\n\t\t\t\t}\r\n\t\t\t\tfunction addListeners() {\r\n\t\t\t\t    angular.element(window).on('click', onClick);\r\n\t\t\t\t}\r\n\t\t\t\tfunction removeListeners() {\r\n\t\t\t\t    angular.element(window).off('click', onClick);\r\n\t\t\t\t}\r\n\t\t\t\tscope.$on('destroy', function () {\r\n\t\t\t\t    removeListeners();\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    addListeners();\r\n\t\t\t\t}, 500);\r\n\t\t\t\t*/\r\n\t\t\t}\r\n\t\t};\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.provider('$modal', [function $modalProvider() {\r\n\r\n        var modals = [];\r\n        var routes = {};\r\n\r\n        this.modals = modals;\r\n        this.routes = routes;\r\n        this.when = when;\r\n\r\n        function when(path, modal) {\r\n            routes[path] = modal;\r\n            return this;\r\n        }\r\n\r\n        this.$get = ['$q', '$timeout', function modalFactory($q, $timeout) {\r\n\r\n            function popModal(modal) {\r\n                // console.log('modalProvider.popModal', modal);                \r\n                var index = -1;\r\n                angular.forEach(modals, function(m, i) {\r\n                    if (m === modal) {\r\n                        index = i;\r\n                    }\r\n                });\r\n                if (index !== -1) {\r\n                    $timeout(function() {\r\n                        modal.active = false;\r\n                        modals.splice(index, 1);\r\n                        if (modals.length) {\r\n                            modals[modals.length - 1].active = true;\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n\r\n            function closeModal(modal) {\r\n                // console.log('modalProvider.closeModal', modal);                \r\n                var index = -1;\r\n                angular.forEach(modals, function(m, i) {\r\n                    if (m === modal) {\r\n                        index = i;\r\n                    }\r\n                });\r\n                if (index !== -1) {\r\n                    modal.active = false;\r\n                    $timeout(function() {\r\n                        while (modals.length) {\r\n                            modals.splice(modals.length - 1, 1);\r\n                        }\r\n                    }, 500);\r\n                }\r\n            }\r\n\r\n            function addModal(path, params) {\r\n                // console.log('modalProvider.addModal', path, params);\r\n                var deferred = $q.defer();\r\n                params = params || null;\r\n                var modal = {\r\n                    title: 'Untitled',\r\n                    controller: null,\r\n                    templateUrl: null,\r\n                    params: params,\r\n                };\r\n                var current = routes[path];\r\n                if (current) {\r\n                    angular.extend(modal, current);\r\n                }\r\n                modal.deferred = deferred;\r\n                modal.back = function(data) {\r\n                    popModal(this);\r\n                    modal.deferred.resolve(data, modal);\r\n                }\r\n                modal.resolve = function(data) {\r\n                    closeModal(this);\r\n                    modal.deferred.resolve(data, modal);\r\n                }\r\n                modal.reject = function() {\r\n                    closeModal(this);\r\n                    modal.deferred.reject(modal);\r\n                }\r\n                modals.push(modal);\r\n                angular.forEach(modals, function(m, i) {\r\n                    m.active = false;\r\n                });\r\n                if (modals.length) {\r\n                    modal.active = true;\r\n                } else {\r\n                    $timeout(function() {\r\n                        modal.active = true;\r\n                        // window.scrollTo(0, 0);\r\n                    }, 500);\r\n                }\r\n                return deferred.promise;\r\n            }\r\n\r\n            return {\r\n                modals: modals,\r\n                addModal: addModal,\r\n            };\r\n        }];\r\n\r\n    }]);\r\n\r\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.directive('nav', ['$parse', 'Nav', function ($parse, Nav) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\treturn attributes.template || 'artisan/nav/nav';\n\t\t\t},\n\t\t\tscope: {\n\t\t\t\titems: '=nav',\n\t\t\t},\n\t\t\tlink: function (scope, element, attributes, model) {\n\t\t\t\tscope.$watch('items', function (value) {\n\t\t\t\t\t// console.log(value instanceof Nav, value);\n\t\t\t\t\tif (value) {\n\t\t\t\t\t\tif (angular.isArray(value)) {\n\t\t\t\t\t\t\tvar onLink = $parse(attributes.onLink)(scope.$parent);\n\t\t\t\t\t\t\tvar onNav = $parse(attributes.onNav)(scope.$parent);\n\t\t\t\t\t\t\tvar nav = new Nav({\n\t\t\t\t\t\t\t\tonLink: onLink,\n\t\t\t\t\t\t\t\tonNav: onNav\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tnav.setItems(value);\n\t\t\t\t\t\t\tscope.item = nav;\n\n\t\t\t\t\t\t} else if (value instanceof Nav) {\n\t\t\t\t\t\t\tscope.item = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n    }]);\n\n\tapp.directive('navItem', ['$timeout', 'Events', function ($timeout, Events) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\treturn attributes.template || 'artisan/nav/nav-item';\n\t\t\t},\n\t\t\tscope: {\n\t\t\t\titem: '=navItem',\n\t\t\t},\n\t\t\tlink: function (scope, element, attributes, model) {\n\t\t\t\tvar navItem = angular.element(element[0].querySelector('.nav-link'));\n\n\t\t\t\tvar output;\n\n\t\t\t\tfunction itemOpen(item, immediate) {\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tstate.active = true;\n\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tstate.immediate = immediate;\n\t\t\t\t\t\tstate.closed = state.closing = false;\n\t\t\t\t\t\tstate.opening = true;\n\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\tstate.opening = false;\n\t\t\t\t\t\t\tstate.opened = true;\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction itemClose(item, immediate) {\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tstate.active = false;\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tstate.immediate = immediate;\n\t\t\t\t\t\tstate.opened = state.opening = false;\n\t\t\t\t\t\tstate.closing = true;\n\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\tstate.closing = false;\n\t\t\t\t\t\t\tstate.closed = true;\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tif (item.items) {\n\t\t\t\t\t\tangular.forEach(item.items, function (o) {\n\t\t\t\t\t\t\titemClose(o, true);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction itemToggle(item) {\n\t\t\t\t\t// console.log('itemToggle', item);\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tstate.active = item.items ? !state.active : true;\n\t\t\t\t\tif (state.active) {\n\t\t\t\t\t\tif (item.$nav.parent) {\n\t\t\t\t\t\t\tangular.forEach(item.$nav.parent.items, function (o) {\n\t\t\t\t\t\t\t\tif (o !== item) {\n\t\t\t\t\t\t\t\t\titemClose(o, true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\titemOpen(item);\n\t\t\t\t\t} else {\n\t\t\t\t\t\titemClose(item);\n\t\t\t\t\t}\n\t\t\t\t\t// console.log(state);\n\t\t\t\t}\n\n\t\t\t\tfunction onDown(e) {\n\t\t\t\t\tvar item = scope.item;\n\t\t\t\t\t// console.log('Item.onDown', item);\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tif (state.active) {\n\t\t\t\t\t\toutput = false;\n\t\t\t\t\t\ttrigger();\n\t\t\t\t\t} else if (item.$nav.onNav) {\n\t\t\t\t\t\tvar promise = item.$nav.onNav(item, item.$nav);\n\t\t\t\t\t\tif (promise && typeof promise.then === 'function') {\n\t\t\t\t\t\t\tpromise.then(function (resolved) {\n\t\t\t\t\t\t\t\t// go on\n\t\t\t\t\t\t\t\ttrigger();\n\t\t\t\t\t\t\t}, function (rejected) {\n\t\t\t\t\t\t\t\t// do nothing\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\toutput = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\toutput = promise;\n\t\t\t\t\t\t\ttrigger();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction trigger() {\n\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\titemToggle(item);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// preventDefault(e);\n\t\t\t\t}\n\n\t\t\t\tfunction onClick(e) {\n\t\t\t\t\t// console.log('Item.onClick', e);\n\t\t\t\t\treturn preventDefault(e);\n\t\t\t\t}\n\n\t\t\t\tfunction preventDefault(e) {\n\t\t\t\t\tif (output === false) {\n\t\t\t\t\t\t// console.log('Item.preventDefault', e);\n\t\t\t\t\t\te.stop();\n\t\t\t\t\t\t// e.preventDefault();\n\t\t\t\t\t\t// e.stopPropagation();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar events = new Events(navItem).add({\n\t\t\t\t\tdown: onDown,\n\t\t\t\t\tclick: onClick,\n\t\t\t\t}, scope);\n\n\t\t\t}\n\t\t};\n    }]);\n\n\tapp.directive('navTo', ['$parse', '$timeout', 'Events', function ($parse, $timeout, Events) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tlink: function (scope, element, attributes) {\n\n\t\t\t\tfunction onDown(e) {\n\t\t\t\t\tconsole.log('navTo.onDown', attributes.navTo);\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tvar callback = $parse(attributes.navTo);\n\t\t\t\t\t\tcallback(scope);\n\t\t\t\t\t});\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tvar events = new Events(element).add({\n\t\t\t\t\tdown: onDown,\n\t\t\t\t}, scope);\n\n\t\t\t}\n\t\t};\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Nav', ['Silent', function (Silent) {\n\n\t\tfunction Nav(options) {\n\t\t\tvar nav = this;\n\t\t\tvar defaults = {\n\t\t\t\titems: [],\n\t\t\t}\n\t\t\tangular.extend(nav, defaults);\n\t\t\tif (options) {\n\t\t\t\tangular.extend(nav, options);\n\t\t\t}\n\t\t\tnav.setNav(nav, null);\n\t\t}\n\n\t\tvar statics = {\n\t\t\tsilent: NavSilent,\n\t\t\tpath: NavPath,\n\t\t};\n\n\t\tvar methods = {\n\t\t\taddItem: addItem,\n\t\t\taddItems: addItems,\n\t\t\tgetLink: getLink,\n\t\t\tsetItems: setItems,\n\t\t\tsetNav: setNav,\n\t\t\tsetNavs: setNavs,\n\t\t};\n\n\t\tangular.extend(Nav, statics);\n\t\tangular.extend(Nav.prototype, methods);\n\n\t\treturn Nav;\n\n\t\t// static methods\n\n\t\tfunction NavSilent(path) {\n\t\t\tSilent.silent(path);\n\t\t}\n\n\t\tfunction NavPath(path) {\n\t\t\tSilent.path(path);\n\t\t}\n\n\t\t// prototype methods\n\n\t\tfunction setItems(items) {\n\t\t\tvar nav = this;\n\t\t\tnav.path = Silent.path();\n\t\t\tnav.items = items;\n\t\t\tnav.setNavs(items, nav);\n\t\t}\n\n\t\tfunction setNavs(items, parent) {\n\t\t\tvar nav = this;\n\t\t\tif (items) {\n\t\t\t\tangular.forEach(items, function (item) {\n\t\t\t\t\tnav.setNav(item, parent);\n\t\t\t\t\tnav.setNavs(item.items, item);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tfunction setNav(item, parent) {\n\t\t\tvar nav = this;\n\t\t\tvar $nav = {\n\t\t\t\tparent: parent || null,\n\t\t\t\tlevel: parent ? parent.$nav.level + 1 : 0,\n\t\t\t\tstate: {},\n\t\t\t\taddItems: function (x) {\n\t\t\t\t\tnav.addItems(x, item);\n\t\t\t\t},\n\t\t\t\tonNav: nav.onNav,\n\t\t\t};\n\t\t\titem.$nav = $nav;\n\t\t\t$nav.link = nav.getLink(item);\n\t\t\tif ($nav.link === nav.path) {\n\t\t\t\t$nav.state.active = true;\n\t\t\t\t$nav.state.opened = true;\n\t\t\t\twhile ($nav.parent) {\n\t\t\t\t\t$nav = $nav.parent.$nav;\n\t\t\t\t\t$nav.state.active = true;\n\t\t\t\t\t$nav.state.opened = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction addItems(itemOrItems, parent) {\n\t\t\tvar nav = this;\n\t\t\tif (angular.isArray(itemOrItems)) {\n\t\t\t\tangular.forEach(itemOrItems, function (item) {\n\t\t\t\t\tnav.addItem(item, parent);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tnav.addItem(itemOrItems, parent);\n\t\t\t}\n\t\t}\n\n\t\tfunction addItem(item, parent) {\n\t\t\tvar nav = this,\n\t\t\t\tonLink = nav.onLink,\n\t\t\t\tonNav = nav.onNav;\n\t\t\tnav.setNav(item, parent);\n\t\t\tif (parent) {\n\t\t\t\tparent.items = parent.items || [];\n\t\t\t\tparent.items.push(item);\n\t\t\t}\n\t\t}\n\n\t\tfunction getLink(item) {\n\t\t\tvar link = null;\n\t\t\tif (this.onLink) {\n\t\t\t\tlink = this.onLink(item, item.$nav);\n\t\t\t} else {\n\t\t\t\tlink = item.link;\n\t\t\t}\n\t\t\treturn link;\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\twindow.ondragstart = function () {\n\t\treturn false;\n\t};\n\n\tvar app = angular.module('artisan');\n\n\tapp.directive('scrollableX', ['$parse', '$compile', '$timeout', 'Scrollable', 'Animate', 'Style', 'Events', 'Utils', function ($parse, $compile, $timeout, Scrollable, Animate, Style, Events, Utils) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplate: '<div class=\"scrollable-content\" ng-transclude></div>',\n\t\t\ttransclude: true,\n\t\t\tlink: function (scope, element, attributes, model) {\n\n\t\t\t\tvar onLeft, onRight, showIndicatorFor, scrollableWhen;\n\t\t\t\tif (attributes.onLeft) {\n\t\t\t\t\tonLeft = $parse(attributes.onLeft);\n\t\t\t\t}\n\t\t\t\tif (attributes.onRight) {\n\t\t\t\t\tonRight = $parse(attributes.onRight);\n\t\t\t\t}\n\t\t\t\tif (attributes.showIndicatorFor) {\n\t\t\t\t\tshowIndicatorFor = $parse(attributes.showIndicatorFor);\n\t\t\t\t}\n\t\t\t\tif (attributes.scrollableWhen) {\n\t\t\t\t\tscrollableWhen = $parse(attributes.scrollableWhen);\n\t\t\t\t}\n\n\t\t\t\t// ELEMENTS & STYLESHEETS;\n\t\t\t\telement.attr('unselectable', 'on').addClass('unselectable');\n\t\t\t\tvar containerNode = element[0];\n\t\t\t\tvar contentNode = containerNode.querySelector('.scrollable-content');\n\t\t\t\tvar content = angular.element(content);\n\t\t\t\tvar contentStyle = new Style();\n\n\t\t\t\tvar animate = new Animate(render);\n\n\t\t\t\tvar scrollable = attributes.scrollableX ? $parse(attributes.scrollableX)(scope) : new Scrollable();\n\n\t\t\t\tlink(scrollable);\n\n\t\t\t\tfunction link(scrollable) {\n\t\t\t\t\tscrollable.link({\n\t\t\t\t\t\tgetItems: function () {\n\t\t\t\t\t\t\tif (attributes.scrollableItem) {\n\t\t\t\t\t\t\t\tvar items = containerNode.querySelectorAll(attributes.scrollableItem);\n\t\t\t\t\t\t\t\treturn items;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tprev: function () {\n\t\t\t\t\t\t\tscrollable.scrollPrev();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnext: function () {\n\t\t\t\t\t\t\tscrollable.scrollNext();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\treset: function () {\n\t\t\t\t\t\t\tscrollable.doReset();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonLeft: onLeft,\n\t\t\t\t\t\tonRight: onRight,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t/*\n\t\t\t\tscope.$watch(attributes.scrollableX, function (newValue) {\n\t\t\t\t\tconsole.log(newValue);\n\t\t\t\t});\n\t\t\t\t*/\n\n\t\t\t\t/*\n\t\t\t\tvar indicator = null,\n\t\t\t\t\tindicatorNode = null,\n\t\t\t\t\tindicatorStyle;\n\t\t\t\tshowIndicatorFor = false;\n\t\t\t\tif (showIndicatorFor) {\n\t\t\t\t\tindicator = angular.element('<div class=\"indicator\"></div>');\n\t\t\t\t\tindicatorNode = indicator[0];\n\t\t\t\t\tindicatorStyle = new Style();\n\t\t\t\t\telement.append(indicator);\n\t\t\t\t\t$compile(indicator.contents())(scope);\n\t\t\t\t\tvar i = scrollbar.getIndicator();\n\t\t\t\t\tindicatorStyle.transform('translate3d(' + i.x.toFixed(2) + 'px,' + i.y.toFixed(2) + 'px,0)');\n\t\t\t\t\tindicatorStyle.set(indicatorNode);\n\t\t\t\t}\n\t\t\t\t*/\n\n\t\t\t\tfunction render(time) {\n\t\t\t\t\tscrollable.setContainer(containerNode);\n\t\t\t\t\tscrollable.setContent(contentNode);\n\t\t\t\t\tscrollable.setEnabled(isEnabled());\n\t\t\t\t\tvar animating = scrollable.renderX();\n\t\t\t\t\tif (!animating) {\n\t\t\t\t\t\t// animate.pause();\n\t\t\t\t\t}\n\t\t\t\t\tvar current = scrollable.getCurrent();\n\t\t\t\t\tcontentStyle.transform('translate3d(' + current.x.toFixed(2) + 'px,0,0)');\n\t\t\t\t\tcontentStyle.set(contentNode);\n\t\t\t\t\t/*\n\t\t\t\t\tif (showIndicatorFor) {\n\t\t\t\t\t\tif (dragging || wheeling || speed) {\n\t\t\t\t\t\t\tvar percent = c.x / (containerNode.offsetWidth - contentNode.offsetWidth);\n\t\t\t\t\t\t\tpercent = Math.max(0, Math.min(1, percent));\n\t\t\t\t\t\t\ti.x = (containerNode.offsetWidth - indicatorNode.offsetWidth) * (percent);\n\t\t\t\t\t\t\ti.y += (0 - i.y) / 4;\n\t\t\t\t\t\t\t// var count = Math.round(contentNode.offsetWidth / 315);\n\t\t\t\t\t\t\tvar index = Math.max(1, Math.round(percent * showIndicatorFor.rows.length));\n\t\t\t\t\t\t\tindicator.html(index + '/' + showIndicatorFor.count);\n\t\t\t\t\t\t\t// indicator.html((percent * 100).toFixed(2).toString());\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ti.y += (45 - i.y) / 4;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tindicatorStyle.transform('translate3d(' + i.x.toFixed(2) + 'px,' + i.y.toFixed(2) + 'px,0)');\n\t\t\t\t\t\tindicatorStyle.set(indicatorNode);\n\t\t\t\t\t}\n\t\t\t\t\t*/\n\t\t\t\t}\n\n\t\t\t\tfunction undrag() {\n\t\t\t\t\tscrollable.off();\n\t\t\t\t\tdragOff();\n\t\t\t\t}\n\n\t\t\t\tfunction onDown(event) {\n\t\t\t\t\tif (scrollable.dragStart(event.absolute)) {\n\t\t\t\t\t\tdragOn();\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onMove(event) {\n\t\t\t\t\tscrollable.dragMove(event.absolute);\n\t\t\t\t\tvar drag = scrollable.getDrag();\n\t\t\t\t\tif (Math.abs(drag.y) > Math.abs(drag.x)) {\n\t\t\t\t\t\tonUp(event);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onUp(event) {\n\t\t\t\t\tscrollable.dragEnd(event.absolute);\n\t\t\t\t\tevent.stop();\n\t\t\t\t\tdragOff();\n\t\t\t\t}\n\n\t\t\t\tfunction _onScrollX(dir, interval) {\n\t\t\t\t\treturn scrollable.wheelX(dir, interval);\n\t\t\t\t}\n\n\t\t\t\tvar onScrollX = _onScrollX;\n\t\t\t\t// var onScrollX = Utils.throttle(_onScrollX, 25);\n\n\t\t\t\tfunction onWheel(event) {\n\t\t\t\t\t// console.log('onWheelX', event.dir, scrollable.wheelXCheck(event.dir));\n\t\t\t\t\tif (scrollable.wheelXCheck(event.dir)) {\n\t\t\t\t\t\tonScrollX(event.dir, event.interval);\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction off() {\n\t\t\t\t\tdragOff();\n\t\t\t\t\t// animate.pause();\n\t\t\t\t\tscrollable.off();\n\t\t\t\t}\n\n\t\t\t\tfunction isEnabled() {\n\t\t\t\t\tvar enabled = true;\n\t\t\t\t\tif (scrollableWhen) {\n\t\t\t\t\t\tenabled = enabled && scrollableWhen(scope);\n\t\t\t\t\t}\n\t\t\t\t\tenabled = enabled && window.innerWidth >= 1024;\n\t\t\t\t\tenabled = enabled && (containerNode.offsetWidth < contentNode.offsetWidth);\n\t\t\t\t\treturn enabled;\n\t\t\t\t}\n\n\t\t\t\tfunction onResize() {\n\t\t\t\t\tvar enabled = isEnabled();\n\t\t\t\t\tif (!enabled) {\n\t\t\t\t\t\toff();\n\t\t\t\t\t}\n\t\t\t\t\trender();\n\t\t\t\t}\n\n\t\t\t\tscope.$watch(function () {\n\t\t\t\t\treturn contentNode.offsetWidth;\n\t\t\t\t}, function (newValue, oldValue) {\n\t\t\t\t\tonResize();\n\t\t\t\t});\n\n\t\t\t\tvar events = new Events(element).add({\n\t\t\t\t\tdown: onDown,\n\t\t\t\t\twheel: onWheel,\n\t\t\t\t}, scope);\n\n\t\t\t\tvar windowEvents = new Events(window).add({\n\t\t\t\t\tresize: onResize,\n\t\t\t\t}, scope);\n\n\t\t\t\tfunction dragOn() {\n\t\t\t\t\twindowEvents.add({\n\t\t\t\t\t\tmove: onMove,\n\t\t\t\t\t\tup: onUp,\n\t\t\t\t\t}, scope);\n\t\t\t\t}\n\n\t\t\t\tfunction dragOff() {\n\t\t\t\t\twindowEvents.remove({\n\t\t\t\t\t\tmove: onMove,\n\t\t\t\t\t\tup: onUp,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tanimate.pause();\n\t\t\t\t});\n\n\t\t\t},\n\t\t};\n    }]);\n\n\tapp.directive('scrollableY', ['$parse', '$compile', '$timeout', 'Scrollable', 'Animate', 'Style', 'Events', 'Utils', function ($parse, $compile, $timeout, Scrollable, Animate, Style, Events, Utils) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplate: '<div class=\"scrollable-content\" ng-transclude></div>',\n\t\t\ttransclude: true,\n\t\t\tlink: function (scope, element, attributes, model) {\n\n\t\t\t\tvar onTop, onBottom, showIndicatorFor, scrollableWhen;\n\t\t\t\tif (attributes.onTop) {\n\t\t\t\t\tonTop = $parse(attributes.onTop);\n\t\t\t\t}\n\t\t\t\tif (attributes.onBottom) {\n\t\t\t\t\tonBottom = $parse(attributes.onBottom);\n\t\t\t\t}\n\t\t\t\tif (attributes.showIndicatorFor) {\n\t\t\t\t\tshowIndicatorFor = $parse(attributes.showIndicatorFor);\n\t\t\t\t}\n\t\t\t\tif (attributes.scrollableWhen) {\n\t\t\t\t\tscrollableWhen = $parse(attributes.scrollableWhen);\n\t\t\t\t}\n\n\t\t\t\t// ELEMENTS & STYLESHEETS;\n\t\t\t\telement.attr('unselectable', 'on').addClass('unselectable');\n\t\t\t\tvar containerNode = element[0];\n\t\t\t\tvar contentNode = containerNode.querySelector('.scrollable-content');\n\t\t\t\tvar content = angular.element(content);\n\t\t\t\tvar contentStyle = new Style();\n\n\t\t\t\tvar animate = new Animate(render);\n\n\t\t\t\tvar scrollable = attributes.scrollableY ? $parse(attributes.scrollableY)(scope) : new Scrollable();\n\t\t\t\tlink(scrollable);\n\n\t\t\t\tfunction link(scrollable) {\n\t\t\t\t\tscrollable.link({\n\t\t\t\t\t\tgetItems: function () {\n\t\t\t\t\t\t\tif (attributes.scrollableItem) {\n\t\t\t\t\t\t\t\tvar items = containerNode.querySelectorAll(attributes.scrollableItem);\n\t\t\t\t\t\t\t\treturn items;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tprev: function () {\n\t\t\t\t\t\t\tscrollable.scrollPrev();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnext: function () {\n\t\t\t\t\t\t\tscrollable.scrollNext();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\treset: function () {\n\t\t\t\t\t\t\tscrollable.doReset();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonTop: onTop,\n\t\t\t\t\t\tonBottom: onBottom,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction render(time) {\n\t\t\t\t\tscrollable.setContainer(containerNode);\n\t\t\t\t\tscrollable.setContent(contentNode);\n\t\t\t\t\tscrollable.setEnabled(isEnabled());\n\t\t\t\t\tvar animating = scrollable.renderY();\n\t\t\t\t\tif (!animating) {\n\t\t\t\t\t\t// animate.pause();\n\t\t\t\t\t}\n\t\t\t\t\tvar current = scrollable.getCurrent();\n\t\t\t\t\tcontentStyle.transform('translate3d(0,' + current.y.toFixed(2) + 'px,0)');\n\t\t\t\t\tcontentStyle.set(contentNode);\n\t\t\t\t}\n\n\t\t\t\tfunction undrag() {\n\t\t\t\t\tscrollable.off();\n\t\t\t\t\tdragOff();\n\t\t\t\t}\n\n\t\t\t\tfunction onDown(event) {\n\t\t\t\t\tif (scrollable.dragStart(event.absolute)) {\n\t\t\t\t\t\tdragOn();\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onMove(event) {\n\t\t\t\t\tscrollable.dragMove(event.absolute);\n\t\t\t\t\tvar drag = scrollable.getDrag();\n\t\t\t\t\tif (Math.abs(drag.x) > Math.abs(drag.y)) {\n\t\t\t\t\t\tonUp(event);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onUp(event) {\n\t\t\t\t\tscrollable.dragEnd(event.absolute);\n\t\t\t\t\tevent.stop();\n\t\t\t\t\tdragOff();\n\t\t\t\t}\n\n\t\t\t\tfunction _onScrollY(dir, interval) {\n\t\t\t\t\treturn scrollable.wheelY(dir, interval);\n\t\t\t\t}\n\n\t\t\t\tvar onScrollY = _onScrollY;\n\t\t\t\t// var onScrollY = Utils.throttle(_onScrollY, 25);\n\n\t\t\t\tfunction onWheel(event) {\n\t\t\t\t\t// console.log('onWheelY', event.dir, scrollable.wheelYCheck(event.dir));\n\t\t\t\t\tif (scrollable.wheelYCheck(event.dir)) {\n\t\t\t\t\t\tonScrollY(event.dir, event.interval);\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction off() {\n\t\t\t\t\tdragOff();\n\t\t\t\t\t// animate.pause();\n\t\t\t\t\tscrollable.off();\n\t\t\t\t}\n\n\t\t\t\tfunction isEnabled() {\n\t\t\t\t\tvar enabled = true;\n\t\t\t\t\tif (scrollableWhen) {\n\t\t\t\t\t\tenabled = enabled && scrollableWhen(scope);\n\t\t\t\t\t}\n\t\t\t\t\tenabled = enabled && window.innerWidth >= 1024;\n\t\t\t\t\tenabled = enabled && (containerNode.offsetHeight < contentNode.offsetHeight);\n\t\t\t\t\treturn enabled;\n\t\t\t\t}\n\n\t\t\t\tfunction onResize() {\n\t\t\t\t\tvar enabled = isEnabled();\n\t\t\t\t\tif (!enabled) {\n\t\t\t\t\t\toff();\n\t\t\t\t\t}\n\t\t\t\t\trender();\n\t\t\t\t}\n\n\t\t\t\tscope.$watch(function () {\n\t\t\t\t\treturn contentNode.offsetHeight;\n\t\t\t\t}, function (newValue, oldValue) {\n\t\t\t\t\tonResize();\n\t\t\t\t});\n\n\t\t\t\tvar events = new Events(element).add({\n\t\t\t\t\tdown: onDown,\n\t\t\t\t\twheel: onWheel,\n\t\t\t\t}, scope);\n\n\t\t\t\tvar windowEvents = new Events(window).add({\n\t\t\t\t\tresize: onResize,\n\t\t\t\t}, scope);\n\n\t\t\t\tfunction dragOn() {\n\t\t\t\t\twindowEvents.add({\n\t\t\t\t\t\tmove: onMove,\n\t\t\t\t\t\tup: onUp,\n\t\t\t\t\t}, scope);\n\t\t\t\t}\n\n\t\t\t\tfunction dragOff() {\n\t\t\t\t\twindowEvents.remove({\n\t\t\t\t\t\tmove: onMove,\n\t\t\t\t\t\tup: onUp,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tanimate.pause();\n\t\t\t\t});\n\n\t\t\t},\n\t\t};\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('Scrollable', ['Utils', 'Point', 'Rect', function(Utils, Point, Rect) {\n\n        function Scrollable() {\n\n            var padding = 150;\n            var enabled, snappable, busy, dragging, wheeling, down, move, prev;\n            var currentIndex = 0;\n\n            snappable = true;\n\n            var start = new Point(),\n                end = new Point(),\n                current = new Point(),\n                drag = new Point(),\n                indicator = new Point(),\n                offset = new Point(),\n                speed = new Point(),\n                container = new Rect(),\n                content = new Rect(),\n                overflow = new Rect();\n\n            var scrollable = {\n                // properties\n                start: start,\n                end: end,\n                current: current,\n                indicator: indicator,\n                speed: speed,\n                overflow: overflow,\n                container: container,\n                content: content,\n                // methods\n                setContainer: setContainer,\n                setContent: setContent,\n                setEnabled: setEnabled,\n                getCurrent: getCurrent,\n                getDrag: getDrag,\n                getIndicator: getIndicator,\n                getIndex: getIndex,\n                scrollToIndex: scrollToIndex,\n                scrollPrev: scrollPrev,\n                scrollNext: scrollNext,\n                dragStart: dragStart,\n                dragMove: dragMove,\n                dragEnd: dragEnd,\n                doReset: doReset,\n                off: off,\n                // x direction\n                doLeft: doLeft,\n                doRight: doRight,\n                renderX: renderX,\n                scrollToX: scrollToX,\n                wheelX: wheelX,\n                wheelXCheck: wheelXCheck,\n                // y direction\n                doTop: doTop,\n                doBottom: doBottom,\n                renderY: renderY,\n                scrollToY: scrollToY,\n                wheelY: wheelY,\n                wheelYCheck: wheelYCheck,\n            };\n\n            angular.extend(this, scrollable);\n\n            scrollable = this;\n\n            function setContainer(node) {\n                container.width = node.offsetWidth;\n                container.height = node.offsetHeight;\n            }\n\n            function setContent(node) {\n                content.width = node.offsetWidth;\n                content.height = node.offsetHeight;\n            }\n\n            function setEnabled(flag) {\n                enabled = flag;\n            }\n\n            function getCurrent() {\n                return current;\n            }\n\n            function getDrag() {\n                return drag;\n            }\n\n            function getIndicator() {\n                return indicator;\n            }\n\n            function getIndex() {\n                return currentIndex;\n            }\n\n            function scrollToIndex(index) {\n                if (index !== currentIndex) {\n                    currentIndex = index;\n                    var item = getItemAtIndex(index);\n                    if (item) {\n                        offset = new Point(\n                            item.offsetLeft,\n                            item.offsetTop\n                        );\n                        // console.log('scrollToIndex', index, offset);\n                    }\n                    return true;\n                }\n            }\n\n            function dragStart(point) {\n                if (!busy) {\n                    start.x = end.x = current.x;\n                    start.y = end.y = current.y;\n                    speed.x = 0;\n                    speed.y = 0;\n                    down = point;\n                    currentIndex = -1;\n                    wheeling = false;\n                    return true;\n                } else {\n                    return false;\n                }\n            }\n\n            function dragMove(point) {\n                prev = move;\n                move = point;\n                drag.x = move.x - down.x;\n                drag.y = move.y - down.y;\n                dragging = true;\n            }\n\n            function dragEnd() {\n                if (move && prev) {\n                    speed.x += (move.x - prev.x) * 4;\n                    speed.y += (move.y - prev.y) * 4;\n                }\n                start.x = end.x = current.x;\n                start.y = end.y = current.y;\n                dragging = false;\n                move = null;\n                down = null;\n                prev = null;\n            }\n\n            function getItemAtIndex(index) {\n                var item = null;\n                var items = scrollable.getItems();\n                if (items) {\n                    if (index >= 0 && index < items.length) {\n                        item = items[index];\n                    }\n                }\n                // console.log('getItemAtIndex', index, items.length, item);\n                return item;\n            }\n\n            function scrollPrev() {\n                var index = Math.max(0, currentIndex - 1);\n                console.log('scrollPrev', index);\n                scrollToIndex(index);\n            }\n\n            function scrollNext() {\n                var items = scrollable.getItems();\n                var index = Math.min(items.length - 1, currentIndex + 1);\n                console.log('scrollNext', index);\n                scrollToIndex(index);\n            }\n\n            function doReset() {\n                end.x = current.x = 0;\n            }\n\n            function off() {\n                dragging = false;\n                wheeling = false;\n                move = null;\n                down = null;\n            }\n\n            // x - direction\n\n            function doLeft(scope) {\n                if (busy) {\n                    return;\n                }\n                if (!scrollable.onLeft) {\n                    return;\n                }\n                busy = true;\n                scrollable.onLeft(scope).then().finally(function() {\n                    scrollToX(0);\n                });\n            }\n\n            function doRight(scope) {\n                if (busy) {\n                    return;\n                }\n                if (!scrollable.onRight) {\n                    return;\n                }\n                busy = true;\n                scrollable.onRight(scope).then().finally(function() {\n                    var right = container.width - content.width;\n                    if (right > overflow.width) {\n                        start.x = end.x = overflow.width;\n                    } else {\n                        start.x = end.x = overflow.width + padding;\n                    }\n                    scrollToX(0);\n                });\n            }\n\n            function renderX() {\n                var animating = true;\n                if (enabled) {\n                    overflow.x = 0;\n                    overflow.width = container.width - content.width;\n                    if (dragging) {\n                        end.x = start.x + move.x - down.x;\n                        if (extendX()) {\n                            start.x = end.x;\n                            down.x = move.x;\n                        }\n                    } else if (speed.x) {\n                        end.x += speed.x;\n                        speed.x *= 0.75;\n                        if (wheeling) {\n                            extendX();\n                        }\n                        if (Math.abs(speed.x) < 2.05) {\n                            speed.x = 0;\n                            scrollable.wheeling = wheeling = false;\n                            snapToNearestX();\n                        }\n                    } else if (offset) {\n                        end.x = -offset.x;\n                        offset = null;\n                    }\n                    end.x = Math.round(end.x * 10000) / 10000;\n                    end.x = Math.min(overflow.x, end.x);\n                    end.x = Math.max(overflow.width, end.x);\n                    current.x += (end.x - current.x) / 4;\n                    if (speed.x === 0 && Math.abs(end.x - current.x) < 0.05) {\n                        current.x = end.x;\n                        if (!snapToNearestX()) {\n                            animating = false;\n                        }\n                    }\n                    // console.log('renderX', current.x, end.x, overflow.x);\n                } else {\n                    current.x = end.x = 0;\n                    animating = false;\n                }\n                return animating;\n            }\n\n            function extendX() {\n                var extending = false;\n                overflow.x += padding;\n                overflow.width -= padding;\n                if (end.x > overflow.x) {\n                    extending = true;\n                    doLeft();\n                } else if (end.x < overflow.width) {\n                    extending = true;\n                    doRight();\n                }\n                return extending;\n            }\n\n            function snapToNearestX() {\n                var items = scrollable.getItems();\n                if (items) {\n                    var index = -1;\n                    var min = Number.POSITIVE_INFINITY;\n                    angular.forEach(items, function(item, i) {\n                        var distance = Math.abs((end.x + speed.x) - (item.offsetLeft * -1));\n                        if (distance < min) {\n                            min = distance;\n                            index = i;\n                        }\n                    });\n                    if (index !== -1) {\n                        if (snappable) {\n                            return scrollToIndex(index);\n                        } else {\n                            currentIndex = index;\n                        }\n                    }\n                }\n            }\n\n            function wheelXCheck(dir) {\n                // console.log('wheelYCheck', dir < 0 ? (end.x - overflow.width) : (end.x - overflow.x));\n                if (!busy && enabled) {\n                    if (dir < 0) {\n                        return end.x - overflow.width;\n                    } else {\n                        return end.x - overflow.x;\n                    }\n                } else {\n                    return false;\n                }\n            }\n\n            function wheelX(dir, interval) {\n                end.x += dir * 100 / 1000 * interval;\n                speed.x += dir * 100 / 1000 * interval;\n                wheeling = true;\n            }\n\n            function scrollToX(value) {\n                start.x = end.x = value;\n                setTimeout(function() {\n                    off();\n                    busy = false;\n                }, 500);\n            }\n\n            // y - direction\n\n            function doTop(scope) {\n                if (busy) {\n                    return;\n                }\n                if (!scrollable.onTop) {\n                    return;\n                }\n                busy = true;\n                scrollable.onTop(scope).then().finally(function() {\n                    scrollToY(0);\n                });\n            }\n\n            function doBottom(scope) {\n                if (busy) {\n                    return;\n                }\n                if (!scrollable.onBottom) {\n                    return;\n                }\n                busy = true;\n                scrollable.onBottom(scope).then().finally(function() {\n                    var bottom = container.height - content.height;\n                    if (bottom > overflow.height) {\n                        start.y = end.y = overflow.height;\n                    } else {\n                        start.y = end.y = overflow.height + padding;\n                    }\n                    scrollToY(0);\n                });\n            }\n\n            function renderY() {\n                var animating = true;\n                if (enabled) {\n                    overflow.y = 0;\n                    overflow.height = container.height - content.height;\n                    if (dragging) {\n                        end.y = start.y + move.y - down.y;\n                        if (extendY()) {\n                            start.y = end.y;\n                            down.y = move.y;\n                        }\n                    } else if (speed.y) {\n                        end.y += speed.y;\n                        speed.y *= 0.75;\n                        if (wheeling) {\n                            extendY();\n                        }\n                        if (Math.abs(speed.y) < 2.05) {\n                            speed.y = 0;\n                            scrollable.wheeling = wheeling = false;\n                            snapToNearestY();\n                        }\n                    } else if (offset) {\n                        end.y = -offset.y;\n                        offset = null;\n                    }\n                    end.y = Math.round(end.y * 10000) / 10000;\n                    end.y = Math.min(overflow.y, end.y);\n                    end.y = Math.max(overflow.height, end.y);\n                    current.y += (end.y - current.y) / 4;\n                    if (speed.y === 0 && Math.abs(end.y - current.y) < 0.05) {\n                        current.y = end.y;\n                        if (!snapToNearestY()) {\n                            animating = false;\n                        }\n                    }\n                    // console.log(parseFloat(current.y.toFixed(6)), end.y, overflow.y);\n                    // console.log(dragging, wheeling, end.y, speed.y, Math.abs(end.y - current.y));\n                } else {\n                    current.y = end.y = 0;\n                    animating = false;\n                }\n                return animating;\n            }\n\n            function extendY() {\n                var extending = false;\n                overflow.y += padding;\n                overflow.height -= padding;\n                if (end.y > overflow.y) {\n                    extending = true;\n                    doTop();\n                } else if (end.y < overflow.height) {\n                    extending = true;\n                    doBottom();\n                }\n                return extending;\n            }\n\n            function snapToNearestY() {\n                var items = scrollable.getItems();\n                if (items) {\n                    var index = -1;\n                    var min = Number.POSITIVE_INFINITY;\n                    angular.forEach(items, function(item, i) {\n                        var distance = Math.abs((end.y + speed.y) - (item.offsetTop * -1));\n                        if (distance < min) {\n                            min = distance;\n                            index = i;\n                        }\n                    });\n                    // console.log('snapToNearestY', index, min);\n                    if (index !== -1) {\n                        if (snappable) {\n                            return scrollToIndex(index);\n                        } else {\n                            currentIndex = index;\n                        }\n                    }\n                }\n            }\n\n            function wheelYCheck(dir) {\n                // console.log('wheelYCheck', dir < 0 ? (end.y - overflow.height) : (end.y - overflow.y));\n                if (!busy && enabled) {\n                    if (dir < 0) {\n                        return end.y - overflow.height;\n                    } else {\n                        return end.y - overflow.y;\n                    }\n                } else {\n                    return false;\n                }\n            }\n\n            function wheelY(dir, interval) {\n                end.y += dir * 100 / 1000 * interval;\n                speed.y += dir * 100 / 1000 * interval;\n                wheeling = true;\n            }\n\n            function scrollToY(value) {\n                start.y = end.y = value;\n                setTimeout(function() {\n                    off();\n                    busy = false;\n                }, 500);\n            }\n\n        }\n\n        function link(methods) {\n            angular.extend(this, methods);\n        }\n\n        Scrollable.prototype = {\n            link: link,\n            getItems: function() {\n                return [content];\n            },\n        };\n        return Scrollable;\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.directive('videoSource', ['$timeout', function ($timeout) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tsource: '=videoSource',\n\t\t\t\timage: '=videoImage',\n\t\t\t},\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\treturn attributes.template || 'artisan/video/video-player';\n\t\t\t},\n\t\t\tlink: function (scope, element, attributes) {\n\t\t\t\tvar native = element[0];\n\t\t\t\tvar video = native.querySelector('video');\n\t\t\t\tvar img = native.querySelector('img');\n\t\t\t\tvar infos = {};\n\t\t\t\tscope.playing = false;\n\t\t\t\tscope.busy = false;\n\t\t\t\tscope.toggle = toggle;\n\t\t\t\tscope.play = play;\n\t\t\t\tscope.pause = pause;\n\t\t\t\tscope.infos = infos;\n\n\t\t\t\tfunction toggle() {\n\t\t\t\t\tif (!scope.busy) {\n\t\t\t\t\t\tscope.busy = true;\n\t\t\t\t\t\tif (scope.playing) {\n\t\t\t\t\t\t\tvideo.pause();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvideo.play();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction play() {\n\t\t\t\t\tif (!scope.busy) {\n\t\t\t\t\t\tscope.busy = true;\n\t\t\t\t\t\tvideo.play();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction pause() {\n\t\t\t\t\tif (!scope.busy) {\n\t\t\t\t\t\tscope.busy = true;\n\t\t\t\t\t\tvideo.pause();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onPlaying(e) {\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tscope.playing = true;\n\t\t\t\t\t\tscope.busy = false;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction onPause(e) {\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tscope.playing = false;\n\t\t\t\t\t\tscope.busy = false;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction onEnded(e) {\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tscope.playing = false;\n\t\t\t\t\t\tscope.busy = false;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction onProgress(e) {\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tinfos.buffered = video.buffered; // todo: TimeRanges\n\t\t\t\t\t\tconsole.log('onProgress', infos);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction onTimeUpdate(e) {\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tinfos.duration = video.duration;\n\t\t\t\t\t\tinfos.currentTime = video.currentTime;\n\t\t\t\t\t\tinfos.progressTime = infos.currentTime / infos.duration;\n\t\t\t\t\t\tconsole.log('onTimeUpdate', infos);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tvar videoElement = angular.element(video);\n\n\t\t\t\tfunction addListeners() {\n\t\t\t\t\tvideoElement.on('playing', onPlaying);\n\t\t\t\t\tvideoElement.on('pause', onPause);\n\t\t\t\t\tvideoElement.on('ended', onEnded);\n\t\t\t\t\tvideoElement.on('progress', onProgress);\n\t\t\t\t\tvideoElement.on('timeupdate', onTimeUpdate);\n\t\t\t\t}\n\n\t\t\t\tfunction removeListeners() {\n\t\t\t\t\tvideoElement.off('playing', onPlaying);\n\t\t\t\t\tvideoElement.off('pause', onPause);\n\t\t\t\t\tvideoElement.off('ended', onEnded);\n\t\t\t\t\tvideoElement.off('progress', onProgress);\n\t\t\t\t\tvideoElement.off('timeupdate', onTimeUpdate);\n\t\t\t\t}\n\n\t\t\t\taddListeners();\n\t\t\t\tscope.$on('destroy', function () {\n\t\t\t\t\tremoveListeners();\n\t\t\t\t});\n\n\t\t\t}\n\t\t};\n    }]);\n\n\t/*\n\tObject.defineProperty(HTMLMediaElement.prototype, 'playing', {\n\t    get: function () {\n\t        return !!(this.currentTime > 0 && !this.paused && !this.ended && this.readyState > 2);\n\t    }\n\t});\n\t*/\n\n}());\n/* global angular */\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\t// micro interactions\n\n\tfunction tap(Events) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tpriority: 0,\n\t\t\tlink: link\n\t\t};\n\n\t\tfunction link(scope, element, attributes, model) {\n\t\t\tif (attributes.ngBind) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t/*\n\t\t\tif (attributes.href === '#' && !attributes.ngHref && !attributes.ngClick) {\n\t\t\t\treturn;\n            }\n            */\n\n\t\t\telement.addClass('interaction-tap');\n\t\t\tvar node = document.createElement('interaction');\n\t\t\telement[0].appendChild(node);\n\n\t\t\tfunction onDown(e) {\n\t\t\t\telement.removeClass('interaction-animate');\n\t\t\t\tvoid element.offsetWidth;\n\t\t\t\t// node.style.animationPlayState = \"paused\";\n\t\t\t\tnode.style.left = e.relative.x + 'px';\n\t\t\t\tnode.style.top = e.relative.y + 'px';\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\telement.addClass('interaction-animate');\n\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\telement.removeClass('interaction-animate');\n\t\t\t\t\t}, 1000);\n\t\t\t\t}, 10);\n\n\t\t\t\t// console.log('tap.onDown', node, node.parentElement);\n\t\t\t}\n\t\t\tvar listeners = { // down, move, up, click\n\t\t\t\tdown: onDown,\n\t\t\t};\n\t\t\tvar events = new Events(element).add(listeners, scope); // passing scope to add remove listeners automatically on $destroy\n\t\t}\n\t}\n\tapp.directive('ngHref', ['Events', tap]);\n\tapp.directive('ngClick', ['Events', tap]);\n\n}());"]}