{"version":3,"sources":["docs/js/artisan.js"],"names":["angular","module","service","$promise","environment","Facebook","promise","undefined","window","FB","resolve","FacebookInit","then","success","error","reject","FacebookStatus","response","init","authResponse","status","FacebookGetMe","fields","config","FacebookLogin","facebook","console","log","api","FacebookGetMyPicture","size","width","height","type","login","scope","FacebookLogout","logout","fbAsyncInit","appId","app_id","cookie","xfbml","version","d","s","id","js","fjs","getElementsByTagName","getElementById","createElement","src","language","culture","parentNode","insertBefore","document","this","statics","getMe","getMyPicture","extend","addons","trhow","factory","Animate","callback","key","ticks","pause","animate","cancelAnimationFrame","play","loop","time","requestAnimationFrame","toggle","methods","prototype","lastTime","vendors","x","length","element","currTime","Date","getTime","timeToCall","Math","max","setTimeout","clearTimeout","Point","Rect","getBoundRect","node","getNode","getDocumentNode","getBoundingClientRect","getClosest","selector","matchesFn","parent","some","fn","body","parentElement","getClosestNode","target","getDelta","event","original","originalEvent","delta","deltaX","wheelDeltaX","deltaY","wheelDeltaY","abs","dir","documentElement","getElement","isArray","getNodeOffset","offset","nodeType","offsetLeft","y","offsetTop","getPageScroll","scroll","documentNode","pageXOffset","scrollLeft","pageYOffset","scrollTop","getParents","topParentNode","parents","push","getView","view","innerWidth","innerHeight","clientWidth","clientHeight","getPointInView","point","TOUCH_EVENTS","indexOf","touch","touches","changedTouches","pageX","pageY","MOUSE_EVENTS","compileController","html","data","link","$compile","contents","controller","$scope","$new","$controller","controllerAs","children","downloadFile","content","name","download","createEvent","anchor","href","base64","downloadName","substring","lastIndexOf","initEvent","dispatchEvent","open","blob","Blob","reader","FileReader","readAsDataURL","onloadend","result","ua","agent","navigator","userAgent","toLowerCase","safari","msie","chrome","mobile","mac","forEach","value","addClass","app","EventsService","Dom","Event","rect","absolute","relative","left","top","timestamp","stop","stopPropagation","preventDefault","Events","setTimestamp","interval","min","events","onClick","e","listeners","click","apply","onMouseDown","down","removeTouchEvents","onMouseMove","move","onMouseUp","up","onMouseWheel","wheel","removeScrollEvents","onMouseScroll","removeWheelEvents","onResize","resize","onTouchStart","removeStandardEvents","onTouchMove","onTouchEnd","standardEvents","touchEvents","wheelEvents","scrollEvents","add","standard","windowElement","listener","remove","on","$on","off","mouseEvents","getTouch","previous","difference","t","getRelativeTouch","hasPassiveEvents","supported","addEventListener","options","Object","defineProperty","get","defaults","passive","capture","EventTarget","modified","copy","call","onScroll","filter","scrollWidth","firefox","$filter","array","filters","item","i","PointDifference","a","b","PointMultiply","clone","mult","setPos","setX","setY","toString","multiply","w","h","RectMultiply","bottom","bottomLeft","bottomRight","center","expand","expandRect","intersect","reduce","reduceRect","offsetRect","right","setH","setSize","setW","topLeft","topRight","Vector","VectorCross","VectorDifference","VectorDistance","sqrt","VectorIncidence","atan2","VectorMake","VectorNormalize","l","VectorPower","VectorSize","cross","distance","friction","incidence","normalize","power","towards","make","Hash","pool","HashGet","defineProperties","enumerable","writable","pools","has","getId","hash","set","newItem","p","keys","oldItem","index","splice","addMany","items","removeMany","removeAll","shift","each","forward","reverse","sort","c","backward","differs","updatePool","Array","$q","deferred","defer","$promiseAll","promises","all","$timeout","State","errors","isReady","idle","busy","state","isBusy","isError","isErroring","isSuccess","isSuccessing","classes","ready","successing","errorring","enabled","DELAY","errorMessage","button","labels","label","submitClass","transformProperty","div","style","every","prefix","Style","props","scale","hoverScale","currentScale","styles","cssText","join","transform","transformOrigin","round","format","string","prepend","expression","splitted","split","formatted","object","reducer","o","reducerAdder","slice","reducerSetter","removeValue","reverseSortOn","throttle","func","wait","context","args","timeout","later","leading","getNow","now","remaining","arguments","trailing","toMd5","where","query","found","TypeError","len","k","Api","Doc","$location","$routeParams","View","doc","url","path","params","route","ViewCurrent","docs","current","$http","HttpPromise","method","urls","HttpGet","HttpPost","HttpPut","HttpPatch","HttpDelete","HttpFake","post","put","patch","delete","fake","$rootScope","RouterSetControllers","$previousController","$previous","$currentController","$current","$nextController","$next","RouterOnChangeStart","next","$$route","RouterOnChangeSuccess","RouterOnChangeError","rejection","RouterOnUpdate","RouterIsController","RouterRedirectTo","$$lastRequestedPath","RouterRetryLastRequestedPath","RouterRedirect","msecs","RouterPath","RouterApply","isController","redirect","SilentUnlink","$$listeners","$locationChangeSuccess","relink","SilentListener","$path","SilentSilent","replace","location","SilentPath","silent","unshift","CookieDelete","CookieSetter","CookieExists","CookieGet","cookieName","ca","charAt","model","JSON","parse","decodeURIComponent","atob","CookieOn","checkCookie","elapsed","Cookie","TIMEOUT","CookieSet","days","cache","json","stringify","btoa","encodeURIComponent","expires","date","setTime","toGMTString","exist","LocalExists","localStorage","LocalGet","LocalSet","setItem","LocalDelete","removeItem","LocalOn","storageEvent","newValue","sessionStorage","$sce","TrustGetValue","values","trustedValues","TrustSetValue","trustedValue","TrustGetOrSet","TrustHtml","trustAsHtml","TrustResource","trustAsResourceUrl","TrustUrl","resource","Color","r","g","uint","parseInt","componentToHex","hex","luma","color","dot","contrast","darker","pow","floor","lighter","toUint","toHex","toRgba","toFixed","alpha","makeSet","foreground","border","light","Shape","shapeCircle","cx","cy","sa","ea","PI","ctx","arc","shapeStar","or","ir","steps","angle","step","moveTo","cos","sin","lineTo","shapeRoundRect","tl","tr","br","bl","defaultRadius","quadraticCurveTo","circle","beginPath","closePath","star","roundRect","constant","black","white","blue","red","lightBlue","lightYellow","greyLighter","greyLight","greyMedium","grey","map","Painter","Palette","painter","buffer","rows","getRect","row","canvas","setCanvas","drawImage","palette","isString","img","Image","onload","addShape","onerror","save","clip","translate","restore","draw","pre","drawRect","tint","setFill","fillRect","globalCompositeOperation","pattern","drawPattern","fillStyle","createPattern","toDataURL","PainterColors","drawingRect","setColors","colors","offsetWidth","offsetHeight","getContext","lineCap","clear","setText","font","align","verticalAlign","textAlign","textBaseline","setStroke","strokeStyle","lineWidth","fillText","text","maxLength","substr","trim","strokeRect","fill","stroke","begin","close","rotate","xy","image","flip","directive","restrict","templateUrl","transclude","message","attributes","$parse","formatLabel","uniqueId","template","control","ngModel","required","form","title","placeholder","source","require","optionLabel","getOptions","number","field","precision","validate","minLength","Number","POSITIVE_INFINITY","focus","visible","onChange","$parent","onFilter","getType","getClasses","control-focus","control-success","$valid","control-error","$invalid","$submitted","$touched","control-empty","$viewValue","getMessages","$error","toggleVisibility","$templateCache","compile","onRemove","getter","numberPicker","setter","assign","onAdd","removeListeners","nodeRemove","nodeAdd","querySelectorAll","onFocus","$modelValue","$setViewValue","doBlur","onBlur","$formatters","$parsers","valid","String","$setValidity","$templateRequest","priority","modal","modalView","provider","when","routes","modals","$get","popModal","m","active","closeModal","addModal","back","Nav","$watch","onLink","onNav","nav","setItems","itemOpen","immediate","$nav","closed","closing","opening","opened","itemClose","itemToggle","onDown","trigger","output","resolved","rejected","navItem","querySelector","navTo","Silent","setNav","NavSilent","NavPath","setNavs","level","addItems","getLink","itemOrItems","addItem","ondragstart","Scrollable","Utils","render","scrollable","setContainer","containerNode","setContent","contentNode","setEnabled","isEnabled","renderX","getCurrent","contentStyle","dragStart","dragOn","onMove","dragMove","drag","getDrag","onUp","dragEnd","dragOff","_onScrollX","wheelX","onWheel","wheelXCheck","onScrollX","scrollableWhen","windowEvents","onLeft","onRight","showIndicatorFor","attr","scrollableX","getItems","scrollableItem","prev","scrollPrev","scrollNext","reset","doReset","oldValue","renderY","_onScrollY","wheelY","wheelYCheck","onScrollY","onTop","onBottom","scrollableY","container","flag","getIndicator","indicator","getIndex","currentIndex","scrollToIndex","getItemAtIndex","start","end","speed","wheeling","dragging","doLeft","finally","scrollToX","doRight","overflow","padding","animating","extendX","snapToNearestX","extending","snappable","doTop","scrollToY","doBottom","extendY","snapToNearestY","playing","video","onPlaying","onPause","onEnded","onProgress","infos","buffered","onTimeUpdate","duration","currentTime","progressTime","videoElement","native","tap","removeClass","ngBind","appendChild"],"mappings":"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","file":"artisan.min.js","sourcesContent":["/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan', ['ng', 'ngRoute', 'ngMessages']);\r\n\r\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.service('FacebookService', ['$promise', 'environment', function ($promise, environment) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\tlogin: FacebookLogin,\n\t\t\tlogout: FacebookLogout,\n\t\t\tstatus: FacebookStatus,\n\t\t\tgetMe: FacebookGetMe,\n\t\t\tgetMyPicture: FacebookGetMyPicture,\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\t// private vars\n\n\t\tif (!environment.addons || !environment.addons.facebook) {\n\t\t\ttrhow('FacebookService.error missing config object in environment.addons.facebook');\n\t\t}\n\n\t\tvar config = environment.addons.facebook;\n\n\t\t// statics methods\n\n\t\t/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n\t\t *  calling facebook initializer on page load to avoid popup blockers via asyncronous loading  *\n\t\t * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\n\n\t\tFacebook();\n\n\t\tfunction Facebook() {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tif (window.FB !== undefined) {\n\t\t\t\t\tpromise.resolve(window.FB);\n\t\t\t\t} else {\n\t\t\t\t\tFacebookInit().then(function (success) {\n\t\t\t\t\t\tpromise.resolve(window.FB);\n\t\t\t\t\t}, function (error) {\n\t\t\t\t\t\tpromise.reject(error);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tfunction FacebookStatus(response, promise, init) {\n\t\t\tservice.authResponse = null;\n\t\t\tif (response.status === 'connected') {\n\t\t\t\tservice.authResponse = response.authResponse;\n\t\t\t\tpromise.resolve(response);\n\t\t\t} else if (response.status === 'not_authorized') {\n\t\t\t\tif (init) {\n\t\t\t\t\tpromise.resolve(response);\n\t\t\t\t} else {\n\t\t\t\t\tpromise.reject(response);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tpromise.reject(response);\n\t\t\t}\n\t\t}\n\n\t\tfunction FacebookGetMe(fields) {\n\t\t\tfields = fields || config.fields;\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tFacebookLogin().then(function (facebook) {\n\t\t\t\t\tconsole.log('FacebookGetMe', facebook);\n\t\t\t\t\tfacebook.api('/me', {\n\t\t\t\t\t\tfields: fields\n\t\t\t\t\t}, function (response) {\n\t\t\t\t\t\tif (!response || response.error) {\n\t\t\t\t\t\t\tpromise.reject('Error occured');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpromise.resolve(response);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tfunction FacebookGetMyPicture(size) {\n\t\t\tsize = size || 300;\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tFacebookLogin().then(function (facebook) {\n\t\t\t\t\tfacebook.api('/me/picture', {\n\t\t\t\t\t\twidth: size,\n\t\t\t\t\t\theight: size,\n\t\t\t\t\t\ttype: 'square'\n\t\t\t\t\t}, function (response) {\n\t\t\t\t\t\tif (!response || response.error) {\n\t\t\t\t\t\t\tpromise.reject('Error occured');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpromise.resolve(response);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tfunction FacebookLogin() {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tFacebook().then(function (facebook) {\n\t\t\t\t\tconsole.log('FacebookLogin', facebook);\n\t\t\t\t\tfacebook.login(function (response) {\n\t\t\t\t\t\tFacebookStatus(response, promise);\n\t\t\t\t\t}, {\n\t\t\t\t\t\tscope: config.scope\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tfunction FacebookLogout() {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tFacebook().then(function (facebook) {\n\t\t\t\t\tfacebook.logout(function (response) {\n\t\t\t\t\t\tpromise.resolve(response);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tfunction FacebookInit() {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\twindow.fbAsyncInit = function () {\n\t\t\t\t\tconsole.log('FacebookInit.fbAsyncInit', window.FB);\n\t\t\t\t\twindow.FB.init({\n\t\t\t\t\t\tappId: config.app_id,\n\t\t\t\t\t\tstatus: true,\n\t\t\t\t\t\tcookie: true,\n\t\t\t\t\t\txfbml: true,\n\t\t\t\t\t\tversion: config.version,\n\t\t\t\t\t});\n\t\t\t\t\tpromise.resolve(window.FB);\n\t\t\t\t\t// window.fbAsyncInit = null;\n\t\t\t\t};\n\t\t\t\ttry {\n\t\t\t\t\t(function (d, s, id) {\n\t\t\t\t\t\tvar js, fjs = d.getElementsByTagName(s)[0];\n\t\t\t\t\t\tif (d.getElementById(id)) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tjs = d.createElement(s);\n\t\t\t\t\t\tjs.id = id;\n\t\t\t\t\t\tjs.src = '//connect.facebook.net/' + environment.language.culture + '/sdk.js';\n\t\t\t\t\t\tfjs.parentNode.insertBefore(js, fjs);\n\t\t\t\t\t}(document, 'script', 'facebook-jssdk'));\n\t\t\t\t} catch (error) {\n\t\t\t\t\tpromise.reject(error);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Animate', [function () {\n\n\t\tfunction Animate(callback) {\n\t\t\tthis.callback = callback;\n\t\t\tthis.key = null;\n\t\t\tthis.ticks = 0;\n\t\t}\n\n\t\tvar statics = {};\n\n\t\tvar methods = {\n\t\t\tpause: pause,\n\t\t\tplay: play,\n\t\t\ttoggle: toggle,\n\t\t};\n\n\t\tangular.extend(Animate, statics);\n\t\tangular.extend(Animate.prototype, methods);\n\n\t\treturn Animate;\n\n\t\t// static methods\n\n\t\t// prototype methods\n\n\t\tfunction pause() {\n\t\t\tvar animate = this;\n\t\t\tif (animate.key) {\n\t\t\t\twindow.cancelAnimationFrame(animate.key);\n\t\t\t\tanimate.key = null;\n\t\t\t}\n\t\t}\n\n\t\tfunction play() {\n\t\t\tvar animate = this;\n\n\t\t\tfunction loop(time) {\n\t\t\t\tanimate.ticks++;\n\t\t\t\tanimate.callback(time, animate.ticks);\n\t\t\t\tanimate.key = window.requestAnimationFrame(loop);\n\t\t\t}\n\t\t\tif (!animate.key) {\n\t\t\t\tloop();\n\t\t\t}\n\t\t}\n\n\t\tfunction toggle() {\n\t\t\tvar animate = this;\n\t\t\tif (animate.key) {\n\t\t\t\tanimate.pause();\n\t\t\t} else {\n\t\t\t\tanimate.play();\n\t\t\t}\n\t\t}\n\n    }]);\n\n\t(function () {\n\t\tvar lastTime = 0;\n\t\tvar vendors = ['ms', 'moz', 'webkit', 'o'];\n\t\tfor (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n\t\t\twindow.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\n\t\t\twindow.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] ||\n\t\t\t\twindow[vendors[x] + 'CancelRequestAnimationFrame'];\n\t\t}\n\t\tif (!window.requestAnimationFrame) {\n\t\t\twindow.requestAnimationFrame = function (callback, element) {\n\t\t\t\tvar currTime = new Date().getTime();\n\t\t\t\tvar timeToCall = Math.max(0, 16 - (currTime - lastTime));\n\t\t\t\tvar id = window.setTimeout(function () {\n\t\t\t\t\tcallback(currTime + timeToCall);\n\t\t\t\t}, timeToCall);\n\t\t\t\tlastTime = currTime + timeToCall;\n\t\t\t\treturn id;\n\t\t\t};\n\t\t}\n\t\tif (!window.cancelAnimationFrame) {\n\t\t\twindow.cancelAnimationFrame = function (id) {\n\t\t\t\tclearTimeout(id);\n\t\t\t};\n\t\t}\n\t}());\n\n}());\n/*\n// handle transition on resizing\nvar resizingTimeout;\n$(window).on('resize', function () {\n    clearTimeout(resizingTimeout);\n    $('body').addClass('resizing');\n    resizingTimeout = setTimeout(function () {\n        $('body').removeClass('resizing');\n    }, 100);\n})\n*/\n\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.service('Dom', ['Point', 'Rect', function (Point, Rect) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\tgetBoundRect: getBoundRect,\n\t\t\tgetClosest: getClosest,\n\t\t\tgetClosestNode: getClosestNode,\n\t\t\tgetDelta: getDelta,\n\t\t\tgetDocumentNode: getDocumentNode,\n\t\t\tgetElement: getElement,\n\t\t\tgetNode: getNode,\n\t\t\tgetNodeOffset: getNodeOffset,\n\t\t\tgetPageScroll: getPageScroll,\n\t\t\tgetParents: getParents,\n\t\t\tgetView: getView,\n\t\t\tgetPointInView: getPointInView,\n\t\t\tcompileController: compileController,\n\t\t\tdownloadFile: downloadFile,\n\t\t\tua: getUA(),\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\t// return node element BoundingClientRect\n\t\tfunction getBoundRect(node) {\n\t\t\tnode = getNode(node);\n\t\t\tif (node === window) {\n\t\t\t\tnode = getDocumentNode();\n\t\t\t}\n\t\t\tvar rect = node.getBoundingClientRect();\n\t\t\treturn rect;\n\t\t}\n\n\t\t// return closest parent node that match a selector\n\t\tfunction getClosest(node, selector) {\n\t\t\tvar matchesFn, parent;\n            ['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector', 'oMatchesSelector'].some(function (fn) {\n\t\t\t\tif (typeof document.body[fn] == 'function') {\n\t\t\t\t\tmatchesFn = fn;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t\tif (node[matchesFn](selector)) {\n\t\t\t\treturn node;\n\t\t\t}\n\t\t\twhile (node !== null) {\n\t\t\t\tparent = node.parentElement;\n\t\t\t\tif (parent !== null && parent[matchesFn](selector)) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tnode = parent;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\t// return closest parent node that math a target node\n\t\tfunction getClosestNode(node, target) {\n\t\t\tvar parent = null;\n\t\t\tif (node === target) {\n\t\t\t\treturn node;\n\t\t\t}\n\t\t\twhile (node !== null) {\n\t\t\t\tparent = node.parentElement;\n\t\t\t\tif (parent !== null && parent === target) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tnode = parent;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\t// return wheel delta\n\t\tfunction getDelta(event) {\n\t\t\tvar original = event.originalEvent ? event.originalEvent : event;\n\t\t\tvar type = original.type;\n\t\t\tvar delta = null;\n\t\t\tif (type === 'wheel' || type === 'mousewheel' || type === 'DOMMouseScroll') {\n\t\t\t\tvar deltaX = original.deltaX || original.wheelDeltaX;\n\t\t\t\tvar deltaY = original.deltaY || original.wheelDeltaY;\n\t\t\t\tdelta = new Point(deltaX, deltaY);\n\t\t\t\tif (Math.abs(deltaX) > Math.abs(deltaY)) {\n\t\t\t\t\tdelta.dir = deltaX < 0 ? 1 : -1;\n\t\t\t\t} else {\n\t\t\t\t\tdelta.dir = deltaY < 0 ? 1 : -1;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn delta;\n\t\t}\n\n\t\t// return document element node\n\t\tfunction getDocumentNode() {\n\t\t\tvar documentNode = (document.documentElement || document.body.parentNode || document.body);\n\t\t\treturn documentNode;\n\t\t}\n\n\t\t// return an angular element\n\t\tfunction getElement(element) {\n\t\t\treturn angular.isArray(element) ? element : angular.element(element);\n\t\t}\n\n\t\t// return a native html node\n\t\tfunction getNode(element) {\n\t\t\treturn angular.isArray(element) ? element[0] : element;\n\t\t}\n\n\t\t// return a node offset point\n\t\tfunction getNodeOffset(node) {\n\t\t\tvar offset = new Point();\n\t\t\tnode = getNode(node);\n\t\t\tif (node && node.nodeType === 1) {\n\t\t\t\toffset.x = node.offsetLeft;\n\t\t\t\toffset.y = node.offsetTop;\n\t\t\t}\n\t\t\treturn offset;\n\t\t}\n\n\t\t// return the current page scroll\n\t\tfunction getPageScroll() {\n\t\t\tvar scroll = new Point();\n\t\t\tvar documentNode = getDocumentNode();\n\t\t\tscroll.x = window.pageXOffset || documentNode.scrollLeft;\n\t\t\tscroll.y = window.pageYOffset || documentNode.scrollTop;\n\t\t\treturn scroll;\n\t\t}\n\n\t\t// return an array of node parants\n\t\tfunction getParents(node, topParentNode) {\n\t\t\t// if no topParentNode defined will bubble up all the way to *document*\n\t\t\ttopParentNode = topParentNode || getDocumentNode();\n\t\t\tvar parents = [];\n\t\t\tif (node) {\n\t\t\t\tparents.push(node);\n\t\t\t\tvar parentNode = node.parentNode;\n\t\t\t\twhile (parentNode !== topParentNode) {\n\t\t\t\t\tparents.push(parentNode);\n\t\t\t\t\tparentNode = parentNode.parentNode;\n\t\t\t\t}\n\t\t\t\tparents.push(topParentNode); // push that topParentNode you wanted to stop at\n\t\t\t}\n\t\t\treturn parents;\n\t\t}\n\n\t\t// return the view rect\n\t\tfunction getView() {\n\t\t\tvar view = new Rect();\n\t\t\tif (window.innerWidth !== undefined) {\n\t\t\t\tview.width = window.innerWidth;\n\t\t\t\tview.height = window.innerHeight;\n\t\t\t} else {\n\t\t\t\tvar documentNode = getDocumentNode();\n\t\t\t\tview.width = documentNode.clientWidth;\n\t\t\t\tview.height = documentNode.clientHeight;\n\t\t\t}\n\t\t\treturn view;\n\t\t}\n\n\t\t// add to constant\n\t\tvar MOUSE_EVENTS = ['click', 'mousedown', 'mouseup', 'mousemove', 'mouseover', 'mouseout', 'mouseenter', 'mouseleave', 'contextmenu'];\n\t\tvar TOUCH_EVENTS = ['touchstart', 'touchmove', 'touchend', 'touchcancel'];\n\n\t\tfunction getPointInView(event) {\n\t\t\tvar original = event.originalEvent ? event.originalEvent : event;\n\t\t\tvar type = original.type;\n\t\t\tvar point = null;\n\t\t\tif (TOUCH_EVENTS.indexOf(type) !== -1) {\n\t\t\t\tvar touch = null;\n\t\t\t\tvar touches = original.touches.length ? original.touches : original.changedTouches;\n\t\t\t\tif (touches && touches.length) {\n\t\t\t\t\ttouch = touches[0];\n\t\t\t\t}\n\t\t\t\tif (touch) {\n\t\t\t\t\tpoint = new Point();\n\t\t\t\t\tpoint.x = touch.pageX;\n\t\t\t\t\tpoint.y = touch.pageY;\n\t\t\t\t}\n\t\t\t} else if (MOUSE_EVENTS.indexOf(type) !== -1) {\n\t\t\t\tpoint = new Point();\n\t\t\t\tpoint.x = original.pageX;\n\t\t\t\tpoint.y = original.pageY;\n\t\t\t}\n\t\t\treturn point;\n\t\t}\n\n\t\tfunction getUA() {\n\t\t\tvar agent = window.navigator.userAgent.toLowerCase();\n\t\t\tvar safari = agent.indexOf('safari') !== -1 && agent.indexOf('chrome') === -1;\n\t\t\tvar msie = agent.indexOf('trident') !== -1 || agent.indexOf('edge') !== -1 || agent.indexOf('msie') !== -1;\n\t\t\tvar chrome = !safari && !msie && agent.indexOf('chrome') !== -1;\n\t\t\tvar mobile = agent.indexOf('mobile') !== -1;\n\t\t\tvar mac = agent.indexOf('macintosh') !== -1;\n\t\t\tvar ua = {\n\t\t\t\tagent: agent,\n\t\t\t\tsafari: safari,\n\t\t\t\tmsie: msie,\n\t\t\t\tchrome: chrome,\n\t\t\t\tmobile: mobile,\n\t\t\t\tmac: mac,\n\t\t\t};\n\t\t\tangular.forEach(ua, function (value, key) {\n\t\t\t\tif (value) {\n\t\t\t\t\tangular.element(document.getElementsByTagName('body')).addClass(key);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ua;\n\t\t}\n\n\t\t/*\n    function mobilecheck() {\n        var check = false;\n        (function(a) { if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4))) check = true; })(navigator.userAgent || navigator.vendor || window.opera);\n        return check;\n    }\n\n    // For those wishing to include tablets in this test (though arguably, you shouldn't), you can use the following function:\n    function mobileAndTabletcheck() {\n        var check = false;\n        (function(a) { if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4))) check = true; })(navigator.userAgent || navigator.vendor || window.opera);\n        return check;\n    }\n\n    var isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n    var isMobile = mobilecheck();\n    var isMobileAndTabled = mobileAndTabletcheck();\n\t\t*/\n\n\t\tfunction compileController(scope, element, html, data) {\n\t\t\t// console.log('Dom.compileController', element);\n\t\t\telement = getElement(element);\n\t\t\telement.html(html);\n\t\t\tvar link = $compile(element.contents());\n\t\t\tif (data.controller) {\n\t\t\t\tvar $scope = scope.$new();\n\t\t\t\tangular.extend($scope, data);\n\t\t\t\tvar controller = $controller(data.controller, {\n\t\t\t\t\t$scope: $scope\n\t\t\t\t});\n\t\t\t\tif (data.controllerAs) {\n\t\t\t\t\tscope[data.controllerAs] = controller;\n\t\t\t\t}\n\t\t\t\telement.data('$ngControllerController', controller);\n\t\t\t\telement.children().data('$ngControllerController', controller);\n\t\t\t\tscope = $scope;\n\t\t\t}\n\t\t\tlink(scope);\n\t\t}\n\n\t\tfunction downloadFile(content, name, type) {\n\t\t\ttype = type || 'application/octet-stream';\n\t\t\tvar base64 = null;\n\t\t\tvar blob = new Blob([content], {\n\t\t\t\ttype: type\n\t\t\t});\n\t\t\tvar reader = new window.FileReader();\n\t\t\treader.readAsDataURL(blob);\n\t\t\treader.onloadend = function () {\n\t\t\t\tbase64 = reader.result;\n\t\t\t\tdownload();\n\t\t\t};\n\n\t\t\tfunction download() {\n\t\t\t\tif (document.createEvent) {\n\t\t\t\t\tvar anchor = document.createElement('a');\n\t\t\t\t\tanchor.href = base64;\n\t\t\t\t\tif (anchor.download !== undefined) {\n\t\t\t\t\t\tvar downloadName = name || base64.substring(base64.lastIndexOf('/') + 1, base64.length);\n\t\t\t\t\t\tanchor.download = downloadName;\n\t\t\t\t\t}\n\t\t\t\t\tvar event = document.createEvent('MouseEvents');\n\t\t\t\t\tevent.initEvent('click', true, true);\n\t\t\t\t\tanchor.dispatchEvent(event);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tvar query = '?download';\n\t\t\t\twindow.open(base64.indexOf('?') > -1 ? base64 : base64 + query, '_self');\n\t\t\t}\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Event', ['EventsService', 'Dom', 'Point', 'Rect', function (EventsService, Dom, Point, Rect) {\n\n\t\tfunction Event(event, element) {\n\t\t\ttry {\n\t\t\t\tevent = event || window.event;\n\t\t\t\tvar type = event.type;\n\t\t\t\tvar originalEvent = event.originalEvent ? event.originalEvent : event;\n\t\t\t\tvar node = element[0]; // Dom.getNode(element);\n\t\t\t\tvar offset = Dom.getNodeOffset(node);\n\t\t\t\tvar rect = Dom.getBoundRect(node);\n\t\t\t\tvar view = Dom.getView();\n\t\t\t\tvar scroll = Dom.getPageScroll();\n\t\t\t\tvar point = Dom.getPointInView(event);\n\t\t\t\tif (point) {\n\t\t\t\t\tvar absolute = new Point(point.x - scroll.x, point.y - scroll.y);\n\t\t\t\t\tvar relative = new Point(absolute.x - rect.left, absolute.y - rect.top);\n\t\t\t\t\tthis.point = point;\n\t\t\t\t\tthis.absolute = absolute;\n\t\t\t\t\tthis.relative = relative;\n\t\t\t\t}\n\t\t\t\tvar delta = Dom.getDelta(event);\n\t\t\t\tif (delta) {\n\t\t\t\t\tthis.delta = delta;\n\t\t\t\t\tthis.dir = delta.dir;\n\t\t\t\t}\n\t\t\t\tthis.event = event;\n\t\t\t\tthis.type = type;\n\t\t\t\tthis.originalEvent = originalEvent;\n\t\t\t\tthis.element = element;\n\t\t\t\tthis.node = node;\n\t\t\t\tthis.offset = offset;\n\t\t\t\tthis.rect = rect;\n\t\t\t\tthis.view = view;\n\t\t\t\tthis.scroll = scroll;\n\t\t\t\tthis.timestamp = new Date().getTime();\n\t\t\t} catch (error) {\n\t\t\t\tconsole.log('Event.error', error);\n\t\t\t}\n\t\t}\n\n\t\tvar methods = {\n\t\t\tstop: stop,\n\t\t};\n\n\t\tvar statics = {};\n\n\t\tangular.extend(Event.prototype, methods);\n\t\tangular.extend(Event, statics);\n\t\treturn Event;\n\n\t\t// prototype methods\n\n\t\tfunction stop() {\n\t\t\tthis.event.stopPropagation();\n\t\t\tthis.event.preventDefault();\n\t\t}\n\n\t}]);\n\n\tapp.factory('Events', ['EventsService', 'Event', 'Dom', function (EventsService, Event, Dom) {\n\n\t\tfunction Events(element) {\n\t\t\tvar events = this;\n\n\t\t\tthis.element = Dom.getElement(element);\n\t\t\tthis.listeners = {};\n\t\t\tthis.standardEvents = {\n\t\t\t\tclick: {\n\t\t\t\t\tkey: 'click',\n\t\t\t\t\tcallback: onClick\n\t\t\t\t},\n\t\t\t\tdown: {\n\t\t\t\t\tkey: 'mousedown',\n\t\t\t\t\tcallback: onMouseDown\n\t\t\t\t},\n\t\t\t\tmove: {\n\t\t\t\t\tkey: 'mousemove',\n\t\t\t\t\tcallback: onMouseMove\n\t\t\t\t},\n\t\t\t\tup: {\n\t\t\t\t\tkey: 'mouseup',\n\t\t\t\t\tcallback: onMouseUp\n\t\t\t\t},\n\t\t\t\tresize: {\n\t\t\t\t\tkey: 'resize',\n\t\t\t\t\tcallback: onResize\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.touchEvents = {\n\t\t\t\tdown: {\n\t\t\t\t\tkey: 'touchstart',\n\t\t\t\t\tcallback: onTouchStart\n\t\t\t\t},\n\t\t\t\tmove: {\n\t\t\t\t\tkey: 'touchmove',\n\t\t\t\t\tcallback: onTouchMove\n\t\t\t\t},\n\t\t\t\tup: {\n\t\t\t\t\tkey: 'touchend',\n\t\t\t\t\tcallback: onTouchEnd\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.wheelEvents = {\n\t\t\t\twheel: {\n\t\t\t\t\tkey: 'mousewheel',\n\t\t\t\t\tcallback: onMouseWheel\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.scrollEvents = {\n\t\t\t\twheel: {\n\t\t\t\t\tkey: 'DOMMouseScroll',\n\t\t\t\t\tcallback: onMouseScroll\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.timestamp = new Date().getTime();\n\t\t\tthis.setTimestamp = setTimestamp;\n\n\t\t\tfunction setTimestamp(event) {\n\t\t\t\tif (event) {\n\t\t\t\t\tevent.interval = Math.min(250, event.timestamp - events.timestamp);\n\t\t\t\t\t// console.log(event.interval, event.timestamp, events.timestamp);\n\t\t\t\t}\n\t\t\t\tevents.timestamp = new Date().getTime();\n\t\t\t}\n\n\t\t\tfunction onClick(e) {\n\t\t\t\t// console.log('onClick', e, events);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.click.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onMouseDown(e) {\n\t\t\t\t// console.log('onMouseDown', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.down.apply(this, [event]);\n\t\t\t\tevents.removeTouchEvents();\n\t\t\t}\n\n\t\t\tfunction onMouseMove(e) {\n\t\t\t\t// console.log('onMouseMove', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.move.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onMouseUp(e) {\n\t\t\t\t// console.log('onMouseUp', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.up.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onMouseWheel(e) {\n\t\t\t\t// console.log('onMouseWheel', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.wheel.apply(this, [event]);\n\t\t\t\tevents.removeScrollEvents();\n\t\t\t}\n\n\t\t\tfunction onMouseScroll(e) {\n\t\t\t\t// console.log('onMouseScroll', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.wheel.apply(this, [event]);\n\t\t\t\tevents.removeWheelEvents();\n\t\t\t}\n\n\t\t\tfunction onResize(e) {\n\t\t\t\t// console.log('onResize', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.resize.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onTouchStart(e) {\n\t\t\t\t// console.log('onTouchStart', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.down.apply(this, [event]);\n\t\t\t\tevents.removeStandardEvents();\n\t\t\t}\n\n\t\t\tfunction onTouchMove(e) {\n\t\t\t\t// console.log('onTouchMove', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.move.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onTouchEnd(e) {\n\t\t\t\t// console.log('onTouchEnd', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.setTimestamp(event);\n\t\t\t\tevents.listeners.up.apply(this, [event]);\n\t\t\t}\n\t\t}\n\n\t\tvar methods = {\n\t\t\tadd: add,\n\t\t\tremove: remove,\n\t\t\tremoveStandardEvents: removeStandardEvents,\n\t\t\tremoveTouchEvents: removeTouchEvents,\n\t\t\tremoveWheelEvents: removeWheelEvents,\n\t\t\tremoveScrollEvents: removeScrollEvents,\n\t\t};\n\n\t\tvar statics = {\n\t\t\tgetTouch: getTouch,\n\t\t\tgetRelativeTouch: getRelativeTouch,\n\t\t};\n\n\t\tangular.extend(Events.prototype, methods);\n\t\tangular.extend(Events, statics);\n\t\treturn Events;\n\n\t\t// prototype methods\n\n\t\tfunction add(listeners, scope) {\n\t\t\tvar events = this,\n\t\t\t\tstandard = this.standardEvents,\n\t\t\t\ttouch = this.touchEvents,\n\t\t\t\twheel = this.wheelEvents,\n\t\t\t\tscroll = this.scrollEvents;\n\t\t\tvar element = this.element,\n\t\t\t\twindowElement = angular.element(window);\n\n\t\t\tangular.forEach(listeners, function (callback, key) {\n\t\t\t\tif (events.listeners[key]) {\n\t\t\t\t\tvar listener = {};\n\t\t\t\t\tlistener[key] = events.listeners[key];\n\t\t\t\t\tremove(listener);\n\t\t\t\t}\n\t\t\t\tevents.listeners[key] = callback;\n\t\t\t\tif (standard[key]) {\n\t\t\t\t\tif (key === 'resize') {\n\t\t\t\t\t\twindowElement.on(standard[key].key, standard[key].callback);\n\t\t\t\t\t} else {\n\t\t\t\t\t\telement.on(standard[key].key, standard[key].callback);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (touch[key]) {\n\t\t\t\t\telement.on(touch[key].key, touch[key].callback);\n\t\t\t\t}\n\t\t\t\tif (wheel[key]) {\n\t\t\t\t\telement.on(wheel[key].key, wheel[key].callback);\n\t\t\t\t}\n\t\t\t\tif (scroll[key]) {\n\t\t\t\t\telement.on(scroll[key].key, scroll[key].callback);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (scope) {\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tevents.remove(listeners);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn events;\n\t\t}\n\n\t\tfunction remove(listeners) {\n\t\t\tvar events = this,\n\t\t\t\tstandard = this.standardEvents,\n\t\t\t\ttouch = this.touchEvents,\n\t\t\t\twheel = this.wheelEvents,\n\t\t\t\tscroll = this.scrollEvents;\n\t\t\tvar element = this.element,\n\t\t\t\twindowElement = angular.element(window);\n\t\t\tangular.forEach(listeners, function (callback, key) {\n\t\t\t\tif (standard[key]) {\n\t\t\t\t\tif (key === 'resize') {\n\t\t\t\t\t\twindowElement.off(standard[key].key, standard[key].callback);\n\t\t\t\t\t} else {\n\t\t\t\t\t\telement.off(standard[key].key, standard[key].callback);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (touch[key]) {\n\t\t\t\t\telement.off(touch[key].key, touch[key].callback);\n\t\t\t\t}\n\t\t\t\tif (wheel[key]) {\n\t\t\t\t\telement.off(wheel[key].key, wheel[key].callback);\n\t\t\t\t}\n\t\t\t\tif (scroll[key]) {\n\t\t\t\t\telement.off(scroll[key].key, scroll[key].callback);\n\t\t\t\t}\n\t\t\t\tevents.listeners[key] = null;\n\t\t\t});\n\t\t\treturn events;\n\t\t}\n\n\t\tfunction removeStandardEvents() {\n\t\t\tvar events = this,\n\t\t\t\tstandard = events.standardEvents,\n\t\t\t\ttouch = events.touchEvents;\n\t\t\tvar element = events.element;\n\t\t\telement.off('mousedown', standard.down.callback);\n\t\t\telement.off('mousemove', standard.move.callback);\n\t\t\telement.off('mouseup', standard.up.callback);\n\t\t}\n\n\t\tfunction removeTouchEvents() {\n\t\t\tvar events = this,\n\t\t\t\tstandard = events.standardEvents,\n\t\t\t\ttouch = events.touchEvents;\n\t\t\tvar element = events.element;\n\t\t\telement.off('touchstart', touch.down.callback);\n\t\t\telement.off('touchmove', touch.move.callback);\n\t\t\telement.off('touchend', touch.up.callback);\n\t\t}\n\n\t\tfunction removeWheelEvents() {\n\t\t\tvar events = this;\n\t\t\tvar element = events.element;\n\t\t\telement.off('mousewheel', events.mouseEvents.wheel.callback);\n\t\t}\n\n\t\tfunction removeScrollEvents() {\n\t\t\tvar events = this;\n\t\t\tvar element = events.element;\n\t\t\telement.off('DOMMouseScroll', events.scrollEvents.wheel.callback);\n\t\t}\n\n\t\t// statics methods\n\n\t\tfunction getTouch(e, previous) {\n\t\t\tvar point = new Point();\n\t\t\tif (e.type === 'touchstart' || e.type === 'touchmove' || e.type === 'touchend' || e.type === 'touchcancel') {\n\t\t\t\tvar touch = null;\n\t\t\t\tvar event = e.originalEvent ? e.originalEvent : e;\n\t\t\t\tvar touches = event.touches.length ? event.touches : event.changedTouches;\n\t\t\t\tif (touches && touches.length) {\n\t\t\t\t\ttouch = touches[0];\n\t\t\t\t}\n\t\t\t\tif (touch) {\n\t\t\t\t\tpoint.x = touch.pageX;\n\t\t\t\t\tpoint.y = touch.pageY;\n\t\t\t\t}\n\t\t\t} else if (e.type === 'click' || e.type === 'mousedown' || e.type === 'mouseup' || e.type === 'mousemove' || e.type === 'mouseover' || e.type === 'mouseout' || e.type === 'mouseenter' || e.type === 'mouseleave' || e.type === 'contextmenu') {\n\t\t\t\tpoint.x = e.pageX;\n\t\t\t\tpoint.y = e.pageY;\n\t\t\t}\n\t\t\tif (previous) {\n\t\t\t\tpoint.s = Point.difference(t, previous);\n\t\t\t}\n\t\t\tpoint.type = e.type;\n\t\t\treturn point;\n\t\t}\n\n\t\tfunction getRelativeTouch(node, point) {\n\t\t\tnode = angular.isArray(node) ? node[0] : node;\n\t\t\treturn Point.difference(point, {\n\t\t\t\tx: node.offsetLeft,\n\t\t\t\ty: node.offsetTop\n\t\t\t});\n\t\t}\n\n    }]);\n\n\tapp.service('EventsService', ['Dom', function (Dom) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\thasPassiveEvents: hasPassiveEvents,\n\t\t\taddEventListener: getAddEventListener(),\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\t// prevent history back on mac os\n\n\t\tpreventHistoryNavigation();\n\n\t\t// static methods\n\n\t\tfunction hasPassiveEvents() {\n\t\t\tvar supported = false;\n\t\t\tif (window.addEventListener) {\n\t\t\t\ttry {\n\t\t\t\t\tvar options = Object.defineProperty({}, 'passive', {\n\t\t\t\t\t\tget: function () {\n\t\t\t\t\t\t\tsupported = true;\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\twindow.addEventListener('test', null, options);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log('getAddEventListener.isSupprted', e);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn supported;\n\t\t}\n\n\t\tfunction getAddEventListener() {\n\t\t\tvar supported = hasPassiveEvents();\n\t\t\tif (!supported) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar defaults = {\n\t\t\t\tpassive: false,\n\t\t\t\tcapture: false,\n\t\t\t};\n\n\t\t\tfunction getModifiedAddEventListener(original) {\n\t\t\t\tfunction addEventListener(type, listener, options) {\n\t\t\t\t\tif (typeof options !== 'object') {\n\t\t\t\t\t\tvar capture = options === true;\n\t\t\t\t\t\toptions = angular.copy(defaults);\n\t\t\t\t\t\toptions.capture = capture;\n\t\t\t\t\t} else {\n\t\t\t\t\t\toptions = angular.extend(angular.copy(defaults), options);\n\t\t\t\t\t}\n\t\t\t\t\toriginal.call(this, type, listener, options);\n\t\t\t\t}\n\t\t\t\treturn addEventListener;\n\t\t\t}\n\n\t\t\tvar original = EventTarget.prototype.addEventListener;\n\t\t\tvar modified = getModifiedAddEventListener(original);\n\t\t\tEventTarget.prototype.addEventListener = modified;\n\t\t\treturn modified;\n\t\t}\n\n\t\tfunction preventHistoryNavigation() {\n\t\t\tif (!Dom.ua.mac) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (Dom.ua.chrome || Dom.ua.safari || Dom.ua.firefox) {\n\t\t\t\twindow.addEventListener('mousewheel', onScroll, {\n\t\t\t\t\tpassive: false\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction onScroll(e) {\n\t\t\t\tif (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\t(e.deltaX < 0 && (Dom.getParents(e.target).filter(function (node) {\n\t\t\t\t\t\treturn node.scrollLeft > 0;\n\t\t\t\t\t}).length === 0)) ||\n\t\t\t\t\t(e.deltaX > 0 && (Dom.getParents(e.target).filter(function (node) {\n\t\t\t\t\t\treturn node.scrollWidth - node.scrollLeft > node.clientWidth;\n\t\t\t\t\t}).length === 0))\n\t\t\t\t) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n    }]);\n\n}());\n/* global angular, app, Autolinker */\r\n(function () {\r\n\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.filter('notIn', ['$filter', function ($filter) {\r\n\r\n\t\treturn function (array, filters, element) {\r\n\t\t\tif (filters) {\r\n\t\t\t\treturn $filter(\"filter\")(array, function (item) {\r\n\t\t\t\t\tfor (var i = 0; i < filters.length; i++) {\r\n\t\t\t\t\t\tif (filters[i][element] === item[element]) return false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\r\n    }]);\r\n\r\n}());\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Point', [function () {\n\n\t\tfunction Point(x, y) {\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\t\t}\n\n\t\tvar statics = {\n\t\t\tdifference: PointDifference,\n\t\t\tmultiply: PointMultiply,\n\t\t};\n\n\t\tvar methods = {\n\t\t\tclone: clone,\n\t\t\tcopy: copy,\n\t\t\tdifference: difference,\n\t\t\tmult: mult,\n\t\t\toffset: offset,\n\t\t\tsetPos: setPos,\n\t\t\tsetX: setX,\n\t\t\tsetY: setY,\n\t\t\ttoString: toString,\n\t\t};\n\n\t\tangular.extend(Point, statics);\n\t\tangular.extend(Point.prototype, methods);\n\n\t\treturn Point;\n\n\t\t// static methods\n\n\t\tfunction PointDifference(a, b) {\n\t\t\treturn new Point(a.x - b.x, a.y - b.y);\n\t\t}\n\n\t\tfunction PointMultiply(point, value) {\n\t\t\tpoint.x *= value;\n\t\t\tpoint.y *= value;\n\t\t\treturn point;\n\t\t}\n\n\t\t// prototype methods\n\n\t\tfunction clone() {\n\t\t\treturn new Point(this.x, this.y);\n\t\t}\n\n\t\tfunction copy(point) {\n\t\t\tthis.x = point.x;\n\t\t\tthis.y = point.y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction difference(b) {\n\t\t\treturn PointDifference(this, b);\n\t\t}\n\n\t\tfunction mult(value) {\n\t\t\treturn PointMultiply(this, value);\n\t\t}\n\n\t\tfunction offset(x, y) {\n\t\t\tthis.x += x;\n\t\t\tthis.y += y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setPos(x, y) {\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setX(x) {\n\t\t\tthis.x = x;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setY(y) {\n\t\t\tthis.y = y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction toString() {\n\t\t\treturn '{' + this.x + ',' + this.y + '}';\n\t\t}\n\n    }]);\n\n}());\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Rect', [function () {\n\n\t\tfunction Rect(x, y, w, h) {\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\t\t\tthis.w = w || 0;\n\t\t\tthis.h = h || 0;\n\t\t}\n\n\t\tvar statics = {\n\t\t\tmult: RectMultiply,\n\t\t};\n\n\t\tvar methods = {\n\t\t\tbottom: bottom,\n\t\t\tbottomLeft: bottomLeft,\n\t\t\tbottomRight: bottomRight,\n\t\t\tcenter: center,\n\t\t\tclone: clone,\n\t\t\tcopy: copy,\n\t\t\texpand: expand,\n\t\t\texpandRect: expandRect,\n\t\t\tintersect: intersect,\n\t\t\tleft: left,\n\t\t\tmult: mult,\n\t\t\toffset: offset,\n\t\t\treduce: reduce,\n\t\t\treduceRect: reduceRect,\n\t\t\tright: right,\n\t\t\tsetH: setH,\n\t\t\tsetPos: setPos,\n\t\t\tsetSize: setSize,\n\t\t\tsetX: setX,\n\t\t\tsetY: setY,\n\t\t\tsetW: setW,\n\t\t\ttop: top,\n\t\t\ttopLeft: topLeft,\n\t\t\ttopRight: topRight,\n\t\t\ttoString: toString,\n\t\t};\n\n\t\tangular.extend(Rect, statics);\n\t\tangular.extend(Rect.prototype, methods);\n\n\t\treturn Rect;\n\n\t\t// static methods\n\n\t\tfunction RectMultiply(rect, value) {\n\t\t\trect.x *= value;\n\t\t\trect.y *= value;\n\t\t\trect.w *= value;\n\t\t\trect.h *= value;\n\t\t\treturn rect;\n\t\t}\n\n\t\t// prototype methods\n\n\t\tfunction bottom() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w / 2,\n\t\t\t\ty: y + h\n\t\t\t};\n\t\t}\n\n\t\tfunction bottomLeft() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x,\n\t\t\t\ty: y + h\n\t\t\t};\n\t\t}\n\n\t\tfunction bottomRight() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w,\n\t\t\t\ty: y + h\n\t\t\t};\n\t\t}\n\n\t\tfunction center() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w / 2,\n\t\t\t\ty: y + h / 2\n\t\t\t};\n\t\t}\n\n\t\tfunction clone() {\n\t\t\treturn new Rect(this.x, this.y, this.w, this.h);\n\t\t}\n\n\t\tfunction copy(rect) {\n\t\t\tthis.x = rect.x;\n\t\t\tthis.y = rect.y;\n\t\t\tthis.w = rect.w;\n\t\t\tthis.h = rect.h;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction expand(size) {\n\t\t\treturn this.expandRect({\n\t\t\t\tx: size,\n\t\t\t\ty: size,\n\t\t\t\tw: size * 2,\n\t\t\t\th: size * 2\n\t\t\t});\n\t\t}\n\n\t\tfunction expandRect(rect) {\n\t\t\tthis.x -= rect.x || 0;\n\t\t\tthis.y -= rect.y || 0;\n\t\t\tthis.w += rect.w || 0;\n\t\t\tthis.h += rect.h || 0;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction intersect(rect) {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn !(rect.x > x + w || rect.x + rect.w < x || rect.y > y + h || rect.y + rect.h < y);\n\t\t}\n\n\t\tfunction left() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x,\n\t\t\t\ty: y + h / 2\n\t\t\t};\n\t\t}\n\n\t\tfunction mult(value) {\n\t\t\treturn RectMultiply(this, value);\n\t\t}\n\n\t\tfunction offset(x, y) {\n\t\t\tthis.x += x;\n\t\t\tthis.y += y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction reduce(size) {\n\t\t\treturn this.offset(-size);\n\t\t}\n\n\t\tfunction reduceRect(rect) {\n\t\t\treturn this.offsetRect(RectMultiply(rect, -1));\n\t\t}\n\n\t\tfunction right() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w,\n\t\t\t\ty: y + h / 2\n\t\t\t};\n\t\t}\n\n\t\tfunction setH(h) {\n\t\t\tthis.h = h;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setPos(x, y) {\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setSize(w, h) {\n\t\t\tthis.w = w;\n\t\t\tthis.h = h;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setX(x) {\n\t\t\tthis.x = x;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setY(y) {\n\t\t\tthis.y = y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction setW(w) {\n\t\t\tthis.w = w;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction top() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w / 2,\n\t\t\t\ty: y\n\t\t\t};\n\t\t}\n\n\t\tfunction topLeft() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x,\n\t\t\t\ty: y\n\t\t\t};\n\t\t}\n\n\t\tfunction topRight() {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y,\n\t\t\t\tw = this.w,\n\t\t\t\th = this.h;\n\t\t\treturn {\n\t\t\t\tx: x + w,\n\t\t\t\ty: y\n\t\t\t};\n\t\t}\n\n\t\tfunction toString() {\n\t\t\treturn '{' + this.x + ',' + this.y + ',' + this.w + ',' + this.h + '}';\n\t\t}\n\n    }]);\n\n}());\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Vector', function () {\n\t\tfunction Vector(x, y) {\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\t\t}\n\n\t\tvar statics = {\n\t\t\tcross: VectorCross,\n\t\t\tdifference: VectorDifference,\n\t\t\tdistance: VectorDistance,\n\t\t\tincidence: VectorIncidence,\n\t\t\tmake: VectorMake,\n\t\t\tnormalize: VectorNormalize,\n\t\t\tpower: VectorPower,\n\t\t\tsize: VectorSize,\n\t\t};\n\n\t\tvar methods = {\n\t\t\tadd: add,\n\t\t\tcopy: copy,\n\t\t\tcross: cross,\n\t\t\tdifference: difference,\n\t\t\tdistance: distance,\n\t\t\tfriction: friction,\n\t\t\tincidence: incidence,\n\t\t\tnormalize: normalize,\n\t\t\tpower: power,\n\t\t\tsize: size,\n\t\t\ttowards: towards,\n\t\t\ttoString: toString,\n\t\t};\n\n\t\tangular.extend(Vector, statics);\n\t\tangular.extend(Vector.prototype, methods);\n\n\t\treturn Vector;\n\n\t\t// statics methods\n\n\t\tfunction VectorCross(a, b) {\n\t\t\treturn (a.x * b.y) - (a.y * b.x);\n\t\t}\n\n\t\tfunction VectorDifference(a, b) {\n\t\t\treturn new Vector(a.x - b.x, a.y - b.y);\n\t\t}\n\n\t\tfunction VectorDistance(a, b) {\n\t\t\treturn Math.sqrt((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));\n\t\t}\n\n\t\tfunction VectorIncidence(a, b) {\n\t\t\tvar angle = Math.atan2(b.y, b.x) - Math.atan2(a.y, a.x);\n\t\t\treturn angle;\n\t\t}\n\n\t\tfunction VectorMake(a, b) {\n\t\t\treturn new Vector(b.x - a.x, b.y - a.y);\n\t\t}\n\n\t\tfunction VectorNormalize(a) {\n\t\t\tvar l = Vector.size(a);\n\t\t\ta.x /= l;\n\t\t\ta.y /= l;\n\t\t\treturn a;\n\t\t}\n\n\t\tfunction VectorPower(a, b) {\n\t\t\tvar x = Math.abs(b.x - a.x);\n\t\t\tvar y = Math.abs(b.y - a.y);\n\t\t\treturn (x + y) / 2;\n\t\t}\n\n\t\tfunction VectorSize(a) {\n\t\t\treturn Math.sqrt(a.x * a.x + a.y * a.y);\n\t\t}\n\n\t\t// prototype methods\n\n\t\tfunction add(b) {\n\t\t\tthis.x += b.x;\n\t\t\tthis.y += b.y;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction copy(b) {\n\t\t\treturn new Vector(this.x, this.y);\n\t\t}\n\n\t\tfunction cross(b) {\n\t\t\treturn VectorCross(this, b);\n\t\t}\n\n\t\tfunction difference(b) {\n\t\t\treturn VectorDifference(this, b);\n\t\t}\n\n\t\tfunction distance(b) {\n\t\t\treturn VectorDistance(this, b);\n\t\t}\n\n\t\tfunction friction(b) {\n\t\t\tthis.x *= b;\n\t\t\tthis.y *= b;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction incidence(b) {\n\t\t\treturn VectorIncidence(this, b);\n\t\t}\n\n\t\tfunction normalize() {\n\t\t\treturn VectorNormalize(this);\n\t\t}\n\n\t\tfunction power() {\n\t\t\treturn (Math.abs(this.x) + Math.abs(this.y)) / 2;\n\t\t}\n\n\t\tfunction size() {\n\t\t\treturn VectorSize(this);\n\t\t}\n\n\t\tfunction towards(b, friction) {\n\t\t\tfriction = friction || 0.125;\n\t\t\tthis.x += (b.x - this.x) * friction;\n\t\t\tthis.y += (b.y - this.y) * friction;\n\t\t\treturn this;\n\t\t}\n\n\t\tfunction toString() {\n\t\t\treturn '{' + this.x + ',' + this.y + '}';\n\t\t}\n\n\t});\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Hash', [function () {\n\n\t\tfunction Hash(key, pool) {\n\t\t\tkey = key || 'id';\n\t\t\tpool = pool ? HashGet(pool) : {};\n\t\t\tObject.defineProperties(this, {\n\t\t\t\tkey: {\n\t\t\t\t\tvalue: key,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\twritable: false\n\t\t\t\t},\n\t\t\t\tpool: {\n\t\t\t\t\tvalue: pool,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\twritable: false\n\t\t\t\t},\n\t\t\t\tlength: {\n\t\t\t\t\tvalue: 0,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\twritable: true\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tvar pools = {};\n\n\t\tvar statics = {\n\t\t\tget: HashGet,\n\t\t};\n\n\t\tvar methods = {\n\t\t\thas: has,\n\t\t\tgetId: getId,\n\t\t\tget: get,\n\t\t\tset: set,\n\t\t\tadd: add,\n\t\t\tremove: remove,\n\t\t\teach: each,\n\t\t\taddMany: addMany,\n\t\t\tremoveMany: removeMany,\n\t\t\tremoveAll: removeAll,\n\t\t\tforward: forward,\n\t\t\tbackward: backward,\n\t\t\tdiffers: differs,\n\t\t\tupdatePool: updatePool,\n\t\t};\n\n\t\tHash.prototype = new Array;\n\n\t\tangular.extend(Hash, statics);\n\t\tangular.extend(Hash.prototype, methods);\n\n\t\treturn Hash;\n\n\t\t// static methods\n\n\t\tfunction HashGet(pool) {\n\t\t\treturn (pools[pool] = pools[pool] || {});\n\t\t}\n\n\t\tfunction has(id) {\n\t\t\treturn this.pool[id] !== undefined;\n\t\t}\n\n\t\tfunction getId(id) {\n\t\t\treturn this.pool[id];\n\t\t}\n\n\t\tfunction get(item) {\n\t\t\tvar hash = this,\n\t\t\t\tkey = this.key;\n\t\t\treturn item ? hash.getId(item[key]) : null;\n\t\t}\n\n\t\tfunction set(item) {\n\t\t\tvar hash = this,\n\t\t\t\tpool = this.pool,\n\t\t\t\tkey = this.key;\n\t\t\tpool[item[key]] = item;\n\t\t\thash.push(item);\n\t\t\treturn item;\n\t\t}\n\n\t\tfunction add(newItem) {\n\t\t\tvar hash = this;\n\t\t\tvar item = hash.get(newItem);\n\t\t\tif (item) {\n\t\t\t\tfor (var i = 0, keys = Object.keys(newItem), p; i < keys.length; i++) {\n\t\t\t\t\tp = keys[i];\n\t\t\t\t\titem[p] = newItem[p];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\titem = hash.set(newItem);\n\t\t\t}\n\t\t\treturn item;\n\t\t}\n\n\t\tfunction remove(oldItem) {\n\t\t\tvar hash = this,\n\t\t\t\tpool = this.pool,\n\t\t\t\tkey = this.key;\n\t\t\tvar item = hash.get(oldItem);\n\t\t\tif (item) {\n\t\t\t\tvar index = hash.indexOf(item);\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\thash.splice(index, 1);\n\t\t\t\t}\n\t\t\t\tdelete pool[item[key]];\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction addMany(items) {\n\t\t\tvar hash = this;\n\t\t\tif (!items) {\n\t\t\t\treturn hash;\n\t\t\t}\n\t\t\tvar i = 0;\n\t\t\twhile (i < items.length) {\n\t\t\t\thash.add(items[i]);\n\t\t\t\ti++;\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction removeMany(items) {\n\t\t\tvar hash = this;\n\t\t\tif (!items) {\n\t\t\t\treturn hash;\n\t\t\t}\n\t\t\tvar i = 0;\n\t\t\twhile (i < items.length) {\n\t\t\t\thash.remove(items[i]);\n\t\t\t\ti++;\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction removeAll() {\n\t\t\tvar hash = this,\n\t\t\t\tkey = hash.key,\n\t\t\t\tpool = hash.pool;\n\t\t\tvar i = 0,\n\t\t\t\tt = hash.length,\n\t\t\t\titem;\n\t\t\twhile (hash.length) {\n\t\t\t\titem = hash.shift();\n\t\t\t\tdelete pool[item[key]];\n\t\t\t\ti++;\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction each(callback) {\n\t\t\tvar hash = this;\n\t\t\tif (callback) {\n\t\t\t\tvar i = 0;\n\t\t\t\twhile (i < hash.length) {\n\t\t\t\t\tcallback(hash[i], i);\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction forward(key, reverse) {\n\t\t\tvar hash = this;\n\t\t\tkey = (key || this.key);\n\t\t\thash.sort(function (c, d) {\n\t\t\t\tvar a = reverse ? d : c;\n\t\t\t\tvar b = reverse ? c : d;\n\t\t\t\treturn a[key] - b[key];\n\t\t\t});\n\t\t\treturn hash;\n\t\t}\n\n\t\tfunction backward(key) {\n\t\t\treturn this.forward(key, true);\n\t\t}\n\n\t\tfunction differs(hash) {\n\t\t\tif (hash.key !== this.key || hash.length !== this.length) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tvar differs = false,\n\t\t\t\t\ti = 0,\n\t\t\t\t\tt = this.length,\n\t\t\t\t\tkey = this.key;\n\t\t\t\twhile (differs && i < t) {\n\t\t\t\t\tdiffers = this[i][key] !== hash[i][key];\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction updatePool() {\n\t\t\tvar hash = this,\n\t\t\t\tpool = this.pool,\n\t\t\t\tkey = this.key;\n\t\t\tObject.keys(pool).forEach(function (key) {\n\t\t\t\tdelete pool[key];\n\t\t\t});\n\t\t\tangular.forEach(hash, function (item) {\n\t\t\t\tpool[item[key]] = item;\n\t\t\t});\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('$promise', ['$q', function ($q) {\n\n\t\tfunction $promise(callback) {\n\t\t\tif (typeof callback !== 'function') {\n\t\t\t\tthrow ('promise resolve callback missing');\n\t\t\t}\n\t\t\tvar deferred = $q.defer();\n\t\t\tcallback(deferred);\n\t\t\treturn deferred.promise;\n\t\t}\n\n\t\tvar statics = {\n\t\t\tall: $promiseAll,\n\t\t};\n\n\t\tvar methods = {};\n\n\t\tangular.extend($promise, statics);\n\t\tangular.extend($promise.prototype, methods);\n\n\t\treturn $promise;\n\n\t\tfunction $promiseAll(promises) {\n\t\t\treturn $q.all(promises);\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('State', ['$timeout', function ($timeout) {\n\n\t\tfunction State() {\n\t\t\tthis.errors = [];\n\t\t\tthis.isReady = false;\n\t\t\tthis.idle();\n\t\t}\n\n\t\tvar DELAY = 2000;\n\n\t\tvar statics = {};\n\n\t\tvar methods = {\n\t\t\tbusy: busy,\n\t\t\tclasses: classes,\n\t\t\tenabled: enabled,\n\t\t\terror: error,\n\t\t\terrorMessage: errorMessage,\n\t\t\tidle: idle,\n\t\t\tlabels: labels,\n\t\t\tready: ready,\n\t\t\tsubmitClass: submitClass,\n\t\t\tsuccess: success,\n\t\t};\n\n\t\tangular.extend(State, statics);\n\t\tangular.extend(State.prototype, methods);\n\n\t\treturn State;\n\n\t\t// static methods\n\n\t\t// prototype methods\n\n\t\tfunction busy() {\n\t\t\tvar state = this;\n\t\t\tif (!state.isBusy) {\n\t\t\t\tstate.isBusy = true;\n\t\t\t\tstate.isError = false;\n\t\t\t\tstate.isErroring = false;\n\t\t\t\tstate.isSuccess = false;\n\t\t\t\tstate.isSuccessing = false;\n\t\t\t\tstate.errors = [];\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfunction classes(addons) {\n\t\t\tvar state = this,\n\t\t\t\tclasses = null;\n\t\t\tclasses = {\n\t\t\t\tready: state.isReady,\n\t\t\t\tbusy: state.isBusy,\n\t\t\t\tsuccessing: state.isSuccessing,\n\t\t\t\tsuccess: state.isSuccess,\n\t\t\t\terrorring: state.isErroring,\n\t\t\t\terror: state.isError,\n\t\t\t};\n\t\t\tif (addons) {\n\t\t\t\tangular.forEach(addons, function (value, key) {\n\t\t\t\t\tclasses[value] = classes[key];\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn classes;\n\t\t}\n\n\t\tfunction enabled() {\n\t\t\tvar state = this;\n\t\t\treturn !state.isBusy && !state.isErroring && !state.isSuccessing;\n\t\t}\n\n\t\tfunction error(error) {\n\t\t\tconsole.log('State.error', error);\n\t\t\tvar state = this;\n\t\t\tstate.isBusy = false;\n\t\t\tstate.isError = true;\n\t\t\tstate.isErroring = true;\n\t\t\tstate.isSuccess = false;\n\t\t\tstate.isSuccessing = false;\n\t\t\tstate.errors.push(error);\n\t\t\t$timeout(function () {\n\t\t\t\tstate.isErroring = false;\n\t\t\t}, DELAY);\n\t\t}\n\n\t\tfunction errorMessage() {\n\t\t\tvar state = this;\n\t\t\treturn state.isError ? state.errors[state.errors.length - 1] : null;\n\t\t}\n\n\t\tfunction idle() {\n\t\t\tvar state = this;\n\t\t\tstate.isBusy = false;\n\t\t\tstate.isError = false;\n\t\t\tstate.isErroring = false;\n\t\t\tstate.isSuccess = false;\n\t\t\tstate.isSuccessing = false;\n\t\t\tstate.button = null;\n\t\t\tstate.errors = [];\n\t\t}\n\n\t\tfunction labels(addons) {\n\t\t\tvar state = this;\n\t\t\tvar defaults = {\n\t\t\t\tready: 'submit',\n\t\t\t\tbusy: 'sending',\n\t\t\t\terror: 'error',\n\t\t\t\tsuccess: 'success',\n\t\t\t};\n\t\t\tif (addons) {\n\t\t\t\tangular.extend(defaults, addons);\n\t\t\t}\n\t\t\tvar label = defaults.ready;\n\t\t\tif (state.isBusy) {\n\t\t\t\tlabel = defaults.busy;\n\t\t\t} else if (state.isSuccess) {\n\t\t\t\tlabel = defaults.success;\n\t\t\t} else if (state.isError) {\n\t\t\t\tlabel = defaults.error;\n\t\t\t}\n\t\t\treturn label;\n\t\t}\n\n\t\tfunction ready() {\n\t\t\tvar state = this;\n\t\t\tstate.idle();\n\t\t\tstate.isReady = true;\n\t\t}\n\n\t\tfunction submitClass() {\n\t\t\tvar state = this;\n\t\t\treturn {\n\t\t\t\tbusy: state.isBusy,\n\t\t\t\tready: state.isReady,\n\t\t\t\tsuccessing: state.isSuccessing,\n\t\t\t\tsuccess: state.isSuccess,\n\t\t\t\terrorring: state.isErroring,\n\t\t\t\terror: state.isError,\n\t\t\t};\n\t\t}\n\n\t\tfunction success() {\n\t\t\tvar state = this;\n\t\t\tstate.isBusy = false;\n\t\t\tstate.isError = false;\n\t\t\tstate.isErroring = false;\n\t\t\tstate.isSuccess = true;\n\t\t\tstate.isSuccessing = true;\n\t\t\tstate.errors = [];\n\t\t\t$timeout(function () {\n\t\t\t\tstate.isSuccessing = false;\n\t\t\t}, DELAY);\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar transformProperty = detectTransformProperty();\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Style', [function () {\n\n\t\tfunction Style() {\n\t\t\tthis.props = {\n\t\t\t\tscale: 1,\n\t\t\t\thoverScale: 1,\n\t\t\t\tcurrentScale: 1,\n\t\t\t};\n\t\t}\n\n\t\tvar statics = {};\n\n\t\tvar methods = {\n\t\t\tset: set,\n\t\t\ttransform: transform,\n\t\t\ttransformOrigin: transformOrigin,\n\t\t};\n\n\t\tangular.extend(Style, statics);\n\t\tangular.extend(Style.prototype, methods);\n\n\t\treturn Style;\n\n\t\t// static methods\n\n\t\t// prototype methods\n\n\t\tfunction set(element) {\n\t\t\tvar styles = [];\n\t\t\tfor (var key in this) {\n\t\t\t\tif (key !== 'props') {\n\t\t\t\t\tstyles.push(key + ':' + this[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telement.style.cssText = styles.join(';') + ';';\n\t\t}\n\n\t\tfunction transform(transform) {\n\t\t\tthis[transformProperty] = transform;\n\t\t}\n\n\t\tfunction transformOrigin(x, y) {\n\t\t\tthis[transformProperty + '-origin-x'] = (Math.round(x * 1000) / 1000) + '%';\n\t\t\tthis[transformProperty + '-origin-y'] = (Math.round(y * 1000) / 1000) + '%';\n\t\t}\n\n    }]);\n\n\tfunction detectTransformProperty() {\n\t\tvar transformProperty = 'transform',\n\t\t\tsafariPropertyHack = 'webkitTransform';\n\t\tvar div = document.createElement(\"DIV\");\n\t\tif (typeof div.style[transformProperty] !== 'undefined') {\n            ['webkit', 'moz', 'o', 'ms'].every(function (prefix) {\n\t\t\t\tvar e = '-' + prefix + '-transform';\n\t\t\t\tif (typeof div.style[e] !== 'undefined') {\n\t\t\t\t\ttransformProperty = e;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t} else if (typeof div.style[safariPropertyHack] !== 'undefined') {\n\t\t\ttransformProperty = '-webkit-transform';\n\t\t} else {\n\t\t\ttransformProperty = undefined;\n\t\t}\n\t\treturn transformProperty;\n\t}\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.service('Utils', ['$compile', '$controller', 'Vector', function ($compile, $controller, Vector) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\tcompileController: compileController,\n\t\t\tformat: format,\n\t\t\tindexOf: indexOf,\n\t\t\treducer: reducer,\n\t\t\treducerAdder: reducerAdder,\n\t\t\treducerSetter: reducerSetter,\n\t\t\tremoveValue: removeValue,\n\t\t\treverseSortOn: reverseSortOn,\n\t\t\tthrottle: throttle,\n\t\t\ttoMd5: toMd5,\n\t\t\twhere: where,\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\tvar getNow = Date.now || function () {\n\t\t\treturn new Date().getTime();\n\t\t};\n\n\t\tfunction compileController(scope, element, html, data) {\n\t\t\t// console.log('Utils.compileController', element);\n\t\t\telement.html(html);\n\t\t\tvar link = $compile(element.contents());\n\t\t\tif (data.controller) {\n\t\t\t\tvar $scope = scope.$new();\n\t\t\t\tangular.extend($scope, data);\n\t\t\t\tvar controller = $controller(data.controller, {\n\t\t\t\t\t$scope: $scope\n\t\t\t\t});\n\t\t\t\tif (data.controllerAs) {\n\t\t\t\t\tscope[data.controllerAs] = controller;\n\t\t\t\t}\n\t\t\t\telement.data('$ngControllerController', controller);\n\t\t\t\telement.children().data('$ngControllerController', controller);\n\t\t\t\tscope = $scope;\n\t\t\t}\n\t\t\tlink(scope);\n\t\t}\n\n\t\tfunction format(string, prepend, expression) {\n\t\t\tstring = string || '';\n\t\t\tprepend = prepend || '';\n\t\t\tvar splitted = string.split(',');\n\t\t\tif (splitted.length > 1) {\n\t\t\t\tvar formatted = splitted.shift();\n\t\t\t\tangular.forEach(splitted, function (value, index) {\n\t\t\t\t\tif (expression) {\n\t\t\t\t\t\tformatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tformatted = formatted.split('{' + index + '}').join(prepend + value);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (expression) {\n\t\t\t\t\treturn '\\'' + formatted + '\\'';\n\t\t\t\t} else {\n\t\t\t\t\treturn formatted;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn prepend + string;\n\t\t\t}\n\t\t}\n\n\t\tfunction indexOf(array, object, key) {\n\t\t\tkey = key || 'id';\n\t\t\tvar index = -1;\n\t\t\tif (array) {\n\t\t\t\tvar i = 0,\n\t\t\t\t\tt = array.length;\n\t\t\t\twhile (i < t) {\n\t\t\t\t\tif (array[i] && array[i][key] === object[key]) {\n\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn index;\n\t\t}\n\n\t\tfunction reducer(o, key) {\n\t\t\treturn o[key];\n\t\t}\n\n\t\tfunction reducerAdder(o, key, value) {\n\t\t\tif (typeof key == 'string') {\n\t\t\t\treturn reducerAdder(o, key.split('.'), value);\n\t\t\t} else if (key.length == 1 && value !== undefined) {\n\t\t\t\treturn (o[key[0]] += value);\n\t\t\t} else if (key.length === 0) {\n\t\t\t\treturn o;\n\t\t\t} else {\n\t\t\t\treturn reducerAdder(o[key[0]], key.slice(1), value);\n\t\t\t}\n\t\t}\n\n\t\tfunction reducerSetter(o, key, value) {\n\t\t\tif (typeof key == 'string') {\n\t\t\t\treturn reducerSetter(o, key.split('.'), value);\n\t\t\t} else if (key.length == 1 && value !== undefined) {\n\t\t\t\treturn (o[key[0]] = value);\n\t\t\t} else if (key.length === 0) {\n\t\t\t\treturn o;\n\t\t\t} else {\n\t\t\t\treturn reducerSetter(o[key[0]], key.slice(1), value);\n\t\t\t}\n\t\t}\n\n\t\tfunction removeValue(array, value) {\n\t\t\tvar index = -1;\n\t\t\tif (array) {\n\t\t\t\tvar i = 0,\n\t\t\t\t\tt = array.length;\n\t\t\t\twhile (i < t) {\n\t\t\t\t\tif (array[i] === value) {\n\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (index !== -1) {\n\t\t\t\tarray.splice(index, 1);\n\t\t\t\treturn value;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\tfunction reverseSortOn(key) {\n\t\t\treturn function (a, b) {\n\t\t\t\tif (a[key] < b[key]) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\tif (a[key] > b[key]) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\t// a must be equal to b\n\t\t\t\treturn 0;\n\t\t\t};\n\t\t}\n\n\t\tfunction throttle(func, wait, options) {\n\t\t\t// Returns a function, that, when invoked, will only be triggered at most once\n\t\t\t// during a given window of time. Normally, the throttled function will run\n\t\t\t// as much as it can, without ever going more than once per `wait` duration;\n\t\t\t// but if you'd like to disable the execution on the leading edge, pass\n\t\t\t// `{leading: false}`. To disable execution on the trailing edge, ditto.\n\t\t\tvar context, args, result;\n\t\t\tvar timeout = null;\n\t\t\tvar previous = 0;\n\t\t\tif (!options) options = {};\n\t\t\tvar later = function () {\n\t\t\t\tprevious = options.leading === false ? 0 : getNow();\n\t\t\t\ttimeout = null;\n\t\t\t\tresult = func.apply(context, args);\n\t\t\t\tif (!timeout) context = args = null;\n\t\t\t};\n\t\t\treturn function () {\n\t\t\t\tvar now = getNow();\n\t\t\t\tif (!previous && options.leading === false) previous = now;\n\t\t\t\tvar remaining = wait - (now - previous);\n\t\t\t\tcontext = this;\n\t\t\t\targs = arguments;\n\t\t\t\tif (remaining <= 0 || remaining > wait) {\n\t\t\t\t\tif (timeout) {\n\t\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\t\ttimeout = null;\n\t\t\t\t\t}\n\t\t\t\t\tprevious = now;\n\t\t\t\t\tresult = func.apply(context, args);\n\t\t\t\t\tif (!timeout) context = args = null;\n\t\t\t\t} else if (!timeout && options.trailing !== false) {\n\t\t\t\t\ttimeout = setTimeout(later, remaining);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t};\n\t\t}\n\n\t\tfunction toMd5(string) {\n\t\t\t// return Md5.encode(string);\n\t\t}\n\n\t\tfunction where(array, query) {\n\t\t\tvar found = null;\n\t\t\tif (array) {\n\t\t\t\tangular.forEach(array, function (item) {\n\t\t\t\t\tvar has = true;\n\t\t\t\t\tangular.forEach(query, function (value, key) {\n\t\t\t\t\t\thas = has && item[key] === value;\n\t\t\t\t\t});\n\t\t\t\t\tif (has) {\n\t\t\t\t\t\tfound = item;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn found;\n\t\t}\n\n    }]);\n\n\t(function () {\n\t\t// POLYFILL Array.prototype.reduce\n\t\t// Production steps of ECMA-262, Edition 5, 15.4.4.21\n\t\t// Reference: http://es5.github.io/#x15.4.4.21\n\t\t// https://tc39.github.io/ecma262/#sec-array.prototype.reduce\n\t\tif (!Array.prototype.reduce) {\n\t\t\tObject.defineProperty(Array.prototype, 'reduce', {\n\t\t\t\tvalue: function (callback) { // , initialvalue\n\t\t\t\t\tif (this === null) {\n\t\t\t\t\t\tthrow new TypeError('Array.prototype.reduce called on null or undefined');\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof callback !== 'function') {\n\t\t\t\t\t\tthrow new TypeError(callback + ' is not a function');\n\t\t\t\t\t}\n\t\t\t\t\tvar o = Object(this);\n\t\t\t\t\tvar len = o.length >>> 0;\n\t\t\t\t\tvar k = 0;\n\t\t\t\t\tvar value;\n\t\t\t\t\tif (arguments.length == 2) {\n\t\t\t\t\t\tvalue = arguments[1];\n\t\t\t\t\t} else {\n\t\t\t\t\t\twhile (k < len && !(k in o)) {\n\t\t\t\t\t\t\tk++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (k >= len) {\n\t\t\t\t\t\t\tthrow new TypeError('Reduce of empty array with no initial value');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvalue = o[k++];\n\t\t\t\t\t}\n\t\t\t\t\twhile (k < len) {\n\t\t\t\t\t\tif (k in o) {\n\t\t\t\t\t\t\tvalue = callback(value, o[k], k, o);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tk++;\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}());\n\n}());\n/* global angular */\r\n\r\n(function () {\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.factory('Doc', ['Api', '$promise', function (Api, $promise) {\r\n\r\n\t\tfunction Doc(item) {\r\n\t\t\tif (item) {\r\n\t\t\t\tangular.extend(this, item);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar statics = {};\r\n\r\n\t\tvar methods = {};\r\n\r\n\t\tangular.extend(Doc, statics);\r\n\t\tangular.extend(Doc.prototype, methods);\r\n\r\n\t\treturn Doc;\r\n\r\n\t\t// static methods\r\n\r\n\t\t// prototype methods\r\n\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function () {\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.factory('View', ['Api', '$promise', '$location', '$routeParams', 'environment', 'Doc', function (Api, $promise, $location, $routeParams, environment, Doc) {\r\n\r\n\t\tfunction View(doc) {\r\n\t\t\tvar url = $location.path(),\r\n\t\t\t\tparams = $routeParams;\r\n\t\t\tvar view = {\r\n\t\t\t\tenvironment: environment,\r\n\t\t\t\troute: {\r\n\t\t\t\t\turl: url,\r\n\t\t\t\t\tparams: params,\r\n\t\t\t\t},\r\n\t\t\t\tdoc: doc,\r\n\t\t\t};\r\n\t\t\tangular.extend(this, view);\r\n\t\t}\r\n\r\n\t\tvar statics = {\r\n\t\t\tcurrent: ViewCurrent,\r\n\t\t};\r\n\r\n\t\tvar methods = {};\r\n\r\n\t\tangular.extend(View, statics);\r\n\t\tangular.extend(View.prototype, methods);\r\n\r\n\t\treturn View;\r\n\r\n\t\t// static methods\r\n\r\n\t\tfunction ViewCurrent() {\r\n\t\t\treturn $promise(function (promise) {\r\n\t\t\t\tvar url = $location.path();\r\n\t\t\t\tconsole.log('View.current', url);\r\n\t\t\t\tApi.docs.url(url).then(function (response) {\r\n\t\t\t\t\tvar doc = new Doc(response);\r\n\t\t\t\t\tvar view = new View(doc);\r\n\t\t\t\t\tpromise.resolve(view);\r\n\r\n\t\t\t\t}, function (error) {\r\n\t\t\t\t\tpromise.reject(error);\r\n\r\n\t\t\t\t});\r\n\t\t\t\t/*\r\n\t\t\t\tApi.navs.main().then(function(items) {\r\n\t\t\t\t    var doc = null,\r\n\t\t\t\t        url = $location.path(),\r\n\t\t\t\t        pool = getPool(items);\r\n\t\t\t\t    var item = pool[url];\r\n\t\t\t\t    if (item) {\r\n\t\t\t\t        doc = new Doc(item);\r\n\t\t\t\t    }\r\n\t\t\t\t    promise.resolve(doc);\r\n\r\n\t\t\t\t}, function(error) {\r\n\t\t\t\t    promise.reject(error);\r\n\r\n\t\t\t\t});\r\n\t\t\t\t*/\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfunction ViewPool(items) {\r\n\t\t\tvar pool = {};\r\n\r\n\t\t\tfunction _getPool(items) {\r\n\t\t\t\tif (items) {\r\n\t\t\t\t\tangular.forEach(items, function (item) {\r\n\t\t\t\t\t\tpool[item.url] = item;\r\n\t\t\t\t\t\t_getPool(item.items);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t_getPool(items);\r\n\t\t\treturn pool;\r\n\t\t}\r\n\r\n\t\t// prototype methods\r\n\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function () {\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.service('Http', ['$http', '$promise', '$timeout', 'environment', function ($http, $promise, $timeout, environment) {\r\n\r\n\t\t\tvar service = this;\r\n\r\n\t\t\tvar statics = {\r\n\t\t\t\tget: HttpGet,\r\n\t\t\t\tpost: HttpPost,\r\n\t\t\t\tput: HttpPut,\r\n\t\t\t\tpatch: HttpPatch,\r\n\t\t\t\t'delete': HttpDelete,\r\n\t\t\t\tfake: HttpFake,\r\n\t\t\t};\r\n\r\n\t\t\tangular.extend(service, statics);\r\n\r\n\t\t\t// statics methods\r\n\r\n\t\t\tfunction HttpPromise(method, url, data) {\r\n\t\t\t\treturn $promise(function (promise) {\r\n\t\t\t\t\t$http[method](environment.urls.api + url, data).then(function (response) {\r\n\t\t\t\t\t\tpromise.resolve(response.data);\r\n\r\n\t\t\t\t\t}, function (e, status) {\r\n\t\t\t\t\t\tvar error = (e && e.data) ? e.data : {};\r\n\t\t\t\t\t\terror.status = e.status;\r\n\t\t\t\t\t\tpromise.reject(error);\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tfunction HttpGet(url) {\r\n\t\t\t\treturn HttpPromise('get', url);\r\n\t\t\t}\r\n\r\n\t\t\tfunction HttpPost(url, data) {\r\n\t\t\t\treturn HttpPromise('post', url, data);\r\n\t\t\t}\r\n\r\n\t\t\tfunction HttpPut(url, data) {\r\n\t\t\t\treturn HttpPromise('put', url, data);\r\n\t\t\t}\r\n\r\n\t\t\tfunction HttpPatch(url, data) {\r\n\t\t\t\treturn HttpPromise('patch', url, data);\r\n\t\t\t}\r\n\r\n\t\t\tfunction HttpDelete(url) {\r\n\t\t\t\treturn HttpPromise('delete', url);\r\n\t\t\t}\r\n\r\n\t\t\tfunction HttpFake(data) {\r\n\t\t\t\tvar deferred = $q.defer();\r\n\t\t\t\t$timeout(function () {\r\n\t\t\t\t\tdeferred.resolve({\r\n\t\t\t\t\t\tdata: data\r\n\t\t\t\t\t});\r\n\t\t\t\t}, 1000);\r\n\t\t\t\treturn deferred.promise;\r\n\t\t\t}\r\n\r\n        }\r\n    ]);\r\n\r\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.service('Router', ['$rootScope', '$location', '$timeout', function ($rootScope, $location, $timeout) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\tisController: RouterIsController,\n\t\t\tredirect: RouterRedirect,\n\t\t\tpath: RouterPath,\n\t\t\tapply: RouterApply,\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\t$rootScope.$on('$routeChangeStart', RouterOnChangeStart);\n\t\t$rootScope.$on('$routeChangeSuccess', RouterOnChangeSuccess);\n\t\t$rootScope.$on('$routeChangeError', RouterOnChangeError);\n\t\t$rootScope.$on('$routeUpdate', RouterOnUpdate);\n\n\t\tvar $previous, $current, $next;\n\t\tvar $previousController, $currentController, $nextController;\n\n\t\tfunction RouterSetControllers() {\n\t\t\t$previousController = $previous ? $previous.controller : null;\n\t\t\t$currentController = $current ? $current.controller : null;\n\t\t\t$nextController = $next ? $next.controller : null;\n\t\t}\n\n\t\t/*\n\t\t$routeChangeStart\n\t\tBroadcasted before a route change. At this point the route services starts resolving all of the dependencies needed for the route change to occur. Typically this involves fetching the view template as well as any dependencies defined in resolve route property. Once all of the dependencies are resolved $routeChangeSuccess is fired.\n\t\tThe route change (and the $location change that triggered it) can be prevented by calling preventDefault method of the event. See $rootScope.Scope for more details about event object.\n\t\t*/\n\t\tfunction RouterOnChangeStart(event, next, current) {\n\t\t\t$previous = null;\n\t\t\t$current = current ? current.$$route : null;\n\t\t\t$next = next ? next.$$route : null;\n\t\t\tRouterSetControllers();\n\t\t\tconsole.log('Router.RouterOnChangeStart', '$previous', $previous, '$current', $current, '$next', $next);\n\t\t}\n\n\t\t/*\n\t\t$routeChangeSuccess\n\t\tBroadcasted after a route change has happened successfully. The resolve dependencies are now available in the current.locals property.\n\t\t*/\n\t\tfunction RouterOnChangeSuccess(event, current, previous) {\n\t\t\t$previous = previous ? previous.$$route : null;\n\t\t\t$current = current ? current.$$route : null;\n\t\t\t$next = null;\n\t\t\tRouterSetControllers();\n\t\t\tconsole.log('Router.RouterOnChangeSuccess', '$previous', $previous, '$current', $current, '$next', $next);\n\t\t}\n\n\t\t/*\n\t\t$routeChangeError\n\t\tBroadcasted if a redirection function fails or any redirection or resolve promises are rejected.\n\t\t*/\n\t\tfunction RouterOnChangeError(event, current, previous, rejection) {\n\t\t\t$previous = null;\n\t\t\t$current = previous.$$route || null;\n\t\t\t$next = null;\n\t\t\tRouterSetControllers();\n\t\t\tconsole.log('Router.RouterOnChangeError', '$previous', $previous, '$current', $current, '$next', $next);\n\t\t}\n\n\t\t/*\n\t\t$routeUpdate\n\t\tThe reloadOnSearch property has been set to false, and we are reusing the same instance of the Controller.\n\t\t*/\n\t\tfunction RouterOnUpdate(event, current) {\n\t\t\t$previous = current ? current.$$route : null;\n\t\t\t$current = current ? current.$$route : null;\n\t\t\t$next = null;\n\t\t\tRouterSetControllers();\n\t\t\tconsole.log('Router.RouterOnUpdate', '$previous', $previous, '$current', $current, '$next', $next);\n\t\t}\n\n\t\tfunction RouterIsController(controller) {\n\t\t\treturn $currentController === controller;\n\t\t}\n\n\t\t// navigation\n\n\t\tfunction RouterRedirectTo(path) {\n\t\t\t$location.$$lastRequestedPath = $location.path();\n\t\t\t$location.path(path);\n\t\t}\n\n\t\tfunction RouterRetryLastRequestedPath(path) {\n\t\t\tpath = $location.$$lastRequestedPath || path;\n\t\t\t$location.$$lastRequestedPath = null;\n\t\t\t$location.path(path);\n\t\t}\n\n\t\tfunction RouterRedirect(path, msecs) {\n\t\t\tif (msecs) {\n\t\t\t\t$timeout(function () {\n\t\t\t\t\tRouterRedirectTo(path);\n\t\t\t\t}, msecs);\n\t\t\t} else {\n\t\t\t\tRouterRedirectTo(path);\n\t\t\t}\n\t\t}\n\n\t\tfunction RouterPath(path, msecs) {\n\t\t\tif (msecs) {\n\t\t\t\t$timeout(function () {\n\t\t\t\t\tRouterRetryLastRequestedPath(path);\n\t\t\t\t}, msecs);\n\t\t\t} else {\n\t\t\t\tRouterRetryLastRequestedPath(path);\n\t\t\t}\n\t\t}\n\n\t\tfunction RouterApply(path, msecs) {\n\t\t\tif (msecs) {\n\t\t\t\t$timeout(function () {\n\t\t\t\t\t$location.path(path);\n\t\t\t\t}, msecs);\n\t\t\t} else {\n\t\t\t\t$timeout(function () {\n\t\t\t\t\t$location.path(path);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.service('Silent', ['$rootScope', '$location', function ($rootScope, $location) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\tsilent: SilentSilent,\n\t\t\tpath: SilentPath,\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\t$rootScope.$$listeners.$locationChangeSuccess.unshift(SilentListener);\n\t\t// console.log('$rootScope.$$listeners.$locationChangeSuccess', $rootScope.$$listeners.$locationChangeSuccess);\n\n\t\t// private vars\n\n\t\tvar $path;\n\n\t\t// static methods\n\n\t\tfunction SilentGetDomain() {\n\t\t\tvar currentDomain = window.location.protocol + '//' + window.location.hostname + (window.location.port ? ':' + window.location.port : '');\n\t\t\treturn currentDomain;\n\t\t}\n\n\t\tfunction SilentUnlink() {\n\t\t\tvar listeners = $rootScope.$$listeners.$locationChangeSuccess;\n\t\t\tangular.forEach(listeners, function (value, name) {\n\t\t\t\tif (value === listener) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfunction relink() {\n\t\t\t\t\tlisteners[name] = value;\n\t\t\t\t}\n\t\t\t\tlisteners[name] = relink; // temporary unlinking\n\t\t\t});\n\t\t}\n\n\t\tfunction SilentListener(e) {\n\t\t\t// console.log('onLocationChangeSuccess', e);\n\t\t\tif ($path === $location.path()) {\n\t\t\t\tSilentUnlink();\n\t\t\t}\n\t\t\t$path = null;\n\t\t}\n\n\t\tfunction SilentSilent(path, replace) {\n\t\t\t// this.prev = $location.path(); ???\n\t\t\tvar location = $location.url(path);\n\t\t\tif (replace) {\n\t\t\t\tlocation.replace();\n\t\t\t}\n\t\t\t$path = $location.path();\n\t\t}\n\n\t\tfunction SilentPath(path) {\n\t\t\treturn $location.path(path);\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tvar TIMEOUT = 5 * 60 * 1000; // five minutes\n\n\tapp.service('Cookie', ['$promise', function ($promise) {\n\n\t\tvar service = {\n\t\t\tTIMEOUT: TIMEOUT,\n\t\t\tdelete: CookieDelete,\n\t\t\texist: CookieExists,\n\t\t\tget: CookieGet,\n\t\t\ton: CookieOn,\n\t\t\tset: CookieSet,\n\t\t};\n\n\t\tangular.extend(this, service);\n\n\t\tfunction CookieDelete(name) {\n\t\t\tCookieSetter(name, \"\", -1);\n\t\t}\n\n\t\tfunction CookieExists(name) {\n\t\t\treturn document.cookie.indexOf(';' + name + '=') !== -1 || document.cookie.indexOf(name + '=') === 0;\n\t\t}\n\n\t\tfunction CookieGet(name) {\n\t\t\tvar cookieName = name + \"=\";\n\t\t\tvar ca = document.cookie.split(';');\n\t\t\tfor (var i = 0; i < ca.length; i++) {\n\t\t\t\tvar c = ca[i];\n\t\t\t\twhile (c.charAt(0) == ' ') {\n\t\t\t\t\tc = c.substring(1, c.length);\n\t\t\t\t}\n\t\t\t\tif (c.indexOf(cookieName) === 0) {\n\t\t\t\t\tvar value = c.substring(cookieName.length, c.length);\n\t\t\t\t\tvar model = null;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tmodel = JSON.parse(decodeURIComponent(atob(value)));\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tconsole.log('Cookie.get.error parsing', key, e);\n\t\t\t\t\t}\n\t\t\t\t\treturn model;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tfunction CookieOn(name) {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tvar i, interval = 1000,\n\t\t\t\t\telapsed = 0,\n\t\t\t\t\ttimeout = Cookie.TIMEOUT;\n\n\t\t\t\tfunction checkCookie() {\n\t\t\t\t\tif (elapsed > timeout) {\n\t\t\t\t\t\tpromise.reject('timeout');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar c = CookieGet(name);\n\t\t\t\t\t\tif (c) {\n\t\t\t\t\t\t\tpromise.resolve(c);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\telapsed += interval;\n\t\t\t\t\t\t\ti = setTimeout(checkCookie, interval);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcheckCookie();\n\t\t\t});\n\t\t}\n\n\t\tfunction CookieSet(name, value, days) {\n\t\t\ttry {\n\t\t\t\tvar cache = [];\n\t\t\t\tvar json = JSON.stringify(value, function (key, value) {\n\t\t\t\t\tif (key === 'pool') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t\t// Circular reference found, discard key\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcache.push(value);\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t\tcache = null;\n\t\t\t\tCookieSetter(name, btoa(encodeURIComponent(json)), days);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('CookieSet.error serializing', name, value, e);\n\t\t\t}\n\t\t}\n\n\t\tfunction CookieSetter(name, value, days) {\n\t\t\tvar expires;\n\t\t\tif (days) {\n\t\t\t\tvar date = new Date();\n\t\t\t\tdate.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n\t\t\t\texpires = '; expires=' + date.toGMTString();\n\t\t\t} else {\n\t\t\t\texpires = '';\n\t\t\t}\n\t\t\tdocument.cookie = name + '=' + value + expires + '; path=/';\n\t\t}\n\n    }]);\n\n\tapp.service('LocalStorage', ['$promise', 'Cookie', function ($promise, Cookie) {\n\n\t\tvar service = {\n\t\t\tTIMEOUT: TIMEOUT,\n\t\t\tdelete: LocalDelete,\n\t\t\texist: LocalExists,\n\t\t\tget: LocalGet,\n\t\t\ton: LocalOn,\n\t\t\tset: LocalSet,\n\t\t};\n\n\t\tvar supported = LocalSupported();\n\n\t\tif (supported) {\n\t\t\tangular.extend(this, service);\n\t\t} else {\n\t\t\tangular.extend(this, Cookie);\n\t\t}\n\n\t\tthis.supported = supported;\n\n\t\tfunction LocalSupported() {\n\t\t\tvar supported = false;\n\t\t\ttry {\n\t\t\t\tsupported = 'localStorage' in window && window.localStorage !== null;\n\t\t\t\tif (supported) {\n\t\t\t\t\twindow.localStorage.setItem('test', '1');\n\t\t\t\t\twindow.localStorage.removeItem('test');\n\t\t\t\t} else {\n\t\t\t\t\tsupported = false;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tsupported = false;\n\t\t\t}\n\t\t\treturn supported;\n\t\t}\n\n\t\tfunction LocalExists(name) {\n\t\t\treturn window.localStorage[name] !== undefined;\n\t\t}\n\n\t\tfunction LocalGet(name) {\n\t\t\tvar value = null;\n\t\t\tif (window.localStorage[name] !== undefined) {\n\t\t\t\ttry {\n\t\t\t\t\tvalue = JSON.parse(window.localStorage[name]);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log('LocalStorage.get.error parsing', name, e);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn value;\n\t\t}\n\n\t\tfunction LocalSet(name, value) {\n\t\t\ttry {\n\t\t\t\tvar cache = [];\n\t\t\t\tvar json = JSON.stringify(value, function (key, value) {\n\t\t\t\t\tif (key === 'pool') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t\t// Circular reference found, discard key\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcache.push(value);\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t\tcache = null;\n\t\t\t\twindow.localStorage.setItem(name, json);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('LocalStorage.set.error serializing', name, value, e);\n\t\t\t}\n\t\t}\n\n\t\tfunction LocalDelete(name) {\n\t\t\twindow.localStorage.removeItem(name);\n\t\t}\n\n\t\tfunction LocalOn(name) {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tvar i, timeout = Cookie.TIMEOUT;\n\n\t\t\t\tfunction storageEvent(e) {\n\t\t\t\t\t// console.log('LocalStorage.on', name, e);\n\t\t\t\t\tif (i) {\n\t\t\t\t\t\tclearTimeout(i);\n\t\t\t\t\t}\n\t\t\t\t\tif (e.originalEvent.key == name) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvar value = JSON.parse(e.originalEvent.newValue); // , e.originalEvent.oldValue\n\t\t\t\t\t\t\tpromise.resolve(value);\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tconsole.log('LocalStorage.on.error parsing', name, error);\n\t\t\t\t\t\t\tpromise.reject('error parsing ' + name);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tangular.element(window).on('storage', storageEvent);\n\t\t\t\ti = setTimeout(function () {\n\t\t\t\t\tpromise.reject('timeout');\n\t\t\t\t}, timeout);\n\t\t\t});\n\t\t}\n\n    }]);\n\n\tapp.factory('SessionStorage', ['$promise', 'Cookie', function ($promise, Cookie) {\n\n\t\tvar service = {\n\t\t\tTIMEOUT: TIMEOUT,\n\t\t\tdelete: LocalDelete,\n\t\t\texist: LocalExists,\n\t\t\tget: LocalGet,\n\t\t\ton: LocalOn,\n\t\t\tset: LocalSet,\n\t\t};\n\n\t\tvar supported = SessionSupported();\n\n\t\tif (supported) {\n\t\t\tangular.extend(this, service);\n\t\t} else {\n\t\t\tangular.extend(this, Cookie);\n\t\t}\n\n\t\tthis.supported = supported;\n\n\t\tfunction SessionSupported() {\n\t\t\tvar supported = false;\n\t\t\ttry {\n\t\t\t\tsupported = 'sessionStorage' in window && window.sessionStorage !== undefined;\n\t\t\t\tif (supported) {\n\t\t\t\t\twindow.sessionStorage.setItem('test', '1');\n\t\t\t\t\twindow.sessionStorage.removeItem('test');\n\t\t\t\t} else {\n\t\t\t\t\tsupported = false;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tsupported = false;\n\t\t\t}\n\t\t\treturn supported;\n\t\t}\n\n\t\tfunction SessionExists(name) {\n\t\t\treturn window.sessionStorage[name] !== undefined;\n\t\t}\n\n\t\tfunction SessionGet(name) {\n\t\t\tvar value = null;\n\t\t\tif (window.sessionStorage[name] !== undefined) {\n\t\t\t\ttry {\n\t\t\t\t\tvalue = JSON.parse(window.sessionStorage[name]);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log('SessionStorage.get.error parsing', name, e);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn value;\n\t\t}\n\n\t\tfunction SessionSet(name, value) {\n\t\t\ttry {\n\t\t\t\tvar cache = [];\n\t\t\t\tvar json = JSON.stringify(value, function (key, value) {\n\t\t\t\t\tif (key === 'pool') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t\t// Circular reference found, discard key\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcache.push(value);\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t\tcache = null;\n\t\t\t\twindow.sessionStorage.setItem(name, json);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('SessionStorage.set.error serializing', name, value, e);\n\t\t\t}\n\t\t}\n\n\t\tfunction SessionDelete(name) {\n\t\t\twindow.sessionStorage.removeItem(name);\n\t\t}\n\n\t\tfunction SessionOn(name) {\n\t\t\treturn $promise(function (promise) {\n\t\t\t\tvar i, timeout = Cookie.TIMEOUT;\n\n\t\t\t\tfunction storageEvent(e) {\n\t\t\t\t\t// console.log('SessionStorage.on', name, e);\n\t\t\t\t\tif (i) {\n\t\t\t\t\t\tclearTimeout(i);\n\t\t\t\t\t}\n\t\t\t\t\tif (e.originalEvent.key === name) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvar value = JSON.parse(e.originalEvent.newValue); // , e.originalEvent.oldValue\n\t\t\t\t\t\t\tpromise.resolve(value);\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tconsole.log('SessionStorage.on.error parsing', name, error);\n\t\t\t\t\t\t\tpromise.reject('error parsing ' + name);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tangular.element(window).on('storage', storageEvent);\n\t\t\t\ti = setTimeout(function () {\n\t\t\t\t\tpromise.reject('timeout');\n\t\t\t\t}, timeout);\n\t\t\t});\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.service('Trust', ['$sce', function ($sce) {\n\n\t\tvar service = this;\n\n\t\tvar statics = {\n\t\t\thtml: TrustHtml,\n\t\t\tresource: TrustResource,\n\t\t\turl: TrustUrl,\n\t\t};\n\n\t\tangular.extend(service, statics);\n\n\t\t// private vars\n\n\t\tvar values = [],\n\t\t\ttrustedValues = [];\n\n\t\tfunction TrustGetValue(value) {\n\t\t\tvar index = values.indexOf(value);\n\t\t\tif (index !== -1) {\n\t\t\t\treturn trustedValues[index];\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\tfunction TrustSetValue(value, trustedValue) {\n\t\t\tvalues.push(value);\n\t\t\tvalues.push(trustedValue);\n\t\t}\n\n\t\tfunction TrustGetOrSet(value, callback) {\n\t\t\tvar trustedValue = TrustGetValue(value);\n\t\t\tif (!trustedValue) {\n\t\t\t\ttrustedValue = callback();\n\t\t\t\tTrustSetValue(value, trustedValue);\n\t\t\t}\n\t\t\treturn trustedValue;\n\t\t}\n\n\t\tfunction TrustHtml(value) {\n\t\t\treturn TrustGetOrSet(value, function () {\n\t\t\t\treturn $sce.trustAsHtml(value);\n\t\t\t});\n\t\t}\n\n\t\tfunction TrustResource(value) {\n\t\t\treturn TrustGetOrSet(value, function () {\n\t\t\t\treturn $sce.trustAsResourceUrl(value);\n\t\t\t});\n\t\t}\n\n\t\tfunction TrustUrl(value) {\n\t\t\treturn TrustGetOrSet(value, function () {\n\t\t\t\treturn 'url(\\'' + value + '\\')';\n\t\t\t});\n\t\t}\n\n    }]);\n\n}());\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Color', [function () {\n\t\tfunction Color(r, g, b, a) {\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tthis.r = (r || r === 0) ? r : 0;\n\t\t\t\tthis.g = (g || g === 0) ? g : 0;\n\t\t\t\tthis.b = (b || b === 0) ? b : 0;\n\t\t\t\tthis.a = (a || a === 0) ? a : 255;\n\t\t\t} else {\n\t\t\t\tvar uint = r || '0xffffff';\n\t\t\t\tuint = parseInt(uint);\n\t\t\t\tif (r.length > 8) {\n\t\t\t\t\tthis.r = uint >> 24 & 0xff;\n\t\t\t\t\tthis.g = uint >> 16 & 0xff;\n\t\t\t\t\tthis.b = uint >> 8 & 0xff;\n\t\t\t\t\tthis.a = uint >> 0 & 0xff;\n\t\t\t\t} else {\n\t\t\t\t\tthis.r = uint >> 16 & 0xff;\n\t\t\t\t\tthis.g = uint >> 8 & 0xff;\n\t\t\t\t\tthis.b = uint >> 0 & 0xff;\n\t\t\t\t\tthis.a = 255;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tColor.componentToHex = function (c) {\n\t\t\tvar hex = c.toString(16);\n\t\t\treturn hex.length == 1 ? '0' + hex : hex;\n\t\t};\n\t\tColor.luma = function (color) {\n\t\t\t// var luma = color.dot({ r: 54.213, g: 182.376, b: 18.411 });\n\t\t\tvar luma = color.dot({\n\t\t\t\tr: 95,\n\t\t\t\tg: 100,\n\t\t\t\tb: 60\n\t\t\t});\n\t\t\treturn luma;\n\t\t};\n\t\tColor.contrast = function (color) {\n\t\t\tvar luma = Color.luma(color);\n\t\t\tif (luma > 0.6) {\n\t\t\t\treturn new Color('0x000000');\n\t\t\t} else {\n\t\t\t\treturn new Color('0xffffff');\n\t\t\t}\n\t\t};\n\t\tColor.darker = function (color, pow, min) {\n\t\t\tmin = min || 0;\n\t\t\tvar r = Math.max(Math.floor(color.r * min), Math.floor(color.r - 255 * pow));\n\t\t\tvar g = Math.max(Math.floor(color.g * min), Math.floor(color.g - 255 * pow));\n\t\t\tvar b = Math.max(Math.floor(color.b * min), Math.floor(color.b - 255 * pow));\n\t\t\treturn new Color(r, g, b, color.a);\n\t\t};\n\t\tColor.lighter = function (color, pow, max) {\n\t\t\tmax = max || 1;\n\t\t\tvar r = Math.min(color.r + Math.floor((255 - color.r) * max), Math.floor(color.r + 255 * pow));\n\t\t\tvar g = Math.min(color.g + Math.floor((255 - color.g) * max), Math.floor(color.g + 255 * pow));\n\t\t\tvar b = Math.min(color.b + Math.floor((255 - color.b) * max), Math.floor(color.b + 255 * pow));\n\t\t\treturn new Color(r, g, b, color.a);\n\t\t};\n\t\t/*\n\t\tColor.rgbaToHex = function (rgba) {\n\t\t    rgba = rgba.match(/^rgba?[\\s+]?\\([\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?/i);\n\t\t    return (rgba && rgba.length === 4) ? \"#\" +\n\t\t        (\"0\" + parseInt(rgba[1], 10).toString(16)).slice(-2) +\n\t\t        (\"0\" + parseInt(rgba[2], 10).toString(16)).slice(-2) +\n\t\t        (\"0\" + parseInt(rgba[3], 10).toString(16)).slice(-2) : '';\n\t\t}\n\t\t*/\n\t\tColor.prototype = {\n\t\t\ttoUint: function () {\n\t\t\t\treturn (this.r << 24) + (this.g << 16) + (this.b << 8) + (this.a);\n\t\t\t},\n\t\t\ttoHex: function () {\n\t\t\t\treturn '#' + Color.componentToHex(this.r) + Color.componentToHex(this.g) + Color.componentToHex(this.b) + Color.componentToHex(this.a);\n\t\t\t},\n\t\t\ttoRgba: function () {\n\t\t\t\treturn 'rgba(' + this.r + ',' + this.g + ',' + this.b + ',' + (this.a / 255).toFixed(3) + ')';\n\t\t\t},\n\t\t\tdot: function (color) {\n\t\t\t\treturn ((this.r / 255) * (color.r / 255) + (this.g / 255) * (color.g / 255) + (this.b / 255) * (color.b / 255));\n\t\t\t},\n\t\t\talpha: function (pow, min, max) {\n\t\t\t\tmin = min || 0;\n\t\t\t\tmax = max || 1;\n\t\t\t\tthis.a = Math.floor((min + (pow * (max - min))) * 255);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tmakeSet: function () {\n\t\t\t\tthis.foreground = Color.contrast(this);\n\t\t\t\tthis.border = Color.darker(this, 0.3);\n\t\t\t\tthis.light = Color.lighter(this, 0.3);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t};\n\t\treturn Color;\n    }]);\n\n\tapp.factory('Shape', [function () {\n\t\tfunction Shape() {}\n\t\tShape.shapeCircle = function (p, cx, cy, r, sa, ea) {\n\t\t\tsa = sa || 0;\n\t\t\tea = ea || 2 * Math.PI;\n\t\t\tp.ctx.arc(cx, cy, r, sa, ea, false);\n\t\t};\n\t\tShape.shapeStar = function (p, cx, cy, or, ir, steps) {\n\t\t\tvar x, y;\n\t\t\tvar angle = Math.PI / 2 * 3;\n\t\t\tvar step = Math.PI / steps;\n\t\t\tvar ctx = p.ctx;\n\t\t\tctx.moveTo(cx, cy - or);\n\t\t\tfor (i = 0; i < steps; i++) {\n\t\t\t\tx = cx + Math.cos(angle) * or;\n\t\t\t\ty = cy + Math.sin(angle) * or;\n\t\t\t\tctx.lineTo(x, y);\n\t\t\t\tangle += step;\n\t\t\t\tx = cx + Math.cos(angle) * ir;\n\t\t\t\ty = cy + Math.sin(angle) * ir;\n\t\t\t\tctx.lineTo(x, y);\n\t\t\t\tangle += step;\n\t\t\t}\n\t\t\tctx.lineTo(cx, cy - or);\n\t\t};\n\t\tShape.shapeRoundRect = function (p, rect, r) {\n\t\t\tvar ctx = p.ctx,\n\t\t\t\tx = rect.x,\n\t\t\t\ty = rect.y,\n\t\t\t\tw = rect.w,\n\t\t\t\th = rect.h;\n\t\t\tif (typeof r === undefined) {\n\t\t\t\tr = 4;\n\t\t\t}\n\t\t\tif (typeof r === 'number') {\n\t\t\t\tr = {\n\t\t\t\t\ttl: r,\n\t\t\t\t\ttr: r,\n\t\t\t\t\tbr: r,\n\t\t\t\t\tbl: r\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tvar defaultRadius = {\n\t\t\t\t\ttl: 0,\n\t\t\t\t\ttr: 0,\n\t\t\t\t\tbr: 0,\n\t\t\t\t\tbl: 0\n\t\t\t\t};\n\t\t\t\tfor (var key in defaultRadius) {\n\t\t\t\t\tr[key] = r[key] || defaultRadius[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\tctx.moveTo(x + r.tl, y);\n\t\t\tctx.lineTo(x + w - r.tr, y);\n\t\t\tctx.quadraticCurveTo(x + w, y, x + w, y + r.tr);\n\t\t\tctx.lineTo(x + w, y + h - r.br);\n\t\t\tctx.quadraticCurveTo(x + w, y + h, x + w - r.br, y + h);\n\t\t\tctx.lineTo(x + r.bl, y + h);\n\t\t\tctx.quadraticCurveTo(x, y + h, x, y + h - r.bl);\n\t\t\tctx.lineTo(x, y + r.tl);\n\t\t\tctx.quadraticCurveTo(x, y, x + r.tl, y);\n\t\t};\n\t\tShape.circle = function () {\n\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\tvar ctx = params[0].ctx;\n\t\t\tctx.beginPath();\n\t\t\tShape.shapeCircle.apply(this, params);\n\t\t\tctx.closePath();\n\t\t};\n\t\tShape.star = function () {\n\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\tvar ctx = params[0].ctx;\n\t\t\tctx.beginPath();\n\t\t\tShape.shapeStar.apply(this, params);\n\t\t\tctx.closePath();\n\t\t};\n\t\tShape.roundRect = function () {\n\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\tvar ctx = params[0].ctx;\n\t\t\tctx.beginPath();\n\t\t\tShape.shapeRoundRect.apply(this, params);\n\t\t\tctx.closePath();\n\t\t};\n\t\treturn Shape;\n    }]);\n\n\tapp.constant('PainterColors', {\n\t\t/*\n\t\tblack: new Color('0x111111'),\n\t\twhite: new Color('0xffffff'),\n\t\tred: new Color('0xff0000'),\n\t\tgreen: new Color('0x00ff00'),\n\t\tblue: new Color('0x0000ff'),\n\t\tyellow: new Color('0xffff00'),\n\t\tcyan: new Color('0x00ffff'),\n\t\tpurple: new Color('0xff00ff'),\n\t\t*/\n\t\tblack: '0x14191e',\n\t\twhite: '0xffffff',\n\t\tblue: '0x0023FF',\n\t\tred: '0xF21500',\n\t\tlightBlue: '0x79ccf2',\n\t\tlightYellow: '0xfff79a',\n\t\tgreyLighter: '0xf8f8f8',\n\t\tgreyLight: '0xeeeeee',\n\t\tgreyMedium: '0xcccccc',\n\t\tgrey: '0x90939b',\n\t\tmap: '0x24292e',\n\t});\n\n\tapp.factory('Palette', ['$q', 'Painter', 'Rect', function ($q, Painter, Rect) {\n\t\tfunction Palette() {\n\t\t\tthis.painter = new Painter().setSize(0, 0);\n\t\t\tthis.buffer = new Painter().setSize(0, 0);\n\t\t\tthis.size = {\n\t\t\t\tw: 0,\n\t\t\t\th: 0\n\t\t\t};\n\t\t\tthis.pool = {};\n\t\t\tthis.rows = {};\n\t\t}\n\t\tPalette.prototype = {\n\t\t\tgetRect: function (w, h) {\n\t\t\t\tvar p = this.painter,\n\t\t\t\t\tsize = this.size,\n\t\t\t\t\trows = this.rows,\n\t\t\t\t\tr = new Rect(0, 0, w, h),\n\t\t\t\t\trow = rows[h] || {\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: size.h\n\t\t\t\t\t};\n\t\t\t\tsize.w = Math.max(size.w, row.x + w);\n\t\t\t\tsize.h = Math.max(size.h, row.y + h);\n\t\t\t\tif (!p.canvas.width && !p.canvas.height) {\n\t\t\t\t\tp.setSize(size.w, size.h);\n\t\t\t\t} else if (size.w > p.canvas.width || size.h > p.canvas.height) {\n\t\t\t\t\t// var img = new Image();\n\t\t\t\t\t// img.src = p.toDataURL();\n\t\t\t\t\t// document.body.appendChild(canvas);\n\t\t\t\t\t// console.log(p.canvas.width, p.canvas.height);\n\t\t\t\t\t// var data = p.ctx.getImageData(0, 0, p.canvas.width, p.canvas.height);\n\t\t\t\t\tvar canvas = p.canvas;\n\t\t\t\t\tp.setCanvas(document.createElement('canvas'));\n\t\t\t\t\tp.setSize(size.w, size.h);\n\t\t\t\t\tp.ctx.drawImage(canvas, 0, 0);\n\t\t\t\t\t// p.ctx.putImageData(data, 0, 0);\n\t\t\t\t\t// p.ctx.drawImage(img, 0, 0);\n\t\t\t\t\t// document.body.removeChild(canvas);\n\t\t\t\t}\n\t\t\t\tr.x = row.x;\n\t\t\t\tr.y = row.y;\n\t\t\t\trow.x += w;\n\t\t\t\trows[h] = row;\n\t\t\t\treturn r;\n\t\t\t},\n\t\t\tadd: function (key, path) {\n\t\t\t\tvar palette = this;\n\t\t\t\tif (angular.isString(path)) {\n\t\t\t\t\tvar deferred = $q.defer();\n\t\t\t\t\tvar img = new Image();\n\t\t\t\t\timg.onload = function () {\n\t\t\t\t\t\tpalette.addShape(key, img.width, img.height, function (p, rect) {\n\t\t\t\t\t\t\tp.ctx.drawImage(img, 0, 0);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdeferred.resolve(img);\n\t\t\t\t\t};\n\t\t\t\t\timg.onerror = function () {\n\t\t\t\t\t\tdeferred.reject('connot load ' + path);\n\t\t\t\t\t};\n\t\t\t\t\timg.src = path;\n\t\t\t\t\treturn deferred.promise;\n\t\t\t\t} else {\n\t\t\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\t\t\treturn palette.addShape.apply(palette, params);\n\t\t\t\t}\n\t\t\t},\n\t\t\taddShape: function (key, w, h, callback) {\n\t\t\t\tvar p = this.painter,\n\t\t\t\t\tr = this.getRect(w, h);\n\t\t\t\tp.ctx.save();\n\t\t\t\tp.ctx.rect(r.x, r.y, r.w, r.h);\n\t\t\t\t// p.ctx.stroke();\n\t\t\t\tp.ctx.clip();\n\t\t\t\tp.ctx.translate(r.x, r.y);\n\t\t\t\tcallback.call(p, p, r.clone().setPos(0, 0));\n\t\t\t\tp.ctx.restore();\n\t\t\t\tthis.pool[key] = r;\n\t\t\t\t// console.log('Painter.add', r);\n\t\t\t},\n\t\t\tdraw: function (target, key, x, y, pre) {\n\t\t\t\tvar r = this.pool[key];\n\t\t\t\tif (r) {\n\t\t\t\t\t// var ctx = target.ctx;\n\t\t\t\t\t// ctx.save();\n\t\t\t\t\ttarget.drawRect(this.painter.canvas, r, {\n\t\t\t\t\t\tx: x,\n\t\t\t\t\t\ty: y,\n\t\t\t\t\t\tw: r.w,\n\t\t\t\t\t\th: r.h\n\t\t\t\t\t}, pre);\n\t\t\t\t\t// target.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, x - r.w / 2, y - r.h / 2, r.w, r.h);\n\t\t\t\t\t// ctx.restore();\n\t\t\t\t}\n\t\t\t},\n\t\t\ttint: function (target, key, x, y, color, pre) {\n\t\t\t\tvar r = this.pool[key];\n\t\t\t\tif (r) {\n\t\t\t\t\tvar p = this.painter,\n\t\t\t\t\t\tb = this.buffer.setSize(r.w, r.h);\n\t\t\t\t\tb.save();\n\t\t\t\t\tb.setFill(color);\n\t\t\t\t\tb.fillRect();\n\t\t\t\t\tb.ctx.globalCompositeOperation = \"destination-atop\";\n\t\t\t\t\tb.ctx.drawImage(p.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n\t\t\t\t\tb.restore();\n\t\t\t\t\tconsole.log(x, y, b.canvas, target.canvas);\n\t\t\t\t\ttarget.draw(b.canvas, {\n\t\t\t\t\t\tx: x,\n\t\t\t\t\t\ty: y\n\t\t\t\t\t}, pre);\n\t\t\t\t}\n\t\t\t},\n\t\t\tpattern: function (target, key, x, y, w, h, color) {\n\t\t\t\tfunction drawPattern(pattern) {\n\t\t\t\t\tvar ctx = target.ctx;\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\t// draw\n\t\t\t\t\t// ctx.beginPath();\n\t\t\t\t\t// ctx.rect(-x, -y, w, h);\n\t\t\t\t\tctx.fillStyle = pattern;\n\t\t\t\t\tctx.fillRect(-x, -y, w, h);\n\t\t\t\t\tctx.translate(-x, -y);\n\t\t\t\t\t// ctx.fill();\n\t\t\t\t\tctx.restore();\n\t\t\t\t}\n\t\t\t\tvar r = this.pool[key];\n\t\t\t\tif (r) {\n\t\t\t\t\tvar img = r.img,\n\t\t\t\t\t\tpattern;\n\t\t\t\t\tif (!img || r.color != color) {\n\t\t\t\t\t\tvar b = this.buffer.setSize(r.w, r.h);\n\t\t\t\t\t\tif (color) {\n\t\t\t\t\t\t\tr.color = color;\n\t\t\t\t\t\t\tb.save();\n\t\t\t\t\t\t\tb.setFill(color);\n\t\t\t\t\t\t\tb.fillRect();\n\t\t\t\t\t\t\tb.ctx.globalCompositeOperation = \"destination-atop\";\n\t\t\t\t\t\t\tb.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n\t\t\t\t\t\t\tb.restore();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tb.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n\t\t\t\t\t\t}\n\t\t\t\t\t\timg = new Image();\n\t\t\t\t\t\timg.onload = function () {\n\t\t\t\t\t\t\tr.img = img;\n\t\t\t\t\t\t\tpattern = target.ctx.createPattern(img, \"repeat\");\n\t\t\t\t\t\t\tdrawPattern(pattern);\n\t\t\t\t\t\t};\n\t\t\t\t\t\timg.src = b.toDataURL();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpattern = target.ctx.createPattern(img, \"repeat\");\n\t\t\t\t\t\tdrawPattern(pattern);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t\treturn Palette;\n    }]);\n\n\tapp.factory('Painter', ['Shape', 'Rect', 'Color', 'PainterColors', function (Shape, Rect, Color, PainterColors) {\n\t\tfunction Painter(canvas) {\n\t\t\tcanvas = canvas || document.createElement('canvas');\n\t\t\tthis.rect = new Rect();\n\t\t\tthis.drawingRect = new Rect();\n\t\t\tthis.setColors();\n\t\t\tthis.setCanvas(canvas);\n\t\t}\n\t\tPainter.colors = {};\n\t\tangular.forEach(PainterColors, function (value, key) {\n\t\t\tPainter.colors[key] = new Color(value).makeSet();\n\t\t});\n\t\tvar colors = Painter.colors;\n\t\tPainter.prototype = {\n\t\t\tcolors: Painter.colors,\n\t\t\tsetColors: function () {\n\t\t\t\tvar colors = this.colors;\n\t\t\t\tangular.forEach(PainterColors, function (value, key) {\n\t\t\t\t\tcolors[key] = new Color(value).makeSet();\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCanvas: function (canvas) {\n\t\t\t\tthis.canvas = canvas;\n\t\t\t\tthis.setSize(canvas.offsetWidth, canvas.offsetHeight);\n\t\t\t\tvar ctx = canvas.getContext('2d');\n\t\t\t\tctx.lineCap = 'square';\n\t\t\t\tthis.ctx = ctx;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetSize: function (w, h) {\n\t\t\t\tthis.canvas.width = w;\n\t\t\t\tthis.canvas.height = h;\n\t\t\t\tthis.rect.w = w;\n\t\t\t\tthis.rect.h = h;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tcopy: function (canvas) {\n\t\t\t\tthis.ctx.drawImage(canvas, 0, 0);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tclear: function () {\n\t\t\t\tthis.resize();\n\t\t\t\t// this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tresize: function () {\n\t\t\t\tthis.setSize(this.canvas.offsetWidth, this.canvas.offsetHeight);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetText: function (font, align, verticalAlign, color) {\n\t\t\t\tfont = font || '11px monospace';\n\t\t\t\talign = align || 'center';\n\t\t\t\tverticalAlign = verticalAlign || 'middle';\n\t\t\t\tcolor = color || this.colors.black;\n\t\t\t\tvar ctx = this.ctx;\n\t\t\t\tctx.font = font;\n\t\t\t\tctx.textAlign = align;\n\t\t\t\tctx.textBaseline = verticalAlign;\n\t\t\t\tctx.fillStyle = color.toRgba();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetFill: function (color) {\n\t\t\t\tcolor = color || this.colors.black;\n\t\t\t\tvar ctx = this.ctx;\n\t\t\t\t/*\n\t\t\t\tvar my_gradient = ctx.createLinearGradient(0, 0, 0, 170);\n\t\t\t\tmy_gradient.addColorStop(0, \"black\");\n\t\t\t\tmy_gradient.addColorStop(1, \"white\");\n\t\t\t\tctx.fillStyle = my_gradient;\n\t\t\t\t*/\n\t\t\t\tctx.fillStyle = color.toRgba();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetStroke: function (color, size) {\n\t\t\t\tcolor = color || this.colors.black;\n\t\t\t\tvar ctx = this.ctx;\n\t\t\t\tsize = size || 1;\n\t\t\t\t/*\n\t\t\t\tvar gradient=ctx.createLinearGradient(0,0,170,0);\n\t\t\t\tgradient.addColorStop(\"0\",\"magenta\");\n\t\t\t\tgradient.addColorStop(\"0.5\",\"blue\");\n\t\t\t\tgradient.addColorStop(\"1.0\",\"red\");\n\t\t\t\tctx.strokeStyle = gradient;\n\t\t\t\t*/\n\t\t\t\t// Fill with gradient\n\t\t\t\tctx.strokeStyle = color.toRgba();\n\t\t\t\tctx.lineWidth = size;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t/*\n\t\t\tdrawRoundRect: function (rect, r) {\n\t\t\t    rect = rect || this.rect;\n\t\t\t    Shape.roundRect(this, rect, r);\n\t\t\t    return this;\n\t\t\t},\n\t\t\t*/\n\t\t\tfillText: function (text, point, width, post, maxLength) {\n\t\t\t\tif (width) {\n\t\t\t\t\tpost = post || '';\n\t\t\t\t\tmaxLength = maxLength || Math.floor(width / 8);\n\t\t\t\t\tif (text.length > maxLength) {\n\t\t\t\t\t\ttext = text.substr(0, Math.min(text.length, maxLength)).trim() + post;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.ctx.fillText(text, point.x, point.y);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tfillRect: function (rect) {\n\t\t\t\trect = rect || this.rect;\n\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\tx = rect.x,\n\t\t\t\t\ty = rect.y,\n\t\t\t\t\tw = rect.w,\n\t\t\t\t\th = rect.h;\n\t\t\t\tctx.fillRect(x, y, w, h);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tstrokeRect: function (rect) {\n\t\t\t\trect = rect || this.rect;\n\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\tx = rect.x,\n\t\t\t\t\ty = rect.y,\n\t\t\t\t\tw = rect.w,\n\t\t\t\t\th = rect.h;\n\t\t\t\tctx.strokeRect(x, y, w, h);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tfill: function () {\n\t\t\t\tthis.ctx.fill();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tstroke: function () {\n\t\t\t\tthis.ctx.stroke();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tbegin: function () {\n\t\t\t\tthis.ctx.beginPath();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tclose: function () {\n\t\t\t\tthis.ctx.closePath();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsave: function () {\n\t\t\t\tthis.ctx.save();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\trestore: function () {\n\t\t\t\tthis.ctx.restore();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\trotate: function (angle) {\n\t\t\t\tthis.ctx.rotate(angle * Math.PI / 180);\n\t\t\t},\n\t\t\ttranslate: function (xy) {\n\t\t\t\tthis.ctx.translate(xy.x, xy.y);\n\t\t\t},\n\t\t\ttoDataURL: function () {\n\t\t\t\treturn this.canvas.toDataURL();\n\t\t\t},\n\t\t\tdraw: function (image, t, pre) {\n\t\t\t\tif (image) {\n\t\t\t\t\tt.w = t.w || image.width;\n\t\t\t\t\tt.h = t.h || image.height;\n\t\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\t\trect = this.drawingRect,\n\t\t\t\t\t\tx = rect.x = t.x - t.w / 2,\n\t\t\t\t\t\ty = rect.y = t.y - t.h / 2,\n\t\t\t\t\t\tw = rect.w = t.w,\n\t\t\t\t\t\th = rect.h = t.h;\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\tif (pre) {\n\t\t\t\t\t\tpre.call(this);\n\t\t\t\t\t}\n\t\t\t\t\tctx.drawImage(image, 0, 0);\n\t\t\t\t\tctx.restore();\n\t\t\t\t\t// console.log('painter.draw', x, y, w, h);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tdrawRect: function (image, s, t, pre) {\n\t\t\t\tif (image) {\n\t\t\t\t\ts.w = s.w || image.width;\n\t\t\t\t\ts.h = s.h || image.height;\n\t\t\t\t\tt.w = t.w || image.width;\n\t\t\t\t\tt.h = t.h || image.height;\n\t\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\t\trect = this.drawingRect,\n\t\t\t\t\t\tx = rect.x = t.x - s.w / 2,\n\t\t\t\t\t\ty = rect.y = t.y - s.h / 2,\n\t\t\t\t\t\tw = rect.w = t.w,\n\t\t\t\t\t\th = rect.h = t.h;\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\tif (pre) {\n\t\t\t\t\t\tpre.call(this);\n\t\t\t\t\t}\n\t\t\t\t\tctx.drawImage(image, s.x, s.y, s.w, s.h, 0, 0, t.w, t.h);\n\t\t\t\t\tctx.restore();\n\t\t\t\t\t// console.log('painter.drawRect', x, y, w, h);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tflip: function (scale) {\n\t\t\t\tscale = scale || {\n\t\t\t\t\tx: 1,\n\t\t\t\t\ty: -1\n\t\t\t\t};\n\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\trect = this.drawingRect;\n\t\t\t\tctx.translate(scale.x === -1 ? rect.w : 0, scale.y === -1 ? rect.h : 0);\n\t\t\t\tctx.scale(scale.x, scale.y);\n\t\t\t},\n\t\t};\n\t\treturn Painter;\n    }]);\n\n}());\n\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.directive('controlMessages', [function() {\n        return {\n            restrict: 'E',\n            templateUrl: 'artisan/forms/messages',\n            transclude: {\n                'message': '?messageItems',\n            },\n            link: function(scope, element, attributes, model) {}\n        };\n    }]);\n\n    app.directive('control', ['$parse', function($parse) {\n        function formatLabel(string, prepend, expression) {\n            string = string || '';\n            prepend = prepend || '';\n            var splitted = string.split(',');\n            if (splitted.length > 1) {\n                var formatted = splitted.shift();\n                angular.forEach(splitted, function(value, index) {\n                    if (expression) {\n                        formatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n                    } else {\n                        formatted = formatted.split('{' + index + '}').join(prepend + value);\n                    }\n                });\n                if (expression) {\n                    return '\\'' + formatted + '\\'';\n                } else {\n                    return formatted;\n                }\n            } else {\n                return prepend + string;\n            }\n        }\n        var uniqueId = 0;\n        return {\n            restrict: 'A',\n            templateUrl: function(element, attributes) {\n                var template = 'artisan/forms/text';\n                switch (attributes.control) {\n                    case 'select':\n                        template = 'artisan/forms/select';\n                        break;\n                }\n                return template;\n            },\n            scope: {\n                ngModel: '=',\n                required: '=',\n                form: '@',\n                title: '@',\n                placeholder: '@',\n                source: '=?',\n                key: '@?',\n                label: '@?',\n            },\n            require: 'ngModel',\n            transclude: true,\n            link: {\n                pre: function preLink(scope, element, attributes, controller, transclude) {\n                    var label = scope.label = (scope.label ? scope.label : 'name');\n                    var key = scope.key = (scope.key ? scope.key : 'id');\n                    if (attributes.control === 'select') {\n                        var filter = (attributes.filter ? '| ' + attributes.filter : '');\n                        var optionLabel = formatLabel(label, 'item.', true);\n                        scope.getOptions = function() {\n                            return attributes.number ?\n                                'item.' + key + ' as ' + optionLabel + ' disable when item.disabled for item in source ' + filter :\n                                optionLabel + ' disable when item.disabled for item in source ' + filter + ' track by item.' + key;\n                        };\n                    }\n                    var type = scope.type = attributes.control;\n                    var form = scope.form = scope.form || 'form';\n                    var title = scope.title = scope.title || 'untitled';\n                    var placeholder = scope.placeholder = scope.placeholder || title;\n                    var field = scope.field = title.replace(/[^0-9a-zA-Z]/g, \"\").split(' ').join('') + (++uniqueId);\n                    scope.format = attributes.format || null;\n                    scope.precision = attributes.precision || null;\n                    scope.validate = attributes.validate || attributes.control;\n                    scope.minLength = attributes.minLength || 0;\n                    scope.maxLength = attributes.maxLength || Number.POSITIVE_INFINITY;\n                    scope.min = attributes.min || null;\n                    scope.max = attributes.max || null;\n                    scope.options = $parse(attributes.options)(scope) || {};\n                    scope.focus = false;\n                    scope.visible = false;\n                    scope.onChange = function(model) {\n                        $parse(attributes.onChange)(scope.$parent);\n                    };\n                    scope.onFilter = function(model) {\n                        $parse(attributes.onFilter)(scope.$parent);\n                    };\n                    scope.getType = function() {\n                        var type = 'text';\n                        switch (attributes.control) {\n                            case 'password':\n                                type = scope.visible ? 'text' : 'password';\n                                break;\n                            default:\n                                type = attributes.control;\n                        }\n                        return type;\n                    };\n                    scope.getClasses = function() {\n                        var form = $parse(scope.form)(scope.$parent);\n                        var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                        return {\n                            'control-focus': scope.focus,\n                            'control-success': field.$valid,\n                            'control-error': field.$invalid && (form.$submitted || field.$touched),\n                            'control-empty': !field.$viewValue\n                        };\n                    };\n                    scope.getMessages = function() {\n                        var form = $parse(scope.form)(scope.$parent);\n                        var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                        return (form.$submitted || field.$touched) && field.$error;\n                    };\n                    scope.toggleVisibility = function() {\n                        scope.visible = !scope.visible;\n                    };\n                },\n            },\n        };\n    }]);\n\n    app.directive('_control', ['$http', '$templateCache', '$compile', '$parse', function($http, $templateCache, $compile, $parse) {\n        function formatLabel(string, prepend, expression) {\n            string = string || '';\n            prepend = prepend || '';\n            var splitted = string.split(',');\n            if (splitted.length > 1) {\n                var formatted = splitted.shift();\n                angular.forEach(splitted, function(value, index) {\n                    if (expression) {\n                        formatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n                    } else {\n                        formatted = formatted.split('{' + index + '}').join(prepend + value);\n                    }\n                });\n                if (expression) {\n                    return '\\'' + formatted + '\\'';\n                } else {\n                    return formatted;\n                }\n            } else {\n                return prepend + string;\n            }\n        }\n        var uniqueId = 0;\n        return {\n            restrict: 'A',\n            templateUrl: function(element, attributes) {\n                var template = 'artisan/forms/text';\n                switch (attributes.control) {\n                    case 'select':\n                        template = 'artisan/forms/select';\n                        break;\n                }\n                return template;\n            },\n            scope: {\n                ngModel: '=',\n                required: '=',\n                form: '@',\n                title: '@',\n                placeholder: '@',\n            },\n            require: 'ngModel',\n            /*\n            link: function(scope, element, attributes, model) {\n            },\n            */\n            compile: function(element, attributes) {\n                    return {\n                        pre: function(scope, element, attributes) {\n                            if (attributes.control === 'select') {\n                                var label = (attributes.label ? attributes.label : 'name');\n                                var key = (attributes.key ? attributes.key : 'id');\n                                var filter = (attributes.min ? ' | filter:gte(\\'' + key + '\\', ' + attributes.min + ')' : '');\n                                var optionLabel = formatLabel(label, 'item.', true);\n                                scope.options = attributes.number ?\n                                    'item.' + key + ' as ' + optionLabel + ' disable when item.disabled for item in ' + attributes.source + filter :\n                                    optionLabel + ' disable when item.disabled for item in ' + attributes.source + filter + ' track by item.' + key;\n                                console.log('control.compile.pre', scope.options);\n                            }\n                            var type = scope.type = attributes.control;\n                            var form = scope.form = scope.form || 'form';\n                            var title = scope.title = scope.title || 'untitled';\n                            var placeholder = scope.placeholder = scope.placeholder || title;\n                            var field = scope.field = title.replace(/[^0-9a-zA-Z]/g, \"\").split(' ').join('') + (++uniqueId);\n                            scope.validate = attributes.validate || attributes.control;\n                            scope.format = attributes.format || null;\n                            scope.precision = attributes.precision || null;\n                            scope.validate = attributes.validate || attributes.control;\n                            scope.minLength = attributes.min || 0;\n                            scope.maxLength = attributes.max || Number.POSITIVE_INFINITY;\n                            scope.options = $parse(attributes.options)(scope) || {};\n                            scope.focus = false;\n                            scope.visible = false;\n                            scope.getType = function() {\n                                var type = 'text';\n                                switch (attributes.control) {\n                                    case 'password':\n                                        // var form = $parse(scope.form)(scope.$parent);\n                                        // var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                        type = scope.visible ? 'text' : 'password';\n                                        break;\n                                    default:\n                                        type = attributes.control;\n                                }\n                                // console.log('control.getType', type);\n                                return type;\n                            };\n                            scope.getClasses = function() {\n                                var form = $parse(scope.form)(scope.$parent);\n                                var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                return {\n                                    'control-focus': scope.focus,\n                                    'control-success': field.$valid,\n                                    'control-error': field.$invalid && (form.$submitted || field.$touched),\n                                    'control-empty': !field.$viewValue\n                                };\n                            };\n                            scope.getMessages = function() {\n                                var form = $parse(scope.form)(scope.$parent);\n                                var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                return (form.$submitted || field.$touched) && field.$error;\n                            };\n                        },\n                        // post: function (scope, element, attributes) { }\n                    };\n                }\n                /*\n                compile: function(element, attributes) {\n                    element.removeAttr('my-dir'); \n                    element.attr('ng-hide', 'true');\n                    return function(scope) {\n                        $compile(element)(scope);\n                    };\n                },\n                */\n        };\n    }]);\n\n    app.directive('numberPicker', ['$parse', '$timeout', function($parse, $timeout) {\n        return {\n            restrict: 'A',\n            template: '<div class=\"input-group\">' +\n                '   <span class=\"input-group-btn\"><button class=\"btn btn-outline-primary\" type=\"button\">-</button></span>' +\n                '   <div ng-transclude></div>' +\n                '   <span class=\"input-group-btn\"><button class=\"btn btn-outline-primary\" type=\"button\">+</button></span>' +\n                '</div>',\n            replace: true,\n            transclude: true,\n            link: function(scope, element, attributes, model) {\n                var node = element[0];\n                var nodeRemove = node.querySelectorAll('.input-group-btn > .btn')[0];\n                var nodeAdd = node.querySelectorAll('.input-group-btn > .btn')[1];\n\n                function onRemove(e) {\n                    var min = $parse(attributes.min)(scope);\n                    var getter = $parse(attributes.numberPicker);\n                    var setter = getter.assign;\n                    $timeout(function() {\n                        setter(scope, Math.max(min, getter(scope) - 1));\n                    });\n                    // console.log('numberPicker.onRemove', min);\n                }\n\n                function onAdd(e) {\n                    var max = $parse(attributes.max)(scope);\n                    var getter = $parse(attributes.numberPicker);\n                    var setter = getter.assign;\n                    $timeout(function() {\n                        setter(scope, Math.min(max, getter(scope) + 1));\n                    });\n                    // console.log('numberPicker.onAdd', max);\n                }\n\n                function addListeners() {\n                    angular.element(nodeRemove).on('touchstart mousedown', onRemove);\n                    angular.element(nodeAdd).on('touchstart mousedown', onAdd);\n                }\n\n                function removeListeners() {\n                    angular.element(nodeRemove).off('touchstart mousedown', onRemove);\n                    angular.element(nodeAdd).off('touchstart mousedown', onAdd);\n                }\n                scope.$on('$destroy', function() {\n                    removeListeners();\n                });\n                addListeners();\n            }\n        };\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.directive('validate', ['$filter', function($filter) {\n        return {\n            require: 'ngModel',\n            link: function(scope, element, attributes, model) {\n                var type = attributes.validate;\n                var format = attributes.format || '';\n                var precision = attributes.precision || 2;\n                var focus = false;\n                // console.log('validate', type);\n                switch (type) {\n                    case 'date':\n                    case 'datetime':\n                    case 'datetime-local':\n                        model.$formatters.push(function(value) {\n                            if (value) {\n                                return $filter('date')(value, format);\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                    case 'number':\n                        model.$parsers.unshift(function(value) {\n                            var valid = false;\n                            if (value !== undefined && value !== \"\") {\n                                valid = String(value).indexOf(Number(value).toString()) !== -1; // isFinite(value); // \n                                value = Number(value);\n                                model.$setValidity('number', valid);\n                                if (valid) {\n                                    model.$setValidity('positive', value >= 0.01);\n                                    if (attributes.min !== undefined) {\n                                        model.$setValidity('range', value >= Number(attributes.min));\n                                    }\n                                    if (attributes.max !== undefined) {\n                                        model.$setValidity('range', value <= Number(attributes.max));\n                                    }\n                                }\n                            } else {\n                                valid = true;\n                                value = Number(value);\n                                model.$setValidity('number', true);\n                                model.$setValidity('positive', true);\n                                if (attributes.min !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                                if (attributes.max !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                            }\n                            return value;\n                        });\n                        model.$formatters.push(function(value) {\n                            if (value) {\n                                return $filter('number')(value, precision) + ' ' + format;\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                    case 'anynumber':\n                        model.$parsers.unshift(function(value) {\n                            var valid = false;\n                            if (value !== undefined && value !== \"\") {\n                                valid = String(value).indexOf(Number(value).toString()) !== -1; // isFinite(value); // \n                                value = Number(value);\n                                model.$setValidity('number', valid);\n                                if (valid) {\n                                    if (attributes.min !== undefined) {\n                                        model.$setValidity('range', value >= Number(attributes.min));\n                                    }\n                                    if (attributes.max !== undefined) {\n                                        model.$setValidity('range', value <= Number(attributes.max));\n                                    }\n                                }\n                            } else {\n                                valid = true;\n                                value = Number(value);\n                                model.$setValidity('number', true);\n                                if (attributes.min !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                                if (attributes.max !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                            }\n                            return value;\n                        });\n                        model.$formatters.push(function(value) {\n                            if (value || value === 0) {\n                                return $filter('number')(value, precision) + ' ' + format;\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                }\n\n                function onFocus() {\n                    focus = true;\n                    if (format) {\n                        element[0].value = model.$modelValue || null;\n                        if (!model.$modelValue) {\n                            model.$setViewValue(null);\n                        }\n                    }\n                }\n\n                function doBlur() {\n                    if (format && !model.$invalid) {\n                        switch (type) {\n                            case 'date':\n                            case 'datetime':\n                            case 'datetime-local':\n                                element[0].value = model.$modelValue ? $filter('date')(model.$modelValue, format) : ' ';\n                                break;\n                            default:\n                                element[0].value = model.$modelValue ? $filter('number')(model.$modelValue, precision) + ' ' + format : ' ';\n                                break;\n                        }\n                    }\n                }\n\n                function onBlur() {\n                    focus = false;\n                    doBlur();\n                }\n\n                function addListeners() {\n                    element.on('focus', onFocus);\n                    element.on('blur', onBlur);\n                }\n\n                function removeListeners() {\n                    element.off('focus', onFocus);\n                    element.off('blur', onBlur);\n                }\n                scope.$on('$destroy', function() {\n                    removeListeners();\n                });\n                addListeners();\n            }\n        };\n    }]);\n\n}());\n/* global angular */\r\n\r\n(function () {\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.directive('modalView', ['$parse', '$templateRequest', '$compile', '$controller', 'Dom', function ($parse, $templateRequest, $compile, $controller, Dom) {\r\n\r\n\t\tfunction compileController(scope, element, html, data) {\r\n\t\t\t// console.log('modalView.compileController', element);\r\n\t\t\telement.html(html);\r\n\t\t\tvar link = $compile(element.contents());\r\n\t\t\tif (data.controller) {\r\n\t\t\t\tvar $scope = scope.$new();\r\n\t\t\t\tangular.extend($scope, data);\r\n\t\t\t\tvar controller = $controller(data.controller, {\r\n\t\t\t\t\t$scope: $scope\r\n\t\t\t\t});\r\n\t\t\t\tif (data.controllerAs) {\r\n\t\t\t\t\tscope[data.controllerAs] = controller;\r\n\t\t\t\t}\r\n\t\t\t\telement.data('$ngControllerController', controller);\r\n\t\t\t\telement.children().data('$ngControllerController', controller);\r\n\t\t\t\tscope = $scope;\r\n\t\t\t}\r\n\t\t\tlink(scope);\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\trestrict: 'A',\r\n\t\t\tpriority: -400,\r\n\t\t\tlink: function (scope, element, attributes, model) {\r\n\t\t\t\tvar modal = $parse(attributes.modalView);\r\n\t\t\t\tmodal = modal(scope);\r\n\t\t\t\tmodal.templateUrl = modal.templateUrl || 'artisan/modals/modal';\r\n\t\t\t\t$templateRequest(modal.templateUrl).then(function (html) {\r\n\t\t\t\t\tcompileController(scope, element, html, modal);\r\n\t\t\t\t});\r\n\t\t\t\t/*\r\n\t\t\t\t// window.scrollTo(0, element[0].offsetTop - 100);\r\n\t\t\t\tfunction onClick(e) {\r\n\t\t\t\t    var closest = Dom.getClosestNode(e.target, element[0]);\r\n\t\t\t\t    if (closest === null) {\r\n\t\t\t\t        modal.reject(null);\r\n\t\t\t\t    }\r\n\t\t\t\t    // console.log('onClick', closest);\r\n\t\t\t\t}\r\n\t\t\t\tfunction addListeners() {\r\n\t\t\t\t    angular.element(window).on('click', onClick);\r\n\t\t\t\t}\r\n\t\t\t\tfunction removeListeners() {\r\n\t\t\t\t    angular.element(window).off('click', onClick);\r\n\t\t\t\t}\r\n\t\t\t\tscope.$on('destroy', function () {\r\n\t\t\t\t    removeListeners();\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    addListeners();\r\n\t\t\t\t}, 500);\r\n\t\t\t\t*/\r\n\t\t\t}\r\n\t\t};\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.provider('$modal', [function $modalProvider() {\r\n\r\n        var modals = [];\r\n        var routes = {};\r\n\r\n        this.modals = modals;\r\n        this.routes = routes;\r\n        this.when = when;\r\n\r\n        function when(path, modal) {\r\n            routes[path] = modal;\r\n            return this;\r\n        }\r\n\r\n        this.$get = ['$q', '$timeout', function modalFactory($q, $timeout) {\r\n\r\n            function popModal(modal) {\r\n                // console.log('modalProvider.popModal', modal);                \r\n                var index = -1;\r\n                angular.forEach(modals, function(m, i) {\r\n                    if (m === modal) {\r\n                        index = i;\r\n                    }\r\n                });\r\n                if (index !== -1) {\r\n                    $timeout(function() {\r\n                        modal.active = false;\r\n                        modals.splice(index, 1);\r\n                        if (modals.length) {\r\n                            modals[modals.length - 1].active = true;\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n\r\n            function closeModal(modal) {\r\n                // console.log('modalProvider.closeModal', modal);                \r\n                var index = -1;\r\n                angular.forEach(modals, function(m, i) {\r\n                    if (m === modal) {\r\n                        index = i;\r\n                    }\r\n                });\r\n                if (index !== -1) {\r\n                    modal.active = false;\r\n                    $timeout(function() {\r\n                        while (modals.length) {\r\n                            modals.splice(modals.length - 1, 1);\r\n                        }\r\n                    }, 500);\r\n                }\r\n            }\r\n\r\n            function addModal(path, params) {\r\n                // console.log('modalProvider.addModal', path, params);\r\n                var deferred = $q.defer();\r\n                params = params || null;\r\n                var modal = {\r\n                    title: 'Untitled',\r\n                    controller: null,\r\n                    templateUrl: null,\r\n                    params: params,\r\n                };\r\n                var current = routes[path];\r\n                if (current) {\r\n                    angular.extend(modal, current);\r\n                }\r\n                modal.deferred = deferred;\r\n                modal.back = function(data) {\r\n                    popModal(this);\r\n                    modal.deferred.resolve(data, modal);\r\n                }\r\n                modal.resolve = function(data) {\r\n                    closeModal(this);\r\n                    modal.deferred.resolve(data, modal);\r\n                }\r\n                modal.reject = function() {\r\n                    closeModal(this);\r\n                    modal.deferred.reject(modal);\r\n                }\r\n                modals.push(modal);\r\n                angular.forEach(modals, function(m, i) {\r\n                    m.active = false;\r\n                });\r\n                if (modals.length) {\r\n                    modal.active = true;\r\n                } else {\r\n                    $timeout(function() {\r\n                        modal.active = true;\r\n                        // window.scrollTo(0, 0);\r\n                    }, 500);\r\n                }\r\n                return deferred.promise;\r\n            }\r\n\r\n            return {\r\n                modals: modals,\r\n                addModal: addModal,\r\n            };\r\n        }];\r\n\r\n    }]);\r\n\r\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.directive('nav', ['$parse', 'Nav', function ($parse, Nav) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\treturn attributes.template || 'artisan/nav/nav';\n\t\t\t},\n\t\t\tscope: {\n\t\t\t\titems: '=nav',\n\t\t\t},\n\t\t\tlink: function (scope, element, attributes, model) {\n\t\t\t\tscope.$watch('items', function (value) {\n\t\t\t\t\t// console.log(value instanceof Nav, value);\n\t\t\t\t\tif (value) {\n\t\t\t\t\t\tif (angular.isArray(value)) {\n\t\t\t\t\t\t\tvar onLink = $parse(attributes.onLink)(scope.$parent);\n\t\t\t\t\t\t\tvar onNav = $parse(attributes.onNav)(scope.$parent);\n\t\t\t\t\t\t\tvar nav = new Nav({\n\t\t\t\t\t\t\t\tonLink: onLink,\n\t\t\t\t\t\t\t\tonNav: onNav\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tnav.setItems(value);\n\t\t\t\t\t\t\tscope.item = nav;\n\n\t\t\t\t\t\t} else if (value instanceof Nav) {\n\t\t\t\t\t\t\tscope.item = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n    }]);\n\n\tapp.directive('navItem', ['$timeout', 'Events', function ($timeout, Events) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\treturn attributes.template || 'artisan/nav/nav-item';\n\t\t\t},\n\t\t\tscope: {\n\t\t\t\titem: '=navItem',\n\t\t\t},\n\t\t\tlink: function (scope, element, attributes, model) {\n\t\t\t\tvar navItem = angular.element(element[0].querySelector('.nav-link'));\n\n\t\t\t\tvar output;\n\n\t\t\t\tfunction itemOpen(item, immediate) {\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tstate.active = true;\n\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tstate.immediate = immediate;\n\t\t\t\t\t\tstate.closed = state.closing = false;\n\t\t\t\t\t\tstate.opening = true;\n\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\tstate.opening = false;\n\t\t\t\t\t\t\tstate.opened = true;\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction itemClose(item, immediate) {\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tstate.active = false;\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tstate.immediate = immediate;\n\t\t\t\t\t\tstate.opened = state.opening = false;\n\t\t\t\t\t\tstate.closing = true;\n\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\tstate.closing = false;\n\t\t\t\t\t\t\tstate.closed = true;\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tif (item.items) {\n\t\t\t\t\t\tangular.forEach(item.items, function (o) {\n\t\t\t\t\t\t\titemClose(o, true);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction itemToggle(item) {\n\t\t\t\t\t// console.log('itemToggle', item);\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tstate.active = item.items ? !state.active : true;\n\t\t\t\t\tif (state.active) {\n\t\t\t\t\t\tif (item.$nav.parent) {\n\t\t\t\t\t\t\tangular.forEach(item.$nav.parent.items, function (o) {\n\t\t\t\t\t\t\t\tif (o !== item) {\n\t\t\t\t\t\t\t\t\titemClose(o, true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\titemOpen(item);\n\t\t\t\t\t} else {\n\t\t\t\t\t\titemClose(item);\n\t\t\t\t\t}\n\t\t\t\t\t// console.log(state);\n\t\t\t\t}\n\n\t\t\t\tfunction onDown(e) {\n\t\t\t\t\tvar item = scope.item;\n\t\t\t\t\t// console.log('Item.onDown', item);\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tif (state.active) {\n\t\t\t\t\t\toutput = false;\n\t\t\t\t\t\ttrigger();\n\t\t\t\t\t} else if (item.$nav.onNav) {\n\t\t\t\t\t\tvar promise = item.$nav.onNav(item, item.$nav);\n\t\t\t\t\t\tif (promise && typeof promise.then === 'function') {\n\t\t\t\t\t\t\tpromise.then(function (resolved) {\n\t\t\t\t\t\t\t\t// go on\n\t\t\t\t\t\t\t\ttrigger();\n\t\t\t\t\t\t\t}, function (rejected) {\n\t\t\t\t\t\t\t\t// do nothing\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\toutput = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\toutput = promise;\n\t\t\t\t\t\t\ttrigger();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction trigger() {\n\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\titemToggle(item);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// preventDefault(e);\n\t\t\t\t}\n\n\t\t\t\tfunction onClick(e) {\n\t\t\t\t\t// console.log('Item.onClick', e);\n\t\t\t\t\treturn preventDefault(e);\n\t\t\t\t}\n\n\t\t\t\tfunction preventDefault(e) {\n\t\t\t\t\tif (output === false) {\n\t\t\t\t\t\t// console.log('Item.preventDefault', e);\n\t\t\t\t\t\te.stop();\n\t\t\t\t\t\t// e.preventDefault();\n\t\t\t\t\t\t// e.stopPropagation();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar events = new Events(navItem).add({\n\t\t\t\t\tdown: onDown,\n\t\t\t\t\tclick: onClick,\n\t\t\t\t}, scope);\n\n\t\t\t}\n\t\t};\n    }]);\n\n\tapp.directive('navTo', ['$parse', '$timeout', 'Events', function ($parse, $timeout, Events) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tlink: function (scope, element, attributes) {\n\n\t\t\t\tfunction onDown(e) {\n\t\t\t\t\tconsole.log('navTo.onDown', attributes.navTo);\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tvar callback = $parse(attributes.navTo);\n\t\t\t\t\t\tcallback(scope);\n\t\t\t\t\t});\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tvar events = new Events(element).add({\n\t\t\t\t\tdown: onDown,\n\t\t\t\t}, scope);\n\n\t\t\t}\n\t\t};\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Nav', ['Silent', function (Silent) {\n\n\t\tfunction Nav(options) {\n\t\t\tvar nav = this;\n\t\t\tvar defaults = {\n\t\t\t\titems: [],\n\t\t\t}\n\t\t\tangular.extend(nav, defaults);\n\t\t\tif (options) {\n\t\t\t\tangular.extend(nav, options);\n\t\t\t}\n\t\t\tnav.setNav(nav, null);\n\t\t}\n\n\t\tvar statics = {\n\t\t\tsilent: NavSilent,\n\t\t\tpath: NavPath,\n\t\t};\n\n\t\tvar methods = {\n\t\t\taddItem: addItem,\n\t\t\taddItems: addItems,\n\t\t\tgetLink: getLink,\n\t\t\tsetItems: setItems,\n\t\t\tsetNav: setNav,\n\t\t\tsetNavs: setNavs,\n\t\t};\n\n\t\tangular.extend(Nav, statics);\n\t\tangular.extend(Nav.prototype, methods);\n\n\t\treturn Nav;\n\n\t\t// static methods\n\n\t\tfunction NavSilent(path) {\n\t\t\tSilent.silent(path);\n\t\t}\n\n\t\tfunction NavPath(path) {\n\t\t\tSilent.path(path);\n\t\t}\n\n\t\t// prototype methods\n\n\t\tfunction setItems(items) {\n\t\t\tvar nav = this;\n\t\t\tnav.path = Silent.path();\n\t\t\tnav.items = items;\n\t\t\tnav.setNavs(items, nav);\n\t\t}\n\n\t\tfunction setNavs(items, parent) {\n\t\t\tvar nav = this;\n\t\t\tif (items) {\n\t\t\t\tangular.forEach(items, function (item) {\n\t\t\t\t\tnav.setNav(item, parent);\n\t\t\t\t\tnav.setNavs(item.items, item);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tfunction setNav(item, parent) {\n\t\t\tvar nav = this;\n\t\t\tvar $nav = {\n\t\t\t\tparent: parent || null,\n\t\t\t\tlevel: parent ? parent.$nav.level + 1 : 0,\n\t\t\t\tstate: {},\n\t\t\t\taddItems: function (x) {\n\t\t\t\t\tnav.addItems(x, item);\n\t\t\t\t},\n\t\t\t\tonNav: nav.onNav,\n\t\t\t};\n\t\t\titem.$nav = $nav;\n\t\t\t$nav.link = nav.getLink(item);\n\t\t\tif ($nav.link === nav.path) {\n\t\t\t\t$nav.state.active = true;\n\t\t\t\t$nav.state.opened = true;\n\t\t\t\twhile ($nav.parent) {\n\t\t\t\t\t$nav = $nav.parent.$nav;\n\t\t\t\t\t$nav.state.active = true;\n\t\t\t\t\t$nav.state.opened = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction addItems(itemOrItems, parent) {\n\t\t\tvar nav = this;\n\t\t\tif (angular.isArray(itemOrItems)) {\n\t\t\t\tangular.forEach(itemOrItems, function (item) {\n\t\t\t\t\tnav.addItem(item, parent);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tnav.addItem(itemOrItems, parent);\n\t\t\t}\n\t\t}\n\n\t\tfunction addItem(item, parent) {\n\t\t\tvar nav = this,\n\t\t\t\tonLink = nav.onLink,\n\t\t\t\tonNav = nav.onNav;\n\t\t\tnav.setNav(item, parent);\n\t\t\tif (parent) {\n\t\t\t\tparent.items = parent.items || [];\n\t\t\t\tparent.items.push(item);\n\t\t\t}\n\t\t}\n\n\t\tfunction getLink(item) {\n\t\t\tvar link = null;\n\t\t\tif (this.onLink) {\n\t\t\t\tlink = this.onLink(item, item.$nav);\n\t\t\t} else {\n\t\t\t\tlink = item.link;\n\t\t\t}\n\t\t\treturn link;\n\t\t}\n\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\twindow.ondragstart = function () {\n\t\treturn false;\n\t};\n\n\tvar app = angular.module('artisan');\n\n\tapp.directive('scrollableX', ['$parse', '$compile', '$timeout', 'Scrollable', 'Animate', 'Style', 'Events', 'Utils', function ($parse, $compile, $timeout, Scrollable, Animate, Style, Events, Utils) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplate: '<div class=\"scrollable-content\" ng-transclude></div>',\n\t\t\ttransclude: true,\n\t\t\tlink: function (scope, element, attributes, model) {\n\n\t\t\t\tvar onLeft, onRight, showIndicatorFor, scrollableWhen;\n\t\t\t\tif (attributes.onLeft) {\n\t\t\t\t\tonLeft = $parse(attributes.onLeft);\n\t\t\t\t}\n\t\t\t\tif (attributes.onRight) {\n\t\t\t\t\tonRight = $parse(attributes.onRight);\n\t\t\t\t}\n\t\t\t\tif (attributes.showIndicatorFor) {\n\t\t\t\t\tshowIndicatorFor = $parse(attributes.showIndicatorFor);\n\t\t\t\t}\n\t\t\t\tif (attributes.scrollableWhen) {\n\t\t\t\t\tscrollableWhen = $parse(attributes.scrollableWhen);\n\t\t\t\t}\n\n\t\t\t\t// ELEMENTS & STYLESHEETS;\n\t\t\t\telement.attr('unselectable', 'on').addClass('unselectable');\n\t\t\t\tvar containerNode = element[0];\n\t\t\t\tvar contentNode = containerNode.querySelector('.scrollable-content');\n\t\t\t\tvar content = angular.element(content);\n\t\t\t\tvar contentStyle = new Style();\n\n\t\t\t\tvar animate = new Animate(render);\n\n\t\t\t\tvar scrollable = attributes.scrollableX ? $parse(attributes.scrollableX)(scope) : new Scrollable();\n\n\t\t\t\tlink(scrollable);\n\n\t\t\t\tfunction link(scrollable) {\n\t\t\t\t\tscrollable.link({\n\t\t\t\t\t\tgetItems: function () {\n\t\t\t\t\t\t\tif (attributes.scrollableItem) {\n\t\t\t\t\t\t\t\tvar items = containerNode.querySelectorAll(attributes.scrollableItem);\n\t\t\t\t\t\t\t\treturn items;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tprev: function () {\n\t\t\t\t\t\t\tscrollable.scrollPrev();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnext: function () {\n\t\t\t\t\t\t\tscrollable.scrollNext();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\treset: function () {\n\t\t\t\t\t\t\tscrollable.doReset();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonLeft: onLeft,\n\t\t\t\t\t\tonRight: onRight,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t/*\n\t\t\t\tscope.$watch(attributes.scrollableX, function (newValue) {\n\t\t\t\t\tconsole.log(newValue);\n\t\t\t\t});\n\t\t\t\t*/\n\n\t\t\t\t/*\n\t\t\t\tvar indicator = null,\n\t\t\t\t\tindicatorNode = null,\n\t\t\t\t\tindicatorStyle;\n\t\t\t\tshowIndicatorFor = false;\n\t\t\t\tif (showIndicatorFor) {\n\t\t\t\t\tindicator = angular.element('<div class=\"indicator\"></div>');\n\t\t\t\t\tindicatorNode = indicator[0];\n\t\t\t\t\tindicatorStyle = new Style();\n\t\t\t\t\telement.append(indicator);\n\t\t\t\t\t$compile(indicator.contents())(scope);\n\t\t\t\t\tvar i = scrollbar.getIndicator();\n\t\t\t\t\tindicatorStyle.transform('translate3d(' + i.x.toFixed(2) + 'px,' + i.y.toFixed(2) + 'px,0)');\n\t\t\t\t\tindicatorStyle.set(indicatorNode);\n\t\t\t\t}\n\t\t\t\t*/\n\n\t\t\t\tfunction render(time) {\n\t\t\t\t\tscrollable.setContainer(containerNode);\n\t\t\t\t\tscrollable.setContent(contentNode);\n\t\t\t\t\tscrollable.setEnabled(isEnabled());\n\t\t\t\t\tvar animating = scrollable.renderX();\n\t\t\t\t\tif (!animating) {\n\t\t\t\t\t\t// animate.pause();\n\t\t\t\t\t}\n\t\t\t\t\tvar current = scrollable.getCurrent();\n\t\t\t\t\tcontentStyle.transform('translate3d(' + current.x.toFixed(2) + 'px,0,0)');\n\t\t\t\t\tcontentStyle.set(contentNode);\n\t\t\t\t\t/*\n\t\t\t\t\tif (showIndicatorFor) {\n\t\t\t\t\t\tif (dragging || wheeling || speed) {\n\t\t\t\t\t\t\tvar percent = c.x / (containerNode.offsetWidth - contentNode.offsetWidth);\n\t\t\t\t\t\t\tpercent = Math.max(0, Math.min(1, percent));\n\t\t\t\t\t\t\ti.x = (containerNode.offsetWidth - indicatorNode.offsetWidth) * (percent);\n\t\t\t\t\t\t\ti.y += (0 - i.y) / 4;\n\t\t\t\t\t\t\t// var count = Math.round(contentNode.offsetWidth / 315);\n\t\t\t\t\t\t\tvar index = Math.max(1, Math.round(percent * showIndicatorFor.rows.length));\n\t\t\t\t\t\t\tindicator.html(index + '/' + showIndicatorFor.count);\n\t\t\t\t\t\t\t// indicator.html((percent * 100).toFixed(2).toString());\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ti.y += (45 - i.y) / 4;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tindicatorStyle.transform('translate3d(' + i.x.toFixed(2) + 'px,' + i.y.toFixed(2) + 'px,0)');\n\t\t\t\t\t\tindicatorStyle.set(indicatorNode);\n\t\t\t\t\t}\n\t\t\t\t\t*/\n\t\t\t\t}\n\n\t\t\t\tfunction undrag() {\n\t\t\t\t\tscrollable.off();\n\t\t\t\t\tdragOff();\n\t\t\t\t}\n\n\t\t\t\tfunction onDown(event) {\n\t\t\t\t\tif (scrollable.dragStart(event.absolute)) {\n\t\t\t\t\t\tdragOn();\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onMove(event) {\n\t\t\t\t\tscrollable.dragMove(event.absolute);\n\t\t\t\t\tvar drag = scrollable.getDrag();\n\t\t\t\t\tif (Math.abs(drag.y) > Math.abs(drag.x)) {\n\t\t\t\t\t\tonUp(event);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onUp(event) {\n\t\t\t\t\tscrollable.dragEnd(event.absolute);\n\t\t\t\t\tevent.stop();\n\t\t\t\t\tdragOff();\n\t\t\t\t}\n\n\t\t\t\tfunction _onScrollX(dir, interval) {\n\t\t\t\t\treturn scrollable.wheelX(dir, interval);\n\t\t\t\t}\n\n\t\t\t\tvar onScrollX = _onScrollX;\n\t\t\t\t// var onScrollX = Utils.throttle(_onScrollX, 25);\n\n\t\t\t\tfunction onWheel(event) {\n\t\t\t\t\t// console.log('onWheelX', event.dir, scrollable.wheelXCheck(event.dir));\n\t\t\t\t\tif (scrollable.wheelXCheck(event.dir)) {\n\t\t\t\t\t\tonScrollX(event.dir, event.interval);\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction off() {\n\t\t\t\t\tdragOff();\n\t\t\t\t\t// animate.pause();\n\t\t\t\t\tscrollable.off();\n\t\t\t\t}\n\n\t\t\t\tfunction isEnabled() {\n\t\t\t\t\tvar enabled = true;\n\t\t\t\t\tif (scrollableWhen) {\n\t\t\t\t\t\tenabled = enabled && scrollableWhen(scope);\n\t\t\t\t\t}\n\t\t\t\t\tenabled = enabled && window.innerWidth >= 1024;\n\t\t\t\t\tenabled = enabled && (containerNode.offsetWidth < contentNode.offsetWidth);\n\t\t\t\t\treturn enabled;\n\t\t\t\t}\n\n\t\t\t\tfunction onResize() {\n\t\t\t\t\tvar enabled = isEnabled();\n\t\t\t\t\tif (!enabled) {\n\t\t\t\t\t\toff();\n\t\t\t\t\t}\n\t\t\t\t\trender();\n\t\t\t\t}\n\n\t\t\t\tscope.$watch(function () {\n\t\t\t\t\treturn contentNode.offsetWidth;\n\t\t\t\t}, function (newValue, oldValue) {\n\t\t\t\t\tonResize();\n\t\t\t\t});\n\n\t\t\t\tvar events = new Events(element).add({\n\t\t\t\t\tdown: onDown,\n\t\t\t\t\twheel: onWheel,\n\t\t\t\t}, scope);\n\n\t\t\t\tvar windowEvents = new Events(window).add({\n\t\t\t\t\tresize: onResize,\n\t\t\t\t}, scope);\n\n\t\t\t\tfunction dragOn() {\n\t\t\t\t\twindowEvents.add({\n\t\t\t\t\t\tmove: onMove,\n\t\t\t\t\t\tup: onUp,\n\t\t\t\t\t}, scope);\n\t\t\t\t}\n\n\t\t\t\tfunction dragOff() {\n\t\t\t\t\twindowEvents.remove({\n\t\t\t\t\t\tmove: onMove,\n\t\t\t\t\t\tup: onUp,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tanimate.pause();\n\t\t\t\t});\n\n\t\t\t},\n\t\t};\n    }]);\n\n\tapp.directive('scrollableY', ['$parse', '$compile', '$timeout', 'Scrollable', 'Animate', 'Style', 'Events', 'Utils', function ($parse, $compile, $timeout, Scrollable, Animate, Style, Events, Utils) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplate: '<div class=\"scrollable-content\" ng-transclude></div>',\n\t\t\ttransclude: true,\n\t\t\tlink: function (scope, element, attributes, model) {\n\n\t\t\t\tvar onTop, onBottom, showIndicatorFor, scrollableWhen;\n\t\t\t\tif (attributes.onTop) {\n\t\t\t\t\tonTop = $parse(attributes.onTop);\n\t\t\t\t}\n\t\t\t\tif (attributes.onBottom) {\n\t\t\t\t\tonBottom = $parse(attributes.onBottom);\n\t\t\t\t}\n\t\t\t\tif (attributes.showIndicatorFor) {\n\t\t\t\t\tshowIndicatorFor = $parse(attributes.showIndicatorFor);\n\t\t\t\t}\n\t\t\t\tif (attributes.scrollableWhen) {\n\t\t\t\t\tscrollableWhen = $parse(attributes.scrollableWhen);\n\t\t\t\t}\n\n\t\t\t\t// ELEMENTS & STYLESHEETS;\n\t\t\t\telement.attr('unselectable', 'on').addClass('unselectable');\n\t\t\t\tvar containerNode = element[0];\n\t\t\t\tvar contentNode = containerNode.querySelector('.scrollable-content');\n\t\t\t\tvar content = angular.element(content);\n\t\t\t\tvar contentStyle = new Style();\n\n\t\t\t\tvar animate = new Animate(render);\n\n\t\t\t\tvar scrollable = attributes.scrollableY ? $parse(attributes.scrollableY)(scope) : new Scrollable();\n\t\t\t\tlink(scrollable);\n\n\t\t\t\tfunction link(scrollable) {\n\t\t\t\t\tscrollable.link({\n\t\t\t\t\t\tgetItems: function () {\n\t\t\t\t\t\t\tif (attributes.scrollableItem) {\n\t\t\t\t\t\t\t\tvar items = containerNode.querySelectorAll(attributes.scrollableItem);\n\t\t\t\t\t\t\t\treturn items;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tprev: function () {\n\t\t\t\t\t\t\tscrollable.scrollPrev();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnext: function () {\n\t\t\t\t\t\t\tscrollable.scrollNext();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\treset: function () {\n\t\t\t\t\t\t\tscrollable.doReset();\n\t\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonTop: onTop,\n\t\t\t\t\t\tonBottom: onBottom,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction render(time) {\n\t\t\t\t\tscrollable.setContainer(containerNode);\n\t\t\t\t\tscrollable.setContent(contentNode);\n\t\t\t\t\tscrollable.setEnabled(isEnabled());\n\t\t\t\t\tvar animating = scrollable.renderY();\n\t\t\t\t\tif (!animating) {\n\t\t\t\t\t\t// animate.pause();\n\t\t\t\t\t}\n\t\t\t\t\tvar current = scrollable.getCurrent();\n\t\t\t\t\tcontentStyle.transform('translate3d(0,' + current.y.toFixed(2) + 'px,0)');\n\t\t\t\t\tcontentStyle.set(contentNode);\n\t\t\t\t}\n\n\t\t\t\tfunction undrag() {\n\t\t\t\t\tscrollable.off();\n\t\t\t\t\tdragOff();\n\t\t\t\t}\n\n\t\t\t\tfunction onDown(event) {\n\t\t\t\t\tif (scrollable.dragStart(event.absolute)) {\n\t\t\t\t\t\tdragOn();\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onMove(event) {\n\t\t\t\t\tscrollable.dragMove(event.absolute);\n\t\t\t\t\tvar drag = scrollable.getDrag();\n\t\t\t\t\tif (Math.abs(drag.x) > Math.abs(drag.y)) {\n\t\t\t\t\t\tonUp(event);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onUp(event) {\n\t\t\t\t\tscrollable.dragEnd(event.absolute);\n\t\t\t\t\tevent.stop();\n\t\t\t\t\tdragOff();\n\t\t\t\t}\n\n\t\t\t\tfunction _onScrollY(dir, interval) {\n\t\t\t\t\treturn scrollable.wheelY(dir, interval);\n\t\t\t\t}\n\n\t\t\t\tvar onScrollY = _onScrollY;\n\t\t\t\t// var onScrollY = Utils.throttle(_onScrollY, 25);\n\n\t\t\t\tfunction onWheel(event) {\n\t\t\t\t\t// console.log('onWheelY', event.dir, scrollable.wheelYCheck(event.dir));\n\t\t\t\t\tif (scrollable.wheelYCheck(event.dir)) {\n\t\t\t\t\t\tonScrollY(event.dir, event.interval);\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t\tevent.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction off() {\n\t\t\t\t\tdragOff();\n\t\t\t\t\t// animate.pause();\n\t\t\t\t\tscrollable.off();\n\t\t\t\t}\n\n\t\t\t\tfunction isEnabled() {\n\t\t\t\t\tvar enabled = true;\n\t\t\t\t\tif (scrollableWhen) {\n\t\t\t\t\t\tenabled = enabled && scrollableWhen(scope);\n\t\t\t\t\t}\n\t\t\t\t\tenabled = enabled && window.innerWidth >= 1024;\n\t\t\t\t\tenabled = enabled && (containerNode.offsetHeight < contentNode.offsetHeight);\n\t\t\t\t\treturn enabled;\n\t\t\t\t}\n\n\t\t\t\tfunction onResize() {\n\t\t\t\t\tvar enabled = isEnabled();\n\t\t\t\t\tif (!enabled) {\n\t\t\t\t\t\toff();\n\t\t\t\t\t}\n\t\t\t\t\trender();\n\t\t\t\t}\n\n\t\t\t\tscope.$watch(function () {\n\t\t\t\t\treturn contentNode.offsetHeight;\n\t\t\t\t}, function (newValue, oldValue) {\n\t\t\t\t\tonResize();\n\t\t\t\t});\n\n\t\t\t\tvar events = new Events(element).add({\n\t\t\t\t\tdown: onDown,\n\t\t\t\t\twheel: onWheel,\n\t\t\t\t}, scope);\n\n\t\t\t\tvar windowEvents = new Events(window).add({\n\t\t\t\t\tresize: onResize,\n\t\t\t\t}, scope);\n\n\t\t\t\tfunction dragOn() {\n\t\t\t\t\twindowEvents.add({\n\t\t\t\t\t\tmove: onMove,\n\t\t\t\t\t\tup: onUp,\n\t\t\t\t\t}, scope);\n\t\t\t\t}\n\n\t\t\t\tfunction dragOff() {\n\t\t\t\t\twindowEvents.remove({\n\t\t\t\t\t\tmove: onMove,\n\t\t\t\t\t\tup: onUp,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tanimate.pause();\n\t\t\t\t});\n\n\t\t\t},\n\t\t};\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('Scrollable', ['Utils', 'Point', 'Rect', function(Utils, Point, Rect) {\n\n        function Scrollable() {\n\n            var padding = 150;\n            var enabled, snappable, busy, dragging, wheeling, down, move, prev;\n            var currentIndex = 0;\n\n            snappable = true;\n\n            var start = new Point(),\n                end = new Point(),\n                current = new Point(),\n                drag = new Point(),\n                indicator = new Point(),\n                offset = new Point(),\n                speed = new Point(),\n                container = new Rect(),\n                content = new Rect(),\n                overflow = new Rect();\n\n            var scrollable = {\n                // properties\n                start: start,\n                end: end,\n                current: current,\n                indicator: indicator,\n                speed: speed,\n                overflow: overflow,\n                container: container,\n                content: content,\n                // methods\n                setContainer: setContainer,\n                setContent: setContent,\n                setEnabled: setEnabled,\n                getCurrent: getCurrent,\n                getDrag: getDrag,\n                getIndicator: getIndicator,\n                getIndex: getIndex,\n                scrollToIndex: scrollToIndex,\n                scrollPrev: scrollPrev,\n                scrollNext: scrollNext,\n                dragStart: dragStart,\n                dragMove: dragMove,\n                dragEnd: dragEnd,\n                doReset: doReset,\n                off: off,\n                // x direction\n                doLeft: doLeft,\n                doRight: doRight,\n                renderX: renderX,\n                scrollToX: scrollToX,\n                wheelX: wheelX,\n                wheelXCheck: wheelXCheck,\n                // y direction\n                doTop: doTop,\n                doBottom: doBottom,\n                renderY: renderY,\n                scrollToY: scrollToY,\n                wheelY: wheelY,\n                wheelYCheck: wheelYCheck,\n            };\n\n            angular.extend(this, scrollable);\n\n            scrollable = this;\n\n            function setContainer(node) {\n                container.width = node.offsetWidth;\n                container.height = node.offsetHeight;\n            }\n\n            function setContent(node) {\n                content.width = node.offsetWidth;\n                content.height = node.offsetHeight;\n            }\n\n            function setEnabled(flag) {\n                enabled = flag;\n            }\n\n            function getCurrent() {\n                return current;\n            }\n\n            function getDrag() {\n                return drag;\n            }\n\n            function getIndicator() {\n                return indicator;\n            }\n\n            function getIndex() {\n                return currentIndex;\n            }\n\n            function scrollToIndex(index) {\n                if (index !== currentIndex) {\n                    currentIndex = index;\n                    var item = getItemAtIndex(index);\n                    if (item) {\n                        offset = new Point(\n                            item.offsetLeft,\n                            item.offsetTop\n                        );\n                        // console.log('scrollToIndex', index, offset);\n                    }\n                    return true;\n                }\n            }\n\n            function dragStart(point) {\n                if (!busy) {\n                    start.x = end.x = current.x;\n                    start.y = end.y = current.y;\n                    speed.x = 0;\n                    speed.y = 0;\n                    down = point;\n                    currentIndex = -1;\n                    wheeling = false;\n                    return true;\n                } else {\n                    return false;\n                }\n            }\n\n            function dragMove(point) {\n                prev = move;\n                move = point;\n                drag.x = move.x - down.x;\n                drag.y = move.y - down.y;\n                dragging = true;\n            }\n\n            function dragEnd() {\n                if (move && prev) {\n                    speed.x += (move.x - prev.x) * 4;\n                    speed.y += (move.y - prev.y) * 4;\n                }\n                start.x = end.x = current.x;\n                start.y = end.y = current.y;\n                dragging = false;\n                move = null;\n                down = null;\n                prev = null;\n            }\n\n            function getItemAtIndex(index) {\n                var item = null;\n                var items = scrollable.getItems();\n                if (items) {\n                    if (index >= 0 && index < items.length) {\n                        item = items[index];\n                    }\n                }\n                // console.log('getItemAtIndex', index, items.length, item);\n                return item;\n            }\n\n            function scrollPrev() {\n                var index = Math.max(0, currentIndex - 1);\n                console.log('scrollPrev', index);\n                scrollToIndex(index);\n            }\n\n            function scrollNext() {\n                var items = scrollable.getItems();\n                var index = Math.min(items.length - 1, currentIndex + 1);\n                console.log('scrollNext', index);\n                scrollToIndex(index);\n            }\n\n            function doReset() {\n                end.x = current.x = 0;\n            }\n\n            function off() {\n                dragging = false;\n                wheeling = false;\n                move = null;\n                down = null;\n            }\n\n            // x - direction\n\n            function doLeft(scope) {\n                if (busy) {\n                    return;\n                }\n                if (!scrollable.onLeft) {\n                    return;\n                }\n                busy = true;\n                scrollable.onLeft(scope).then().finally(function() {\n                    scrollToX(0);\n                });\n            }\n\n            function doRight(scope) {\n                if (busy) {\n                    return;\n                }\n                if (!scrollable.onRight) {\n                    return;\n                }\n                busy = true;\n                scrollable.onRight(scope).then().finally(function() {\n                    var right = container.width - content.width;\n                    if (right > overflow.width) {\n                        start.x = end.x = overflow.width;\n                    } else {\n                        start.x = end.x = overflow.width + padding;\n                    }\n                    scrollToX(0);\n                });\n            }\n\n            function renderX() {\n                var animating = true;\n                if (enabled) {\n                    overflow.x = 0;\n                    overflow.width = container.width - content.width;\n                    if (dragging) {\n                        end.x = start.x + move.x - down.x;\n                        if (extendX()) {\n                            start.x = end.x;\n                            down.x = move.x;\n                        }\n                    } else if (speed.x) {\n                        end.x += speed.x;\n                        speed.x *= 0.75;\n                        if (wheeling) {\n                            extendX();\n                        }\n                        if (Math.abs(speed.x) < 2.05) {\n                            speed.x = 0;\n                            scrollable.wheeling = wheeling = false;\n                            snapToNearestX();\n                        }\n                    } else if (offset) {\n                        end.x = -offset.x;\n                        offset = null;\n                    }\n                    end.x = Math.round(end.x * 10000) / 10000;\n                    end.x = Math.min(overflow.x, end.x);\n                    end.x = Math.max(overflow.width, end.x);\n                    current.x += (end.x - current.x) / 4;\n                    if (speed.x === 0 && Math.abs(end.x - current.x) < 0.05) {\n                        current.x = end.x;\n                        if (!snapToNearestX()) {\n                            animating = false;\n                        }\n                    }\n                    // console.log('renderX', current.x, end.x, overflow.x);\n                } else {\n                    current.x = end.x = 0;\n                    animating = false;\n                }\n                return animating;\n            }\n\n            function extendX() {\n                var extending = false;\n                overflow.x += padding;\n                overflow.width -= padding;\n                if (end.x > overflow.x) {\n                    extending = true;\n                    doLeft();\n                } else if (end.x < overflow.width) {\n                    extending = true;\n                    doRight();\n                }\n                return extending;\n            }\n\n            function snapToNearestX() {\n                var items = scrollable.getItems();\n                if (items) {\n                    var index = -1;\n                    var min = Number.POSITIVE_INFINITY;\n                    angular.forEach(items, function(item, i) {\n                        var distance = Math.abs((end.x + speed.x) - (item.offsetLeft * -1));\n                        if (distance < min) {\n                            min = distance;\n                            index = i;\n                        }\n                    });\n                    if (index !== -1) {\n                        if (snappable) {\n                            return scrollToIndex(index);\n                        } else {\n                            currentIndex = index;\n                        }\n                    }\n                }\n            }\n\n            function wheelXCheck(dir) {\n                // console.log('wheelYCheck', dir < 0 ? (end.x - overflow.width) : (end.x - overflow.x));\n                if (!busy && enabled) {\n                    if (dir < 0) {\n                        return end.x - overflow.width;\n                    } else {\n                        return end.x - overflow.x;\n                    }\n                } else {\n                    return false;\n                }\n            }\n\n            function wheelX(dir, interval) {\n                end.x += dir * 100 / 1000 * interval;\n                speed.x += dir * 100 / 1000 * interval;\n                wheeling = true;\n            }\n\n            function scrollToX(value) {\n                start.x = end.x = value;\n                setTimeout(function() {\n                    off();\n                    busy = false;\n                }, 500);\n            }\n\n            // y - direction\n\n            function doTop(scope) {\n                if (busy) {\n                    return;\n                }\n                if (!scrollable.onTop) {\n                    return;\n                }\n                busy = true;\n                scrollable.onTop(scope).then().finally(function() {\n                    scrollToY(0);\n                });\n            }\n\n            function doBottom(scope) {\n                if (busy) {\n                    return;\n                }\n                if (!scrollable.onBottom) {\n                    return;\n                }\n                busy = true;\n                scrollable.onBottom(scope).then().finally(function() {\n                    var bottom = container.height - content.height;\n                    if (bottom > overflow.height) {\n                        start.y = end.y = overflow.height;\n                    } else {\n                        start.y = end.y = overflow.height + padding;\n                    }\n                    scrollToY(0);\n                });\n            }\n\n            function renderY() {\n                var animating = true;\n                if (enabled) {\n                    overflow.y = 0;\n                    overflow.height = container.height - content.height;\n                    if (dragging) {\n                        end.y = start.y + move.y - down.y;\n                        if (extendY()) {\n                            start.y = end.y;\n                            down.y = move.y;\n                        }\n                    } else if (speed.y) {\n                        end.y += speed.y;\n                        speed.y *= 0.75;\n                        if (wheeling) {\n                            extendY();\n                        }\n                        if (Math.abs(speed.y) < 2.05) {\n                            speed.y = 0;\n                            scrollable.wheeling = wheeling = false;\n                            snapToNearestY();\n                        }\n                    } else if (offset) {\n                        end.y = -offset.y;\n                        offset = null;\n                    }\n                    end.y = Math.round(end.y * 10000) / 10000;\n                    end.y = Math.min(overflow.y, end.y);\n                    end.y = Math.max(overflow.height, end.y);\n                    current.y += (end.y - current.y) / 4;\n                    if (speed.y === 0 && Math.abs(end.y - current.y) < 0.05) {\n                        current.y = end.y;\n                        if (!snapToNearestY()) {\n                            animating = false;\n                        }\n                    }\n                    // console.log(parseFloat(current.y.toFixed(6)), end.y, overflow.y);\n                    // console.log(dragging, wheeling, end.y, speed.y, Math.abs(end.y - current.y));\n                } else {\n                    current.y = end.y = 0;\n                    animating = false;\n                }\n                return animating;\n            }\n\n            function extendY() {\n                var extending = false;\n                overflow.y += padding;\n                overflow.height -= padding;\n                if (end.y > overflow.y) {\n                    extending = true;\n                    doTop();\n                } else if (end.y < overflow.height) {\n                    extending = true;\n                    doBottom();\n                }\n                return extending;\n            }\n\n            function snapToNearestY() {\n                var items = scrollable.getItems();\n                if (items) {\n                    var index = -1;\n                    var min = Number.POSITIVE_INFINITY;\n                    angular.forEach(items, function(item, i) {\n                        var distance = Math.abs((end.y + speed.y) - (item.offsetTop * -1));\n                        if (distance < min) {\n                            min = distance;\n                            index = i;\n                        }\n                    });\n                    // console.log('snapToNearestY', index, min);\n                    if (index !== -1) {\n                        if (snappable) {\n                            return scrollToIndex(index);\n                        } else {\n                            currentIndex = index;\n                        }\n                    }\n                }\n            }\n\n            function wheelYCheck(dir) {\n                // console.log('wheelYCheck', dir < 0 ? (end.y - overflow.height) : (end.y - overflow.y));\n                if (!busy && enabled) {\n                    if (dir < 0) {\n                        return end.y - overflow.height;\n                    } else {\n                        return end.y - overflow.y;\n                    }\n                } else {\n                    return false;\n                }\n            }\n\n            function wheelY(dir, interval) {\n                end.y += dir * 100 / 1000 * interval;\n                speed.y += dir * 100 / 1000 * interval;\n                wheeling = true;\n            }\n\n            function scrollToY(value) {\n                start.y = end.y = value;\n                setTimeout(function() {\n                    off();\n                    busy = false;\n                }, 500);\n            }\n\n        }\n\n        function link(methods) {\n            angular.extend(this, methods);\n        }\n\n        Scrollable.prototype = {\n            link: link,\n            getItems: function() {\n                return [content];\n            },\n        };\n        return Scrollable;\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.directive('videoSource', ['$timeout', function ($timeout) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tsource: '=videoSource',\n\t\t\t\timage: '=videoImage',\n\t\t\t},\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\treturn attributes.template || 'artisan/video/video-player';\n\t\t\t},\n\t\t\tlink: function (scope, element, attributes) {\n\t\t\t\tvar native = element[0];\n\t\t\t\tvar video = native.querySelector('video');\n\t\t\t\tvar img = native.querySelector('img');\n\t\t\t\tvar infos = {};\n\t\t\t\tscope.playing = false;\n\t\t\t\tscope.busy = false;\n\t\t\t\tscope.toggle = toggle;\n\t\t\t\tscope.play = play;\n\t\t\t\tscope.pause = pause;\n\t\t\t\tscope.infos = infos;\n\n\t\t\t\tfunction toggle() {\n\t\t\t\t\tif (!scope.busy) {\n\t\t\t\t\t\tscope.busy = true;\n\t\t\t\t\t\tif (scope.playing) {\n\t\t\t\t\t\t\tvideo.pause();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvideo.play();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction play() {\n\t\t\t\t\tif (!scope.busy) {\n\t\t\t\t\t\tscope.busy = true;\n\t\t\t\t\t\tvideo.play();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction pause() {\n\t\t\t\t\tif (!scope.busy) {\n\t\t\t\t\t\tscope.busy = true;\n\t\t\t\t\t\tvideo.pause();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onPlaying(e) {\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tscope.playing = true;\n\t\t\t\t\t\tscope.busy = false;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction onPause(e) {\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tscope.playing = false;\n\t\t\t\t\t\tscope.busy = false;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction onEnded(e) {\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tscope.playing = false;\n\t\t\t\t\t\tscope.busy = false;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction onProgress(e) {\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tinfos.buffered = video.buffered; // todo: TimeRanges\n\t\t\t\t\t\tconsole.log('onProgress', infos);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction onTimeUpdate(e) {\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tinfos.duration = video.duration;\n\t\t\t\t\t\tinfos.currentTime = video.currentTime;\n\t\t\t\t\t\tinfos.progressTime = infos.currentTime / infos.duration;\n\t\t\t\t\t\tconsole.log('onTimeUpdate', infos);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tvar videoElement = angular.element(video);\n\n\t\t\t\tfunction addListeners() {\n\t\t\t\t\tvideoElement.on('playing', onPlaying);\n\t\t\t\t\tvideoElement.on('pause', onPause);\n\t\t\t\t\tvideoElement.on('ended', onEnded);\n\t\t\t\t\tvideoElement.on('progress', onProgress);\n\t\t\t\t\tvideoElement.on('timeupdate', onTimeUpdate);\n\t\t\t\t}\n\n\t\t\t\tfunction removeListeners() {\n\t\t\t\t\tvideoElement.off('playing', onPlaying);\n\t\t\t\t\tvideoElement.off('pause', onPause);\n\t\t\t\t\tvideoElement.off('ended', onEnded);\n\t\t\t\t\tvideoElement.off('progress', onProgress);\n\t\t\t\t\tvideoElement.off('timeupdate', onTimeUpdate);\n\t\t\t\t}\n\n\t\t\t\taddListeners();\n\t\t\t\tscope.$on('destroy', function () {\n\t\t\t\t\tremoveListeners();\n\t\t\t\t});\n\n\t\t\t}\n\t\t};\n    }]);\n\n\t/*\n\tObject.defineProperty(HTMLMediaElement.prototype, 'playing', {\n\t    get: function () {\n\t        return !!(this.currentTime > 0 && !this.paused && !this.ended && this.readyState > 2);\n\t    }\n\t});\n\t*/\n\n}());\n/* global angular */\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\t// micro interactions\n\n\tfunction tap(Events) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tpriority: 0,\n\t\t\tlink: link\n\t\t};\n\n\t\tfunction link(scope, element, attributes, model) {\n\t\t\tif (attributes.ngBind) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t/*\n\t\t\tif (attributes.href === '#' && !attributes.ngHref && !attributes.ngClick) {\n\t\t\t\treturn;\n            }\n            */\n\n\t\t\telement.addClass('interaction-tap');\n\t\t\tvar node = document.createElement('interaction');\n\t\t\telement[0].appendChild(node);\n\n\t\t\tfunction onDown(e) {\n\t\t\t\telement.removeClass('interaction-animate');\n\t\t\t\tvoid element.offsetWidth;\n\t\t\t\t// node.style.animationPlayState = \"paused\";\n\t\t\t\tnode.style.left = e.relative.x + 'px';\n\t\t\t\tnode.style.top = e.relative.y + 'px';\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\telement.addClass('interaction-animate');\n\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\telement.removeClass('interaction-animate');\n\t\t\t\t\t}, 1000);\n\t\t\t\t}, 10);\n\n\t\t\t\t// console.log('tap.onDown', node, node.parentElement);\n\t\t\t}\n\t\t\tvar listeners = { // down, move, up, click\n\t\t\t\tdown: onDown,\n\t\t\t};\n\t\t\tvar events = new Events(element).add(listeners, scope); // passing scope to add remove listeners automatically on $destroy\n\t\t}\n\t}\n\tapp.directive('ngHref', ['Events', tap]);\n\tapp.directive('ngClick', ['Events', tap]);\n\n}());"]}