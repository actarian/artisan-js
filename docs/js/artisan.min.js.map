{"version":3,"sources":["docs/js/artisan.js"],"names":["angular","module","factory","Animate","callback","this","key","ticks","prototype","play","loop","time","_this","window","requestAnimationFrame","pause","cancelAnimationFrame","playpause","doNOTPlay","lastTime","vendors","x","length","element","currTime","Date","getTime","timeToCall","Math","max","id","setTimeout","clearTimeout","filter","$filter","array","filters","item","i","Hash","pool","get","Object","defineProperties","value","enumerable","writable","has","undefined","getId","hash","set","push","add","newItem","p","keys","remove","oldItem","index","indexOf","splice","addMany","items","removeMany","removeAll","shift","each","forward","reverse","sort","c","d","a","b","backward","differs","t","updatePool","forEach","pools","Array","$q","$promise","deferred","defer","promise","statics","all","promises","extend","transformProperty","div","document","createElement","style","every","prefix","e","Style","props","scale","hoverScale","currentScale","styles","cssText","join","transform","transformOrigin","y","round","app","Vector","make","size","sqrt","normalize","l","incidence","atan2","distance","cross","difference","power","abs","towards","friction","copy","toString","$compile","$controller","Utils","getTouch","previous","type","touch","event","originalEvent","touches","changedTouches","pageX","pageY","s","getRelativeTouch","node","point","rect","getBoundingClientRect","left","top","getClosest","el","selector","matchesFn","parent","some","fn","body","parentElement","getClosestElement","target","throttle","func","wait","options","context","args","result","timeout","later","leading","getNow","apply","now","remaining","arguments","trailing","where","query","found","compileController","scope","html","data","link","contents","controller","$scope","$new","controllerAs","children","reverseSortOn","format","string","prepend","expression","splitted","split","formatted","reducer","o","reducerSetter","slice","reducerAdder","downloadFile","content","name","download","createEvent","anchor","href","base64","downloadName","substring","lastIndexOf","initEvent","dispatchEvent","open","blob","Blob","reader","FileReader","readAsDataURL","onloadend","serverDownload","defaults","uri","extension","JSON","stringify","form","input","appendChild","action","method","enctype","submit","removeChild","reduce","defineProperty","TypeError","len","k","ua","navigator","userAgent","toLowerCase","safari","msie","chrome","mobile","toMd5","Md5","encode","getElementsByTagName","addClass","Api","Doc","$location","$routeParams","environment","View","doc","url","path","params","view","route","current","console","log","docs","then","response","resolve","error","reject","service","$http","$timeout","$httpPromise","urls","api","status","$get","$post","$put","$patch","$delete","$fake","post","put","patch","delete","fake","redirect","msecs","doRedirect","$$lastRequestedPath","doRetry","$rootScope","$silent","unlink","listeners","$$listeners","$locationChangeSuccess","relink","listener","$path","silent","replace","location","unshift","$window","Cookie","TIMEOUT","_set","days","expires","date","setTime","toGMTString","cookie","exists","cookieName","ca","charAt","model","parse","decodeURIComponent","atob","cache","json","btoa","encodeURIComponent","on","checkCookie","elapsed","interval","LocalStorage","isSupported","supported","localStorage","setItem","removeItem","storageEvent","newValue","SessionStorage","sessionStorage","Rect","w","h","mult","offset","reduceRect","offsetRect","expandRect","expand","intersect","right","bottom","center","topLeft","topRight","bottomRight","bottomLeft","setX","setY","setW","setH","setPos","setSize","clone","Color","r","g","uint","parseInt","componentToHex","hex","luma","color","dot","contrast","darker","pow","min","floor","lighter","toUint","toHex","toRgba","toFixed","alpha","makeSet","foreground","border","light","Shape","shapeCircle","cx","cy","sa","ea","PI","ctx","arc","shapeStar","or","ir","steps","angle","step","moveTo","cos","sin","lineTo","shapeRoundRect","tl","tr","br","bl","defaultRadius","quadraticCurveTo","circle","call","beginPath","closePath","star","roundRect","constant","black","white","blue","red","lightBlue","lightYellow","greyLighter","greyLight","greyMedium","grey","map","Painter","Palette","painter","buffer","rows","getRect","row","canvas","width","height","setCanvas","drawImage","palette","isString","img","Image","onload","addShape","onerror","src","save","clip","translate","restore","draw","pre","drawRect","tint","setFill","fillRect","globalCompositeOperation","pattern","drawPattern","fillStyle","createPattern","toDataURL","PainterColors","drawingRect","setColors","colors","offsetWidth","offsetHeight","getContext","lineCap","clear","resize","setText","font","align","verticalAlign","textAlign","textBaseline","setStroke","strokeStyle","lineWidth","fillText","text","maxLength","substr","trim","strokeRect","fill","stroke","begin","close","rotate","xy","image","flip","directive","restrict","templateUrl","transclude","message","attributes","$parse","formatLabel","uniqueId","template","control","ngModel","required","title","placeholder","source","label","require","optionLabel","getOptions","number","field","precision","validate","minLength","Number","POSITIVE_INFINITY","focus","visible","onChange","$parent","onFilter","getType","getClasses","control-focus","control-success","$valid","control-error","$invalid","$submitted","$touched","control-empty","$viewValue","getMessages","$error","toggleVisibility","$templateCache","compile","onRemove","getter","numberPicker","setter","assign","onAdd","removeListeners","nodeRemove","off","nodeAdd","querySelectorAll","$on","onFocus","$modelValue","$setViewValue","doBlur","onBlur","$formatters","$parsers","valid","String","$setValidity","$templateRequest","priority","modal","modalView","provider","when","routes","modals","popModal","m","active","closeModal","addModal","back","Nav","$watch","isArray","onLink","onNav","nav","setItems","itemOpen","immediate","state","$nav","closed","closing","opening","opened","itemClose","itemToggle","onTap","trigger","output","resolved","rejected","onTouchStart","navItem","onMouseDown","onClick","prevent","preventDefault","querySelector","setNav","setNavs","level","addItems","getLink","itemOrItems","addItem","Scrollable","Events","redraw","isEnabled","elementNode","contentNode","dragging","move","down","bounce","speed","wheeling","contentStyle","showIndicatorFor","percent","indicatorNode","indicator","count","indicatorStyle","padding","doLeft","doRight","busy","onLeft","finally","undrag","onRight","removeDragListeners","onDown","addDragListeners","animate","onMove","prev","onUp","up","getWheelIncrement","increment","_onWheel","dir","deltaY","wheelDelta","enabled","scrollableWhen","innerWidth","onResize","onWheel","ondragstart","scrollable","scrollableX","reset","attr","append","oldValue","doTop","onTop","doBottom","onBottom","scrollableY","start","end","container","bounceX","renderX","scrollToX","methods","Event","documentNode","documentElement","parentNode","scroll","pageXOffset","scrollLeft","pageYOffset","scrollTop","getWidth","getHeight","getNode","offsetLeft","offsetTop","page","getPage","relative","absolute","self","clientWidth","innerHeight","clientHeight","standardEvents","touchEvents","events","click","removeTouchEvents","onMouseMove","onMouseUp","removeStandardEvents","onTouchMove","onTouchEnd","getElement","standard","windowElement","tap","removeClass","ngBind","ngHref","ngClick","State","errors","isReady","idle","isBusy","isError","isErroring","isSuccess","isSuccessing","button","ready","success","errorMessage","submitClass","successing","errorring","labels","addons","classes"],"mappings":"CAEC,WACG,YAEUA,SAAQC,OAAO,WAAY,KAAM,UAAW,kBAKzD,WACA,YAEUD,SAAQC,OAAO,WAErBC,QAAQ,WAAY,WAEvB,QAASC,GAAQC,GAChBC,KAAKD,SAAWA,EAChBC,KAAKC,IAAM,KACXD,KAAKE,MAAQ,EAgCd,MA9BAJ,GAAQK,WACPC,KAAM,WAGL,QAASC,GAAKC,GACbC,EAAML,QACNK,EAAMR,SAASO,EAAMC,EAAML,OAC3BK,EAAMN,IAAMO,OAAOC,sBAAsBJ,GAL1C,GAAIE,GAAQP,IAOPA,MAAKC,KACTI,KAGFK,MAAO,WACFV,KAAKC,MACRO,OAAOG,qBAAqBX,KAAKC,KACjCD,KAAKC,IAAM,OAGbW,UAAW,WACNZ,KAAKC,IACRD,KAAKU,QAELV,KAAKI,QAGPS,UAAW,WACVb,KAAKU,UAGAZ,KAGP,WAGA,IAAK,GAFDgB,GAAW,EACXC,GAAW,KAAM,MAAO,SAAU,KAC7BC,EAAI,EAAGA,EAAID,EAAQE,SAAWT,OAAOC,wBAAyBO,EACtER,OAAOC,sBAAwBD,OAAOO,EAAQC,GAAK,yBACnDR,OAAOG,qBAAuBH,OAAOO,EAAQC,GAAK,yBACjDR,OAAOO,EAAQC,GAAK,8BAEjBR,QAAOC,wBACXD,OAAOC,sBAAwB,SAAUV,EAAUmB,GAClD,GAAIC,IAAW,GAAIC,OAAOC,UACtBC,EAAaC,KAAKC,IAAI,EAAG,IAAML,EAAWL,IAC1CW,EAAKjB,OAAOkB,WAAW,WAC1B3B,EAASoB,EAAWG,IAClBA,EAEH,OADAR,GAAWK,EAAWG,EACfG,IAGJjB,OAAOG,uBACXH,OAAOG,qBAAuB,SAAUc,GACvCE,aAAaF,WAQhB,WAEA,YAEU9B,SAAQC,OAAO,WAErBgC,OAAO,SAAU,UAAW,SAAUC,GACzC,MAAO,UAAUC,EAAOC,EAASb,GAChC,GAAIa,EACH,MAAOF,GAAQ,UAAUC,EAAO,SAAUE,GACzC,IAAK,GAAIC,GAAI,EAAGA,EAAIF,EAAQd,OAAQgB,IACnC,GAAIF,EAAQE,GAAGf,KAAac,EAAKd,GAAU,OAAO,CAEnD,QAAO,WAUX,WACG,YAEUvB,SAAQC,OAAO,WAErBC,QAAQ,QAAS,WAGjB,QAASqC,GAAKjC,EAAKkC,GACflC,EAAMA,GAAO,KACbkC,EAAOA,EAAOD,EAAKE,IAAID,MACvBE,OAAOC,iBAAiBtC,MACpBC,KACIsC,MAAOtC,EACPuC,YAAY,EACZC,UAAU,GAEdN,MACII,MAAOJ,EACPK,YAAY,EACZC,UAAU,GAEdxB,QACIsB,MAAO,EACPC,YAAY,EACZC,UAAU,KAwBtB,QAASC,GAAIjB,GACT,WAAyBkB,KAAlB3C,KAAKmC,KAAKV,GAGrB,QAASmB,GAAMnB,GACX,MAAOzB,MAAKmC,KAAKV,GAGrB,QAASW,GAAIJ,GACT,GAAIa,GAAO7C,KACPC,EAAMD,KAAKC,GACf,OAAO+B,GAAOa,EAAKD,MAAMZ,EAAK/B,IAAQ,KAG1C,QAAS6C,GAAId,GACT,GAAIa,GAAO7C,IAKX,OAJWA,MAAKmC,KAEXH,EADKhC,KAAKC,MACG+B,EAClBa,EAAKE,KAAKf,GACHA,EAGX,QAASgB,GAAIC,GACT,GAAIJ,GAAO7C,KACPgC,EAAOa,EAAKT,IAAIa,EACpB,IAAIjB,EACA,IAAK,GAAwCkB,GAApCjB,EAAI,EAAGkB,EAAOd,OAAOc,KAAKF,GAAahB,EAAIkB,EAAKlC,OAAQgB,IAC7DiB,EAAIC,EAAKlB,GACTD,EAAKkB,GAAKD,EAAQC,OAGtBlB,GAAOa,EAAKC,IAAIG,EAEpB,OAAOjB,GAGX,QAASoB,GAAOC,GACZ,GAAIR,GAAO7C,KACPmC,EAAOnC,KAAKmC,KACZlC,EAAMD,KAAKC,IACX+B,EAAOa,EAAKT,IAAIiB,EACpB,IAAIrB,EAAM,CACN,GAAIsB,GAAQT,EAAKU,QAAQvB,IACV,IAAXsB,GACAT,EAAKW,OAAOF,EAAO,SAEhBnB,GAAKH,EAAK/B,IAErB,MAAO4C,GAGX,QAASY,GAAQC,GACb,GAAIb,GAAO7C,IACX,KAAK0D,EACD,MAAOb,EAGX,KADA,GAAIZ,GAAI,EACDA,EAAIyB,EAAMzC,QACb4B,EAAKG,IAAIU,EAAMzB,IACfA,GAEJ,OAAOY,GAGX,QAASc,GAAWD,GAChB,GAAIb,GAAO7C,IACX,KAAK0D,EACD,MAAOb,EAGX,KADA,GAAIZ,GAAI,EACDA,EAAIyB,EAAMzC,QACb4B,EAAKO,OAAOM,EAAMzB,IAClBA,GAEJ,OAAOY,GAGX,QAASe,KACL,GAKI5B,GALAa,EAAO7C,KACPC,EAAM4C,EAAK5C,IACXkC,EAAOU,EAAKV,KACZF,EAAI,CAGR,KAFQY,EAAK5B,OAEN4B,EAAK5B,QACRe,EAAOa,EAAKgB,cACL1B,GAAKH,EAAK/B,IACjBgC,GAEJ,OAAOY,GAGX,QAASiB,GAAK/D,GACV,GAAI8C,GAAO7C,IACX,IAAID,EAEA,IADA,GAAIkC,GAAI,EACDA,EAAIY,EAAK5B,QACZlB,EAAS8C,EAAKZ,GAAIA,GAClBA,GAGR,OAAOY,GAGX,QAASkB,GAAQ9D,EAAK+D,GAClB,GAAInB,GAAO7C,IAOX,OANAC,GAAOA,GAAOD,KAAKC,IACnB4C,EAAKoB,KAAK,SAASC,EAAGC,GAClB,GAAIC,GAAIJ,EAAUG,EAAID,EAClBG,EAAIL,EAAUE,EAAIC,CACtB,OAAOC,GAAEnE,GAAOoE,EAAEpE,KAEf4C,EAGX,QAASyB,GAASrE,GACd,MAAOD,MAAK+D,QAAQ9D,GAAK,GAG7B,QAASsE,GAAQ1B,GACb,GAAIA,EAAK5C,MAAQD,KAAKC,KAAO4C,EAAK5B,SAAWjB,KAAKiB,OAC9C,OAAO,CAMP,KAJA,GAAIsD,IAAU,EACVtC,EAAI,EACJuC,EAAIxE,KAAKiB,OACThB,EAAMD,KAAKC,IACRsE,GAAWtC,EAAIuC,GAClBD,EAAUvE,KAAKiC,GAAGhC,KAAS4C,EAAKZ,GAAGhC,GACnCgC,IAKZ,QAASwC,KACL,GAAI5B,GAAO7C,KACPmC,EAAOnC,KAAKmC,KACZlC,EAAMD,KAAKC,GACfoC,QAAOc,KAAKhB,GAAMuC,QAAQ,SAASzE,SACxBkC,GAAKlC,KAEhBN,QAAQ+E,QAAQ7B,EAAM,SAASb,GAC3BG,EAAKH,EAAK/B,IAAQ+B,IA1L1B,GAAI2C,KAyCJ,OAlBAzC,GAAKE,IAAM,SAASD,GAChB,MAAQwC,GAAMxC,GAAQwC,EAAMxC,QAEhCD,EAAK/B,UAAY,GAAIyE,OACrB1C,EAAK/B,UAAUuC,IAAMA,EACrBR,EAAK/B,UAAUyC,MAAQA,EACvBV,EAAK/B,UAAUiC,IAAMA,EACrBF,EAAK/B,UAAU2C,IAAMA,EACrBZ,EAAK/B,UAAU6C,IAAMA,EACrBd,EAAK/B,UAAUiD,OAASA,EACxBlB,EAAK/B,UAAU2D,KAAOA,EACtB5B,EAAK/B,UAAUsD,QAAUA,EACzBvB,EAAK/B,UAAUwD,WAAaA,EAC5BzB,EAAK/B,UAAUyD,UAAYA,EAC3B1B,EAAK/B,UAAU4D,QAAUA,EACzB7B,EAAK/B,UAAUmE,SAAWA,EAC1BpC,EAAK/B,UAAUoE,QAAUA,EACzBrC,EAAK/B,UAAUsE,WAAaA,EACrBvC,QA0Jd,WACG,YAEUvC,SAAQC,OAAO,WAErBC,QAAQ,YAAa,KAAM,SAASgF,GACpC,QAASC,GAAS/E,GACd,GAAwB,kBAAbA,GACP,KAAM,kCAEV,IAAIgF,GAAWF,EAAGG,OAElB,OADAjF,GAASgF,GACFA,EAASE,QAEpB,GAAIC,IACAC,IAAK,SAASC,GACV,MAAOP,GAAGM,IAAIC,IAItB,OADAzF,SAAQ0F,OAAOP,EAAUI,GAClBJ,QAMd,WACA,YAEA,IAAIQ,GAmCJ,WACC,GAAIA,GAAoB,YAEpBC,EAAMC,SAASC,cAAc,MAejC,YAd4C,KAAjCF,EAAIG,MAAMJ,IACV,SAAU,MAAO,IAAK,MAAMK,MAAM,SAAUC,GACrD,GAAIC,GAAI,IAAMD,EAAS,YACvB,YAA4B,KAAjBL,EAAIG,MAAMG,KACpBP,EAAoBO,GACb,KAKTP,MADmD,KAAlCC,EAAIG,MAAwB,gBACzB,wBAEA/C,GAEd2C,IAnDE3F,SAAQC,OAAO,WAErBC,QAAQ,SAAU,WACrB,QAASiG,KACR9F,KAAK+F,OACJC,MAAO,EACPC,WAAY,EACZC,aAAc,GAuBhB,MAnBAJ,GAAM3F,WACL2C,IAAK,SAAU5B,GACd,GAAIiF,KACJ,KAAK,GAAIlG,KAAOD,MACH,UAARC,GACHkG,EAAOpD,KAAK9C,EAAM,IAAMD,KAAKC,GAG/BiB,GAAQwE,MAAMU,QAAUD,EAAOE,KAAK,KAAO,KAE5CC,UAAW,SAAUA,GACpBtG,KAAKsF,GAAqBgB,GAE3BC,gBAAiB,SAAUvF,EAAGwF,GAC7BxG,KAAKsF,EAAoB,aAAgB/D,KAAKkF,MAAU,IAAJzF,GAAY,IAAQ,IACxEhB,KAAKsF,EAAoB,aAAgB/D,KAAKkF,MAAU,IAAJD,GAAY,IAAQ,MAInEV,QA4BR,WACA,YAEA,IAAIY,GAAM/G,QAAQC,OAAO,UAEzB8G,GAAI7G,QAAQ,SAAU,WACrB,QAAS8G,GAAO3F,EAAGwF,GAClBxG,KAAKgB,EAAIA,GAAK,EACdhB,KAAKwG,EAAIA,GAAK,EA+Ef,MA7EAG,GAAOC,KAAO,SAAUxC,EAAGC,GAC1B,MAAO,IAAIsC,GAAOtC,EAAErD,EAAIoD,EAAEpD,EAAGqD,EAAEmC,EAAIpC,EAAEoC,IAEtCG,EAAOE,KAAO,SAAUzC,GACvB,MAAO7C,MAAKuF,KAAK1C,EAAEpD,EAAIoD,EAAEpD,EAAIoD,EAAEoC,EAAIpC,EAAEoC,IAEtCG,EAAOI,UAAY,SAAU3C,GAC5B,GAAI4C,GAAIL,EAAOE,KAAKzC,EAGpB,OAFAA,GAAEpD,GAAKgG,EACP5C,EAAEoC,GAAKQ,EACA5C,GAERuC,EAAOM,UAAY,SAAU7C,EAAGC,GAI/B,MAHY9C,MAAK2F,MAAM7C,EAAEmC,EAAGnC,EAAErD,GAAKO,KAAK2F,MAAM9C,EAAEoC,EAAGpC,EAAEpD,IAKtD2F,EAAOQ,SAAW,SAAU/C,EAAGC,GAC9B,MAAO9C,MAAKuF,MAAM1C,EAAEpD,EAAIqD,EAAErD,IAAMoD,EAAEpD,EAAIqD,EAAErD,IAAMoD,EAAEoC,EAAInC,EAAEmC,IAAMpC,EAAEoC,EAAInC,EAAEmC,KAErEG,EAAOS,MAAQ,SAAUhD,EAAGC,GAC3B,MAAQD,GAAEpD,EAAIqD,EAAEmC,EAAMpC,EAAEoC,EAAInC,EAAErD,GAE/B2F,EAAOU,WAAa,SAAUjD,EAAGC,GAChC,MAAO,IAAIsC,GAAOvC,EAAEpD,EAAIqD,EAAErD,EAAGoD,EAAEoC,EAAInC,EAAEmC,IAEtCG,EAAOW,MAAQ,SAAUlD,EAAGC,GAG3B,OAFQ9C,KAAKgG,IAAIlD,EAAErD,EAAIoD,EAAEpD,GACjBO,KAAKgG,IAAIlD,EAAEmC,EAAIpC,EAAEoC,IACR,GAElBG,EAAOxG,WACN0G,KAAM,WACL,MAAOF,GAAOE,KAAK7G,OAEpB+G,UAAW,WACV,MAAOJ,GAAOI,UAAU/G,OAEzBiH,UAAW,SAAU5C,GACpB,MAAOsC,GAAOM,UAAUjH,KAAMqE,IAE/B+C,MAAO,SAAU/C,GAChB,MAAOsC,GAAOS,MAAMpH,KAAMqE,IAE3B8C,SAAU,SAAU9C,GACnB,MAAOsC,GAAOQ,SAASnH,KAAMqE,IAE9BgD,WAAY,SAAUhD,GACrB,MAAOsC,GAAOU,WAAWrH,KAAMqE,IAEhCiD,MAAO,WACN,OAAQ/F,KAAKgG,IAAIvH,KAAKgB,GAAKO,KAAKgG,IAAIvH,KAAKwG,IAAM,GAEhDgB,QAAS,SAAUnD,EAAGoD,GAIrB,MAHAA,GAAWA,GAAY,KACvBzH,KAAKgB,IAAMqD,EAAErD,EAAIhB,KAAKgB,GAAKyG,EAC3BzH,KAAKwG,IAAMnC,EAAEmC,EAAIxG,KAAKwG,GAAKiB,EACpBzH,MAERgD,IAAK,SAAUqB,GAGd,MAFArE,MAAKgB,GAAKqD,EAAErD,EACZhB,KAAKwG,GAAKnC,EAAEmC,EACLxG,MAERyH,SAAU,SAAUpD,GAGnB,MAFArE,MAAKgB,GAAKqD,EACVrE,KAAKwG,GAAKnC,EACHrE,MAER0H,KAAM,SAAUrD,GACf,MAAO,IAAIsC,GAAO3G,KAAKgB,EAAGhB,KAAKwG,IAEhCmB,SAAU,WACT,MAAO,IAAM3H,KAAKgB,EAAI,IAAMhB,KAAKwG,EAAI,MAGhCG,IAGRD,EAAI7G,QAAQ,SAAU,WAAY,cAAe,SAAU,SAAU+H,EAAUC,EAAalB,GAsD3F,QAASmB,MAyCT,QAASC,GAASlC,EAAGmC,GACpB,GAAIxD,GAAI,GAAImC,EACZ,IAAe,eAAXd,EAAEoC,MAAoC,cAAXpC,EAAEoC,MAAmC,aAAXpC,EAAEoC,MAAkC,gBAAXpC,EAAEoC,KAAwB,CAC3G,GAAIC,GAAQ,KACRC,EAAQtC,EAAEuC,cAAgBvC,EAAEuC,cAAgBvC,EAC5CwC,EAAUF,EAAME,QAAQpH,OAASkH,EAAME,QAAUF,EAAMG,cACvDD,IAAWA,EAAQpH,SACtBiH,EAAQG,EAAQ,IAEbH,IACH1D,EAAExD,EAAIkH,EAAMK,MACZ/D,EAAEgC,EAAI0B,EAAMM,WAEQ,UAAX3C,EAAEoC,MAA+B,cAAXpC,EAAEoC,MAAmC,YAAXpC,EAAEoC,MAAiC,cAAXpC,EAAEoC,MAAmC,cAAXpC,EAAEoC,MAAmC,aAAXpC,EAAEoC,MAAkC,eAAXpC,EAAEoC,MAAoC,eAAXpC,EAAEoC,MAAoC,gBAAXpC,EAAEoC,OACvNzD,EAAExD,EAAI6E,EAAE0C,MACR/D,EAAEgC,EAAIX,EAAE2C,MAMT,OAJIR,KACHxD,EAAEiE,EAAI9B,EAAOU,WAAW7C,EAAGwD,IAE5BxD,EAAEyD,KAAOpC,EAAEoC,KACJzD,EAGR,QAASkE,GAAiBC,EAAMC,GAE/BD,EADchJ,QAAQuB,QAAQyH,GACf,EACf,IAAIE,GAAOF,EAAKG,wBAEZjD,EAAI,GAAIc,GAAOkC,EAAKE,KAAMF,EAAKG,IACnC,OAAOrC,GAAOU,WAAWuB,EAAO/C,GAGjC,QAASoD,GAAWC,EAAIC,GACvB,GAAIC,GAAWC,CAQf,KAPU,UAAW,wBAAyB,qBAAsB,oBAAqB,oBAAoBC,KAAK,SAAUC,GAC3H,MAAgC,kBAArB/D,UAASgE,KAAKD,KACxBH,EAAYG,GACL,KAILL,EAAGE,GAAWD,GACjB,MAAOD,EAER,MAAc,OAAPA,GAAa,CAEnB,GAAe,QADfG,EAASH,EAAGO,gBACWJ,EAAOD,GAAWD,GACxC,MAAOE,EAERH,GAAKG,EAEN,MAAO,MAGR,QAASK,GAAkBR,EAAIS,GAC9B,GAAeN,EACf,IAAIH,IAAOS,EACV,MAAOT,EAER,MAAc,OAAPA,GAAa,CAEnB,GAAe,QADfG,EAASH,EAAGO,gBACWJ,IAAWM,EACjC,MAAON,EAERH,GAAKG,EAEN,MAAO,MAGR,QAASO,GAASC,EAAMC,EAAMC,GAM7B,GAAIC,GAASC,EAAMC,EACfC,EAAU,KACVnC,EAAW,CACV+B,KAASA,KACd,IAAIK,GAAQ,WACXpC,GAA+B,IAApB+B,EAAQM,QAAoB,EAAIC,IAC3CH,EAAU,KACVD,EAASL,EAAKU,MAAMP,EAASC,GACxBE,IAASH,EAAUC,EAAO,MAEhC,OAAO,YACN,GAAIO,GAAMF,GACLtC,KAAgC,IAApB+B,EAAQM,UAAmBrC,EAAWwC,EACvD,IAAIC,GAAYX,GAAQU,EAAMxC,EAc9B,OAbAgC,GAAUhK,KACViK,EAAOS,UACHD,GAAa,GAAKA,EAAYX,GAC7BK,IACHxI,aAAawI,GACbA,EAAU,MAEXnC,EAAWwC,EACXN,EAASL,EAAKU,MAAMP,EAASC,GACxBE,IAASH,EAAUC,EAAO,OACpBE,IAAgC,IAArBJ,EAAQY,WAC9BR,EAAUzI,WAAW0I,EAAOK,IAEtBP,GAIT,QAASU,GAAM9I,EAAO+I,GACrB,GAAIC,GAAQ,IAYZ,OAXIhJ,IACHnC,QAAQ+E,QAAQ5C,EAAO,SAAUE,GAChC,GAAIU,IAAM,CACV/C,SAAQ+E,QAAQmG,EAAO,SAAUtI,EAAOtC,GACvCyC,EAAMA,GAAOV,EAAK/B,KAASsC,IAExBG,IACHoI,EAAQ9I,KAIJ8I,EAGR,QAASC,GAAkBC,EAAO9J,EAAS+J,EAAMC,GAEhDhK,EAAQ+J,KAAKA,EACb,IAAIE,GAAOvD,EAAS1G,EAAQkK,WAC5B,IAAIF,EAAKG,WAAY,CACpB,GAAIC,GAASN,EAAMO,MACnB5L,SAAQ0F,OAAOiG,EAAQJ,EACvB,IAAIG,GAAaxD,EAAYqD,EAAKG,YACjCC,OAAQA,GAELJ,GAAKM,eACRR,EAAME,EAAKM,cAAgBH,GAE5BnK,EAAQgK,KAAK,0BAA2BG,GACxCnK,EAAQuK,WAAWP,KAAK,0BAA2BG,GACnDL,EAAQM,EAETH,EAAKH,GAGN,QAASU,GAAczL,GACtB,MAAO,UAAUmE,EAAGC,GACnB,MAAID,GAAEnE,GAAOoE,EAAEpE,GACP,EAEJmE,EAAEnE,GAAOoE,EAAEpE,IACN,EAGF,GAIT,QAAS0L,GAAOC,EAAQC,EAASC,GAChCF,EAASA,GAAU,GACnBC,EAAUA,GAAW,EACrB,IAAIE,GAAWH,EAAOI,MAAM,IAC5B,IAAID,EAAS9K,OAAS,EAAG,CACxB,GAAIgL,GAAYF,EAASlI,OAQzB,OAPAlE,SAAQ+E,QAAQqH,EAAU,SAAUxJ,EAAOe,GAEzC2I,EADGH,EACSG,EAAUD,MAAM,IAAM1I,EAAQ,KAAK+C,KAAK,OAAUwF,EAAUtJ,EAAQ,QAEpE0J,EAAUD,MAAM,IAAM1I,EAAQ,KAAK+C,KAAKwF,EAAUtJ,KAG5DuJ,EACI,IAAOG,EAAY,IAEnBA,EAGR,MAAOJ,GAAUD,EAInB,QAASM,GAAQC,EAAGlM,GACnB,MAAOkM,GAAElM,GAGV,QAASmM,GAAcD,EAAGlM,EAAKsC,GAC9B,MAAkB,gBAAPtC,GACHmM,EAAcD,EAAGlM,EAAI+L,MAAM,KAAMzJ,GAChB,GAAdtC,EAAIgB,YAAyB0B,KAAVJ,EACrB4J,EAAElM,EAAI,IAAMsC,EACK,IAAftC,EAAIgB,OACPkL,EAEAC,EAAcD,EAAElM,EAAI,IAAKA,EAAIoM,MAAM,GAAI9J,GAIhD,QAAS+J,GAAaH,EAAGlM,EAAKsC,GAC7B,MAAkB,gBAAPtC,GACHqM,EAAaH,EAAGlM,EAAI+L,MAAM,KAAMzJ,GACf,GAAdtC,EAAIgB,YAAyB0B,KAAVJ,EACrB4J,EAAElM,EAAI,KAAOsC,EACI,IAAftC,EAAIgB,OACPkL,EAEAG,EAAaH,EAAElM,EAAI,IAAKA,EAAIoM,MAAM,GAAI9J,GAI/C,QAASgK,GAAaC,EAASC,EAAMxE,GAapC,QAASyE,KAIR,GAAIlH,SAASmH,YAAa,CACzB,GAAIC,GAASpH,SAASC,cAAc,IAEpC,IADAmH,EAAOC,KAAOC,MACUnK,KAApBiK,EAAOF,SAAwB,CAElC,GAAIK,GAAeN,GAAQK,EAAOE,UAAUF,EAAOG,YAAY,KAAO,EAAGH,EAAO7L,OAChF2L,GAAOF,SAAWK,EAGnB,GAAI5E,GAAQ3C,SAASmH,YAAY,cAGjC,OAFAxE,GAAM+E,UAAU,SAAS,GAAM,GAC/BN,EAAOO,cAAchF,IACd,EAKR3H,OAAO4M,KAAKN,EAAOvJ,QAAQ,MAAQ,EAAIuJ,EAASA,EADpC,YACoD,SAjCjE7E,EAAOA,GAAQ,0BACf,IAAI6E,GAAS,KACTO,EAAO,GAAIC,OAAMd,IACpBvE,KAAMA,IAEHsF,EAAS,GAAI/M,QAAOgN,UACxBD,GAAOE,cAAcJ,GACrBE,EAAOG,UAAY,WAClBZ,EAASS,EAAOrD,OAChBwC,KA4EF,QAASiB,GAAe5D,GACvB,GAAI6D,IACHC,IAAK,wBACLpB,KAAM,WACNqB,UAAW,MACX7F,KAAM,aACNuE,QAAS,SAEVzC,GAAUpK,QAAQ0F,OAAOuI,EAAU7D,EACnC,IAAIyC,GAAUuB,KAAKC,UAAUjE,GACzBkE,EAAOzI,SAASC,cAAc,QAC9ByI,EAAQ1I,SAASC,cAAc,QAgBnC,OAfAyI,GAAMzB,KAAO,WACbyB,EAAM3L,MAAQiK,EACdyB,EAAKE,YAAYD,GACjBD,EAAKG,OAASrE,EAAQ8D,IACtBI,EAAKI,OAAS,OACdJ,EAAKtE,OAAS,mBACdsE,EAAKK,QAAU,oCAGf9I,SAASgE,KAAK2E,YAAYF,GAC1BA,EAAKM,SACL7M,WAAW,WACV8D,SAASgE,KAAKgF,YAAYP,IACxB,KAEInG,GA7ZP,WAKKlD,MAAMzE,UAAUsO,QACpBpM,OAAOqM,eAAe9J,MAAMzE,UAAW,UACtCoC,MAAO,SAAUxC,GAChB,GAAa,OAATC,KACH,KAAM,IAAI2O,WAAU,qDAErB,IAAwB,kBAAb5O,GACV,KAAM,IAAI4O,WAAU5O,EAAW,qBAEhC,IAGIwC,GAHA4J,EAAI9J,OAAOrC,MACX4O,EAAMzC,EAAElL,SAAW,EACnB4N,EAAI,CAER,IAAwB,GAApBnE,UAAUzJ,OACbsB,EAAQmI,UAAU,OACZ,CACN,KAAOmE,EAAID,KAASC,IAAK1C,KACxB0C,GAED,IAAIA,GAAKD,EACR,KAAM,IAAID,WAAU,8CAErBpM,GAAQ4J,EAAE0C,KAEX,KAAOA,EAAID,GACNC,IAAK1C,KACR5J,EAAQxC,EAASwC,EAAO4J,EAAE0C,GAAIA,EAAG1C,IAElC0C,GAED,OAAOtM,QAKX,IACI+H,GAASlJ,KAAKoJ,KAAO,WACxB,OAAO,GAAIpJ,OAAOC,WAEfyN,EAAKtO,OAAOuO,UAAUC,UAAUC,cAChCC,GAAmC,IAA1BJ,EAAGvL,QAAQ,YAA8C,IAA1BuL,EAAGvL,QAAQ,UACnD4L,GAAkC,IAA3BL,EAAGvL,QAAQ,aAA6C,IAAxBuL,EAAGvL,QAAQ,UAA0C,IAAxBuL,EAAGvL,QAAQ,QAC/E6L,GAAUF,IAAWC,IAAkC,IAA1BL,EAAGvL,QAAQ,UACxC8L,GAAmC,IAA1BP,EAAGvL,QAAQ,SACTwL,WAAUC,UAAUC,cAAc1L,QAAQ,UAC1CwL,UAAUC,UAAUC,cAAc1L,QAAQ,SA+BzD,OA5BAuE,GAAM4D,cAAgBA,EACtB5D,EAAMC,SAAWA,EACjBD,EAAMY,iBAAmBA,EACzBZ,EAAMmB,WAAaA,EACnBnB,EAAM4B,kBAAoBA,EAC1B5B,EAAM8B,SAAWA,EACjB9B,EAAM8C,MAAQA,EACd9C,EAAM6D,OAASA,EACf7D,EAAMiD,kBAAoBA,EAC1BjD,EAAMoE,QAAUA,EAChBpE,EAAMsE,cAAgBA,EACtBtE,EAAMwE,aAAeA,EACrBxE,EAAMyE,aAAeA,EACrBzE,EAAM6F,eAAiBA,EACvB7F,EAAMwH,MAAQ,SAAU1D,GACvB,MAAO2D,KAAIC,OAAO5D,IAEnB9D,EAAMgH,IACLI,OAAQA,EACRC,KAAMA,EACNC,OAAQA,EACRC,OAAQA,GAET1P,QAAQ+E,QAAQoD,EAAMgH,GAAI,SAAUvM,EAAOtC,GACtCsC,GACH5C,QAAQuB,QAAQsE,SAASiK,qBAAqB,SAASC,SAASzP,KAG3D6H,QAoVR,WACG,YAEUnI,SAAQC,OAAO,WAErBC,QAAQ,OAAQ,MAAO,WAAY,SAAS8P,EAAK7K,GACjD,QAAS8K,GAAI5N,GACLA,GACArC,QAAQ0F,OAAOrF,KAAMgC,GAI7B4N,EAAIzP,YAIJ,IAAI+E,KAIJ,OAFAvF,SAAQ0F,OAAOuK,EAAK1K,GAEb0K,QAMd,WACG,YAEUjQ,SAAQC,OAAO,WAErBC,QAAQ,QAAS,MAAO,WAAY,YAAa,eAAgB,cAAe,MAAO,SAAS8P,EAAK7K,EAAU+K,EAAWC,EAAcC,EAAaH,GACrJ,QAASI,GAAKC,GACV,GAAIC,GAAML,EAAUM,OAChBC,EAASN,EACTO,GACAN,YAAaA,EACbO,OACIJ,IAAKA,EACLE,OAAQA,GAEZH,IAAKA,EAETtQ,SAAQ0F,OAAOrF,KAAMqQ,GAGzBL,EAAK7P,YAIL,IAAI+E,IACAqL,QAAS,WACL,MAAOzL,GAAS,SAASG,GACrB,GAAIiL,GAAML,EAAUM,MACpBK,SAAQC,IAAI,eAAgBP,GAC5BP,EAAIe,KAAKR,IAAIA,GAAKS,KAAK,SAASC,GAC5B,GAAIX,GAAM,GAAIL,GAAIgB,GACdP,EAAO,GAAIL,GAAKC,EACpBhL,GAAQ4L,QAAQR,IAEjB,SAASS,GACR7L,EAAQ8L,OAAOD,QAwC/B,OAjBAnR,SAAQ0F,OAAO2K,EAAM9K,GAiBd8K,QAMd,WACG,YAEUrQ,SAAQC,OAAO,WAErBoR,QAAQ,UAAW,QAAS,WAAY,WAAY,cACpD,SAASC,EAAOnM,EAAUoM,EAAUnB,GAEhC,QAASoB,GAAa9C,EAAQ6B,EAAKhF,GAC/B,MAAOpG,GAAS,SAASG,GAErBgM,EAAM5C,GAAQ0B,EAAYqB,KAAKC,IAAMnB,EAAKhF,GAAMyF,KAAK,SAASC,GAC1D3L,EAAQ4L,QAAQD,EAAS1F,OAE1B,SAASrF,EAAGyL,GACX,GAAIR,GAASjL,GAAKA,EAAEqF,KAAQrF,EAAEqF,OAC9B4F,GAAMQ,OAASzL,EAAEyL,OACjBrM,EAAQ8L,OAAOD,OAM3B,QAASS,GAAKrB,GACV,MAAOiB,GAAa,MAAOjB,GAG/B,QAASsB,GAAMtB,EAAKhF,GAChB,MAAOiG,GAAa,OAAQjB,EAAKhF,GAGrC,QAASuG,GAAKvB,EAAKhF,GACf,MAAOiG,GAAa,MAAOjB,EAAKhF,GAGpC,QAASwG,GAAOxB,EAAKhF,GACjB,MAAOiG,GAAa,QAASjB,EAAKhF,GAGtC,QAASyG,GAAQzB,GACb,MAAOiB,GAAa,SAAUjB,GAGlC,QAAS0B,GAAM1G,GACX,GAAInG,GAAWF,GAAGG,OAIlB,OAHAkM,GAAS,WACLnM,EAAS8L,SAAU3F,KAAMA,KAC1B,KACInG,EAASE,QAGpBjF,KAAKoC,IAAMmP,EACXvR,KAAK6R,KAAOL,EACZxR,KAAK8R,IAAML,EACXzR,KAAK+R,MAAQL,EACb1R,KAAKgS,OAASL,EACd3R,KAAKiS,KAAOL,QAQvB,WACG,YAEUjS,SAAQC,OAAO,WAErBoR,QAAQ,UAAW,YAAa,WAAY,SAASnB,EAAWqB,GAOhE,QAASgB,GAAS/B,EAAMgC,GACpB,QAASC,KACLvC,EAAUwC,oBAAsBxC,EAAUM,OAC1CN,EAAUM,KAAKA,GAEfgC,EACAjB,EAAS,WACLkB,KACDD,GAEHC,IAIR,QAASjC,GAAKA,EAAMgC,GAChB,QAASG,KACLnC,EAAON,EAAUwC,qBAAuBlC,EACxCN,EAAUwC,oBAAsB,KAChCxC,EAAUM,KAAKA,GAEfgC,EACAjB,EAAS,WACLoB,KACDH,GAEHG,IAIR,QAAS/H,GAAM4F,EAAMgC,GACjB,QAASG,KACLzC,EAAUM,KAAKA,GAEfgC,EACAjB,EAAS,WACLoB,KACDH,GAEHjB,EAAS,WACLoB,MA5CZ,GAAItB,GAAUhR,IACdgR,GAAQkB,SAAWA,EACnBlB,EAAQb,KAAOA,EACfa,EAAQzG,MAAQA,QAmDvB,WACG,YAEU5K,SAAQC,OAAO,WAErBC,QAAQ,WAAY,aAAc,YAAa,SAAS0S,EAAY1C,GACpE,QAAS2C,MAIT,QAASC,KACL,GAAIC,GAAYH,EAAWI,YAAYC,sBACvCjT,SAAQ+E,QAAQgO,EAAW,SAASnQ,EAAOkK,GAKvC,QAASoG,KACLH,EAAUjG,GAAQlK,EALlBA,IAAUuQ,IAOdJ,EAAUjG,GAAQoG,KAI1B,QAASC,GAASjN,GAEVkN,IAAUlD,EAAUM,QACpBsC,IAEJM,EAAQ,KArBZ,GAAIA,GAwBA7N,GACA8N,OAAQ,SAAS7C,EAAM8C,GAEnB,GAAIC,GAAWrD,EAAUK,IAAIC,EACzB8C,IACAC,EAASD,UAEbF,EAAQlD,EAAUM,QAEtBA,KAAM,SAASA,GACX,MAAON,GAAUM,KAAKA,IAO9B,OAHAxQ,SAAQ0F,OAAOmN,EAAStN,GACxBqN,EAAWI,YAAYC,uBAAuBO,QAAQL,GAE/CN,QAMd,WACG,YAEA,IAAI9L,GAAM/G,QAAQC,OAAO,UAEzB8G,GAAI7G,QAAQ,UAAW,KAAM,UAAW,SAASgF,EAAIuO,GACjD,QAASC,MAoFT,MAnFAA,GAAOC,QAAU,IACjBD,EAAOE,KAAO,SAAS9G,EAAMlK,EAAOiR,GAChC,GAAIC,EACJ,IAAID,EAAM,CACN,GAAIE,GAAO,GAAItS,KACfsS,GAAKC,QAAQD,EAAKrS,UAAoB,GAAPmS,EAAY,GAAK,GAAK,KACrDC,EAAU,aAAeC,EAAKE,kBAE9BH,GAAU,EAEdL,GAAQ5N,SAASqO,OAASpH,EAAO,IAAMlK,EAAQkR,EAAU,YAE7DJ,EAAOS,OAAS,SAASrH,GACrB,OAA8D,IAAvD2G,EAAQ5N,SAASqO,OAAOtQ,QAAQ,IAAMkJ,EAAO,MAA+D,IAAhD2G,EAAQ5N,SAASqO,OAAOtQ,QAAQkJ,EAAO,MAE9G4G,EAAOjR,IAAM,SAASqK,GAGlB,IAAK,GAFDsH,GAAatH,EAAO,IACpBuH,EAAKZ,EAAQ5N,SAASqO,OAAO7H,MAAM,KAC9B/J,EAAI,EAAGA,EAAI+R,EAAG/S,OAAQgB,IAAK,CAEhC,IADA,GAAIiC,GAAI8P,EAAG/R,GACW,KAAfiC,EAAE+P,OAAO,IACZ/P,EAAIA,EAAE8I,UAAU,EAAG9I,EAAEjD,OAEzB,IAA8B,IAA1BiD,EAAEX,QAAQwQ,GAAmB,CAC7B,GAAIxR,GAAQ2B,EAAE8I,UAAU+G,EAAW9S,OAAQiD,EAAEjD,QACzCiT,EAAQ,IACZ,KACIA,EAAQnG,KAAKoG,MAAMC,mBAAmBC,KAAK9R,KAC7C,MAAOsD,GACL2K,QAAQC,IAAI,2BAA4BxQ,IAAK4F,GAEjD,MAAOqO,IAGf,MAAO,OAEXb,EAAOvQ,IAAM,SAAS2J,EAAMlK,EAAOiR,GAC/B,IACI,GAAIc,MACAC,EAAOxG,KAAKC,UAAUzL,EAAO,SAAStC,EAAKsC,GAC3C,GAAY,SAARtC,EAAJ,CAGA,GAAqB,gBAAVsC,IAAgC,OAAVA,EAAgB,CAC7C,IAA8B,IAA1B+R,EAAM/Q,QAAQhB,GAEd,MAEJ+R,GAAMvR,KAAKR,GAEf,MAAOA,KAEX+R,GAAQ,KACRjB,EAAOE,KAAK9G,EAAM+H,KAAKC,mBAAmBF,IAAQf,GACpD,MAAO3N,GACL2K,QAAQC,IAAI,+BAAgChE,EAAMlK,EAAOsD,KAGjEwN,EAAOrB,OAAS,SAASvF,GACrB4G,EAAOE,KAAK9G,EAAM,IAAK,IAE3B4G,EAAOqB,GAAK,SAASjI,GAMjB,QAASkI,KACL,GAAIC,EAAUzK,EACVpF,EAASgM,OAAO,eACb,CACH,GAAI7M,GAAImP,EAAOjR,IAAIqK,EACfvI,GACAa,EAAS8L,QAAQ3M,IAEjB0Q,GAAWC,EACX5S,EAAIP,WAAWiT,EAAaE,KAdxC,GACI5S,GADA8C,EAAWF,EAAGG,QACX6P,EAAW,IACdD,EAAU,EACVzK,EAAUkJ,EAAOC,OAgBrB,OADAqB,KACO5P,EAASE,SAEboO,KAGX3M,EAAI7G,QAAQ,gBAAiB,KAAM,UAAW,SAAU,SAASgF,EAAIuO,EAASC,GAC1E,QAASyB,MAyFT,MAxEAA,GAAaC,YAfb,WACI,GAAIC,IAAY,CAChB,KACIA,EAAY,gBAAkB5B,IAAoC,OAAzBA,EAAQ6B,aAC7CD,GACA5B,EAAQ6B,aAAaC,QAAQ,OAAQ,KACrC9B,EAAQ6B,aAAaE,WAAW,SAEhCH,GAAY,EAElB,MAAOnP,GACLmP,GAAY,EAEhB,MAAOA,MAGPF,EAAaC,aACbD,EAAahB,OAAS,SAASrH,GAC3B,WAAsC9J,KAA/ByQ,EAAQ6B,aAAaxI,IAEhCqI,EAAa1S,IAAM,SAASqK,GACxB,GAAIlK,GAAQ,IACZ,QAAmCI,KAA/ByQ,EAAQ6B,aAAaxI,GACrB,IACIlK,EAAQwL,KAAKoG,MAAMf,EAAQ6B,aAAaxI,IAC1C,MAAO5G,GACL2K,QAAQC,IAAI,iCAAkChE,EAAM5G,GAG5D,MAAOtD,IAEXuS,EAAahS,IAAM,SAAS2J,EAAMlK,GAC9B,IACI,GAAI+R,MACAC,EAAOxG,KAAKC,UAAUzL,EAAO,SAAStC,EAAKsC,GAC3C,GAAY,SAARtC,EAAJ,CAGA,GAAqB,gBAAVsC,IAAgC,OAAVA,EAAgB,CAC7C,IAA8B,IAA1B+R,EAAM/Q,QAAQhB,GAEd,MAEJ+R,GAAMvR,KAAKR,GAEf,MAAOA,KAEX+R,GAAQ,KACRlB,EAAQ6B,aAAaC,QAAQzI,EAAM8H,GACrC,MAAO1O,GACL2K,QAAQC,IAAI,qCAAsChE,EAAMlK,EAAOsD,KAGvEiP,EAAa9C,OAAS,SAASvF,GAC3B2G,EAAQ6B,aAAaE,WAAW1I,IAEpCqI,EAAaJ,GAAK,SAASjI,GAIvB,QAAS2I,GAAavP,GAGlB,GADAlE,aAAaM,GACT4D,EAAEuC,cAAcnI,KAAOwM,EACvB,IACI,GAAIlK,GAAQwL,KAAKoG,MAAMtO,EAAEuC,cAAciN,SACvCtQ,GAAS8L,QAAQtO,GACnB,MAAOuO,GACLN,QAAQC,IAAI,gCAAiChE,EAAMqE,GACnD/L,EAASgM,OAAO,iBAAmBtE,IAZ/C,GACIxK,GADA8C,EAAWF,EAAGG,QACXmF,EAAUkJ,EAAOC,OAmBxB,OAJA3T,SAAQuB,QAAQkS,GAASsB,GAAG,UAAWU,GACvCnT,EAAIP,WAAW,WACXqD,EAASgM,OAAO,YACjB5G,GACIpF,EAASE,WAGpBuL,QAAQC,IAAI,iDACZqE,EAAahB,OAAST,EAAOS,OAC7BgB,EAAahS,IAAMuQ,EAAOvQ,IAC1BgS,EAAa1S,IAAMiR,EAAOjR,IAC1B0S,EAAa9C,OAASqB,EAAOrB,OAC7B8C,EAAaJ,GAAKrB,EAAOqB,IAEtBI,KAGXpO,EAAI7G,QAAQ,kBAAmB,KAAM,UAAW,SAAU,SAASgF,EAAIuO,EAASC,GAC5E,QAASiC,MAyFT,MAxEAA,GAAeP,YAff,WACI,GAAIC,IAAY,CAChB,KACIA,EAAY,kBAAoB5B,QAAsCzQ,KAA3ByQ,EAAQmC,eAC/CP,GACA5B,EAAQmC,eAAeL,QAAQ,OAAQ,KACvC9B,EAAQmC,eAAeJ,WAAW,SAElCH,GAAY,EAElB,MAAOnP,GACLmP,GAAY,EAEhB,MAAOA,MAGPM,EAAeP,aACfO,EAAexB,OAAS,SAASrH,GAC7B,WAAwC9J,KAAjCyQ,EAAQmC,eAAe9I,IAElC6I,EAAelT,IAAM,SAASqK,GAC1B,GAAIlK,GAAQ,IACZ,QAAqCI,KAAjCyQ,EAAQmC,eAAe9I,GACvB,IACIlK,EAAQwL,KAAKoG,MAAMf,EAAQmC,eAAe9I,IAC5C,MAAO5G,GACL2K,QAAQC,IAAI,mCAAoChE,EAAM5G,GAG9D,MAAOtD,IAEX+S,EAAexS,IAAM,SAAS2J,EAAMlK,GAChC,IACI,GAAI+R,MACAC,EAAOxG,KAAKC,UAAUzL,EAAO,SAAStC,EAAKsC,GAC3C,GAAY,SAARtC,EAAJ,CAGA,GAAqB,gBAAVsC,IAAgC,OAAVA,EAAgB,CAC7C,IAA8B,IAA1B+R,EAAM/Q,QAAQhB,GAEd,MAEJ+R,GAAMvR,KAAKR,GAEf,MAAOA,KAEX+R,GAAQ,KACRlB,EAAQmC,eAAeL,QAAQzI,EAAM8H,GACvC,MAAO1O,GACL2K,QAAQC,IAAI,uCAAwChE,EAAMlK,EAAOsD,KAGzEyP,EAAetD,OAAS,SAASvF,GAC7B2G,EAAQmC,eAAeJ,WAAW1I,IAEtC6I,EAAeZ,GAAK,SAASjI,GAIzB,QAAS2I,GAAavP,GAGlB,GADAlE,aAAaM,GACT4D,EAAEuC,cAAcnI,MAAQwM,EACxB,IACI,GAAIlK,GAAQwL,KAAKoG,MAAMtO,EAAEuC,cAAciN,SACvCtQ,GAAS8L,QAAQtO,GACnB,MAAOuO,GACLN,QAAQC,IAAI,kCAAmChE,EAAMqE,GACrD/L,EAASgM,OAAO,iBAAmBtE,IAZ/C,GACIxK,GADA8C,EAAWF,EAAGG,QACXmF,EAAUkJ,EAAOC,OAmBxB,OAJA3T,SAAQuB,QAAQkS,GAASsB,GAAG,UAAWU,GACvCnT,EAAIP,WAAW,WACXqD,EAASgM,OAAO,YACjB5G,GACIpF,EAASE,WAGpBuL,QAAQC,IAAI,mDACZ6E,EAAexB,OAAST,EAAOS,OAC/BwB,EAAexS,IAAMuQ,EAAOvQ,IAC5BwS,EAAelT,IAAMiR,EAAOjR,IAC5BkT,EAAetD,OAASqB,EAAOrB,OAC/BsD,EAAeZ,GAAKrB,EAAOqB,IAExBY,QAMd,WACG,YAEA,IAAI5O,GAAM/G,QAAQC,OAAO,UAEzB8G,GAAI7G,QAAQ,QAAS,WACjB,QAAS2V,GAAKxU,EAAGwF,EAAGiP,EAAGC,GACnB1V,KAAKgB,EAAIA,GAAK,EACdhB,KAAKwG,EAAIA,GAAK,EACdxG,KAAKyV,EAAIA,GAAK,EACdzV,KAAK0V,EAAIA,GAAK,EAgJlB,MA9IAF,GAAKG,KAAO,SAAS9M,EAAMtG,GAKvB,MAJAsG,GAAK7H,GAAKuB,EACVsG,EAAKrC,GAAKjE,EACVsG,EAAK4M,GAAKlT,EACVsG,EAAK6M,GAAKnT,EACHsG,GAEX2M,EAAKrV,WACDwV,KAAM,SAASpT,GACX,MAAOiT,GAAKG,KAAK3V,KAAMuC,IAE3BqT,OAAQ,SAAS5U,EAAGwF,GAGhB,MAFAxG,MAAKgB,GAAKA,EACVhB,KAAKwG,GAAKA,EACHxG,MAEXyO,OAAQ,SAAS5H,GACb,MAAO7G,MAAK4V,QAAQ/O,IAExBgP,WAAY,SAAShN,GACjB,MAAO7I,MAAK8V,WAAWN,EAAKG,KAAK9M,GAAO,KAE5CkN,WAAY,SAASlN,GAKjB,MAJA7I,MAAKgB,GAAK6H,EAAK7H,GAAK,EACpBhB,KAAKwG,GAAKqC,EAAKrC,GAAK,EACpBxG,KAAKyV,GAAK5M,EAAK4M,GAAK,EACpBzV,KAAK0V,GAAK7M,EAAK6M,GAAK,EACb1V,MAEXgW,OAAQ,SAASnP,GACb,MAAO7G,MAAK+V,YAAa/U,EAAG6F,EAAML,EAAGK,EAAM4O,EAAU,EAAP5O,EAAU6O,EAAU,EAAP7O,KAE/DoP,UAAW,SAASpN,GAChB,GAAI7H,GAAIhB,KAAKgB,EACTwF,EAAIxG,KAAKwG,EACTiP,EAAIzV,KAAKyV,EACTC,EAAI1V,KAAK0V,CACb,SAAS7M,EAAK7H,EAAIA,EAAIyU,GAAK5M,EAAK7H,EAAI6H,EAAK4M,EAAIzU,GAAK6H,EAAKrC,EAAIA,EAAIkP,GAAK7M,EAAKrC,EAAIqC,EAAK6M,EAAIlP,IAE1FwC,IAAK,WACD,GAAIhI,GAAIhB,KAAKgB,EACTwF,EAAIxG,KAAKwG,EACTiP,EAAIzV,KAAKyV,CACLzV,MAAK0V,CACb,QAAS1U,EAAGA,EAAIyU,EAAI,EAAGjP,EAAGA,IAE9B0P,MAAO,WACH,GAAIlV,GAAIhB,KAAKgB,EACTwF,EAAIxG,KAAKwG,CAGb,QAASxF,EAAGA,EAFJhB,KAAKyV,EAEMjP,EAAGA,EADdxG,KAAK0V,EACiB,IAElCS,OAAQ,WACJ,GAAInV,GAAIhB,KAAKgB,EACTwF,EAAIxG,KAAKwG,CAGb,QAASxF,EAAGA,EAFJhB,KAAKyV,EAEO,EAAGjP,EAAGA,EADlBxG,KAAK0V,IAGjB3M,KAAM,WACF,GAAI/H,GAAIhB,KAAKgB,EACTwF,EAAIxG,KAAKwG,CACLxG,MAAKyV,CAEb,QAASzU,EAAGA,EAAGwF,EAAGA,EADVxG,KAAK0V,EACa,IAE9BU,OAAQ,WACJ,GAAIpV,GAAIhB,KAAKgB,EACTwF,EAAIxG,KAAKwG,CAGb,QAASxF,EAAGA,EAFJhB,KAAKyV,EAEO,EAAGjP,EAAGA,EADlBxG,KAAK0V,EACqB,IAEtCW,QAAS,WACL,GAAIrV,GAAIhB,KAAKgB,EACTwF,EAAIxG,KAAKwG,CACLxG,MAAKyV,EACLzV,KAAK0V,CACb,QAAS1U,EAAGA,EAAGwF,EAAGA,IAEtB8P,SAAU,WACN,GAAItV,GAAIhB,KAAKgB,EACTwF,EAAIxG,KAAKwG,EACTiP,EAAIzV,KAAKyV,CACLzV,MAAK0V,CACb,QAAS1U,EAAGA,EAAIyU,EAAGjP,EAAGA,IAE1B+P,YAAa,WACT,GAAIvV,GAAIhB,KAAKgB,EACTwF,EAAIxG,KAAKwG,CAGb,QAASxF,EAAGA,EAFJhB,KAAKyV,EAEMjP,EAAGA,EADdxG,KAAK0V,IAGjBc,WAAY,WACR,GAAIxV,GAAIhB,KAAKgB,EACTwF,EAAIxG,KAAKwG,CACLxG,MAAKyV,CAEb,QAASzU,EAAGA,EAAGwF,EAAGA,EADVxG,KAAK0V,IAGjBe,KAAM,SAASzV,GAEX,MADAhB,MAAKgB,EAAIA,EACFhB,MAEX0W,KAAM,SAASlQ,GAEX,MADAxG,MAAKwG,EAAIA,EACFxG,MAEX2W,KAAM,SAASlB,GAEX,MADAzV,MAAKyV,EAAIA,EACFzV,MAEX4W,KAAM,SAASlB,GAEX,MADA1V,MAAK0V,EAAIA,EACF1V,MAEX6W,OAAQ,SAAS7V,EAAGwF,GAGhB,MAFAxG,MAAKgB,EAAIA,EACThB,KAAKwG,EAAIA,EACFxG,MAEX8W,QAAS,SAASrB,EAAGC,GAGjB,MAFA1V,MAAKyV,EAAIA,EACTzV,KAAK0V,EAAIA,EACF1V,MAEX0H,KAAM,SAASmB,GAKX,MAJA7I,MAAKgB,EAAI6H,EAAK7H,EACdhB,KAAKwG,EAAIqC,EAAKrC,EACdxG,KAAKyV,EAAI5M,EAAK4M,EACdzV,KAAK0V,EAAI7M,EAAK6M,EACP1V,MAEX+W,MAAO,WACH,MAAO,IAAIvB,GAAKxV,KAAKgB,EAAGhB,KAAKwG,EAAGxG,KAAKyV,EAAGzV,KAAK0V,IAEjD/N,SAAU,WACN,MAAO,IAAM3H,KAAKgB,EAAI,IAAMhB,KAAKwG,EAAI,IAAMxG,KAAKyV,EAAI,IAAMzV,KAAK0V,EAAI,MAGpEF,KAGX9O,EAAI7G,QAAQ,SAAU,WAClB,QAASmX,GAAMC,EAAGC,EAAG7S,EAAGD,GACpB,GAAIsG,UAAUzJ,OAAS,EACnBjB,KAAKiX,EAAKA,GAAW,IAANA,EAAWA,EAAI,EAC9BjX,KAAKkX,EAAKA,GAAW,IAANA,EAAWA,EAAI,EAC9BlX,KAAKqE,EAAKA,GAAW,IAANA,EAAWA,EAAI,EAC9BrE,KAAKoE,EAAKA,GAAW,IAANA,EAAWA,EAAI,QAC3B,CACH,GAAI+S,GAAOF,GAAK,UAChBE,GAAOC,SAASD,GACZF,EAAEhW,OAAS,GACXjB,KAAKiX,EAAIE,GAAQ,GAAK,IACtBnX,KAAKkX,EAAIC,GAAQ,GAAK,IACtBnX,KAAKqE,EAAI8S,GAAQ,EAAI,IACrBnX,KAAKoE,EAAI+S,GAAQ,EAAI,MAErBnX,KAAKiX,EAAIE,GAAQ,GAAK,IACtBnX,KAAKkX,EAAIC,GAAQ,EAAI,IACrBnX,KAAKqE,EAAI8S,GAAQ,EAAI,IACrBnX,KAAKoE,EAAI,MAsErB,MAlEA4S,GAAMK,eAAiB,SAASnT,GAC5B,GAAIoT,GAAMpT,EAAEyD,SAAS,GACrB,OAAqB,IAAd2P,EAAIrW,OAAc,IAAMqW,EAAMA,GAEzCN,EAAMO,KAAO,SAASC,GAGlB,MADWA,GAAMC,KAAMR,EAAG,GAAIC,EAAG,IAAK7S,EAAG,MAG7C2S,EAAMU,SAAW,SAASF,GAEtB,MACW,IAAIR,GAFJA,EAAMO,KAAKC,GACX,GACU,WAEA,aAGzBR,EAAMW,OAAS,SAASH,EAAOI,EAAKC,GAKhC,MAJAA,GAAMA,GAAO,EAIN,GAAIb,GAHHzV,KAAKC,IAAID,KAAKuW,MAAMN,EAAMP,EAAIY,GAAMtW,KAAKuW,MAAMN,EAAMP,EAAI,IAAMW,IAC/DrW,KAAKC,IAAID,KAAKuW,MAAMN,EAAMN,EAAIW,GAAMtW,KAAKuW,MAAMN,EAAMN,EAAI,IAAMU,IAC/DrW,KAAKC,IAAID,KAAKuW,MAAMN,EAAMnT,EAAIwT,GAAMtW,KAAKuW,MAAMN,EAAMnT,EAAI,IAAMuT,IAC7CJ,EAAMpT,IAEpC4S,EAAMe,QAAU,SAASP,EAAOI,EAAKpW,GAKjC,MAJAA,GAAMA,GAAO,EAIN,GAAIwV,GAHHzV,KAAKsW,IAAIL,EAAMP,EAAI1V,KAAKuW,OAAO,IAAMN,EAAMP,GAAKzV,GAAMD,KAAKuW,MAAMN,EAAMP,EAAI,IAAMW,IACjFrW,KAAKsW,IAAIL,EAAMN,EAAI3V,KAAKuW,OAAO,IAAMN,EAAMN,GAAK1V,GAAMD,KAAKuW,MAAMN,EAAMN,EAAI,IAAMU,IACjFrW,KAAKsW,IAAIL,EAAMnT,EAAI9C,KAAKuW,OAAO,IAAMN,EAAMnT,GAAK7C,GAAMD,KAAKuW,MAAMN,EAAMnT,EAAI,IAAMuT,IAC/DJ,EAAMpT,IAWpC4S,EAAM7W,WACF6X,OAAQ,WACJ,OAAQhY,KAAKiX,GAAK,KAAOjX,KAAKkX,GAAK,KAAOlX,KAAKqE,GAAK,GAAMrE,KAAM,GAEpEiY,MAAO,WACH,MAAO,IAAMjB,EAAMK,eAAerX,KAAKiX,GAAKD,EAAMK,eAAerX,KAAKkX,GAAKF,EAAMK,eAAerX,KAAKqE,GAAK2S,EAAMK,eAAerX,KAAKoE,IAExI8T,OAAQ,WACJ,MAAO,QAAUlY,KAAKiX,EAAI,IAAMjX,KAAKkX,EAAI,IAAMlX,KAAKqE,EAAI,KAAOrE,KAAKoE,EAAI,KAAK+T,QAAQ,GAAK,KAE9FV,IAAK,SAASD,GACV,MAASxX,MAAKiX,EAAI,KAAQO,EAAMP,EAAI,KAAQjX,KAAKkX,EAAI,KAAQM,EAAMN,EAAI,KAAQlX,KAAKqE,EAAI,KAAQmT,EAAMnT,EAAI,MAE9G+T,MAAO,SAASR,EAAKC,EAAKrW,GAItB,MAHAqW,GAAMA,GAAO,EACbrW,EAAMA,GAAO,EACbxB,KAAKoE,EAAI7C,KAAKuW,MAAoC,KAA7BD,EAAOD,GAAOpW,EAAMqW,KAClC7X,MAEXqY,QAAS,WAIL,MAHArY,MAAKsY,WAAatB,EAAMU,SAAS1X,MACjCA,KAAKuY,OAASvB,EAAMW,OAAO3X,KAAM,IACjCA,KAAKwY,MAAQxB,EAAMe,QAAQ/X,KAAM,IAC1BA,OAGRgX,KAGXtQ,EAAI7G,QAAQ,SAAU,WAClB,QAAS4Y,MAwET,MAvEAA,GAAMC,YAAc,SAASxV,EAAGyV,EAAIC,EAAI3B,EAAG4B,EAAIC,GAC3CD,EAAKA,GAAM,EACXC,EAAKA,GAAM,EAAIvX,KAAKwX,GACpB7V,EAAE8V,IAAIC,IAAIN,EAAIC,EAAI3B,EAAG4B,EAAIC,GAAI,IAEjCL,EAAMS,UAAY,SAAShW,EAAGyV,EAAIC,EAAIO,EAAIC,EAAIC,GAC1C,GAAIrY,GAAGwF,EACH8S,EAAQ/X,KAAKwX,GAAK,EAAI,EACtBQ,EAAOhY,KAAKwX,GAAKM,EACjBL,EAAM9V,EAAE8V,GAEZ,KADAA,EAAIQ,OAAOb,EAAIC,EAAKO,GACflX,EAAI,EAAGA,EAAIoX,EAAOpX,IACnBjB,EAAI2X,EAAKpX,KAAKkY,IAAIH,GAASH,EAC3B3S,EAAIoS,EAAKrX,KAAKmY,IAAIJ,GAASH,EAC3BH,EAAIW,OAAO3Y,EAAGwF,GACd8S,GAASC,EACTvY,EAAI2X,EAAKpX,KAAKkY,IAAIH,GAASF,EAC3B5S,EAAIoS,EAAKrX,KAAKmY,IAAIJ,GAASF,EAC3BJ,EAAIW,OAAO3Y,EAAGwF,GACd8S,GAASC,CAEbP,GAAIW,OAAOhB,EAAIC,EAAKO,IAExBV,EAAMmB,eAAiB,SAAS1W,EAAG2F,EAAMoO,GACrC,GAAI+B,GAAM9V,EAAE8V,IACRhY,EAAI6H,EAAK7H,EACTwF,EAAIqC,EAAKrC,EACTiP,EAAI5M,EAAK4M,EACTC,EAAI7M,EAAK6M,CAIb,QAHiB/S,WAANsU,KACPA,EAAI,GAES,gBAANA,GACPA,GAAM4C,GAAI5C,EAAG6C,GAAI7C,EAAG8C,GAAI9C,EAAG+C,GAAI/C,OAC5B,CACH,GAAIgD,IAAkBJ,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAC/C,KAAK,GAAI/Z,KAAOga,GACZhD,EAAEhX,GAAOgX,EAAEhX,IAAQga,EAAcha,GAGzC+Y,EAAIQ,OAAOxY,EAAIiW,EAAE4C,GAAIrT,GACrBwS,EAAIW,OAAO3Y,EAAIyU,EAAIwB,EAAE6C,GAAItT,GACzBwS,EAAIkB,iBAAiBlZ,EAAIyU,EAAGjP,EAAGxF,EAAIyU,EAAGjP,EAAIyQ,EAAE6C,IAC5Cd,EAAIW,OAAO3Y,EAAIyU,EAAGjP,EAAIkP,EAAIuB,EAAE8C,IAC5Bf,EAAIkB,iBAAiBlZ,EAAIyU,EAAGjP,EAAIkP,EAAG1U,EAAIyU,EAAIwB,EAAE8C,GAAIvT,EAAIkP,GACrDsD,EAAIW,OAAO3Y,EAAIiW,EAAE+C,GAAIxT,EAAIkP,GACzBsD,EAAIkB,iBAAiBlZ,EAAGwF,EAAIkP,EAAG1U,EAAGwF,EAAIkP,EAAIuB,EAAE+C,IAC5ChB,EAAIW,OAAO3Y,EAAGwF,EAAIyQ,EAAE4C,IACpBb,EAAIkB,iBAAiBlZ,EAAGwF,EAAGxF,EAAIiW,EAAE4C,GAAIrT,IAEzCiS,EAAM0B,OAAS,WACX,GAAI/J,GAASxL,MAAMzE,UAAUkM,MAAM+N,KAAK1P,WACpCsO,EAAM5I,EAAO,GAAG4I,GACpBA,GAAIqB,YACJ5B,EAAMC,YAAYnO,MAAMvK,KAAMoQ,GAC9B4I,EAAIsB,aAER7B,EAAM8B,KAAO,WACT,GAAInK,GAASxL,MAAMzE,UAAUkM,MAAM+N,KAAK1P,WACpCsO,EAAM5I,EAAO,GAAG4I,GACpBA,GAAIqB,YACJ5B,EAAMS,UAAU3O,MAAMvK,KAAMoQ,GAC5B4I,EAAIsB,aAER7B,EAAM+B,UAAY,WACd,GAAIpK,GAASxL,MAAMzE,UAAUkM,MAAM+N,KAAK1P,WACpCsO,EAAM5I,EAAO,GAAG4I,GACpBA,GAAIqB,YACJ5B,EAAMmB,eAAerP,MAAMvK,KAAMoQ,GACjC4I,EAAIsB,aAED7B,KAGX/R,EAAI+T,SAAS,iBAWTC,MAAO,WACPC,MAAO,WACPC,KAAM,WACNC,IAAK,WACLC,UAAW,WACXC,YAAa,WACbC,YAAa,WACbC,UAAW,WACXC,WAAY,WACZC,KAAM,WACNC,IAAK,aAGT1U,EAAI7G,QAAQ,WAAY,KAAM,UAAW,OAAQ,SAASgF,EAAIwW,EAAS7F,GACnE,QAAS8F,KACLtb,KAAKub,SAAU,GAAIF,IAAUvE,QAAQ,EAAG,GACxC9W,KAAKwb,QAAS,GAAIH,IAAUvE,QAAQ,EAAG,GACvC9W,KAAK6G,MAAS4O,EAAG,EAAGC,EAAG,GACvB1V,KAAKmC,QACLnC,KAAKyb,QAyIT,MAvIAH,GAAQnb,WACJub,QAAS,SAASjG,EAAGC,GACjB,GAAIxS,GAAIlD,KAAKub,QACT1U,EAAO7G,KAAK6G,KACZ4U,EAAOzb,KAAKyb,KACZxE,EAAI,GAAIzB,GAAK,EAAG,EAAGC,EAAGC,GACtBiG,EAAMF,EAAK/F,KAAQ1U,EAAG,EAAGwF,EAAGK,EAAK6O,EAGrC,IAFA7O,EAAK4O,EAAIlU,KAAKC,IAAIqF,EAAK4O,EAAGkG,EAAI3a,EAAIyU,GAClC5O,EAAK6O,EAAInU,KAAKC,IAAIqF,EAAK6O,EAAGiG,EAAInV,EAAIkP,GAC7BxS,EAAE0Y,OAAOC,OAAU3Y,EAAE0Y,OAAOE,QAE1B,GAAIjV,EAAK4O,EAAIvS,EAAE0Y,OAAOC,OAAShV,EAAK6O,EAAIxS,EAAE0Y,OAAOE,OAAQ,CAM5D,GAAIF,GAAS1Y,EAAE0Y,MACf1Y,GAAE6Y,UAAUvW,SAASC,cAAc,WACnCvC,EAAE4T,QAAQjQ,EAAK4O,EAAG5O,EAAK6O,GACvBxS,EAAE8V,IAAIgD,UAAUJ,EAAQ,EAAG,QAV3B1Y,GAAE4T,QAAQjQ,EAAK4O,EAAG5O,EAAK6O,EAmB3B,OAJAuB,GAAEjW,EAAI2a,EAAI3a,EACViW,EAAEzQ,EAAImV,EAAInV,EACVmV,EAAI3a,GAAKyU,EACTgG,EAAK/F,GAAKiG,EACH1E,GAEXjU,IAAK,SAAS/C,EAAKkQ,GACf,GAAI8L,GAAUjc,IACd,IAAIL,QAAQuc,SAAS/L,GAAO,CACxB,GAAIpL,GAAWF,EAAGG,QACdmX,EAAM,GAAIC,MAWd,OAVAD,GAAIE,OAAS,WACTJ,EAAQK,SAASrc,EAAKkc,EAAIN,MAAOM,EAAIL,OAAQ,SAAS5Y,EAAG2F,GACrD3F,EAAE8V,IAAIgD,UAAUG,EAAK,EAAG,KAE5BpX,EAAS8L,QAAQsL,IAErBA,EAAII,QAAU,WACVxX,EAASgM,OAAO,eAAiBZ,IAErCgM,EAAIK,IAAMrM,EACHpL,EAASE,QAEhB,GAAImL,GAASxL,MAAMzE,UAAUkM,MAAM+N,KAAK1P,UACxC,OAAOuR,GAAQK,SAAS/R,MAAM0R,EAAS7L,IAG/CkM,SAAU,SAASrc,EAAKwV,EAAGC,EAAG3V,GAC1B,GAAImD,GAAIlD,KAAKub,QACTtE,EAAIjX,KAAK0b,QAAQjG,EAAGC,EACxBxS,GAAE8V,IAAIyD,OACNvZ,EAAE8V,IAAInQ,KAAKoO,EAAEjW,EAAGiW,EAAEzQ,EAAGyQ,EAAExB,EAAGwB,EAAEvB,GAE5BxS,EAAE8V,IAAI0D,OACNxZ,EAAE8V,IAAI2D,UAAU1F,EAAEjW,EAAGiW,EAAEzQ,GACvBzG,EAASqa,KAAKlX,EAAGA,EAAG+T,EAAEF,QAAQF,OAAO,EAAG,IACxC3T,EAAE8V,IAAI4D,UACN5c,KAAKmC,KAAKlC,GAAOgX,GAGrB4F,KAAM,SAASlT,EAAQ1J,EAAKe,EAAGwF,EAAGsW,GAC9B,GAAI7F,GAAIjX,KAAKmC,KAAKlC,EACdgX,IAGAtN,EAAOoT,SAAS/c,KAAKub,QAAQK,OAAQ3E,GAAKjW,EAAGA,EAAGwF,EAAGA,EAAGiP,EAAGwB,EAAExB,EAAGC,EAAGuB,EAAEvB,GAAKoH,IAKhFE,KAAM,SAASrT,EAAQ1J,EAAKe,EAAGwF,EAAGgR,EAAOsF,GACrC,GAAI7F,GAAIjX,KAAKmC,KAAKlC,EAClB,IAAIgX,EAAG,CACH,GAAI/T,GAAIlD,KAAKub,QACTlX,EAAIrE,KAAKwb,OAAO1E,QAAQG,EAAExB,EAAGwB,EAAEvB,EACnCrR,GAAEoY,OACFpY,EAAE4Y,QAAQzF,GACVnT,EAAE6Y,WACF7Y,EAAE2U,IAAImE,yBAA2B,mBACjC9Y,EAAE2U,IAAIgD,UAAU9Y,EAAE0Y,OAAQ3E,EAAEjW,EAAGiW,EAAEzQ,EAAGyQ,EAAExB,EAAGwB,EAAEvB,EAAG,EAAG,EAAGuB,EAAExB,EAAGwB,EAAEvB,GAC3DrR,EAAEuY,UACFpM,QAAQC,IAAIzP,EAAGwF,EAAGnC,EAAEuX,OAAQjS,EAAOiS,QACnCjS,EAAOkT,KAAKxY,EAAEuX,QAAU5a,EAAGA,EAAGwF,EAAGA,GAAKsW,KAG9CM,QAAS,SAASzT,EAAQ1J,EAAKe,EAAGwF,EAAGiP,EAAGC,EAAG8B,GACvC,QAAS6F,GAAYD,GACjB,GAAIpE,GAAMrP,EAAOqP,GACjBA,GAAIyD,OACJzD,EAAI2D,UAAU3b,EAAGwF,GAIjBwS,EAAIsE,UAAYF,EAChBpE,EAAIkE,UAAUlc,GAAIwF,EAAGiP,EAAGC,GACxBsD,EAAI2D,WAAW3b,GAAIwF,GAEnBwS,EAAI4D,UAER,GAAI3F,GAAIjX,KAAKmC,KAAKlC,EAClB,IAAIgX,EAAG,CACH,GACImG,GADAjB,EAAMlF,EAAEkF,GAEZ,IAAKA,GAAOlF,EAAEO,OAASA,EAqBnB4F,EAAUzT,EAAOqP,IAAIuE,cAAcpB,EAAK,UACxCkB,EAAYD,OAtBc,CAC1B,GAAI/Y,GAAIrE,KAAKwb,OAAO1E,QAAQG,EAAExB,EAAGwB,EAAEvB,EAC/B8B,IACAP,EAAEO,MAAQA,EACVnT,EAAEoY,OACFpY,EAAE4Y,QAAQzF,GACVnT,EAAE6Y,WACF7Y,EAAE2U,IAAImE,yBAA2B,mBACjC9Y,EAAE2U,IAAIgD,UAAUhc,KAAKub,QAAQK,OAAQ3E,EAAEjW,EAAGiW,EAAEzQ,EAAGyQ,EAAExB,EAAGwB,EAAEvB,EAAG,EAAG,EAAGuB,EAAExB,EAAGwB,EAAEvB,GACtErR,EAAEuY,WAEFvY,EAAE2U,IAAIgD,UAAUhc,KAAKub,QAAQK,OAAQ3E,EAAEjW,EAAGiW,EAAEzQ,EAAGyQ,EAAExB,EAAGwB,EAAEvB,EAAG,EAAG,EAAGuB,EAAExB,EAAGwB,EAAEvB,GAE1EyG,EAAM,GAAIC,OACVD,EAAIE,OAAS,WACTpF,EAAEkF,IAAMA,EACRiB,EAAUzT,EAAOqP,IAAIuE,cAAcpB,EAAK,UACxCkB,EAAYD,IAEhBjB,EAAIK,IAAMnY,EAAEmZ,gBAQrBlC,KAGX5U,EAAI7G,QAAQ,WAAY,QAAS,OAAQ,QAAS,gBAAiB,SAAS4Y,EAAOjD,EAAMwB,EAAOyG,GAC5F,QAASpC,GAAQO,GACbA,EAASA,GAAUpW,SAASC,cAAc,UAC1CzF,KAAK6I,KAAO,GAAI2M,GAChBxV,KAAK0d,YAAc,GAAIlI,GACvBxV,KAAK2d,YACL3d,KAAK+b,UAAUH,GAEnBP,EAAQuC,UACRje,QAAQ+E,QAAQ+Y,EAAe,SAASlb,EAAOtC,GAC3Cob,EAAQuC,OAAO3d,GAAO,GAAI+W,GAAMzU,GAAO8V,WAE9BgD,GAAQuC,MAwMrB,OAvMAvC,GAAQlb,WACJyd,OAAQvC,EAAQuC,OAChBD,UAAW,WACP,GAAIC,GAAS5d,KAAK4d,MAClBje,SAAQ+E,QAAQ+Y,EAAe,SAASlb,EAAOtC,GAC3C2d,EAAO3d,GAAO,GAAI+W,GAAMzU,GAAO8V,aAGvC0D,UAAW,SAASH,GAChB5b,KAAK4b,OAASA,EACd5b,KAAK8W,QAAQ8E,EAAOiC,YAAajC,EAAOkC,aACxC,IAAI9E,GAAM4C,EAAOmC,WAAW,KAG5B,OAFA/E,GAAIgF,QAAU,SACdhe,KAAKgZ,IAAMA,EACJhZ,MAEX8W,QAAS,SAASrB,EAAGC,GAKjB,MAJA1V,MAAK4b,OAAOC,MAAQpG,EACpBzV,KAAK4b,OAAOE,OAASpG,EACrB1V,KAAK6I,KAAK4M,EAAIA,EACdzV,KAAK6I,KAAK6M,EAAIA,EACP1V,MAEX0H,KAAM,SAASkU,GAEX,MADA5b,MAAKgZ,IAAIgD,UAAUJ,EAAQ,EAAG,GACvB5b,MAEXie,MAAO,WAGH,MAFAje,MAAKke,SAEEle,MAEXke,OAAQ,WAEJ,MADAle,MAAK8W,QAAQ9W,KAAK4b,OAAOiC,YAAa7d,KAAK4b,OAAOkC,cAC3C9d,MAEXme,QAAS,SAASC,EAAMC,EAAOC,EAAe9G,GAC1C4G,EAAOA,GAAQ,iBACfC,EAAQA,GAAS,SACjBC,EAAgBA,GAAiB,SACjC9G,EAAQA,GAASxX,KAAK4d,OAAOlD,KAC7B,IAAI1B,GAAMhZ,KAAKgZ,GAKf,OAJAA,GAAIoF,KAAOA,EACXpF,EAAIuF,UAAYF,EAChBrF,EAAIwF,aAAeF,EACnBtF,EAAIsE,UAAY9F,EAAMU,SACflY,MAEXid,QAAS,SAASzF,GAUd,MATAA,GAAQA,GAASxX,KAAK4d,OAAOlD,MACnB1a,KAAKgZ,IAOXsE,UAAY9F,EAAMU,SACflY,MAEXye,UAAW,SAASjH,EAAO3Q,GACvB2Q,EAAQA,GAASxX,KAAK4d,OAAOlD,KAC7B,IAAI1B,GAAMhZ,KAAKgZ,GAYf,OAXAnS,GAAOA,GAAQ,EASfmS,EAAI0F,YAAclH,EAAMU,SACxBc,EAAI2F,UAAY9X,EACT7G,MASX4e,SAAU,SAASC,EAAMjW,EAAOiT,EAAOhK,EAAMiN,GASzC,MARIjD,KACAhK,EAAOA,GAAQ,GACfiN,EAAYA,GAAavd,KAAKuW,MAAM+D,EAAQ,GACxCgD,EAAK5d,OAAS6d,IACdD,EAAOA,EAAKE,OAAO,EAAGxd,KAAKsW,IAAIgH,EAAK5d,OAAQ6d,IAAYE,OAASnN,IAGzE7R,KAAKgZ,IAAI4F,SAASC,EAAMjW,EAAM5H,EAAG4H,EAAMpC,GAChCxG,MAEXkd,SAAU,SAASrU,GACfA,EAAOA,GAAQ7I,KAAK6I,IACpB,IAAImQ,GAAMhZ,KAAKgZ,IACXhY,EAAI6H,EAAK7H,EACTwF,EAAIqC,EAAKrC,EACTiP,EAAI5M,EAAK4M,EACTC,EAAI7M,EAAK6M,CAEb,OADAsD,GAAIkE,SAASlc,EAAGwF,EAAGiP,EAAGC,GACf1V,MAEXif,WAAY,SAASpW,GACjBA,EAAOA,GAAQ7I,KAAK6I,IACpB,IAAImQ,GAAMhZ,KAAKgZ,IACXhY,EAAI6H,EAAK7H,EACTwF,EAAIqC,EAAKrC,EACTiP,EAAI5M,EAAK4M,EACTC,EAAI7M,EAAK6M,CAEb,OADAsD,GAAIiG,WAAWje,EAAGwF,EAAGiP,EAAGC,GACjB1V,MAEXkf,KAAM,WAEF,MADAlf,MAAKgZ,IAAIkG,OACFlf,MAEXmf,OAAQ,WAEJ,MADAnf,MAAKgZ,IAAImG,SACFnf,MAEXof,MAAO,WAEH,MADApf,MAAKgZ,IAAIqB,YACFra,MAEXqf,MAAO,WAEH,MADArf,MAAKgZ,IAAIsB,YACFta,MAEXyc,KAAM,WAEF,MADAzc,MAAKgZ,IAAIyD,OACFzc,MAEX4c,QAAS,WAEL,MADA5c,MAAKgZ,IAAI4D,UACF5c,MAEXsf,OAAQ,SAAShG,GACbtZ,KAAKgZ,IAAIsG,OAAOhG,EAAQ/X,KAAKwX,GAAK,MAEtC4D,UAAW,SAAS4C,GAChBvf,KAAKgZ,IAAI2D,UAAU4C,EAAGve,EAAGue,EAAG/Y,IAEhCgX,UAAW,WACP,MAAOxd,MAAK4b,OAAO4B,aAEvBX,KAAM,SAAS2C,EAAOhb,EAAGsY,GACrB,GAAI0C,EAAO,CACPhb,EAAEiR,EAAIjR,EAAEiR,GAAK+J,EAAM3D,MACnBrX,EAAEkR,EAAIlR,EAAEkR,GAAK8J,EAAM1D,MACnB,IAAI9C,GAAMhZ,KAAKgZ,IACXnQ,EAAO7I,KAAK0d,YACZ1c,EAAI6H,EAAK7H,EAAIwD,EAAExD,EAAIwD,EAAEiR,EAAI,EACzBjP,EAAIqC,EAAKrC,EAAIhC,EAAEgC,EAAIhC,EAAEkR,EAAI,CACrB7M,GAAK4M,EAAIjR,EAAEiR,EACX5M,EAAK6M,EAAIlR,EAAEkR,CACnBsD,GAAIyD,OACJzD,EAAI2D,UAAU3b,EAAGwF,GACbsW,GACAA,EAAI1C,KAAKpa,MAEbgZ,EAAIgD,UAAUwD,EAAO,EAAG,GACxBxG,EAAI4D,UAGR,MAAO5c,OAEX+c,SAAU,SAASyC,EAAO/W,EAAGjE,EAAGsY,GAC5B,GAAI0C,EAAO,CACP/W,EAAEgN,EAAIhN,EAAEgN,GAAK+J,EAAM3D,MACnBpT,EAAEiN,EAAIjN,EAAEiN,GAAK8J,EAAM1D,OACnBtX,EAAEiR,EAAIjR,EAAEiR,GAAK+J,EAAM3D,MACnBrX,EAAEkR,EAAIlR,EAAEkR,GAAK8J,EAAM1D,MACnB,IAAI9C,GAAMhZ,KAAKgZ,IACXnQ,EAAO7I,KAAK0d,YACZ1c,EAAI6H,EAAK7H,EAAIwD,EAAExD,EAAIyH,EAAEgN,EAAI,EACzBjP,EAAIqC,EAAKrC,EAAIhC,EAAEgC,EAAIiC,EAAEiN,EAAI,CACrB7M,GAAK4M,EAAIjR,EAAEiR,EACX5M,EAAK6M,EAAIlR,EAAEkR,CACnBsD,GAAIyD,OACJzD,EAAI2D,UAAU3b,EAAGwF,GACbsW,GACAA,EAAI1C,KAAKpa,MAEbgZ,EAAIgD,UAAUwD,EAAO/W,EAAEzH,EAAGyH,EAAEjC,EAAGiC,EAAEgN,EAAGhN,EAAEiN,EAAG,EAAG,EAAGlR,EAAEiR,EAAGjR,EAAEkR,GACtDsD,EAAI4D,UAGR,MAAO5c,OAEXyf,KAAM,SAASzZ,GACXA,EAAQA,IAAWhF,EAAG,EAAGwF,GAAI,EAC7B,IAAIwS,GAAMhZ,KAAKgZ,IACXnQ,EAAO7I,KAAK0d,WAChB1E,GAAI2D,WAAuB,IAAb3W,EAAMhF,EAAW6H,EAAK4M,EAAI,GAAgB,IAAbzP,EAAMQ,EAAWqC,EAAK6M,EAAI,GACrEsD,EAAIhT,MAAMA,EAAMhF,EAAGgF,EAAMQ,KAG1B6U,QAMd,WACG,YAEA,IAAI3U,GAAM/G,QAAQC,OAAO,UAEzB8G,GAAIgZ,UAAU,mBAAoB,WAC9B,OACIC,SAAU,IACVC,YAAa,yBACbC,YACIC,QAAW,iBAEf3U,KAAM,SAASH,EAAO9J,EAAS6e,EAAY7L,SAInDxN,EAAIgZ,UAAU,WAAY,SAAU,SAASM,GACzC,QAASC,GAAYrU,EAAQC,EAASC,GAClCF,EAASA,GAAU,GACnBC,EAAUA,GAAW,EACrB,IAAIE,GAAWH,EAAOI,MAAM,IAC5B,IAAID,EAAS9K,OAAS,EAAG,CACrB,GAAIgL,GAAYF,EAASlI,OAQzB,OAPAlE,SAAQ+E,QAAQqH,EAAU,SAASxJ,EAAOe,GAElC2I,EADAH,EACYG,EAAUD,MAAM,IAAM1I,EAAQ,KAAK+C,KAAK,OAAUwF,EAAUtJ,EAAQ,QAEpE0J,EAAUD,MAAM,IAAM1I,EAAQ,KAAK+C,KAAKwF,EAAUtJ,KAGlEuJ,EACO,IAAOG,EAAY,IAEnBA,EAGX,MAAOJ,GAAUD,EAGzB,GAAIsU,GAAW,CACf,QACIP,SAAU,IACVC,YAAa,SAAS1e,EAAS6e,GAC3B,GAAII,GAAW,oBACf,QAAQJ,EAAWK,SACf,IAAK,SACDD,EAAW,uBAGnB,MAAOA,IAEXnV,OACIqV,QAAS,IACTC,SAAU,IACVrS,KAAM,IACNsS,MAAO,IACPC,YAAa,IACbC,OAAQ,KACRxgB,IAAK,KACLygB,MAAO,MAEXC,QAAS,UACTd,YAAY,EACZ1U,MACI2R,IAAK,SAAiB9R,EAAO9J,EAAS6e,EAAY1U,EAAYwU,GAC1D,GAAIa,GAAQ1V,EAAM0V,MAAS1V,EAAM0V,MAAQ1V,EAAM0V,MAAQ,OACnDzgB,EAAM+K,EAAM/K,IAAO+K,EAAM/K,IAAM+K,EAAM/K,IAAM,IAC/C,IAA2B,WAAvB8f,EAAWK,QAAsB,CACjC,GAAIxe,GAAUme,EAAWne,OAAS,KAAOme,EAAWne,OAAS,GACzDgf,EAAcX,EAAYS,EAAO,SAAS,EAC9C1V,GAAM6V,WAAa,WACf,MAAOd,GAAWe,OACd,QAAU7gB,EAAM,OAAS2gB,EAAc,kDAAoDhf,EAC3Fgf,EAAc,kDAAoDhf,EAAS,kBAAoB3B,GAG3G,GAEIsgB,IAFOvV,EAAM/C,KAAO8X,EAAWK,QACxBpV,EAAMiD,KAAOjD,EAAMiD,MAAQ,OAC1BjD,EAAMuV,MAAQvV,EAAMuV,OAAS,WACvBvV,GAAMwV,YAAcxV,EAAMwV,aAAeD,EAC/CvV,EAAM+V,MAAQR,EAAMtN,QAAQ,gBAAiB,IAAIjH,MAAM,KAAK3F,KAAK,OAAS6Z,CACtFlV,GAAMW,OAASoU,EAAWpU,QAAU,KACpCX,EAAMgW,UAAYjB,EAAWiB,WAAa,KAC1ChW,EAAMiW,SAAWlB,EAAWkB,UAAYlB,EAAWK,QACnDpV,EAAMkW,UAAYnB,EAAWmB,WAAa,EAC1ClW,EAAM8T,UAAYiB,EAAWjB,WAAaqC,OAAOC,kBACjDpW,EAAM6M,IAAMkI,EAAWlI,KAAO,KAC9B7M,EAAMxJ,IAAMue,EAAWve,KAAO,KAC9BwJ,EAAMjB,QAAUiW,EAAOD,EAAWhW,SAASiB,OAC3CA,EAAMqW,OAAQ,EACdrW,EAAMsW,SAAU,EAChBtW,EAAMuW,SAAW,SAASrN,GACtB8L,EAAOD,EAAWwB,UAAUvW,EAAMwW,UAEtCxW,EAAMyW,SAAW,SAASvN,GACtB8L,EAAOD,EAAW0B,UAAUzW,EAAMwW,UAEtCxW,EAAM0W,QAAU,WACZ,GAAIzZ,GAAO,MACX,QAAQ8X,EAAWK,SACf,IAAK,WACDnY,EAAO+C,EAAMsW,QAAU,OAAS,UAChC,MACJ,SACIrZ,EAAO8X,EAAWK,QAE1B,MAAOnY,IAEX+C,EAAM2W,WAAa,WACf,GAAI1T,GAAO+R,EAAOhV,EAAMiD,MAAMjD,EAAMwW,SAChCT,EAAQf,EAAOhV,EAAMiD,KAAO,IAAMjD,EAAM+V,OAAO/V,EAAMwW,QACzD,QACII,gBAAiB5W,EAAMqW,MACvBQ,kBAAmBd,EAAMe,OACzBC,gBAAiBhB,EAAMiB,WAAa/T,EAAKgU,YAAclB,EAAMmB,UAC7DC,iBAAkBpB,EAAMqB,aAGhCpX,EAAMqX,YAAc,WAChB,GAAIpU,GAAO+R,EAAOhV,EAAMiD,MAAMjD,EAAMwW,SAChCT,EAAQf,EAAOhV,EAAMiD,KAAO,IAAMjD,EAAM+V,OAAO/V,EAAMwW,QACzD,QAAQvT,EAAKgU,YAAclB,EAAMmB,WAAanB,EAAMuB,QAExDtX,EAAMuX,iBAAmB,WACrBvX,EAAMsW,SAAWtW,EAAMsW,eAO3C5a,EAAIgZ,UAAU,YAAa,QAAS,iBAAkB,WAAY,SAAU,SAASzO,EAAOuR,EAAgB5a,EAAUoY,GAClH,QAASC,GAAYrU,EAAQC,EAASC,GAClCF,EAASA,GAAU,GACnBC,EAAUA,GAAW,EACrB,IAAIE,GAAWH,EAAOI,MAAM,IAC5B,IAAID,EAAS9K,OAAS,EAAG,CACrB,GAAIgL,GAAYF,EAASlI,OAQzB,OAPAlE,SAAQ+E,QAAQqH,EAAU,SAASxJ,EAAOe,GAElC2I,EADAH,EACYG,EAAUD,MAAM,IAAM1I,EAAQ,KAAK+C,KAAK,OAAUwF,EAAUtJ,EAAQ,QAEpE0J,EAAUD,MAAM,IAAM1I,EAAQ,KAAK+C,KAAKwF,EAAUtJ,KAGlEuJ,EACO,IAAOG,EAAY,IAEnBA,EAGX,MAAOJ,GAAUD,EAGzB,GAAIsU,GAAW,CACf,QACIP,SAAU,IACVC,YAAa,SAAS1e,EAAS6e,GAC3B,GAAII,GAAW,oBACf,QAAQJ,EAAWK,SACf,IAAK,SACDD,EAAW,uBAGnB,MAAOA,IAEXnV,OACIqV,QAAS,IACTC,SAAU,IACVrS,KAAM,IACNsS,MAAO,IACPC,YAAa,KAEjBG,QAAS,UAKT8B,QAAS,SAASvhB,EAAS6e,GACnB,OACIjD,IAAK,SAAS9R,EAAO9J,EAAS6e,GAC1B,GAA2B,WAAvBA,EAAWK,QAAsB,CACjC,GAAIM,GAASX,EAAWW,MAAQX,EAAWW,MAAQ,OAC/CzgB,EAAO8f,EAAW9f,IAAM8f,EAAW9f,IAAM,KACzC2B,EAAUme,EAAWlI,IAAM,kBAAqB5X,EAAM,MAAS8f,EAAWlI,IAAM,IAAM,GACtF+I,EAAcX,EAAYS,EAAO,SAAS,EAC9C1V,GAAMjB,QAAUgW,EAAWe,OACvB,QAAU7gB,EAAM,OAAS2gB,EAAc,2CAA6Cb,EAAWU,OAAS7e,EACxGgf,EAAc,2CAA6Cb,EAAWU,OAAS7e,EAAS,kBAAoB3B,EAChHuQ,QAAQC,IAAI,sBAAuBzF,EAAMjB,SAE7C,GAEIwW,IAFOvV,EAAM/C,KAAO8X,EAAWK,QACxBpV,EAAMiD,KAAOjD,EAAMiD,MAAQ,OAC1BjD,EAAMuV,MAAQvV,EAAMuV,OAAS,WACvBvV,GAAMwV,YAAcxV,EAAMwV,aAAeD,EAC/CvV,EAAM+V,MAAQR,EAAMtN,QAAQ,gBAAiB,IAAIjH,MAAM,KAAK3F,KAAK,OAAS6Z,CACtFlV,GAAMiW,SAAWlB,EAAWkB,UAAYlB,EAAWK,QACnDpV,EAAMW,OAASoU,EAAWpU,QAAU,KACpCX,EAAMgW,UAAYjB,EAAWiB,WAAa,KAC1ChW,EAAMiW,SAAWlB,EAAWkB,UAAYlB,EAAWK,QACnDpV,EAAMkW,UAAYnB,EAAWlI,KAAO,EACpC7M,EAAM8T,UAAYiB,EAAWve,KAAO2f,OAAOC,kBAC3CpW,EAAMjB,QAAUiW,EAAOD,EAAWhW,SAASiB,OAC3CA,EAAMqW,OAAQ,EACdrW,EAAMsW,SAAU,EAChBtW,EAAM0W,QAAU,WACZ,GAAIzZ,GAAO,MACX,QAAQ8X,EAAWK,SACf,IAAK,WAGDnY,EAAO+C,EAAMsW,QAAU,OAAS,UAChC,MACJ,SACIrZ,EAAO8X,EAAWK,QAG1B,MAAOnY,IAEX+C,EAAM2W,WAAa,WACf,GAAI1T,GAAO+R,EAAOhV,EAAMiD,MAAMjD,EAAMwW,SAChCT,EAAQf,EAAOhV,EAAMiD,KAAO,IAAMjD,EAAM+V,OAAO/V,EAAMwW,QACzD,QACII,gBAAiB5W,EAAMqW,MACvBQ,kBAAmBd,EAAMe,OACzBC,gBAAiBhB,EAAMiB,WAAa/T,EAAKgU,YAAclB,EAAMmB,UAC7DC,iBAAkBpB,EAAMqB,aAGhCpX,EAAMqX,YAAc,WAChB,GAAIpU,GAAO+R,EAAOhV,EAAMiD,MAAMjD,EAAMwW,SAChCT,EAAQf,EAAOhV,EAAMiD,KAAO,IAAMjD,EAAM+V,OAAO/V,EAAMwW,QACzD,QAAQvT,EAAKgU,YAAclB,EAAMmB,WAAanB,EAAMuB,eAkBhF5b,EAAIgZ,UAAU,gBAAiB,SAAU,WAAY,SAASM,EAAQ9O,GAClE,OACIyO,SAAU,IACVQ,SAAU,8QAKVlN,SAAS,EACT4M,YAAY,EACZ1U,KAAM,SAASH,EAAO9J,EAAS6e,EAAY7L,GAKvC,QAASwO,GAAS7c,GACd,GAAIgS,GAAMmI,EAAOD,EAAWlI,KAAK7M,GAC7B2X,EAAS3C,EAAOD,EAAW6C,cAC3BC,EAASF,EAAOG,MACpB5R,GAAS,WACL2R,EAAO7X,EAAOzJ,KAAKC,IAAIqW,EAAK8K,EAAO3X,GAAS,MAKpD,QAAS+X,GAAMld,GACX,GAAIrE,GAAMwe,EAAOD,EAAWve,KAAKwJ,GAC7B2X,EAAS3C,EAAOD,EAAW6C,cAC3BC,EAASF,EAAOG,MACpB5R,GAAS,WACL2R,EAAO7X,EAAOzJ,KAAKsW,IAAIrW,EAAKmhB,EAAO3X,GAAS,MAUpD,QAASgY,KACLrjB,QAAQuB,QAAQ+hB,GAAYC,IAAI,uBAAwBR,GACxD/iB,QAAQuB,QAAQiiB,GAASD,IAAI,uBAAwBH,GA/BzD,GAAIpa,GAAOzH,EAAQ,GACf+hB,EAAata,EAAKya,iBAAiB,2BAA2B,GAC9DD,EAAUxa,EAAKya,iBAAiB,2BAA2B,EA+B/DpY,GAAMqY,IAAI,WAAY,WAClBL,MAVJ,WACIrjB,QAAQuB,QAAQ+hB,GAAYvO,GAAG,uBAAwBgO,GACvD/iB,QAAQuB,QAAQiiB,GAASzO,GAAG,uBAAwBqO,cAkBvE,WACG,YAEUpjB,SAAQC,OAAO,WAErB8f,UAAU,YAAa,UAAW,SAAS7d,GAC3C,OACI8e,QAAS,UACTxV,KAAM,SAASH,EAAO9J,EAAS6e,EAAY7L,GA8FvC,QAASoP,KACLjC,GAAQ,EACJ1V,IACAzK,EAAQ,GAAGqB,MAAQ2R,EAAMqP,aAAe,KACnCrP,EAAMqP,aACPrP,EAAMsP,cAAc,OAKhC,QAASC,KACL,GAAI9X,IAAWuI,EAAM8N,SACjB,OAAQ/Z,GACJ,IAAK,OACL,IAAK,WACL,IAAK,iBACD/G,EAAQ,GAAGqB,MAAQ2R,EAAMqP,YAAc1hB,EAAQ,QAAQqS,EAAMqP,YAAa5X,GAAU,GACpF,MACJ,SACIzK,EAAQ,GAAGqB,MAAQ2R,EAAMqP,YAAc1hB,EAAQ,UAAUqS,EAAMqP,YAAavC,GAAa,IAAMrV,EAAS,KAMxH,QAAS+X,KACLrC,GAAQ,EACRoC,IAQJ,QAAST,KACL9hB,EAAQgiB,IAAI,QAASI,GACrBpiB,EAAQgiB,IAAI,OAAQQ,GAlIxB,GAAIzb,GAAO8X,EAAWkB,SAClBtV,EAASoU,EAAWpU,QAAU,GAC9BqV,EAAYjB,EAAWiB,WAAa,EACpCK,GAAQ,CAEZ,QAAQpZ,GACJ,IAAK,OACL,IAAK;eACL,IAAK,iBACDiM,EAAMyP,YAAY5gB,KAAK,SAASR,GAC5B,MAAIA,GACOV,EAAQ,QAAQU,EAAOoJ,GAEvB,MAGf,MACJ,KAAK,SACDuI,EAAM0P,SAASzQ,QAAQ,SAAS5Q,GAC5B,GAAIshB,IAAQ,CA0BZ,YAzBclhB,KAAVJ,GAAiC,KAAVA,GACvBshB,GAA6D,IAArDC,OAAOvhB,GAAOgB,QAAQ4d,OAAO5e,GAAOoF,YAC5CpF,EAAQ4e,OAAO5e,GACf2R,EAAM6P,aAAa,SAAUF,GACzBA,IACA3P,EAAM6P,aAAa,WAAYxhB,GAAS,SACjBI,KAAnBod,EAAWlI,KACX3D,EAAM6P,aAAa,QAASxhB,GAAS4e,OAAOpB,EAAWlI,UAEpClV,KAAnBod,EAAWve,KACX0S,EAAM6P,aAAa,QAASxhB,GAAS4e,OAAOpB,EAAWve,SAI/DqiB,GAAQ,EACRthB,EAAQ4e,OAAO5e,GACf2R,EAAM6P,aAAa,UAAU,GAC7B7P,EAAM6P,aAAa,YAAY,OACRphB,KAAnBod,EAAWlI,KACX3D,EAAM6P,aAAa,SAAS,OAETphB,KAAnBod,EAAWve,KACX0S,EAAM6P,aAAa,SAAS,IAG7BxhB,IAEX2R,EAAMyP,YAAY5gB,KAAK,SAASR,GAC5B,MAAIA,GACOV,EAAQ,UAAUU,EAAOye,GAAa,IAAMrV,EAE5C,MAGf,MACJ,KAAK,YACDuI,EAAM0P,SAASzQ,QAAQ,SAAS5Q,GAC5B,GAAIshB,IAAQ,CAwBZ,YAvBclhB,KAAVJ,GAAiC,KAAVA,GACvBshB,GAA6D,IAArDC,OAAOvhB,GAAOgB,QAAQ4d,OAAO5e,GAAOoF,YAC5CpF,EAAQ4e,OAAO5e,GACf2R,EAAM6P,aAAa,SAAUF,GACzBA,QACuBlhB,KAAnBod,EAAWlI,KACX3D,EAAM6P,aAAa,QAASxhB,GAAS4e,OAAOpB,EAAWlI,UAEpClV,KAAnBod,EAAWve,KACX0S,EAAM6P,aAAa,QAASxhB,GAAS4e,OAAOpB,EAAWve,SAI/DqiB,GAAQ,EACRthB,EAAQ4e,OAAO5e,GACf2R,EAAM6P,aAAa,UAAU,OACNphB,KAAnBod,EAAWlI,KACX3D,EAAM6P,aAAa,SAAS,OAETphB,KAAnBod,EAAWve,KACX0S,EAAM6P,aAAa,SAAS,IAG7BxhB,IAEX2R,EAAMyP,YAAY5gB,KAAK,SAASR,GAC5B,MAAIA,IAAmB,IAAVA,EACFV,EAAQ,UAAUU,EAAOye,GAAa,IAAMrV,EAE5C,OA6CvBX,EAAMqY,IAAI,WAAY,WAClBL,MAVJ,WACI9hB,EAAQwT,GAAG,QAAS4O,GACpBpiB,EAAQwT,GAAG,OAAQgP,cAkBtC,WACG,YAEU/jB,SAAQC,OAAO,WAErB8f,UAAU,aAAc,SAAU,mBAAoB,WAAY,cAAe,QAAS,SAASM,EAAQgE,EAAkBpc,EAAUC,EAAaC,GAEpJ,QAASiD,GAAkBC,EAAO9J,EAAS+J,EAAMC,GAE7ChK,EAAQ+J,KAAKA,EACb,IAAIE,GAAOvD,EAAS1G,EAAQkK,WAC5B,IAAIF,EAAKG,WAAY,CACjB,GAAIC,GAASN,EAAMO,MACnB5L,SAAQ0F,OAAOiG,EAAQJ,EACvB,IAAIG,GAAaxD,EAAYqD,EAAKG,YAAcC,OAAQA,GACpDJ,GAAKM,eACLR,EAAME,EAAKM,cAAgBH,GAE/BnK,EAAQgK,KAAK,0BAA2BG,GACxCnK,EAAQuK,WAAWP,KAAK,0BAA2BG,GACnDL,EAAQM,EAEZH,EAAKH,GAGT,OACI2U,SAAU,IACVsE,UAAW,IACX9Y,KAAM,SAASH,EAAO9J,EAAS6e,EAAY7L,GACvC,GAAIgQ,GAAQlE,EAAOD,EAAWoE,UAC9BD,GAAQA,EAAMlZ,GACdkZ,EAAMtE,YAAcsE,EAAMtE,aAAe,uBACzCoE,EAAiBE,EAAMtE,aAAajP,KAAK,SAAS1F,GAC9CF,EAAkBC,EAAO9J,EAAS+J,EAAMiZ,aA+B3D,WACG,YAEUvkB,SAAQC,OAAO,WAErBwkB,SAAS,UAAW,WASpB,QAASC,GAAKlU,EAAM+T,GAEhB,MADAI,GAAOnU,GAAQ+T,EACRlkB,KATX,GAAIukB,MACAD,IAEJtkB,MAAKukB,OAASA,EACdvkB,KAAKskB,OAASA,EACdtkB,KAAKqkB,KAAOA,EAOZrkB,KAAKuR,MAAQ,KAAM,WAAY,SAAsB1M,EAAIqM,GAErD,QAASsT,GAASN,GAEd,GAAI5gB,IAAS,CACb3D,SAAQ+E,QAAQ6f,EAAQ,SAASE,EAAGxiB,GAC5BwiB,IAAMP,IACN5gB,EAAQrB,MAGD,IAAXqB,GACA4N,EAAS,WACLgT,EAAMQ,QAAS,EACfH,EAAO/gB,OAAOF,EAAO,GACjBihB,EAAOtjB,SACPsjB,EAAOA,EAAOtjB,OAAS,GAAGyjB,QAAS,KAMnD,QAASC,GAAWT,GAEhB,GAAI5gB,IAAS,CACb3D,SAAQ+E,QAAQ6f,EAAQ,SAASE,EAAGxiB,GAC5BwiB,IAAMP,IACN5gB,EAAQrB,MAGD,IAAXqB,IACA4gB,EAAMQ,QAAS,EACfxT,EAAS,WACL,KAAOqT,EAAOtjB,QACVsjB,EAAO/gB,OAAO+gB,EAAOtjB,OAAS,EAAG,IAEtC,MAIX,QAAS2jB,GAASzU,EAAMC,GAEpB,GAAIrL,GAAWF,EAAGG,OAClBoL,GAASA,GAAU,IACnB,IAAI8T,IACA3D,MAAO,WACPlV,WAAY,KACZuU,YAAa,KACbxP,OAAQA,GAERG,EAAU+T,EAAOnU,EA6BrB,OA5BII,IACA5Q,QAAQ0F,OAAO6e,EAAO3T,GAE1B2T,EAAMnf,SAAWA,EACjBmf,EAAMW,KAAO,SAAS3Z,GAClBsZ,EAASxkB,MACTkkB,EAAMnf,SAAS8L,QAAQ3F,EAAMgZ,IAEjCA,EAAMrT,QAAU,SAAS3F,GACrByZ,EAAW3kB,MACXkkB,EAAMnf,SAAS8L,QAAQ3F,EAAMgZ,IAEjCA,EAAMnT,OAAS,WACX4T,EAAW3kB,MACXkkB,EAAMnf,SAASgM,OAAOmT,IAE1BK,EAAOxhB,KAAKmhB,GACZvkB,QAAQ+E,QAAQ6f,EAAQ,SAASE,EAAGxiB,GAChCwiB,EAAEC,QAAS,IAEXH,EAAOtjB,OACPijB,EAAMQ,QAAS,EAEfxT,EAAS,WACLgT,EAAMQ,QAAS,GAEhB,KAEA3f,EAASE,QAGpB,OACIsf,OAAQA,EACRK,SAAUA,WASzB,WACA,YAEA,IAAIle,GAAM/G,QAAQC,OAAO,UAEzB8G,GAAIgZ,UAAU,OAAQ,SAAU,MAAO,SAAUM,EAAQ8E,GACxD,OACCnF,SAAU,IACVC,YAAa,SAAU1e,EAAS6e,GAC/B,MAAOA,GAAWI,UAAY,mBAE/BnV,OACCtH,MAAO,QAERyH,KAAM,SAAUH,EAAO9J,EAAS6e,EAAY7L,GAC3ClJ,EAAM+Z,OAAO,QAAS,SAAUxiB,GAE/B,GAAIA,EACH,GAAI5C,QAAQqlB,QAAQziB,GAAQ,CAC3B,GAAI0iB,GAASjF,EAAOD,EAAWkF,QAAQja,EAAMwW,SACzC0D,EAAQlF,EAAOD,EAAWmF,OAAOla,EAAMwW,SACvC2D,EAAM,GAAIL,IACbG,OAAQA,EACRC,MAAOA,GAERC,GAAIC,SAAS7iB,GACbyI,EAAMhJ,KAAOmjB,MAEH5iB,aAAiBuiB,KAC3B9Z,EAAMhJ,KAAOO,UAQnBmE,EAAIgZ,UAAU,WAAY,WAAY,SAAUxO,GAC/C,OACCyO,SAAU,IACVC,YAAa,SAAU1e,EAAS6e,GAC/B,MAAOA,GAAWI,UAAY,wBAE/BnV,OACChJ,KAAM,YAEPmJ,KAAM,SAAUH,EAAO9J,EAAS6e,EAAY7L,GAK3C,QAASmR,GAASrjB,EAAMsjB,GACvB,GAAIC,GAAQvjB,EAAKwjB,KAAKD,KACtBA,GAAMb,QAAS,EAEfxT,EAAS,WACRqU,EAAMD,UAAYA,EAClBC,EAAME,OAASF,EAAMG,SAAU,EAC/BH,EAAMI,SAAU,EAChBzU,EAAS,WACRqU,EAAMI,SAAU,EAChBJ,EAAMK,QAAS,MAKlB,QAASC,GAAU7jB,EAAMsjB,GACxB,GAAIC,GAAQvjB,EAAKwjB,KAAKD,KACtBA,GAAMb,QAAS,EACfxT,EAAS,WACRqU,EAAMD,UAAYA,EAClBC,EAAMK,OAASL,EAAMI,SAAU,EAC/BJ,EAAMG,SAAU,EAChBxU,EAAS,WACRqU,EAAMG,SAAU,EAChBH,EAAME,QAAS,MAGbzjB,EAAK0B,OACR/D,QAAQ+E,QAAQ1C,EAAK0B,MAAO,SAAUyI,GACrC0Z,EAAU1Z,GAAG,KAKhB,QAAS2Z,GAAW9jB,GAEnB,GAAIujB,GAAQvjB,EAAKwjB,KAAKD,KACtBA,GAAMb,QAAS1iB,EAAK0B,QAAS6hB,EAAMb,OAC/Ba,EAAMb,QACL1iB,EAAKwjB,KAAKnc,QACb1J,QAAQ+E,QAAQ1C,EAAKwjB,KAAKnc,OAAO3F,MAAO,SAAUyI,GAC7CA,IAAMnK,GACT6jB,EAAU1Z,GAAG,KAIhBkZ,EAASrjB,IAET6jB,EAAU7jB,GAKZ,QAAS+jB,GAAMlgB,GAuBd,QAASmgB,KACR9U,EAAS,WACR4U,EAAW9jB,KAxBb,GAAIA,GAAOgJ,EAAMhJ,IAGjB,IADYA,EAAKwjB,KAAKD,MACZb,OACTuB,GAAS,EACTD,QACM,IAAIhkB,EAAKwjB,KAAKN,MAAO,CAC3B,GAAIjgB,GAAUjD,EAAKwjB,KAAKN,MAAMljB,EAAMA,EAAKwjB,KACrCvgB,IAAmC,kBAAjBA,GAAQ0L,MAC7B1L,EAAQ0L,KAAK,SAAUuV,GAEtBF,KACE,SAAUG,MAGbF,GAAS,IAETA,EAAShhB,EACT+gB,MAWH,QAASI,GAAavgB,GAErBkgB,EAAMlgB,GACNwgB,EACEnD,IAAI,YAAaoD,GAIpB,QAASA,GAAYzgB,GAEpBkgB,EAAMlgB,GACNwgB,EACEnD,IAAI,aAAckD,GAIrB,QAASG,GAAQ1gB,GAEhB,MAAO2gB,GAAQ3gB,GAGhB,QAAS2gB,GAAQ3gB,GAChB,IAAe,IAAXogB,EAIH,MAFApgB,GAAE4gB,kBAEK,EAWT,QAASzD,KACRqD,EACEnD,IAAI,aAAckD,GAClBlD,IAAI,YAAaoD,GACjBpD,IAAI,QAASqD,GAhIhB,GAEIN,GAFAI,EAAU1mB,QAAQuB,QAAQA,EAAQ,GAAGwlB,cAAc,eAqHvD,WACCL,EACE3R,GAAG,aAAc0R,GACjB1R,GAAG,YAAa4R,GAChB5R,GAAG,QAAS6R,MAYfvb,EAAMqY,IAAI,WAAY,WACrBL,cAUJ,WACG,YAEUrjB,SAAQC,OAAO,WAErBC,QAAQ,OAAQ,UAAW,SAAS2S,GACpC,QAASsS,GAAI/a,GACT,GAAIob,GAAMnlB,KACN4N,GACAlK,SAEJ/D,SAAQ0F,OAAO8f,EAAKvX,GAChB7D,GACApK,QAAQ0F,OAAO8f,EAAKpb,GAExBob,EAAIwB,OAAOxB,EAAK,MAEpBL,EAAI3kB,WACAilB,SAAU,SAAS1hB,GACf,GAAIyhB,GAAMnlB,IACVmlB,GAAIhV,KAAOqC,EAAQrC,OACnBgV,EAAIzhB,MAAQA,EACZyhB,EAAIyB,QAAQljB,EAAOyhB,IAEvByB,QAAS,SAASljB,EAAO2F,GACrB,GAAI8b,GAAMnlB,IACN0D,IACA/D,QAAQ+E,QAAQhB,EAAO,SAAS1B,GAC5BmjB,EAAIwB,OAAO3kB,EAAMqH,GACjB8b,EAAIyB,QAAQ5kB,EAAK0B,MAAO1B,MAIpC2kB,OAAQ,SAAS3kB,EAAMqH,GACnB,GAAI8b,GAAMnlB,KACNwlB,GACAnc,OAAQA,GAAU,KAClBwd,MAAOxd,EAASA,EAAOmc,KAAKqB,MAAQ,EAAI,EACxCtB,SACAuB,SAAU,SAAS9lB,GACfmkB,EAAI2B,SAAS9lB,EAAGgB,IAEpBkjB,MAAOC,EAAID,MAIf,IAFAljB,EAAKwjB,KAAOA,EACZA,EAAKra,KAAOga,EAAI4B,QAAQ/kB,GACpBwjB,EAAKra,OAASga,EAAIhV,KAGlB,IAFAqV,EAAKD,MAAMb,QAAS,EACpBc,EAAKD,MAAMK,QAAS,EACbJ,EAAKnc,QACRmc,EAAOA,EAAKnc,OAAOmc,KACnBA,EAAKD,MAAMb,QAAS,EACpBc,EAAKD,MAAMK,QAAS,GAIhCkB,SAAU,SAASE,EAAa3d,GAC5B,GAAI8b,GAAMnlB,IACNL,SAAQqlB,QAAQgC,GAChBrnB,QAAQ+E,QAAQsiB,EAAa,SAAShlB,GAClCmjB,EAAI8B,QAAQjlB,EAAMqH,KAGtB8b,EAAI8B,QAAQD,EAAa3d,IAGjC4d,QAAS,SAASjlB,EAAMqH,GACpB,GAAI8b,GAAMnlB,IACGmlB,GAAIF,OACLE,EAAID,MAChBC,EAAIwB,OAAO3kB,EAAMqH,GACbA,IACAA,EAAO3F,MAAQ2F,EAAO3F,UACtB2F,EAAO3F,MAAMX,KAAKf,KAG1B+kB,QAAS,SAAS/kB,GAOd,MALIhC,MAAKilB,OACEjlB,KAAKilB,OAAOjjB,EAAMA,EAAKwjB,MAEvBxjB,EAAKmJ,MAKxB,IAAIjG,IACA8N,OAAQ,SAAS7C,GACbqC,EAAQQ,OAAO7C,IAEnBA,KAAM,SAASA,GACXqC,EAAQrC,KAAKA,IAIrB,OADAxQ,SAAQ0F,OAAOyf,EAAK5f,GACb4f,QAMd,WACA,YAEA,IAAIpe,GAAM/G,QAAQC,OAAO,UAEzB8G,GAAIgZ,UAAU,eAAgB,SAAU,WAAY,UAAW,WAAY,aAAc,UAAW,QAAS,SAAU,QAAS,SAAUM,EAAQpY,EAAUwL,EAASlC,EAAUgW,EAAYpnB,EAASgG,EAAOqhB,EAAQrf,GAClN,OACC6X,SAAU,IACVQ,SAAU,4CACVN,YAAY,EACZ1U,KAAM,SAAUH,EAAO9J,EAAS6e,EAAY7L,GAmH3C,QAASkT,GAAO9mB,GACf,GAAI+mB,KA6BH,GA3BArgB,EAAE+B,KAAO,EACT/B,EAAEkP,MAAQoR,EAAYzJ,YAAc0J,EAAY1J,YAC5C2J,GACH3hB,EAAE7E,EAAIyH,EAAEzH,EAAIymB,EAAKzmB,EAAI0mB,EAAK1mB,EAC1B2mB,KAGUC,IACV/hB,EAAE7E,GAAK4mB,EACPA,GAAS,IACLC,GACHF,IAGGpmB,KAAKgG,IAAIqgB,GAAS,MACrBA,EAAQ,EACR/hB,EAAE7E,EAAIyH,EAAEzH,EAAIkD,EAAElD,EACd6mB,GAAW,IAKbhiB,EAAE7E,EAAIO,KAAKsW,IAAI7Q,EAAE+B,KAAMlD,EAAE7E,GACzB6E,EAAE7E,EAAIO,KAAKC,IAAIwF,EAAEkP,MAAOrQ,EAAE7E,GAC1BkD,EAAElD,IAAM6E,EAAE7E,EAAIkD,EAAElD,GAAK,EACrB8mB,EAAaxhB,UAAU,eAAiBpC,EAAElD,EAAEmX,QAAQ,GAAK,WACzD2P,EAAahlB,IAAIykB,GACbQ,EAAkB,CACrB,GAAIP,GAAYK,GAAYD,EAAO,CAClC,GAAII,GAAU9jB,EAAElD,GAAKsmB,EAAYzJ,YAAc0J,EAAY1J,YAC3DmK,GAAUzmB,KAAKC,IAAI,EAAGD,KAAKsW,IAAI,EAAGmQ,IAClC/lB,EAAEjB,GAAKsmB,EAAYzJ,YAAcoK,EAAcpK,aAAe,EAC9D5b,EAAEuE,IAAM,EAAIvE,EAAEuE,GAAK,CAEnB,IAAIlD,GAAQ/B,KAAKC,IAAI,EAAGD,KAAKkF,MAAMuhB,EAAUD,EAAiBtM,KAAKxa,QACnEinB,GAAUjd,KAAK3H,EAAQ,IAAMykB,EAAiBI,WAG9ClmB,GAAEuE,IAAM,GAAKvE,EAAEuE,GAAK,CAErB4hB,GAAe9hB,UAAU,eAAiBrE,EAAEjB,EAAEmX,QAAQ,GAAK,MAAQlW,EAAEuE,EAAE2R,QAAQ,GAAK,SACpFiQ,EAAetlB,IAAImlB,QAKpBH,GAAaxhB,UAAU,sBACvBwhB,EAAahlB,IAAIykB,GAInB,QAASI,KACR3gB,EAAE+B,MAAQsf,EACVrhB,EAAEkP,OAASmS,EACPxiB,EAAE7E,EAAIgG,EAAE+B,KACXuf,IACUziB,EAAE7E,EAAIgG,EAAEkP,OAClBqS,IAIF,QAASD,KACJE,GAGCC,IAGLD,GAAO,EACPC,EAAOzd,GAAO2F,OAAO+X,QAAQ,WAC5BjgB,EAAEzH,EAAI6E,EAAE7E,EAAI,EACZU,WAAW,WACVinB,IACAH,GAAO,GACL,QAIL,QAASD,KACJC,GAGCI,IAGLJ,GAAO,EACPI,EAAQ5d,GAAO2F,OAAO+X,QAAQ,WACjBpB,EAAYzJ,YAAc0J,EAAY1J,YACtC7W,EAAEkP,MACbzN,EAAEzH,EAAI6E,EAAE7E,EAAIgG,EAAEkP,MAEdzN,EAAEzH,EAAI6E,EAAE7E,EAAIgG,EAAEkP,MAAQmS,EAEvB3mB,WAAW,WACVinB,IACAH,GAAO,GACL,QAIL,QAASG,KAERnB,GAAW,EACXK,GAAW,EACXJ,EAAO,KACPC,EAAO,KACPmB,IAGD,QAASC,GAAO3gB,GACG,cAAdA,EAAMF,MACT/G,EAAQgiB,IAAI,YAAa4F,GAErBN,IACJ/f,EAAEzH,EAAI6E,EAAE7E,EAAIkD,EAAElD,EACd4mB,EAAQ,EACRF,EAAO5f,EAAMC,SAASI,GACtB0f,GAAW,EAEXkB,IACAC,EAAQ5oB,QAIV,QAAS6oB,GAAO9gB,GACG,aAAdA,EAAMF,MACTtI,QAAQuB,QAAQkS,GAAS8P,IAAI,YAAa+F,GAE3CC,EAAOzB,EACPA,EAAO3f,EAAMC,SAASI,GACtBqf,GAAW,EAIZ,QAAS2B,GAAKhhB,GACK,YAAdA,EAAMF,MACTtI,QAAQuB,QAAQkS,GAAS8P,IAAI,UAAWiG,GAErC1B,GAAQyB,IACXtB,GAA6B,GAAnBH,EAAKzmB,EAAIkoB,EAAKloB,IAEzByH,EAAEzH,EAAI6E,EAAE7E,EAAIkD,EAAElD,EACdwmB,GAAW,EACXC,EAAO,KACPC,EAAO,KACPwB,EAAO,KACPE,EAAKthB,EAAMC,SAASI,GAEpB0gB,IAGD,QAASQ,KACR,GAAIC,IAAa/B,EAAY1J,YAAcyJ,EAAYzJ,aAAe,EAEtE,OADAyL,GAAY/nB,KAAKsW,IAAI,GAAItW,KAAKC,IAAI,IAAK8nB,IAIxC,QAASC,GAAS1jB,GACjB,IAAK2iB,GAAQnB,IAAa,CACpBxhB,IAAGA,EAAIuN,EAAQjL,OACpBtC,EAAIA,EAAEuC,cAAgBvC,EAAEuC,cAAgBvC,CACxC,IAAI2jB,GAAS3jB,EAAE4jB,OAAS,GAAK5jB,EAAE6jB,WAAa,GAAM7jB,EAAE4jB,OAAS,EAAK,GAAK,CACvE7B,IAAS4B,EAAMH,IACfxB,GAAW,EAEXmB,EAAQ5oB,QAMV,QAAS8iB,KACR2F,IACAG,EAAQtoB,QACRioB,IAGD,QAAStB,KACR,GAAIsC,IAAU,CAMd,OALIC,KACHD,EAAUA,GAAWC,EAAe5e,IAErC2e,EAAUA,GAAWvW,EAAQyW,YAAc,KAC3CF,EAAUA,GAAYrC,EAAYzJ,YAAc0J,EAAY1J,YAI7D,QAASiM,KACHzC,KACJnE,IAEDkE,IAiBD,QAASpE,KACRrjB,QAAQuB,QAAQkS,GAAS8P,IAAI,SAAU4G,GACvC5oB,EAAQgiB,IAAI,uBAAwB4F,GACpC5nB,EAAQgiB,IAAI,QAAS6G,IAGtB,QAAShB,KACRppB,QAAQuB,QAAQkS,GAASsB,GAAG,sBAAuBuU,GACnDtpB,QAAQuB,QAAQkS,GAASsB,GAAG,mBAAoByU,GAGjD,QAASN,KACRlpB,QAAQuB,QAAQkS,GAAS8P,IAAI,sBAAuB+F,GACpDtpB,QAAQuB,QAAQkS,GAAS8P,IAAI,mBAAoBiG,GAjVlD/V,EAAQ4W,YAAc,WACrB,OAAO,EAIR,IAGIxC,GAAUK,EAAUW,EAGpBd,EAAMD,EAAMyB,EAAME,EA2BlBa,EAAYxB,EAAQG,EAASb,EAAkB6B,EAjC/CvB,EAAU,IASV5f,GACFzH,EAAG,EACHwF,EAAG,GAEJX,GACC7E,EAAG,EACHwF,EAAG,GAEJtC,GACClD,EAAG,EACHwF,EAAG,GAEJvE,GACCjB,EAAG,GACHwF,EAAG,GAEJQ,GACCgC,IAAK,EACLkN,MAAO,EACPC,OAAQ,EACRpN,KAAM,GAEP6e,EAAQ,CAIRqC,GADGlK,EAAWmK,YACDlK,EAAOD,EAAWmK,aAAalf,GAE/B,GAAIkc,GAElB+C,EAAW9e,MACVgf,MAAO,WACNtkB,EAAE7E,EAAIkD,EAAElD,EAAI,EACZomB,KAEDkB,OAAQA,EACRC,QAASA,QAEgB5lB,KAAtBod,EAAW0I,SACdA,EAASzI,EAAOD,EAAW0I,OAA4B,MAA4B,QAEzD9lB,KAAvBod,EAAW6I,UACdA,EAAU5I,EAAOD,EAAW6I,QAA6B,MAA4B,QAElDjmB,KAAhCod,EAAWgI,mBACdA,EAAmB/H,EAAOD,EAAWgI,iBAAsC,MAA4B,QAEtEplB,KAA9Bod,EAAW6J,iBACdA,EAAiB5J,EAAOD,EAAW6J,eAAoC,MAA4B,IAMpG1oB,EAAQkpB,KAAK,eAAgB,MAAM1a,SAAS,eAC5C,IAMC0Y,GANGd,EAAcpmB,EAAQ,GACtBqmB,EAAcD,EAAYZ,cAAc,YACxCla,EAAU7M,QAAQuB,QAAQsL,GAC1Bsb,EAAe,GAAIhiB,GACnBoiB,EAAY,KACfD,EAAgB,MAEjBF,GAAmB,KAElBG,EAAYvoB,QAAQuB,QAAQ,iCAC5B+mB,EAAgBC,EAAU,GAC1BE,EAAiB,GAAItiB,GACrB5E,EAAQmpB,OAAOnC,GACftgB,EAASsgB,EAAU9c,YAAYJ,GAC/Bod,EAAe9hB,UAAU,eAAiBrE,EAAEjB,EAAEmX,QAAQ,GAAK,MAAQlW,EAAEuE,EAAE2R,QAAQ,GAAK,SACpFiQ,EAAetlB,IAAImlB,GAGpB,IAAIe,GAAU,GAAIlpB,GAAQsnB,GAsMtB2C,GAAUjiB,EAAM8B,SAAS2f,EAAU,GAyBvCve,GAAM+Z,OAAO,WACZ,MAAOwC,GAAY1J,aACjB,SAAUxI,EAAUiV,GACtBR,MA0BD9e,EAAMqY,IAAI,WAAY,WACrBL,IACAgG,EAAQtoB,UAzBT,WACCf,QAAQuB,QAAQkS,GAASsB,GAAG,SAAUoV,GACtC5oB,EAAQwT,GAAG,uBAAwBoU,GACnC5nB,EAAQwT,GAAG,QAASqV,YA+BxBrjB,EAAIgZ,UAAU,eAAgB,SAAU,WAAY,UAAW,WAAY,aAAc,UAAW,QAAS,SAAU,QAAS,SAAUM,EAAQpY,EAAUwL,EAASlC,EAAUgW,EAAYpnB,EAASgG,EAAOqhB,EAAQrf,GAElN,OACC6X,SAAU,IACVQ,SAAU,4CACVN,YAAY,EACZ1U,KAAM,SAAUH,EAAO9J,EAAS6e,EAAY7L,GAwF3C,QAASkT,GAAO9mB,GACf,GAAI+mB,MAEHrgB,EAAEgC,IAAM,EACRhC,EAAEmP,OAASmR,EAAYxJ,aAAeyJ,EAAYzJ,aAC9C0J,GACH3hB,EAAEW,EAAIiC,EAAEjC,EAAIihB,EAAKjhB,EAAIkhB,EAAKlhB,EAC1BmhB,KACUC,IACV/hB,EAAEW,GAAKohB,EACPA,GAAS,IACLC,GACHF,IAEGpmB,KAAKgG,IAAIqgB,GAAS,MACrBA,EAAQ,EACR/hB,EAAEW,EAAIiC,EAAEjC,EAAItC,EAAEsC,EACdqhB,GAAW,EACXmB,EAAQtoB,UAIVmF,EAAEW,EAAIjF,KAAKsW,IAAI7Q,EAAEgC,IAAKnD,EAAEW,GACxBX,EAAEW,EAAIjF,KAAKC,IAAIwF,EAAEmP,OAAQtQ,EAAEW,GAC3BtC,EAAEsC,IAAMX,EAAEW,EAAItC,EAAEsC,GAAK,EACrBshB,EAAaxhB,UAAU,iBAAmBpC,EAAEsC,EAAE2R,QAAQ,GAAK,SAC3D2P,EAAahlB,IAAIykB,GACbQ,GAAkB,CACrB,GAAIP,GAAYK,GAAYD,EAAO,CAClC,GAAII,GAAU9jB,EAAEsC,GAAK8gB,EAAYxJ,aAAeyJ,EAAYzJ,aAC5DkK,GAAUzmB,KAAKC,IAAI,EAAGD,KAAKsW,IAAI,EAAGmQ,IAClC/lB,EAAEuE,GAAK8gB,EAAYxJ,aAAemK,EAAcnK,cAAgB,EAChE7b,EAAEjB,IAAM,EAAIiB,EAAEjB,GAAK,CAEnB,IAAIsC,GAAQ/B,KAAKC,IAAI,EAAGD,KAAKkF,MAAMuhB,EAAUD,EAAiBtM,KAAKxa,QACnEinB,GAAUjd,KAAK3H,EAAQ,IAAMykB,EAAiBI,WAG9ClmB,GAAEjB,IAAM,GAAKiB,EAAEjB,GAAK,CAErBonB,GAAe9hB,UAAU,eAAiBrE,EAAEjB,EAAEmX,QAAQ,GAAK,MAAQlW,EAAEuE,EAAE2R,QAAQ,GAAK,SACpFiQ,EAAetlB,IAAImlB,IAKtB,QAASsC,KACJ/B,GAGCgC,IAGLhC,GAAO,EACPgC,EAAMxf,GAAO2F,OAAO+X,QAAQ,WAC3BjgB,EAAEjC,EAAIX,EAAEW,EAAI,EACZ9E,WAAW,WACVinB,IACAH,GAAO,GACL,QAIL,QAASiC,KACJjC,GAGCkC,IAGLlC,GAAO,EACPkC,EAAS1f,GAAO2F,OAAO+X,QAAQ,WACjBpB,EAAYxJ,aAAeyJ,EAAYzJ,aACvC9W,EAAEmP,OACd1N,EAAEjC,EAAIX,EAAEW,EAAIQ,EAAEmP,OAEd1N,EAAEjC,EAAIX,EAAEW,EAAIQ,EAAEmP,OAASkS,EAExB3mB,WAAW,WACVinB,IACAH,GAAO,GACL,QAIL,QAASG,KAERnB,GAAW,EACXK,GAAW,EACXJ,EAAO,KACPC,EAAO,KACPmB,IAGD,QAASlB,KACR3gB,EAAEgC,KAAOqf,EACTrhB,EAAEmP,QAAUkS,EACRxiB,EAAEW,EAAIQ,EAAEgC,IACXuhB,IACU1kB,EAAEW,EAAIQ,EAAEmP,QAClBsU,IAIF,QAAS3B,GAAO3gB,GACG,cAAdA,EAAMF,MACT/G,EAAQgiB,IAAI,YAAa4F,GAErBN,IACJ/f,EAAEjC,EAAIX,EAAEW,EAAItC,EAAEsC,EACdohB,EAAQ,EACRF,EAAO5f,EAAMC,SAASI,GACtB0f,GAAW,EAEXkB,IACAC,EAAQ5oB,QAIV,QAAS6oB,GAAO9gB,GACG,aAAdA,EAAMF,MACTtI,QAAQuB,QAAQkS,GAAS8P,IAAI,YAAa+F,GAE3CC,EAAOzB,EACPA,EAAO3f,EAAMC,SAASI,GACtBqf,GAAW,EAIZ,QAAS2B,GAAKhhB,GACK,YAAdA,EAAMF,MACTtI,QAAQuB,QAAQkS,GAAS8P,IAAI,UAAWiG,GAErC1B,GAAQyB,IACXtB,GAA6B,GAAnBH,EAAKjhB,EAAI0iB,EAAK1iB,IAEzBiC,EAAEjC,EAAIX,EAAEW,EAAItC,EAAEsC,EACdghB,GAAW,EACXC,EAAO,KACPC,EAAO,KACPwB,EAAO,KACPE,EAAKthB,EAAMC,SAASI,GAEpB0gB,IAGD,QAASU,GAAS1jB,GACjB,IAAK2iB,GAAQnB,IAAa,CACpBxhB,IAAGA,EAAIuN,EAAQjL,OACpBtC,EAAIA,EAAEuC,cAAgBvC,EAAEuC,cAAgBvC,CACxC,IAAI2jB,GAAS3jB,EAAE4jB,OAAS,GAAK5jB,EAAE6jB,WAAa,GAAM7jB,EAAE4jB,OAAS,EAAK,GAAK,CACvE7B,IAAe,EAAN4B,EACT3B,GAAW,EACXmB,EAAQ5oB,QAMV,QAAS8iB,KACR2F,IACAG,EAAQtoB,QACRioB,IAGD,QAAStB,KACR,GAAIsC,IAAU,CAMd,OALIC,KACHD,EAAUA,GAAWC,EAAe5e,IAErC2e,EAAUA,GAAWvW,EAAQyW,YAAc,KAC3CF,EAAUA,GAAYrC,EAAYxJ,aAAeyJ,EAAYzJ,aAI9D,QAASgM,KACHzC,KACJnE,IAEDkE,IAiBD,QAASpE,KACRrjB,QAAQuB,QAAQkS,GAAS8P,IAAI,SAAU4G,GACvC5oB,EAAQgiB,IAAI,uBAAwB4F,GACpC5nB,EAAQgiB,IAAI,QAAS6G,GAGtB,QAAShB,KACRppB,QAAQuB,QAAQkS,GAASsB,GAAG,sBAAuBuU,GACnDtpB,QAAQuB,QAAQkS,GAASsB,GAAG,mBAAoByU,GAGjD,QAASN,KACRlpB,QAAQuB,QAAQkS,GAAS8P,IAAI,sBAAuB+F,GACpDtpB,QAAQuB,QAAQkS,GAAS8P,IAAI,mBAAoBiG,GAxSlD/V,EAAQ4W,YAAc,WACrB,OAAO,EAIR,IAGIxC,GAAUK,EAAUW,EAGpBd,EAAMD,EAAMyB,EAAME,EA2BlBa,EAAYO,EAAOE,EAAU3C,EAAkB6B,EAjC/CvB,EAAU,IASV5f,GACFzH,EAAG,EACHwF,EAAG,GAEJX,GACC7E,EAAG,EACHwF,EAAG,GAEJtC,GACClD,EAAG,EACHwF,EAAG,GAEJvE,GACCjB,EAAG,GACHwF,EAAG,GAEJQ,GACCgC,IAAK,EACLkN,MAAO,EACPC,OAAQ,EACRpN,KAAM,GAEP6e,EAAQ,CAIRqC,GADGlK,EAAW4K,YACD3K,EAAOD,EAAW4K,aAAa3f,GAE/B,GAAIkc,GAElB+C,EAAW9e,MACVgf,MAAO,WACNtkB,EAAEW,EAAItC,EAAEsC,EAAI,EACZ4gB,WAGuBzkB,KAArBod,EAAWyK,QACdA,EAAQxK,EAAOD,EAAWyK,MAA2B,MAA4B,QAEtD7nB,KAAxBod,EAAW2K,WACdA,EAAW1K,EAAOD,EAAW2K,SAA8B,MAA4B,QAEpD/nB,KAAhCod,EAAWgI,mBACdA,EAAmB/H,EAAOD,EAAWgI,iBAAsC,MAA4B,QAEtEplB,KAA9Bod,EAAW6J,iBACdA,EAAiB5J,EAAOD,EAAW6J,eAAoC,MAA4B,IAKpG1oB,EAAQkpB,KAAK,eAAgB,MAAM1a,SAAS,eAE5C,IAMC0Y,GANGd,EAAcpmB,EAAQ,GACtBqmB,EAAcD,EAAYZ,cAAc,YACxCla,EAAU7M,QAAQuB,QAAQsL,GAC1Bsb,EAAe,GAAIhiB,GACnBoiB,EAAY,KACfD,EAAgB,MAEjBF,GAAmB,KAElBG,EAAYvoB,QAAQuB,QAAQ,iCAC5B+mB,EAAgBC,EAAU,GAC1BE,EAAiB,GAAItiB,GACrB5E,EAAQmpB,OAAOnC,GACftgB,EAASsgB,EAAU9c,YAAYJ,GAC/Bod,EAAe9hB,UAAU,eAAiBrE,EAAEjB,EAAEmX,QAAQ,GAAK,MAAQlW,EAAEuE,EAAE2R,QAAQ,GAAK,SACpFiQ,EAAetlB,IAAImlB,GAGpB,IAAIe,GAAU,GAAIlpB,GAAQsnB,GA+JtB2C,EAAUjiB,EAAM8B,SAAS2f,EAAU,GAyBvCve,GAAM+Z,OAAO,WACZ,MAAOwC,GAAY1J,aACjB,SAAUxI,EAAUiV,GACtBR,MA0BD9e,EAAMqY,IAAI,WAAY,WACrBL,IACAgG,EAAQtoB,UAzBT,WACCf,QAAQuB,QAAQkS,GAASsB,GAAG,SAAUoV,GACtC5oB,EAAQwT,GAAG,uBAAwBoU,GACnC5nB,EAAQwT,GAAG,QAASqV,cAmCxB,WACA,YAEUpqB,SAAQC,OAAO,WAErBC,QAAQ,cAAe,WAC1B,QAASqnB,KACR,GAAI+C,IACHW,OACC5pB,EAAG,EACHwF,EAAG,GAEJqkB,KACC7pB,EAAG,EACHwF,EAAG,GAEJ+J,SACCvP,EAAG,EACHwF,EAAG,GAEJ0hB,WACClnB,EAAG,GACHwF,EAAG,GAEJohB,OACC5mB,EAAG,EACHwF,EAAG,GAEJqC,MACCG,IAAK,EACLkN,MAAO,EACPC,OAAQ,EACRpN,KAAM,GAEP+hB,WACCjP,MAAO,EACPC,OAAQ,GAETtP,SACCqP,MAAO,EACPC,OAAQ,GAGVnc,SAAQ0F,OAAOrF,KAAMiqB,GA0KtB,MAxKA/C,GAAW/mB,WACV4qB,QAAS,WACR,GAAId,GAAajqB,KACb6qB,EAAMZ,EAAWY,IACpBhiB,EAAOohB,EAAWphB,IAEnBA,GAAKE,MADS,IAEdF,EAAKqN,OAFS,IAGV2U,EAAI7pB,EAAI6H,EAAKE,KAChBkhB,EAAW3B,SACDuC,EAAI7pB,EAAIgG,EAAEkP,OACpB+T,EAAW1B,WAGbyC,QAAS,WACR,GAAIf,GAAajqB,KAChB2pB,EAAUM,EAAWN,QACrBnC,EAAWyC,EAAWzC,SACtBK,EAAWoC,EAAWpC,SACtBJ,EAAOwC,EAAWxC,KAClBC,EAAOuC,EAAWvC,KACfkD,EAAQX,EAAWW,MACtBC,EAAMZ,EAAWY,IACjBta,EAAU0Z,EAAW1Z,QAErBqX,GADYqC,EAAW/B,UACf+B,EAAWrC,OACnB/e,EAAOohB,EAAWphB,KACfiiB,EAAYb,EAAWa,UAC1Bte,EAAUyd,EAAWzd,OAClBmd,IACH9gB,EAAKE,KAAO,EACZF,EAAKqN,MAAQ4U,EAAUjP,MAAQrP,EAAQqP,MACnC2L,GACHqD,EAAI7pB,EAAI4pB,EAAM5pB,EAAIymB,EAAKzmB,EAAI0mB,EAAK1mB,EAChCipB,EAAWc,WACDnD,EAAM5mB,IAChB6pB,EAAI7pB,GAAK4mB,EAAM5mB,EACf4mB,EAAM5mB,GAAK,IACP6mB,GACHoC,EAAWc,UAERxpB,KAAKgG,IAAIqgB,EAAM5mB,GAAK,MACvB4mB,EAAM5mB,EAAI,EACV6pB,EAAI7pB,EAAI4pB,EAAM5pB,EAAIuP,EAAQvP,EAC1BipB,EAAWpC,UAAW,IAIxBgD,EAAI7pB,EAAIO,KAAKsW,IAAIhP,EAAKE,KAAM8hB,EAAI7pB,GAChC6pB,EAAI7pB,EAAIO,KAAKC,IAAIqH,EAAKqN,MAAO2U,EAAI7pB,GACjCuP,EAAQvP,IAAM6pB,EAAI7pB,EAAIuP,EAAQvP,GAAK,GAEnCuP,EAAQvP,EAAI6pB,EAAI7pB,EAAI,GAGtBiqB,UAAW,SAAUjqB,GACpB,GAAIipB,GAAajqB,IACjBiqB,GAAWW,MAAM5pB,EAAIipB,EAAWY,IAAI7pB,EAAI,EACxCU,WAAW,WACVuoB,EAAWtB,SACXsB,EAAWzB,MAAO,GAChB,MAEJF,OAAQ,SAAUtd,GACjB,GAAIif,GAAajqB,IACbiqB,GAAWzB,MAGVyB,EAAWxB,SAGhBwB,EAAWzB,MAAO,EAClByB,EAAWxB,OAAOzd,GAAO2F,OAAO+X,QAAQ,WACvCuB,EAAWgB,UAAU,OAGvB1C,QAAS,SAAUvd,GAClB,GAAIif,GAAajqB,IACbiqB,GAAWzB,MAGVyB,EAAWrB,UAGhBqB,EAAWzB,MAAO,EAClByB,EAAWrB,QAAQ5d,GAAO2F,OAAO+X,QAAQ,WAC5B1d,EAAM8f,UAAUjP,MAAQ7Q,EAAMwB,QAAQqP,MACtChT,KAAKqN,MAChB0U,MAAM5pB,EAAI6pB,IAAI7pB,EAAI6H,KAAKqN,MAEvB0U,MAAM5pB,EAAI6pB,IAAI7pB,EAAI6H,KAAKqN,MAAQmS,QAEhC4B,EAAWgB,UAAU,OAGvBtC,OAAQ,WACP,GAAIsB,GAAajqB,IACjBiqB,GAAWzC,UAAW,EACtByC,EAAWpC,UAAW,EACtBoC,EAAWxC,KAAO,KAClBwC,EAAWvC,KAAO,MAEnBoB,OAAQ,SAAUpB,GACjB,GAAIuC,GAAajqB,KAChB4qB,EAAQX,EAAWW,MACnBC,EAAMZ,EAAWY,IACjBta,EAAU0Z,EAAW1Z,QACrBqX,EAAQqC,EAAWrC,KACpBgD,GAAM5pB,EAAI6pB,EAAI7pB,EAAIuP,EAAQvP,EAC1B4mB,EAAM5mB,EAAI,EACVipB,EAAWvC,KAAOA,EAClBuC,EAAWpC,UAAW,GAEvBoB,OAAQ,SAAUxB,GACjB,GAAIwC,GAAajqB,IACjBiqB,GAAWf,KAAOe,EAAWxC,KAC7BwC,EAAWxC,KAAOA,EAClBwC,EAAWzC,UAAW,GAEvB2B,KAAM,WACL,GAAIc,GAAajqB,KAIhBynB,GAHUwC,EAAWN,QACVM,EAAWzC,SACXyC,EAAWpC,SACfoC,EAAWxC,MAEfmD,GADIX,EAAWvC,KACPuC,EAAWW,OACtBC,EAAMZ,EAAWY,IACjBta,EAAU0Z,EAAW1Z,QAErBqX,GADYqC,EAAW/B,UACf+B,EAAWrC,MACZqC,GAAWphB,KACHohB,EAAWa,UAChBb,EAAWzd,QAClBib,GAAQyB,OACXtB,EAAM5mB,GAAyB,GAAnBymB,EAAKzmB,EAAIkoB,KAAKloB,IAE3B4pB,EAAM5pB,EAAI6pB,EAAI7pB,EAAIuP,EAAQvP,EAC1BipB,EAAWzC,UAAW,EACtByC,EAAWxC,KAAO,KAClBwC,EAAWvC,KAAO,KAClBuC,EAAWf,KAAO,MAEnBG,kBAAmB,WAClB,GAAIY,GAAajqB,KACb8qB,EAAYb,EAAWa,UAC1Bte,EAAUyd,EAAWzd,QAClB8c,GAAa9c,EAAQqP,MAAQiP,EAAUjP,OAAS,EAEpD,OADAyN,GAAY/nB,KAAKsW,IAAI,GAAItW,KAAKC,IAAI,IAAK8nB,KAGxCS,QAAS,SAAUlkB,GAClB,GAAIokB,GAAajqB,KAChB4nB,EAAQqC,EAAWrC,KACpB,KAAKqC,EAAWzB,MAAQyB,EAAWN,QAAS,CACtC9jB,IAAGA,EAAIuN,QAAQjL,OACpBtC,EAAIA,EAAEuC,cAAgBvC,EAAEuC,cAAgBvC,CACxC,IAAI2jB,GAAS3jB,EAAE4jB,OAAS,GAAK5jB,EAAE6jB,WAAa,GAAM7jB,EAAE4jB,OAAS,EAAK,GAAK,CAIvE,OAHA7B,GAAM5mB,GAAKwoB,EAAMS,EAAWZ,oBAC5BY,EAAWpC,UAAW,GAEf,IAGT1c,KAAM,SAAU+f,GACfvrB,QAAQ0F,OAAOrF,KAAMkrB,KAGhBhE,QAOR,WACA,YAEUvnB,SAAQC,OAAO,WAErBC,QAAQ,UAAW,WAEtB,QAASsrB,GAAMtlB,EAAG3E,GACjB,GAAIkqB,GAAgB5lB,SAAS6lB,iBAAmB7lB,SAASgE,KAAK8hB,YAAc9lB,SAASgE,KACjF+hB,GACHvqB,EAAGR,OAAOgrB,aAAeJ,EAAaK,WACtCjlB,EAAGhG,OAAOkrB,aAAeN,EAAaO,UAEvC,IAAe,WAAX9lB,EAAEoC,KAAmB,CACxB,GAAIoI,IACHoF,EAAGzV,KAAK4rB,WACRlW,EAAG1V,KAAK6rB,YAET7rB,MAAKqQ,KAAOA,EAEb,GAAI1H,GAAOmjB,EAAQ5qB,GACf0U,GACH5U,EAAG2H,EAAKojB,WACRvlB,EAAGmC,EAAKqjB,WAELnjB,EAAOF,EAAKG,wBACZmjB,EAAOjsB,KAAKksB,QAAQrmB,EACxB,IAAIomB,EAAM,CACT,GAAIE,IACHnrB,EAAGirB,EAAKjrB,EAAIuqB,EAAOvqB,EAAI6H,EAAKE,KAC5BvC,EAAGylB,EAAKzlB,EAAI+kB,EAAO/kB,EAAIqC,EAAKG,KAEzBojB,GACHprB,EAAGirB,EAAKjrB,EAAIuqB,EAAOvqB,EACnBwF,EAAGylB,EAAKzlB,EAAI+kB,EAAO/kB,EAEpBxG,MAAKmsB,SAAWA,EAChBnsB,KAAKosB,SAAWA,EAEC,WAAdpsB,KAAKiI,MACRuI,QAAQC,IAAIzQ,KAAKiI,MAElBjI,KAAKoI,cAAgBvC,EACrB7F,KAAKkB,QAAUA,EACflB,KAAK2I,KAAOA,EACZ3I,KAAK4V,OAASA,EACd5V,KAAK6I,KAAOA,EAUb,QAAS+iB,KACR,MAAIS,MAAKxC,WACDwC,KAAKxC,WAETrkB,SAAS6lB,iBAAmB7lB,SAAS6lB,gBAAgBiB,YACjD9mB,SAAS6lB,gBAAgBiB,YAE7B9mB,SAASgE,KACLhE,SAASgE,KAAK8iB,gBADtB,GAKD,QAAST,KACR,MAAIQ,MAAKE,YACDF,KAAKE,YAET/mB,SAAS6lB,iBAAmB7lB,SAAS6lB,gBAAgBmB,aACjDhnB,SAAS6lB,gBAAgBmB,aAE7BhnB,SAASgE,KACLhE,SAASgE,KAAKgjB,iBADtB,GAKD,QAASN,GAAQrmB,GAChB,GAAI4mB,IAAkB,QAAS,YAAa,UAAW,YAAa,YAAa,WAAY,aAAc,aAAc,eACrHC,GAAe,aAAc,YAAa,WAAY,eACtDT,EAAO,IACX,KAAqC,IAAjCS,EAAYnpB,QAAQsC,EAAEoC,MAAc,CACvC,GAAIzD,GAAI,KACJ2D,EAAQtC,EAAEuC,cAAgBvC,EAAEuC,cAAgBvC,EAC5CwC,EAAUF,EAAME,QAAQpH,OAASkH,EAAME,QAAUF,EAAMG,cACvDD,IAAWA,EAAQpH,SACtBuD,EAAI6D,EAAQ,IAET7D,IACHynB,GACCjrB,EAAGwD,EAAE+D,MACL/B,EAAGhC,EAAEgE,aAGuC,IAApCikB,EAAelpB,QAAQsC,EAAEoC,QACnCgkB,GACCjrB,EAAG6E,EAAE0C,MACL/B,EAAGX,EAAE2C,OAIP,OADAxI,MAAKiI,KAAOpC,EAAEoC,KACPgkB,EAGR,QAAS9E,GAAOjmB,GA0Cf,QAASqlB,GAAQ1gB,GAEhB,GAAIsC,GAAQ,GAAIgjB,GAAMtlB,EAAG8mB,EAAOzrB,QAChCyrB,GAAOja,UAAUka,MAAMriB,MAAMvK,MAAOmI,IAGrC,QAASme,GAAYzgB,GAEpB,GAAIsC,GAAQ,GAAIgjB,GAAMtlB,EAAG8mB,EAAOzrB,QAChCyrB,GAAOja,UAAUgV,KAAKnd,MAAMvK,MAAOmI,IACnCwkB,EAAOE,oBAGR,QAASC,GAAYjnB,GAEpB,GAAIsC,GAAQ,GAAIgjB,GAAMtlB,EAAG8mB,EAAOzrB,QAChCyrB,GAAOja,UAAU+U,KAAKld,MAAMvK,MAAOmI,IAGpC,QAAS4kB,GAAUlnB,GAElB,GAAIsC,GAAQ,GAAIgjB,GAAMtlB,EAAG8mB,EAAOzrB,QAChCyrB,GAAOja,UAAU0W,GAAG7e,MAAMvK,MAAOmI,IAGlC,QAAS2hB,GAASjkB,GACjB2K,QAAQC,IAAI,WAAY5K,EACxB,IAAIsC,GAAQ,GAAIgjB,GAAMtlB,EAAG8mB,EAAOzrB,QAChCyrB,GAAOja,UAAUwL,OAAO3T,MAAMvK,MAAOmI,IAGtC,QAASie,GAAavgB,GAErB,GAAIsC,GAAQ,GAAIgjB,GAAMtlB,EAAG8mB,EAAOzrB,QAChCyrB,GAAOja,UAAUgV,KAAKnd,MAAMvK,MAAOmI,IACnCwkB,EAAOK,uBAGR,QAASC,GAAYpnB,GAEpB,GAAIsC,GAAQ,GAAIgjB,GAAMtlB,EAAG8mB,EAAOzrB,QAChCyrB,GAAOja,UAAU+U,KAAKld,MAAMvK,MAAOmI,IAGpC,QAAS+kB,GAAWrnB,GAEnB,GAAIsC,GAAQ,GAAIgjB,GAAMtlB,EAAG8mB,EAAOzrB,QAChCyrB,GAAOja,UAAU0W,GAAG7e,MAAMvK,MAAOmI,IAxFlCnI,KAAKkB,QAAUA,EACflB,KAAK0S,aACL1S,KAAKysB,gBACJG,OACC3sB,IAAK,QACLF,SAAUwmB,GAEXmB,MACCznB,IAAK,YACLF,SAAUumB,GAEXmB,MACCxnB,IAAK,YACLF,SAAU+sB,GAEX1D,IACCnpB,IAAK,UACLF,SAAUgtB,GAEX7O,QACCje,IAAK,SACLF,SAAU+pB,IAGZ9pB,KAAK0sB,aACJhF,MACCznB,IAAK,aACLF,SAAUqmB,GAEXqB,MACCxnB,IAAK,YACLF,SAAUktB,GAEX7D,IACCnpB,IAAK,WACLF,SAAUmtB,GAIZ,IAAIP,GAAS3sB,KA4Dd,QAAS8rB,GAAQ5qB,GAChB,MAAOA,GAAQD,OAASC,EAAQ,GAAKA,EAGtC,QAASisB,GAAWjsB,GACnB,MAAOA,GAAQD,OAASC,EAAUvB,QAAQuB,QAAQA,GAGnD,QAAS8B,GAAI0P,EAAW1H,GACvB,GAAI2hB,GAAS3sB,KACZotB,EAAWptB,KAAKysB,eAChBvkB,EAAQlI,KAAK0sB,YACVxrB,EAAUisB,EAAWntB,KAAKkB,SAC7BmsB,EAAgB1tB,QAAQuB,QAAQV,OA2BjC,OAzBAb,SAAQ+E,QAAQgO,EAAW,SAAU3S,EAAUE,GAC9C,GAAI0sB,EAAOja,UAAUzS,GAAM,CAC1B,GAAI6S,KACJA,GAAS7S,GAAO0sB,EAAOja,UAAUzS,GACjCmD,EAAO0P,GAER6Z,EAAOja,UAAUzS,GAAOF,EACpBqtB,EAASntB,KACA,WAARA,EACHotB,EAAc3Y,GAAG0Y,EAASntB,GAAKA,IAAKmtB,EAASntB,GAAKF,UAElDmB,EAAQwT,GAAG0Y,EAASntB,GAAKA,IAAKmtB,EAASntB,GAAKF,WAG1CmI,EAAMjI,IACTiB,EAAQwT,GAAGxM,EAAMjI,GAAKA,IAAKiI,EAAMjI,GAAKF,YAIpCiL,GACHA,EAAMqY,IAAI,WAAY,WACrBsJ,EAAOvpB,OAAOsP,KAITia,EAGR,QAASvpB,GAAOsP,GACf,GAAIia,GAAS3sB,KACZotB,EAAWptB,KAAKysB,eAChBvkB,EAAQlI,KAAK0sB,YACVxrB,EAAUisB,EAAWntB,KAAKkB,SAC7BmsB,EAAgB1tB,QAAQuB,QAAQV,OAcjC,OAbAb,SAAQ+E,QAAQgO,EAAW,SAAU3S,EAAUE,GAC1CmtB,EAASntB,KACA,WAARA,EACHotB,EAAcnK,IAAIkK,EAASntB,GAAKA,IAAKmtB,EAASntB,GAAKF,UAEnDmB,EAAQgiB,IAAIkK,EAASntB,GAAKA,IAAKmtB,EAASntB,GAAKF,WAG3CmI,EAAMjI,IACTiB,EAAQgiB,IAAIhb,EAAMjI,GAAKA,IAAKiI,EAAMjI,GAAKF,UAExC4sB,EAAOja,UAAUzS,GAAO,OAElB0sB,EAGR,QAASK,KACR,GAAIL,GAAS3sB,KACZotB,EAAWT,EAAOF,eAEfvrB,GADKyrB,EAAOD,YACFS,EAAWR,EAAOzrB,SAChCA,GAAQgiB,IAAI,YAAakK,EAAS1F,KAAK3nB,UACvCmB,EAAQgiB,IAAI,YAAakK,EAAS3F,KAAK1nB,UACvCmB,EAAQgiB,IAAI,UAAWkK,EAAShE,GAAGrpB,UAGpC,QAAS8sB,KACR,GAAIF,GAAS3sB,KAEZkI,GADWykB,EAAOF,eACVE,EAAOD,aACZxrB,EAAUisB,EAAWR,EAAOzrB,QAChCA,GAAQgiB,IAAI,aAAchb,EAAMwf,KAAK3nB,UACrCmB,EAAQgiB,IAAI,YAAahb,EAAMuf,KAAK1nB,UACpCmB,EAAQgiB,IAAI,WAAYhb,EAAMkhB,GAAGrpB,UApFlC,MA3JAorB,GAAMhrB,WACL+rB,QAASA,EACTN,SAAUA,EACVC,UAAWA,GAkJZ1E,EAAOhnB,WACN6C,IAAKA,EACLI,OAAQA,EACR4pB,qBAAsBA,EACtBH,kBAAmBA,GAEb1F,QA4FR,WACG,YAMA,SAASmG,GAAInG,GAOT,QAAShc,GAAKH,EAAO9J,EAAS6e,EAAY7L,GAYtC,QAAS4U,GAAOjjB,GACZ3E,EAAQqsB,YAAY,uBACfrsB,EAAQ2c,YAEblV,EAAKjD,MAAMqD,KAAOlD,EAAEsmB,SAASnrB,EAAI,KACjC2H,EAAKjD,MAAMsD,IAAMnD,EAAEsmB,SAAS3lB,EAAI,KAChC9E,WAAW,WACPR,EAAQwO,SAAS,uBACjBhO,WAAW,WACPR,EAAQqsB,YAAY,wBACrB,MACJ,IAtBP,IAAIxN,EAAWyN,SAGS,MAApBzN,EAAWlT,MAAiBkT,EAAW0N,QAAW1N,EAAW2N,SAAjE,CAIAxsB,EAAQwO,SAAS,kBACjB,IAAI/G,GAAOnD,SAASC,cAAc,cAClCvE,GAAQ,GAAGiN,YAAYxF,EAiBvB,IAAI+J,IACAgV,KAAMoB,EAEG,IAAI3B,GAAOjmB,GAAS8B,IAAI0P,EAAW1H,IApCpD,OACI2U,SAAU,IACVsE,SAAU,EACV9Y,KAAMA,GARd,GAAIzE,GAAM/G,QAAQC,OAAO,UA4CzB8G,GAAIgZ,UAAU,QAAS,SAAU4N,IACjC5mB,EAAIgZ,UAAU,WAAY,SAAU4N,OAKvC,WACG,YAEU3tB,SAAQC,OAAO,WAErBC,QAAQ,SAAU,WAAY,SAASqR,GAGvC,QAASyc,KACL3tB,KAAK4tB,UACL5tB,KAAK6tB,SAAU,EACf7tB,KAAK8tB,OAsHT,MAnHAH,GAAMxtB,WACF2tB,KAAM,WACF,GAAIvI,GAAQvlB,IACZulB,GAAMwI,QAAS,EACfxI,EAAMyI,SAAU,EAChBzI,EAAM0I,YAAa,EACnB1I,EAAM2I,WAAY,EAClB3I,EAAM4I,cAAe,EACrB5I,EAAM6I,OAAS,KACf7I,EAAMqI,WAEVpF,KAAM,WACF,GAAIjD,GAAQvlB,IACZ,QAAKulB,EAAMwI,SACPxI,EAAMwI,QAAS,EACfxI,EAAMyI,SAAU,EAChBzI,EAAM0I,YAAa,EACnB1I,EAAM2I,WAAY,EAClB3I,EAAM4I,cAAe,EACrB5I,EAAMqI,WACC,IAKf9c,MAAO,SAAeA,GAClBN,QAAQC,IAAI,cAAeK,EAC3B,IAAIyU,GAAQvlB,IACZulB,GAAMwI,QAAS,EACfxI,EAAMyI,SAAU,EAChBzI,EAAM0I,YAAa,EACnB1I,EAAM2I,WAAY,EAClB3I,EAAM4I,cAAe,EACrB5I,EAAMqI,OAAO7qB,KAAK+N,GAClBI,EAAS,WACLqU,EAAM0I,YAAa,GA3CnB,MA8CRI,MAAO,WACH,GAAI9I,GAAQvlB,IACZulB,GAAMuI,OACNvI,EAAMsI,SAAU,GAEpBS,QAAS,WACL,GAAI/I,GAAQvlB,IACZulB,GAAMwI,QAAS,EACfxI,EAAMyI,SAAU,EAChBzI,EAAM0I,YAAa,EACnB1I,EAAM2I,WAAY,EAClB3I,EAAM4I,cAAe,EACrB5I,EAAMqI,UACN1c,EAAS,WACLqU,EAAM4I,cAAe,GA5DrB,MA+DRxE,QAAS,WACL,GAAIpE,GAAQvlB,IACZ,QAAQulB,EAAMwI,SAAWxI,EAAM0I,aAAe1I,EAAM4I,cAExDI,aAAc,WACV,GAAIhJ,GAAQvlB,IACZ,OAAOulB,GAAMyI,QAAUzI,EAAMqI,OAAOrI,EAAMqI,OAAO3sB,OAAS,GAAK,MAEnEutB,YAAa,WACT,GAAIjJ,GAAQvlB,IACZ,QACIwoB,KAAMjD,EAAMwI,OACZM,MAAO9I,EAAMsI,QACbY,WAAYlJ,EAAM4I,aAClBG,QAAS/I,EAAM2I,UACfQ,UAAWnJ,EAAM0I,WACjBnd,MAAOyU,EAAMyI,UAGrBW,OAAQ,SAAgBC,GACpB,GAAIrJ,GAAQvlB,KACR4N,GACAygB,MAAO,SACP7F,KAAM,UACN1X,MAAO,QACPwd,QAAS,UAETM,IACAjvB,QAAQ0F,OAAOuI,EAAUghB,EAE7B,IAAIlO,GAAQ9S,EAASygB,KAQrB,OAPI9I,GAAMwI,OACNrN,EAAQ9S,EAAS4a,KACVjD,EAAM2I,UACbxN,EAAQ9S,EAAS0gB,QACV/I,EAAMyI,UACbtN,EAAQ9S,EAASkD,OAEd4P,GAEXmO,QAAS,SAAiBD,GACtB,GAAIrJ,GAAQvlB,KACR6uB,EAAU,IAcd,OAbAA,IACIR,MAAO9I,EAAMsI,QACbrF,KAAMjD,EAAMwI,OACZU,WAAYlJ,EAAM4I,aAClBG,QAAS/I,EAAM2I,UACfQ,UAAWnJ,EAAM0I,WACjBnd,MAAOyU,EAAMyI,SAEbY,GACAjvB,QAAQ+E,QAAQkqB,EAAQ,SAASrsB,EAAOtC,GACpC4uB,EAAQtsB,GAASssB,EAAQ5uB,KAG1B4uB,IAIRlB","file":"artisan.min.js","sourcesContent":["/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan', ['ng', 'ngRoute', 'ngMessages']);\r\n\r\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Animate', [function () {\n\n\t\tfunction Animate(callback) {\n\t\t\tthis.callback = callback;\n\t\t\tthis.key = null;\n\t\t\tthis.ticks = 0;\n\t\t}\n\t\tAnimate.prototype = {\n\t\t\tplay: function () {\n\t\t\t\tvar _this = this;\n\n\t\t\t\tfunction loop(time) {\n\t\t\t\t\t_this.ticks++;\n\t\t\t\t\t_this.callback(time, _this.ticks);\n\t\t\t\t\t_this.key = window.requestAnimationFrame(loop);\n\t\t\t\t}\n\t\t\t\tif (!this.key) {\n\t\t\t\t\tloop();\n\t\t\t\t}\n\t\t\t},\n\t\t\tpause: function () {\n\t\t\t\tif (this.key) {\n\t\t\t\t\twindow.cancelAnimationFrame(this.key);\n\t\t\t\t\tthis.key = null;\n\t\t\t\t}\n\t\t\t},\n\t\t\tplaypause: function () {\n\t\t\t\tif (this.key) {\n\t\t\t\t\tthis.pause();\n\t\t\t\t} else {\n\t\t\t\t\tthis.play();\n\t\t\t\t}\n\t\t\t},\n\t\t\tdoNOTPlay: function () {\n\t\t\t\tthis.pause();\n\t\t\t},\n\t\t}\n\t\treturn Animate;\n    }]);\n\n\t(function () {\n\t\tvar lastTime = 0;\n\t\tvar vendors = ['ms', 'moz', 'webkit', 'o'];\n\t\tfor (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n\t\t\twindow.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\n\t\t\twindow.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] ||\n\t\t\t\twindow[vendors[x] + 'CancelRequestAnimationFrame'];\n\t\t}\n\t\tif (!window.requestAnimationFrame) {\n\t\t\twindow.requestAnimationFrame = function (callback, element) {\n\t\t\t\tvar currTime = new Date().getTime();\n\t\t\t\tvar timeToCall = Math.max(0, 16 - (currTime - lastTime));\n\t\t\t\tvar id = window.setTimeout(function () {\n\t\t\t\t\tcallback(currTime + timeToCall);\n\t\t\t\t}, timeToCall);\n\t\t\t\tlastTime = currTime + timeToCall;\n\t\t\t\treturn id;\n\t\t\t};\n\t\t}\n\t\tif (!window.cancelAnimationFrame) {\n\t\t\twindow.cancelAnimationFrame = function (id) {\n\t\t\t\tclearTimeout(id);\n\t\t\t};\n\t\t}\n\t}());\n\n}());\n\n/* global angular, app, Autolinker */\r\n(function () {\r\n\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.filter('notIn', ['$filter', function ($filter) {\r\n\t\treturn function (array, filters, element) {\r\n\t\t\tif (filters) {\r\n\t\t\t\treturn $filter(\"filter\")(array, function (item) {\r\n\t\t\t\t\tfor (var i = 0; i < filters.length; i++) {\r\n\t\t\t\t\t\tif (filters[i][element] === item[element]) return false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n    }]);\r\n\r\n}());\r\n\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('Hash', [function() {\n        var pools = {};\n\n        function Hash(key, pool) {\n            key = key || 'id';\n            pool = pool ? Hash.get(pool) : {};\n            Object.defineProperties(this, {\n                key: {\n                    value: key,\n                    enumerable: false,\n                    writable: false\n                },\n                pool: {\n                    value: pool,\n                    enumerable: false,\n                    writable: false\n                },\n                length: {\n                    value: 0,\n                    enumerable: false,\n                    writable: true\n                }\n            });\n        }\n        Hash.get = function(pool) {\n            return (pools[pool] = pools[pool] || {});\n        };\n        Hash.prototype = new Array;\n        Hash.prototype.has = has;\n        Hash.prototype.getId = getId;\n        Hash.prototype.get = get;\n        Hash.prototype.set = set;\n        Hash.prototype.add = add;\n        Hash.prototype.remove = remove;\n        Hash.prototype.each = each;\n        Hash.prototype.addMany = addMany;\n        Hash.prototype.removeMany = removeMany;\n        Hash.prototype.removeAll = removeAll;\n        Hash.prototype.forward = forward;\n        Hash.prototype.backward = backward;\n        Hash.prototype.differs = differs;\n        Hash.prototype.updatePool = updatePool;\n        return Hash;\n\n        function has(id) {\n            return this.pool[id] !== undefined;\n        }\n\n        function getId(id) {\n            return this.pool[id];\n        }\n\n        function get(item) {\n            var hash = this,\n                key = this.key;\n            return item ? hash.getId(item[key]) : null;\n        }\n\n        function set(item) {\n            var hash = this,\n                pool = this.pool,\n                key = this.key;\n            pool[item[key]] = item;\n            hash.push(item);\n            return item;\n        }\n\n        function add(newItem) {\n            var hash = this;\n            var item = hash.get(newItem);\n            if (item) {\n                for (var i = 0, keys = Object.keys(newItem), p; i < keys.length; i++) {\n                    p = keys[i];\n                    item[p] = newItem[p];\n                }\n            } else {\n                item = hash.set(newItem);\n            }\n            return item;\n        }\n\n        function remove(oldItem) {\n            var hash = this,\n                pool = this.pool,\n                key = this.key;\n            var item = hash.get(oldItem);\n            if (item) {\n                var index = hash.indexOf(item);\n                if (index !== -1) {\n                    hash.splice(index, 1);\n                }\n                delete pool[item[key]];\n            }\n            return hash;\n        }\n\n        function addMany(items) {\n            var hash = this;\n            if (!items) {\n                return hash;\n            }\n            var i = 0;\n            while (i < items.length) {\n                hash.add(items[i]);\n                i++;\n            }\n            return hash;\n        }\n\n        function removeMany(items) {\n            var hash = this;\n            if (!items) {\n                return hash;\n            }\n            var i = 0;\n            while (i < items.length) {\n                hash.remove(items[i]);\n                i++;\n            }\n            return hash;\n        }\n\n        function removeAll() {\n            var hash = this,\n                key = hash.key,\n                pool = hash.pool;\n            var i = 0,\n                t = hash.length,\n                item;\n            while (hash.length) {\n                item = hash.shift();\n                delete pool[item[key]];\n                i++;\n            }\n            return hash;\n        }\n\n        function each(callback) {\n            var hash = this;\n            if (callback) {\n                var i = 0;\n                while (i < hash.length) {\n                    callback(hash[i], i);\n                    i++;\n                }\n            }\n            return hash;\n        }\n\n        function forward(key, reverse) {\n            var hash = this;\n            key = (key || this.key);\n            hash.sort(function(c, d) {\n                var a = reverse ? d : c;\n                var b = reverse ? c : d;\n                return a[key] - b[key];\n            });\n            return hash;\n        }\n\n        function backward(key) {\n            return this.forward(key, true);\n        }\n\n        function differs(hash) {\n            if (hash.key !== this.key || hash.length !== this.length) {\n                return true;\n            } else {\n                var differs = false,\n                    i = 0,\n                    t = this.length,\n                    key = this.key;\n                while (differs && i < t) {\n                    differs = this[i][key] !== hash[i][key];\n                    i++;\n                }\n            }\n        }\n\n        function updatePool() {\n            var hash = this,\n                pool = this.pool,\n                key = this.key;\n            Object.keys(pool).forEach(function(key) {\n                delete pool[key];\n            });\n            angular.forEach(hash, function(item) {\n                pool[item[key]] = item;\n            });\n        }\n\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('$promise', ['$q', function($q) {\n        function $promise(callback) {\n            if (typeof callback !== 'function') {\n                throw ('promise resolve callback missing');\n            }\n            var deferred = $q.defer();\n            callback(deferred);\n            return deferred.promise;\n        }\n        var statics = {\n            all: function(promises) {\n                return $q.all(promises);\n            },\n        };\n        angular.extend($promise, statics);\n        return $promise;\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar transformProperty = detectTransformProperty();\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Style', [function () {\n\t\tfunction Style() {\n\t\t\tthis.props = {\n\t\t\t\tscale: 1,\n\t\t\t\thoverScale: 1,\n\t\t\t\tcurrentScale: 1,\n\t\t\t};\n\t\t}\n\n\t\tStyle.prototype = {\n\t\t\tset: function (element) {\n\t\t\t\tvar styles = [];\n\t\t\t\tfor (var key in this) {\n\t\t\t\t\tif (key !== 'props') {\n\t\t\t\t\t\tstyles.push(key + ':' + this[key]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telement.style.cssText = styles.join(';') + ';';\n\t\t\t},\n\t\t\ttransform: function (transform) {\n\t\t\t\tthis[transformProperty] = transform;\n\t\t\t},\n\t\t\ttransformOrigin: function (x, y) {\n\t\t\t\tthis[transformProperty + '-origin-x'] = (Math.round(x * 1000) / 1000) + '%';\n\t\t\t\tthis[transformProperty + '-origin-y'] = (Math.round(y * 1000) / 1000) + '%';\n\t\t\t},\n\t\t};\n\n\t\treturn Style;\n    }]);\n\n\tfunction detectTransformProperty() {\n\t\tvar transformProperty = 'transform',\n\t\t\tsafariPropertyHack = 'webkitTransform';\n\t\tvar div = document.createElement(\"DIV\");\n\t\tif (typeof div.style[transformProperty] !== 'undefined') {\n            ['webkit', 'moz', 'o', 'ms'].every(function (prefix) {\n\t\t\t\tvar e = '-' + prefix + '-transform';\n\t\t\t\tif (typeof div.style[e] !== 'undefined') {\n\t\t\t\t\ttransformProperty = e;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t} else if (typeof div.style[safariPropertyHack] !== 'undefined') {\n\t\t\ttransformProperty = '-webkit-transform';\n\t\t} else {\n\t\t\ttransformProperty = undefined;\n\t\t}\n\t\treturn transformProperty;\n\t}\n\n}());\n\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Vector', function () {\n\t\tfunction Vector(x, y) {\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\t\t}\n\t\tVector.make = function (a, b) {\n\t\t\treturn new Vector(b.x - a.x, b.y - a.y);\n\t\t};\n\t\tVector.size = function (a) {\n\t\t\treturn Math.sqrt(a.x * a.x + a.y * a.y);\n\t\t};\n\t\tVector.normalize = function (a) {\n\t\t\tvar l = Vector.size(a);\n\t\t\ta.x /= l;\n\t\t\ta.y /= l;\n\t\t\treturn a;\n\t\t};\n\t\tVector.incidence = function (a, b) {\n\t\t\tvar angle = Math.atan2(b.y, b.x) - Math.atan2(a.y, a.x);\n\t\t\t// if (angle < 0) angle += 2 * Math.PI;\n\t\t\t// angle = Math.min(angle, (Math.PI * 2 - angle));\n\t\t\treturn angle;\n\t\t};\n\t\tVector.distance = function (a, b) {\n\t\t\treturn Math.sqrt((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));\n\t\t};\n\t\tVector.cross = function (a, b) {\n\t\t\treturn (a.x * b.y) - (a.y * b.x);\n\t\t};\n\t\tVector.difference = function (a, b) {\n\t\t\treturn new Vector(a.x - b.x, a.y - b.y);\n\t\t};\n\t\tVector.power = function (a, b) {\n\t\t\tvar x = Math.abs(b.x - a.x);\n\t\t\tvar y = Math.abs(b.y - a.y);\n\t\t\treturn (x + y) / 2;\n\t\t};\n\t\tVector.prototype = {\n\t\t\tsize: function () {\n\t\t\t\treturn Vector.size(this);\n\t\t\t},\n\t\t\tnormalize: function () {\n\t\t\t\treturn Vector.normalize(this);\n\t\t\t},\n\t\t\tincidence: function (b) {\n\t\t\t\treturn Vector.incidence(this, b);\n\t\t\t},\n\t\t\tcross: function (b) {\n\t\t\t\treturn Vector.cross(this, b);\n\t\t\t},\n\t\t\tdistance: function (b) {\n\t\t\t\treturn Vector.distance(this, b);\n\t\t\t},\n\t\t\tdifference: function (b) {\n\t\t\t\treturn Vector.difference(this, b);\n\t\t\t},\n\t\t\tpower: function () {\n\t\t\t\treturn (Math.abs(this.x) + Math.abs(this.y)) / 2;\n\t\t\t},\n\t\t\ttowards: function (b, friction) {\n\t\t\t\tfriction = friction || 0.125;\n\t\t\t\tthis.x += (b.x - this.x) * friction;\n\t\t\t\tthis.y += (b.y - this.y) * friction;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tadd: function (b) {\n\t\t\t\tthis.x += b.x;\n\t\t\t\tthis.y += b.y;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tfriction: function (b) {\n\t\t\t\tthis.x *= b;\n\t\t\t\tthis.y *= b;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tcopy: function (b) {\n\t\t\t\treturn new Vector(this.x, this.y);\n\t\t\t},\n\t\t\ttoString: function () {\n\t\t\t\treturn '{' + this.x + ',' + this.y + '}';\n\t\t\t},\n\t\t};\n\t\treturn Vector;\n\t});\n\n\tapp.factory('Utils', ['$compile', '$controller', 'Vector', function ($compile, $controller, Vector) {\n\n\t\t(function () {\n\t\t\t// POLYFILL Array.prototype.reduce\n\t\t\t// Production steps of ECMA-262, Edition 5, 15.4.4.21\n\t\t\t// Reference: http://es5.github.io/#x15.4.4.21\n\t\t\t// https://tc39.github.io/ecma262/#sec-array.prototype.reduce\n\t\t\tif (!Array.prototype.reduce) {\n\t\t\t\tObject.defineProperty(Array.prototype, 'reduce', {\n\t\t\t\t\tvalue: function (callback) { // , initialvalue\n\t\t\t\t\t\tif (this === null) {\n\t\t\t\t\t\t\tthrow new TypeError('Array.prototype.reduce called on null or undefined');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (typeof callback !== 'function') {\n\t\t\t\t\t\t\tthrow new TypeError(callback + ' is not a function');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar o = Object(this);\n\t\t\t\t\t\tvar len = o.length >>> 0;\n\t\t\t\t\t\tvar k = 0;\n\t\t\t\t\t\tvar value;\n\t\t\t\t\t\tif (arguments.length == 2) {\n\t\t\t\t\t\t\tvalue = arguments[1];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twhile (k < len && !(k in o)) {\n\t\t\t\t\t\t\t\tk++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (k >= len) {\n\t\t\t\t\t\t\t\tthrow new TypeError('Reduce of empty array with no initial value');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvalue = o[k++];\n\t\t\t\t\t\t}\n\t\t\t\t\t\twhile (k < len) {\n\t\t\t\t\t\t\tif (k in o) {\n\t\t\t\t\t\t\t\tvalue = callback(value, o[k], k, o);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tk++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}());\n\t\tvar _isTouch;\n\t\tvar getNow = Date.now || function () {\n\t\t\treturn new Date().getTime();\n\t\t};\n\t\tvar ua = window.navigator.userAgent.toLowerCase();\n\t\tvar safari = ua.indexOf('safari') !== -1 && ua.indexOf('chrome') === -1;\n\t\tvar msie = ua.indexOf('trident') !== -1 || ua.indexOf('edge') !== -1 || ua.indexOf('msie') !== -1;\n\t\tvar chrome = !safari && !msie && ua.indexOf('chrome') !== -1;\n\t\tvar mobile = ua.indexOf('mobile') !== -1;\n\t\tvar isChrome = navigator.userAgent.toLowerCase().indexOf('chrome') > -1;\n\t\tvar isSafari = navigator.userAgent.toLowerCase().indexOf('safari') > -1;\n\n\t\tfunction Utils() {}\n\t\tUtils.reverseSortOn = reverseSortOn;\n\t\tUtils.getTouch = getTouch;\n\t\tUtils.getRelativeTouch = getRelativeTouch;\n\t\tUtils.getClosest = getClosest;\n\t\tUtils.getClosestElement = getClosestElement;\n\t\tUtils.throttle = throttle;\n\t\tUtils.where = where;\n\t\tUtils.format = format;\n\t\tUtils.compileController = compileController;\n\t\tUtils.reducer = reducer;\n\t\tUtils.reducerSetter = reducerSetter;\n\t\tUtils.reducerAdder = reducerAdder;\n\t\tUtils.downloadFile = downloadFile;\n\t\tUtils.serverDownload = serverDownload;\n\t\tUtils.toMd5 = function (string) {\n\t\t\treturn Md5.encode(string);\n\t\t};\n\t\tUtils.ua = {\n\t\t\tsafari: safari,\n\t\t\tmsie: msie,\n\t\t\tchrome: chrome,\n\t\t\tmobile: mobile,\n\t\t};\n\t\tangular.forEach(Utils.ua, function (value, key) {\n\t\t\tif (value) {\n\t\t\t\tangular.element(document.getElementsByTagName('body')).addClass(key);\n\t\t\t}\n\t\t});\n\t\treturn Utils;\n\n\t\tfunction isTouch() {\n\t\t\tif (!_isTouch) {\n\t\t\t\t_isTouch = {\n\t\t\t\t\tvalue: ('ontouchstart' in window || 'onmsgesturechange' in window)\n\t\t\t\t};\n\t\t\t}\n\t\t\t// console.log(_isTouch);\n\t\t\treturn _isTouch.value;\n\t\t}\n\n\t\tfunction getTouch(e, previous) {\n\t\t\tvar t = new Vector();\n\t\t\tif (e.type === 'touchstart' || e.type === 'touchmove' || e.type === 'touchend' || e.type === 'touchcancel') {\n\t\t\t\tvar touch = null;\n\t\t\t\tvar event = e.originalEvent ? e.originalEvent : e;\n\t\t\t\tvar touches = event.touches.length ? event.touches : event.changedTouches;\n\t\t\t\tif (touches && touches.length) {\n\t\t\t\t\ttouch = touches[0];\n\t\t\t\t}\n\t\t\t\tif (touch) {\n\t\t\t\t\tt.x = touch.pageX;\n\t\t\t\t\tt.y = touch.pageY;\n\t\t\t\t}\n\t\t\t} else if (e.type === 'click' || e.type === 'mousedown' || e.type === 'mouseup' || e.type === 'mousemove' || e.type === 'mouseover' || e.type === 'mouseout' || e.type === 'mouseenter' || e.type === 'mouseleave' || e.type === 'contextmenu') {\n\t\t\t\tt.x = e.pageX;\n\t\t\t\tt.y = e.pageY;\n\t\t\t}\n\t\t\tif (previous) {\n\t\t\t\tt.s = Vector.difference(t, previous);\n\t\t\t}\n\t\t\tt.type = e.type;\n\t\t\treturn t;\n\t\t}\n\n\t\tfunction getRelativeTouch(node, point) {\n\t\t\tvar element = angular.element(node); // passing through jqlite for accepting both\n\t\t\tnode = element[0];\n\t\t\tvar rect = node.getBoundingClientRect();\n\t\t\t// var e = new Vector(rect.left + node.scrollLeft, rect.top + node.scrollTop);\n\t\t\tvar e = new Vector(rect.left, rect.top);\n\t\t\treturn Vector.difference(point, e);\n\t\t}\n\n\t\tfunction getClosest(el, selector) {\n\t\t\tvar matchesFn, parent;\n            ['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector', 'oMatchesSelector'].some(function (fn) {\n\t\t\t\tif (typeof document.body[fn] == 'function') {\n\t\t\t\t\tmatchesFn = fn;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t\tif (el[matchesFn](selector)) {\n\t\t\t\treturn el;\n\t\t\t}\n\t\t\twhile (el !== null) {\n\t\t\t\tparent = el.parentElement;\n\t\t\t\tif (parent !== null && parent[matchesFn](selector)) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tel = parent;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tfunction getClosestElement(el, target) {\n\t\t\tvar matchesFn, parent;\n\t\t\tif (el === target) {\n\t\t\t\treturn el;\n\t\t\t}\n\t\t\twhile (el !== null) {\n\t\t\t\tparent = el.parentElement;\n\t\t\t\tif (parent !== null && parent === target) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tel = parent;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tfunction throttle(func, wait, options) {\n\t\t\t// Returns a function, that, when invoked, will only be triggered at most once\n\t\t\t// during a given window of time. Normally, the throttled function will run\n\t\t\t// as much as it can, without ever going more than once per `wait` duration;\n\t\t\t// but if you'd like to disable the execution on the leading edge, pass\n\t\t\t// `{leading: false}`. To disable execution on the trailing edge, ditto.\n\t\t\tvar context, args, result;\n\t\t\tvar timeout = null;\n\t\t\tvar previous = 0;\n\t\t\tif (!options) options = {};\n\t\t\tvar later = function () {\n\t\t\t\tprevious = options.leading === false ? 0 : getNow();\n\t\t\t\ttimeout = null;\n\t\t\t\tresult = func.apply(context, args);\n\t\t\t\tif (!timeout) context = args = null;\n\t\t\t};\n\t\t\treturn function () {\n\t\t\t\tvar now = getNow();\n\t\t\t\tif (!previous && options.leading === false) previous = now;\n\t\t\t\tvar remaining = wait - (now - previous);\n\t\t\t\tcontext = this;\n\t\t\t\targs = arguments;\n\t\t\t\tif (remaining <= 0 || remaining > wait) {\n\t\t\t\t\tif (timeout) {\n\t\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\t\ttimeout = null;\n\t\t\t\t\t}\n\t\t\t\t\tprevious = now;\n\t\t\t\t\tresult = func.apply(context, args);\n\t\t\t\t\tif (!timeout) context = args = null;\n\t\t\t\t} else if (!timeout && options.trailing !== false) {\n\t\t\t\t\ttimeout = setTimeout(later, remaining);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t};\n\t\t}\n\n\t\tfunction where(array, query) {\n\t\t\tvar found = null;\n\t\t\tif (array) {\n\t\t\t\tangular.forEach(array, function (item) {\n\t\t\t\t\tvar has = true;\n\t\t\t\t\tangular.forEach(query, function (value, key) {\n\t\t\t\t\t\thas = has && item[key] === value;\n\t\t\t\t\t});\n\t\t\t\t\tif (has) {\n\t\t\t\t\t\tfound = item;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn found;\n\t\t}\n\n\t\tfunction compileController(scope, element, html, data) {\n\t\t\t// console.log('Utils.compileController', element);\n\t\t\telement.html(html);\n\t\t\tvar link = $compile(element.contents());\n\t\t\tif (data.controller) {\n\t\t\t\tvar $scope = scope.$new();\n\t\t\t\tangular.extend($scope, data);\n\t\t\t\tvar controller = $controller(data.controller, {\n\t\t\t\t\t$scope: $scope\n\t\t\t\t});\n\t\t\t\tif (data.controllerAs) {\n\t\t\t\t\tscope[data.controllerAs] = controller;\n\t\t\t\t}\n\t\t\t\telement.data('$ngControllerController', controller);\n\t\t\t\telement.children().data('$ngControllerController', controller);\n\t\t\t\tscope = $scope;\n\t\t\t}\n\t\t\tlink(scope);\n\t\t}\n\n\t\tfunction reverseSortOn(key) {\n\t\t\treturn function (a, b) {\n\t\t\t\tif (a[key] < b[key]) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\tif (a[key] > b[key]) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\t// a must be equal to b\n\t\t\t\treturn 0;\n\t\t\t};\n\t\t}\n\n\t\tfunction format(string, prepend, expression) {\n\t\t\tstring = string || '';\n\t\t\tprepend = prepend || '';\n\t\t\tvar splitted = string.split(',');\n\t\t\tif (splitted.length > 1) {\n\t\t\t\tvar formatted = splitted.shift();\n\t\t\t\tangular.forEach(splitted, function (value, index) {\n\t\t\t\t\tif (expression) {\n\t\t\t\t\t\tformatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tformatted = formatted.split('{' + index + '}').join(prepend + value);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (expression) {\n\t\t\t\t\treturn '\\'' + formatted + '\\'';\n\t\t\t\t} else {\n\t\t\t\t\treturn formatted;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn prepend + string;\n\t\t\t}\n\t\t}\n\n\t\tfunction reducer(o, key) {\n\t\t\treturn o[key];\n\t\t}\n\n\t\tfunction reducerSetter(o, key, value) {\n\t\t\tif (typeof key == 'string') {\n\t\t\t\treturn reducerSetter(o, key.split('.'), value);\n\t\t\t} else if (key.length == 1 && value !== undefined) {\n\t\t\t\treturn (o[key[0]] = value);\n\t\t\t} else if (key.length === 0) {\n\t\t\t\treturn o;\n\t\t\t} else {\n\t\t\t\treturn reducerSetter(o[key[0]], key.slice(1), value);\n\t\t\t}\n\t\t}\n\n\t\tfunction reducerAdder(o, key, value) {\n\t\t\tif (typeof key == 'string') {\n\t\t\t\treturn reducerAdder(o, key.split('.'), value);\n\t\t\t} else if (key.length == 1 && value !== undefined) {\n\t\t\t\treturn (o[key[0]] += value);\n\t\t\t} else if (key.length === 0) {\n\t\t\t\treturn o;\n\t\t\t} else {\n\t\t\t\treturn reducerAdder(o[key[0]], key.slice(1), value);\n\t\t\t}\n\t\t}\n\n\t\tfunction downloadFile(content, name, type) {\n\t\t\ttype = type || 'application/octet-stream';\n\t\t\tvar base64 = null;\n\t\t\tvar blob = new Blob([content], {\n\t\t\t\ttype: type\n\t\t\t});\n\t\t\tvar reader = new window.FileReader();\n\t\t\treader.readAsDataURL(blob);\n\t\t\treader.onloadend = function () {\n\t\t\t\tbase64 = reader.result;\n\t\t\t\tdownload();\n\t\t\t};\n\n\t\t\tfunction download() {\n\t\t\t\t// If in Chrome or Safari - download via virtual link click\n\t\t\t\t// if (isChrome || isSafari) {\n\t\t\t\t//Creating new link node.\n\t\t\t\tif (document.createEvent) {\n\t\t\t\t\tvar anchor = document.createElement('a');\n\t\t\t\t\tanchor.href = base64;\n\t\t\t\t\tif (anchor.download !== undefined) {\n\t\t\t\t\t\t//Set HTML5 download attribute. This will prevent file from opening if supported.\n\t\t\t\t\t\tvar downloadName = name || base64.substring(base64.lastIndexOf('/') + 1, base64.length);\n\t\t\t\t\t\tanchor.download = downloadName;\n\t\t\t\t\t}\n\t\t\t\t\t//Dispatching click event.\n\t\t\t\t\tvar event = document.createEvent('MouseEvents');\n\t\t\t\t\tevent.initEvent('click', true, true);\n\t\t\t\t\tanchor.dispatchEvent(event);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\t// }\n\t\t\t\t// Force file download (whether supported by server).\n\t\t\t\tvar query = '?download';\n\t\t\t\twindow.open(base64.indexOf('?') > -1 ? base64 : base64 + query, '_self');\n\t\t\t}\n\n\t\t\tfunction __download() {\n\t\t\t\tvar supportsDownloadAttribute = 'download' in document.createElement('a');\n\t\t\t\tif (supportsDownloadAttribute) {\n\t\t\t\t\tvar anchor = document.createElement('a');\n\t\t\t\t\tanchor.href = 'data:attachment/text;base64,' + encodeURI(window.btoa(content));\n\t\t\t\t\tanchor.target = '_blank';\n\t\t\t\t\tanchor.download = name;\n\t\t\t\t\t//Dispatching click event.\n\t\t\t\t\tif (document.createEvent) {\n\t\t\t\t\t\tvar event = document.createEvent('MouseEvents');\n\t\t\t\t\t\tevent.initEvent('click', true, true);\n\t\t\t\t\t\tanchor.dispatchEvent(event);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t} else if (window.Blob !== undefined && window.saveAs !== undefined) {\n\t\t\t\t\tvar blob = new Blob([content], {\n\t\t\t\t\t\ttype: type\n\t\t\t\t\t});\n\t\t\t\t\tsaveAs(blob, filename);\n\t\t\t\t} else {\n\t\t\t\t\twindow.open('data:attachment/text;charset=utf-8,' + encodeURI(content));\n\t\t\t\t}\n\t\t\t}\n\t\t\t/*\n\t\t\tvar headers = response.headers();\n\t\t\t// console.log(response);\n\t\t\tvar blob = new Blob([response.data], { type: \"application/octet-stream\" }); // { type: headers['content-type'] });\n\t\t\tvar windowUrl = (window.URL || window.webkitURL);\n\t\t\tvar downloadUrl = windowUrl.createObjectURL(blob);\n\t\t\tvar anchor = document.createElement(\"a\");\n\t\t\tanchor.href = downloadUrl;\n\t\t\tvar fileNamePattern = /filename[^;=\\n]*=((['\"]).*?\\2|[^;\\n]*)/;\n\t\t\tanchor.download = fileNamePattern.exec(headers['content-disposition'])[1];\n\t\t\tdocument.body.appendChild(anchor);\n\t\t\tanchor.click();\n\t\t\twindowUrl.revokeObjectURL(blob);\n\t\t\tanchor.remove();\n\t\t\t*/\n\t\t\t/*\n\t\t\t//Dispatching click event.\n\t\t\tif (document.createEvent) {\n\t\t\t    var e = document.createEvent('MouseEvents');\n\t\t\t    e.initEvent('click', true, true);\n\t\t\t    link.dispatchEvent(e);\n\t\t\t    return true;\n\t\t\t}\n\t\t\t*/\n\t\t}\n\n\t\tfunction serverDownload(options) {\n\t\t\tvar defaults = {\n\t\t\t\turi: '/api/reports/download',\n\t\t\t\tname: 'Filename',\n\t\t\t\textension: 'txt',\n\t\t\t\ttype: 'text/plain',\n\t\t\t\tcontent: 'Hello!',\n\t\t\t};\n\t\t\toptions = angular.extend(defaults, options);\n\t\t\tvar content = JSON.stringify(options); // unescape(encodeURIComponent(JSON.stringify(download)));\n\t\t\tvar form = document.createElement('form');\n\t\t\tvar input = document.createElement('input');\n\t\t\tinput.name = 'download';\n\t\t\tinput.value = content;\n\t\t\tform.appendChild(input);\n\t\t\tform.action = options.uri;\n\t\t\tform.method = 'POST';\n\t\t\tform.target = 'ProjectDownloads';\n\t\t\tform.enctype = 'application/x-www-form-urlencoded';\n\t\t\t// form.enctype = 'multipart/form-data';\n\t\t\t// form.enctype = 'text/plain';\n\t\t\tdocument.body.appendChild(form);\n\t\t\tform.submit();\n\t\t\tsetTimeout(function () {\n\t\t\t\tdocument.body.removeChild(form);\n\t\t\t}, 100);\n\t\t\t// angular.element(form).find('button')[0].click();\n\t\t\treturn Utils;\n\t\t}\n    }]);\n\n}());\n\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.factory('Doc', ['Api', '$promise', function(Api, $promise) {\r\n        function Doc(item) {\r\n            if (item) {\r\n                angular.extend(this, item);\r\n            }\r\n        }\r\n\r\n        Doc.prototype = {\r\n\r\n        };\r\n\r\n        var statics = {};\r\n\r\n        angular.extend(Doc, statics);\r\n\r\n        return Doc;\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.factory('View', ['Api', '$promise', '$location', '$routeParams', 'environment', 'Doc', function(Api, $promise, $location, $routeParams, environment, Doc) {\r\n        function View(doc) {\r\n            var url = $location.path(),\r\n                params = $routeParams;\r\n            var view = {\r\n                environment: environment,\r\n                route: {\r\n                    url: url,\r\n                    params: params,\r\n                },\r\n                doc: doc,\r\n            };\r\n            angular.extend(this, view);\r\n        }\r\n\r\n        View.prototype = {\r\n\r\n        };\r\n\r\n        var statics = {\r\n            current: function() {\r\n                return $promise(function(promise) {\r\n                    var url = $location.path();\r\n                    console.log('View.current', url);\r\n                    Api.docs.url(url).then(function(response) {\r\n                        var doc = new Doc(response);\r\n                        var view = new View(doc);\r\n                        promise.resolve(view);\r\n\r\n                    }, function(error) {\r\n                        promise.reject(error);\r\n\r\n                    });\r\n                    /*\r\n                    Api.navs.main().then(function(items) {\r\n                        var doc = null,\r\n                            url = $location.path(),\r\n                            pool = getPool(items);\r\n                        var item = pool[url];\r\n                        if (item) {\r\n                            doc = new Doc(item);\r\n                        }\r\n                        promise.resolve(doc);\r\n\r\n                    }, function(error) {\r\n                        promise.reject(error);\r\n\r\n                    });\r\n                    */\r\n                });\r\n            }\r\n        };\r\n\r\n        angular.extend(View, statics);\r\n\r\n        function getPool(items) {\r\n            var pool = {};\r\n\r\n            function _getPool(items) {\r\n                if (items) {\r\n                    angular.forEach(items, function(item) {\r\n                        pool[item.url] = item;\r\n                        _getPool(item.items);\r\n                    });\r\n                }\r\n            }\r\n            _getPool(items);\r\n            return pool;\r\n        }\r\n\r\n        return View;\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.service('WebApi', ['$http', '$promise', '$timeout', 'environment',\r\n        function($http, $promise, $timeout, environment) {\r\n\r\n            function $httpPromise(method, url, data) {\r\n                return $promise(function(promise) {\r\n\r\n                    $http[method](environment.urls.api + url, data).then(function(response) {\r\n                        promise.resolve(response.data);\r\n\r\n                    }, function(e, status) {\r\n                        var error = (e && e.data) ? e.data : {};\r\n                        error.status = e.status;\r\n                        promise.reject(error);\r\n\r\n                    });\r\n                });\r\n            }\r\n\r\n            function $get(url) {\r\n                return $httpPromise('get', url);\r\n            }\r\n\r\n            function $post(url, data) {\r\n                return $httpPromise('post', url, data);\r\n            }\r\n\r\n            function $put(url, data) {\r\n                return $httpPromise('put', url, data);\r\n            }\r\n\r\n            function $patch(url, data) {\r\n                return $httpPromise('patch', url, data);\r\n            }\r\n\r\n            function $delete(url) {\r\n                return $httpPromise('delete', url);\r\n            }\r\n\r\n            function $fake(data) {\r\n                var deferred = $q.defer();\r\n                $timeout(function() {\r\n                    deferred.resolve({ data: data });\r\n                }, 1000);\r\n                return deferred.promise;\r\n            }\r\n\r\n            this.get = $get;\r\n            this.post = $post;\r\n            this.put = $put;\r\n            this.patch = $patch;\r\n            this.delete = $delete;\r\n            this.fake = $fake;\r\n\r\n        }\r\n    ]);\r\n\r\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.service('Router', ['$location', '$timeout', function($location, $timeout) {\n\n        var service = this;\n        service.redirect = redirect;\n        service.path = path;\n        service.apply = apply;\n\n        function redirect(path, msecs) {\n            function doRedirect() {\n                $location.$$lastRequestedPath = $location.path();\n                $location.path(path);\n            }\n            if (msecs) {\n                $timeout(function() {\n                    doRedirect();\n                }, msecs);\n            } else {\n                doRedirect();\n            }\n        }\n\n        function path(path, msecs) {\n            function doRetry() {\n                path = $location.$$lastRequestedPath || path;\n                $location.$$lastRequestedPath = null;\n                $location.path(path);\n            }\n            if (msecs) {\n                $timeout(function() {\n                    doRetry();\n                }, msecs);\n            } else {\n                doRetry();\n            }\n        }\n\n        function apply(path, msecs) {\n            function doRetry() {\n                $location.path(path);\n            }\n            if (msecs) {\n                $timeout(function() {\n                    doRetry();\n                }, msecs);\n            } else {\n                $timeout(function() {\n                    doRetry();\n                });\n            }\n        }\n\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('$silent', ['$rootScope', '$location', function($rootScope, $location) {\n        function $silent() {}\n\n        var $path;\n\n        function unlink() {\n            var listeners = $rootScope.$$listeners.$locationChangeSuccess;\n            angular.forEach(listeners, function(value, name) {\n                if (value === listener) {\n                    return;\n                }\n\n                function relink() {\n                    listeners[name] = value;\n                }\n                listeners[name] = relink; // temporary unlinking\n            });\n        }\n\n        function listener(e) {\n            // console.log('onLocationChangeSuccess', e);\n            if ($path === $location.path()) {\n                unlink();\n            }\n            $path = null;\n        }\n\n        var statics = {\n            silent: function(path, replace) {\n                // this.prev = $location.path(); ???\n                var location = $location.url(path);\n                if (replace) {\n                    location.replace();\n                }\n                $path = $location.path();\n            },\n            path: function(path) {\n                return $location.path(path);\n            },\n        };\n\n        angular.extend($silent, statics);\n        $rootScope.$$listeners.$locationChangeSuccess.unshift(listener);\n        // console.log('$rootScope.$$listeners.$locationChangeSuccess', $rootScope.$$listeners.$locationChangeSuccess);\n        return $silent;\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('Cookie', ['$q', '$window', function($q, $window) {\n        function Cookie() {}\n        Cookie.TIMEOUT = 5 * 60 * 1000; // five minutes\n        Cookie._set = function(name, value, days) {\n            var expires;\n            if (days) {\n                var date = new Date();\n                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n                expires = '; expires=' + date.toGMTString();\n            } else {\n                expires = '';\n            }\n            $window.document.cookie = name + '=' + value + expires + '; path=/';\n        };\n        Cookie.exists = function(name) {\n            return $window.document.cookie.indexOf(';' + name + '=') !== -1 || $window.document.cookie.indexOf(name + '=') === 0;\n        };\n        Cookie.get = function(name) {\n            var cookieName = name + \"=\";\n            var ca = $window.document.cookie.split(';');\n            for (var i = 0; i < ca.length; i++) {\n                var c = ca[i];\n                while (c.charAt(0) == ' ') {\n                    c = c.substring(1, c.length);\n                }\n                if (c.indexOf(cookieName) === 0) {\n                    var value = c.substring(cookieName.length, c.length);\n                    var model = null;\n                    try {\n                        model = JSON.parse(decodeURIComponent(atob(value)));\n                    } catch (e) {\n                        console.log('Cookie.get.error parsing', key, e);\n                    }\n                    return model;\n                }\n            }\n            return null;\n        };\n        Cookie.set = function(name, value, days) {\n            try {\n                var cache = [];\n                var json = JSON.stringify(value, function(key, value) {\n                    if (key === 'pool') {\n                        return;\n                    }\n                    if (typeof value === 'object' && value !== null) {\n                        if (cache.indexOf(value) !== -1) {\n                            // Circular reference found, discard key\n                            return;\n                        }\n                        cache.push(value);\n                    }\n                    return value;\n                });\n                cache = null;\n                Cookie._set(name, btoa(encodeURIComponent(json)), days);\n            } catch (e) {\n                console.log('Cookie.set.error serializing', name, value, e);\n            }\n        };\n        Cookie.delete = function(name) {\n            Cookie._set(name, \"\", -1);\n        };\n        Cookie.on = function(name) {\n            var deferred = $q.defer();\n            var i, interval = 1000,\n                elapsed = 0,\n                timeout = Cookie.TIMEOUT;\n\n            function checkCookie() {\n                if (elapsed > timeout) {\n                    deferred.reject('timeout');\n                } else {\n                    var c = Cookie.get(name);\n                    if (c) {\n                        deferred.resolve(c);\n                    } else {\n                        elapsed += interval;\n                        i = setTimeout(checkCookie, interval);\n                    }\n                }\n            }\n            checkCookie();\n            return deferred.promise;\n        };\n        return Cookie;\n    }]);\n\n    app.factory('LocalStorage', ['$q', '$window', 'Cookie', function($q, $window, Cookie) {\n        function LocalStorage() {}\n\n        function isLocalStorageSupported() {\n            var supported = false;\n            try {\n                supported = 'localStorage' in $window && $window.localStorage !== null;\n                if (supported) {\n                    $window.localStorage.setItem('test', '1');\n                    $window.localStorage.removeItem('test');\n                } else {\n                    supported = false;\n                }\n            } catch (e) {\n                supported = false;\n            }\n            return supported;\n        }\n        LocalStorage.isSupported = isLocalStorageSupported();\n        if (LocalStorage.isSupported) {\n            LocalStorage.exists = function(name) {\n                return $window.localStorage[name] !== undefined;\n            };\n            LocalStorage.get = function(name) {\n                var value = null;\n                if ($window.localStorage[name] !== undefined) {\n                    try {\n                        value = JSON.parse($window.localStorage[name]);\n                    } catch (e) {\n                        console.log('LocalStorage.get.error parsing', name, e);\n                    }\n                }\n                return value;\n            };\n            LocalStorage.set = function(name, value) {\n                try {\n                    var cache = [];\n                    var json = JSON.stringify(value, function(key, value) {\n                        if (key === 'pool') {\n                            return;\n                        }\n                        if (typeof value === 'object' && value !== null) {\n                            if (cache.indexOf(value) !== -1) {\n                                // Circular reference found, discard key\n                                return;\n                            }\n                            cache.push(value);\n                        }\n                        return value;\n                    });\n                    cache = null;\n                    $window.localStorage.setItem(name, json);\n                } catch (e) {\n                    console.log('LocalStorage.set.error serializing', name, value, e);\n                }\n            };\n            LocalStorage.delete = function(name) {\n                $window.localStorage.removeItem(name);\n            };\n            LocalStorage.on = function(name) {\n                var deferred = $q.defer();\n                var i, timeout = Cookie.TIMEOUT;\n\n                function storageEvent(e) {\n                    // console.log('LocalStorage.on', name, e);\n                    clearTimeout(i);\n                    if (e.originalEvent.key == name) {\n                        try {\n                            var value = JSON.parse(e.originalEvent.newValue); // , e.originalEvent.oldValue\n                            deferred.resolve(value);\n                        } catch (error) {\n                            console.log('LocalStorage.on.error parsing', name, error);\n                            deferred.reject('error parsing ' + name);\n                        }\n                    }\n                }\n                angular.element($window).on('storage', storageEvent);\n                i = setTimeout(function() {\n                    deferred.reject('timeout');\n                }, timeout);\n                return deferred.promise;\n            };\n        } else {\n            console.log('LocalStorage.unsupported switching to cookies');\n            LocalStorage.exists = Cookie.exists;\n            LocalStorage.set = Cookie.set;\n            LocalStorage.get = Cookie.get;\n            LocalStorage.delete = Cookie.delete;\n            LocalStorage.on = Cookie.on;\n        }\n        return LocalStorage;\n    }]);\n\n    app.factory('SessionStorage', ['$q', '$window', 'Cookie', function($q, $window, Cookie) {\n        function SessionStorage() {}\n\n        function isSessionStorageSupported() {\n            var supported = false;\n            try {\n                supported = 'sessionStorage' in $window && $window.sessionStorage !== undefined;\n                if (supported) {\n                    $window.sessionStorage.setItem('test', '1');\n                    $window.sessionStorage.removeItem('test');\n                } else {\n                    supported = false;\n                }\n            } catch (e) {\n                supported = false;\n            }\n            return supported;\n        }\n        SessionStorage.isSupported = isSessionStorageSupported();\n        if (SessionStorage.isSupported) {\n            SessionStorage.exists = function(name) {\n                return $window.sessionStorage[name] !== undefined;\n            };\n            SessionStorage.get = function(name) {\n                var value = null;\n                if ($window.sessionStorage[name] !== undefined) {\n                    try {\n                        value = JSON.parse($window.sessionStorage[name]);\n                    } catch (e) {\n                        console.log('SessionStorage.get.error parsing', name, e);\n                    }\n                }\n                return value;\n            };\n            SessionStorage.set = function(name, value) {\n                try {\n                    var cache = [];\n                    var json = JSON.stringify(value, function(key, value) {\n                        if (key === 'pool') {\n                            return;\n                        }\n                        if (typeof value === 'object' && value !== null) {\n                            if (cache.indexOf(value) !== -1) {\n                                // Circular reference found, discard key\n                                return;\n                            }\n                            cache.push(value);\n                        }\n                        return value;\n                    });\n                    cache = null;\n                    $window.sessionStorage.setItem(name, json);\n                } catch (e) {\n                    console.log('SessionStorage.set.error serializing', name, value, e);\n                }\n            };\n            SessionStorage.delete = function(name) {\n                $window.sessionStorage.removeItem(name);\n            };\n            SessionStorage.on = function(name) {\n                var deferred = $q.defer();\n                var i, timeout = Cookie.TIMEOUT;\n\n                function storageEvent(e) {\n                    // console.log('SessionStorage.on', name, e);\n                    clearTimeout(i);\n                    if (e.originalEvent.key === name) {\n                        try {\n                            var value = JSON.parse(e.originalEvent.newValue); // , e.originalEvent.oldValue\n                            deferred.resolve(value);\n                        } catch (error) {\n                            console.log('SessionStorage.on.error parsing', name, error);\n                            deferred.reject('error parsing ' + name);\n                        }\n                    }\n                }\n                angular.element($window).on('storage', storageEvent);\n                i = setTimeout(function() {\n                    deferred.reject('timeout');\n                }, timeout);\n                return deferred.promise;\n            };\n        } else {\n            console.log('SessionStorage.unsupported switching to cookies');\n            SessionStorage.exists = Cookie.exists;\n            SessionStorage.set = Cookie.set;\n            SessionStorage.get = Cookie.get;\n            SessionStorage.delete = Cookie.delete;\n            SessionStorage.on = Cookie.on;\n        }\n        return SessionStorage;\n    }]);\n\n}());\n/* global angular, firebase */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('Rect', [function() {\n        function Rect(x, y, w, h) {\n            this.x = x || 0;\n            this.y = y || 0;\n            this.w = w || 0;\n            this.h = h || 0;\n        }\n        Rect.mult = function(rect, value) {\n            rect.x *= value;\n            rect.y *= value;\n            rect.w *= value;\n            rect.h *= value;\n            return rect;\n        };\n        Rect.prototype = {\n            mult: function(value) {\n                return Rect.mult(this, value);\n            },\n            offset: function(x, y) {\n                this.x += x;\n                this.y += y;\n                return this;\n            },\n            reduce: function(size) {\n                return this.offset(-size);\n            },\n            reduceRect: function(rect) {\n                return this.offsetRect(Rect.mult(rect, -1));\n            },\n            expandRect: function(rect) {\n                this.x -= rect.x || 0;\n                this.y -= rect.y || 0;\n                this.w += rect.w || 0;\n                this.h += rect.h || 0;\n                return this;\n            },\n            expand: function(size) {\n                return this.expandRect({ x: size, y: size, w: size * 2, h: size * 2 });\n            },\n            intersect: function(rect) {\n                var x = this.x,\n                    y = this.y,\n                    w = this.w,\n                    h = this.h;\n                return !(rect.x > x + w || rect.x + rect.w < x || rect.y > y + h || rect.y + rect.h < y);\n            },\n            top: function() {\n                var x = this.x,\n                    y = this.y,\n                    w = this.w,\n                    h = this.h;\n                return { x: x + w / 2, y: y };\n            },\n            right: function() {\n                var x = this.x,\n                    y = this.y,\n                    w = this.w,\n                    h = this.h;\n                return { x: x + w, y: y + h / 2 };\n            },\n            bottom: function() {\n                var x = this.x,\n                    y = this.y,\n                    w = this.w,\n                    h = this.h;\n                return { x: x + w / 2, y: y + h };\n            },\n            left: function() {\n                var x = this.x,\n                    y = this.y,\n                    w = this.w,\n                    h = this.h;\n                return { x: x, y: y + h / 2 };\n            },\n            center: function() {\n                var x = this.x,\n                    y = this.y,\n                    w = this.w,\n                    h = this.h;\n                return { x: x + w / 2, y: y + h / 2 };\n            },\n            topLeft: function() {\n                var x = this.x,\n                    y = this.y,\n                    w = this.w,\n                    h = this.h;\n                return { x: x, y: y };\n            },\n            topRight: function() {\n                var x = this.x,\n                    y = this.y,\n                    w = this.w,\n                    h = this.h;\n                return { x: x + w, y: y };\n            },\n            bottomRight: function() {\n                var x = this.x,\n                    y = this.y,\n                    w = this.w,\n                    h = this.h;\n                return { x: x + w, y: y + h };\n            },\n            bottomLeft: function() {\n                var x = this.x,\n                    y = this.y,\n                    w = this.w,\n                    h = this.h;\n                return { x: x, y: y + h };\n            },\n            setX: function(x) {\n                this.x = x;\n                return this;\n            },\n            setY: function(y) {\n                this.y = y;\n                return this;\n            },\n            setW: function(w) {\n                this.w = w;\n                return this;\n            },\n            setH: function(h) {\n                this.h = h;\n                return this;\n            },\n            setPos: function(x, y) {\n                this.x = x;\n                this.y = y;\n                return this;\n            },\n            setSize: function(w, h) {\n                this.w = w;\n                this.h = h;\n                return this;\n            },\n            copy: function(rect) {\n                this.x = rect.x;\n                this.y = rect.y;\n                this.w = rect.w;\n                this.h = rect.h;\n                return this;\n            },\n            clone: function() {\n                return new Rect(this.x, this.y, this.w, this.h);\n            },\n            toString: function() {\n                return '{' + this.x + ',' + this.y + ',' + this.w + ',' + this.h + '}';\n            },\n        };\n        return Rect;\n    }]);\n\n    app.factory('Color', [function() {\n        function Color(r, g, b, a) {\n            if (arguments.length > 1) {\n                this.r = (r || r === 0) ? r : 0;\n                this.g = (g || g === 0) ? g : 0;\n                this.b = (b || b === 0) ? b : 0;\n                this.a = (a || a === 0) ? a : 255;\n            } else {\n                var uint = r || '0xffffff';\n                uint = parseInt(uint);\n                if (r.length > 8) {\n                    this.r = uint >> 24 & 0xff;\n                    this.g = uint >> 16 & 0xff;\n                    this.b = uint >> 8 & 0xff;\n                    this.a = uint >> 0 & 0xff;\n                } else {\n                    this.r = uint >> 16 & 0xff;\n                    this.g = uint >> 8 & 0xff;\n                    this.b = uint >> 0 & 0xff;\n                    this.a = 255;\n                }\n            }\n        }\n        Color.componentToHex = function(c) {\n            var hex = c.toString(16);\n            return hex.length == 1 ? '0' + hex : hex;\n        };\n        Color.luma = function(color) {\n            // var luma = color.dot({ r: 54.213, g: 182.376, b: 18.411 });\n            var luma = color.dot({ r: 95, g: 100, b: 60 });\n            return luma;\n        };\n        Color.contrast = function(color) {\n            var luma = Color.luma(color);\n            if (luma > 0.6) {\n                return new Color('0x000000');\n            } else {\n                return new Color('0xffffff');\n            }\n        };\n        Color.darker = function(color, pow, min) {\n            min = min || 0;\n            var r = Math.max(Math.floor(color.r * min), Math.floor(color.r - 255 * pow));\n            var g = Math.max(Math.floor(color.g * min), Math.floor(color.g - 255 * pow));\n            var b = Math.max(Math.floor(color.b * min), Math.floor(color.b - 255 * pow));\n            return new Color(r, g, b, color.a);\n        };\n        Color.lighter = function(color, pow, max) {\n            max = max || 1;\n            var r = Math.min(color.r + Math.floor((255 - color.r) * max), Math.floor(color.r + 255 * pow));\n            var g = Math.min(color.g + Math.floor((255 - color.g) * max), Math.floor(color.g + 255 * pow));\n            var b = Math.min(color.b + Math.floor((255 - color.b) * max), Math.floor(color.b + 255 * pow));\n            return new Color(r, g, b, color.a);\n        };\n        /*\n        Color.rgbaToHex = function (rgba) {        \n            rgba = rgba.match(/^rgba?[\\s+]?\\([\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?/i);\n            return (rgba && rgba.length === 4) ? \"#\" +\n                (\"0\" + parseInt(rgba[1], 10).toString(16)).slice(-2) +\n                (\"0\" + parseInt(rgba[2], 10).toString(16)).slice(-2) +\n                (\"0\" + parseInt(rgba[3], 10).toString(16)).slice(-2) : '';        \n        }\n        */\n        Color.prototype = {\n            toUint: function() {\n                return (this.r << 24) + (this.g << 16) + (this.b << 8) + (this.a);\n            },\n            toHex: function() {\n                return '#' + Color.componentToHex(this.r) + Color.componentToHex(this.g) + Color.componentToHex(this.b) + Color.componentToHex(this.a);\n            },\n            toRgba: function() {\n                return 'rgba(' + this.r + ',' + this.g + ',' + this.b + ',' + (this.a / 255).toFixed(3) + ')';\n            },\n            dot: function(color) {\n                return ((this.r / 255) * (color.r / 255) + (this.g / 255) * (color.g / 255) + (this.b / 255) * (color.b / 255));\n            },\n            alpha: function(pow, min, max) {\n                min = min || 0;\n                max = max || 1;\n                this.a = Math.floor((min + (pow * (max - min))) * 255);\n                return this;\n            },\n            makeSet: function() {\n                this.foreground = Color.contrast(this);\n                this.border = Color.darker(this, 0.3);\n                this.light = Color.lighter(this, 0.3);\n                return this;\n            },\n        };\n        return Color;\n    }]);\n\n    app.factory('Shape', [function() {\n        function Shape() {}\n        Shape.shapeCircle = function(p, cx, cy, r, sa, ea) {\n            sa = sa || 0;\n            ea = ea || 2 * Math.PI;\n            p.ctx.arc(cx, cy, r, sa, ea, false);\n        };\n        Shape.shapeStar = function(p, cx, cy, or, ir, steps) {\n            var x, y;\n            var angle = Math.PI / 2 * 3;\n            var step = Math.PI / steps;\n            var ctx = p.ctx;\n            ctx.moveTo(cx, cy - or);\n            for (i = 0; i < steps; i++) {\n                x = cx + Math.cos(angle) * or;\n                y = cy + Math.sin(angle) * or;\n                ctx.lineTo(x, y);\n                angle += step;\n                x = cx + Math.cos(angle) * ir;\n                y = cy + Math.sin(angle) * ir;\n                ctx.lineTo(x, y);\n                angle += step;\n            }\n            ctx.lineTo(cx, cy - or);\n        };\n        Shape.shapeRoundRect = function(p, rect, r) {\n            var ctx = p.ctx,\n                x = rect.x,\n                y = rect.y,\n                w = rect.w,\n                h = rect.h;\n            if (typeof r === undefined) {\n                r = 4;\n            }\n            if (typeof r === 'number') {\n                r = { tl: r, tr: r, br: r, bl: r };\n            } else {\n                var defaultRadius = { tl: 0, tr: 0, br: 0, bl: 0 };\n                for (var key in defaultRadius) {\n                    r[key] = r[key] || defaultRadius[key];\n                }\n            }\n            ctx.moveTo(x + r.tl, y);\n            ctx.lineTo(x + w - r.tr, y);\n            ctx.quadraticCurveTo(x + w, y, x + w, y + r.tr);\n            ctx.lineTo(x + w, y + h - r.br);\n            ctx.quadraticCurveTo(x + w, y + h, x + w - r.br, y + h);\n            ctx.lineTo(x + r.bl, y + h);\n            ctx.quadraticCurveTo(x, y + h, x, y + h - r.bl);\n            ctx.lineTo(x, y + r.tl);\n            ctx.quadraticCurveTo(x, y, x + r.tl, y);\n        };\n        Shape.circle = function() {\n            var params = Array.prototype.slice.call(arguments);\n            var ctx = params[0].ctx;\n            ctx.beginPath();\n            Shape.shapeCircle.apply(this, params);\n            ctx.closePath();\n        };\n        Shape.star = function() {\n            var params = Array.prototype.slice.call(arguments);\n            var ctx = params[0].ctx;\n            ctx.beginPath();\n            Shape.shapeStar.apply(this, params);\n            ctx.closePath();\n        };\n        Shape.roundRect = function() {\n            var params = Array.prototype.slice.call(arguments);\n            var ctx = params[0].ctx;\n            ctx.beginPath();\n            Shape.shapeRoundRect.apply(this, params);\n            ctx.closePath();\n        };\n        return Shape;\n    }]);\n\n    app.constant('PainterColors', {\n        /*\n        black: new Color('0x111111'),\n        white: new Color('0xffffff'),\n        red: new Color('0xff0000'),\n        green: new Color('0x00ff00'),\n        blue: new Color('0x0000ff'),\n        yellow: new Color('0xffff00'),\n        cyan: new Color('0x00ffff'),\n        purple: new Color('0xff00ff'),\n        */\n        black: '0x14191e',\n        white: '0xffffff',\n        blue: '0x0023FF',\n        red: '0xF21500',\n        lightBlue: '0x79ccf2',\n        lightYellow: '0xfff79a',\n        greyLighter: '0xf8f8f8',\n        greyLight: '0xeeeeee',\n        greyMedium: '0xcccccc',\n        grey: '0x90939b',\n        map: '0x24292e',\n    });\n\n    app.factory('Palette', ['$q', 'Painter', 'Rect', function($q, Painter, Rect) {\n        function Palette() {\n            this.painter = new Painter().setSize(0, 0);\n            this.buffer = new Painter().setSize(0, 0);\n            this.size = { w: 0, h: 0 };\n            this.pool = {};\n            this.rows = {};\n        }\n        Palette.prototype = {\n            getRect: function(w, h) {\n                var p = this.painter,\n                    size = this.size,\n                    rows = this.rows,\n                    r = new Rect(0, 0, w, h),\n                    row = rows[h] || { x: 0, y: size.h };\n                size.w = Math.max(size.w, row.x + w);\n                size.h = Math.max(size.h, row.y + h);\n                if (!p.canvas.width && !p.canvas.height) {\n                    p.setSize(size.w, size.h);\n                } else if (size.w > p.canvas.width || size.h > p.canvas.height) {\n                    // var img = new Image();\n                    // img.src = p.toDataURL();\n                    // document.body.appendChild(canvas);\n                    // console.log(p.canvas.width, p.canvas.height);\n                    // var data = p.ctx.getImageData(0, 0, p.canvas.width, p.canvas.height);\n                    var canvas = p.canvas;\n                    p.setCanvas(document.createElement('canvas'));\n                    p.setSize(size.w, size.h);\n                    p.ctx.drawImage(canvas, 0, 0);\n                    // p.ctx.putImageData(data, 0, 0);\n                    // p.ctx.drawImage(img, 0, 0);\n                    // document.body.removeChild(canvas);\n                }\n                r.x = row.x;\n                r.y = row.y;\n                row.x += w;\n                rows[h] = row;\n                return r;\n            },\n            add: function(key, path) {\n                var palette = this;\n                if (angular.isString(path)) {\n                    var deferred = $q.defer();\n                    var img = new Image();\n                    img.onload = function() {\n                        palette.addShape(key, img.width, img.height, function(p, rect) {\n                            p.ctx.drawImage(img, 0, 0);\n                        });\n                        deferred.resolve(img);\n                    };\n                    img.onerror = function() {\n                        deferred.reject('connot load ' + path);\n                    };\n                    img.src = path;\n                    return deferred.promise;\n                } else {\n                    var params = Array.prototype.slice.call(arguments);\n                    return palette.addShape.apply(palette, params);\n                }\n            },\n            addShape: function(key, w, h, callback) {\n                var p = this.painter,\n                    r = this.getRect(w, h);\n                p.ctx.save();\n                p.ctx.rect(r.x, r.y, r.w, r.h);\n                // p.ctx.stroke();\n                p.ctx.clip();\n                p.ctx.translate(r.x, r.y);\n                callback.call(p, p, r.clone().setPos(0, 0));\n                p.ctx.restore();\n                this.pool[key] = r;\n                // console.log('Painter.add', r);\n            },\n            draw: function(target, key, x, y, pre) {\n                var r = this.pool[key];\n                if (r) {\n                    // var ctx = target.ctx;\n                    // ctx.save();\n                    target.drawRect(this.painter.canvas, r, { x: x, y: y, w: r.w, h: r.h }, pre);\n                    // target.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, x - r.w / 2, y - r.h / 2, r.w, r.h);\n                    // ctx.restore();\n                }\n            },\n            tint: function(target, key, x, y, color, pre) {\n                var r = this.pool[key];\n                if (r) {\n                    var p = this.painter,\n                        b = this.buffer.setSize(r.w, r.h);\n                    b.save();\n                    b.setFill(color);\n                    b.fillRect();\n                    b.ctx.globalCompositeOperation = \"destination-atop\";\n                    b.ctx.drawImage(p.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n                    b.restore();\n                    console.log(x, y, b.canvas, target.canvas);\n                    target.draw(b.canvas, { x: x, y: y }, pre);\n                }\n            },\n            pattern: function(target, key, x, y, w, h, color) {\n                function drawPattern(pattern) {\n                    var ctx = target.ctx;\n                    ctx.save();\n                    ctx.translate(x, y);\n                    // draw\n                    // ctx.beginPath();\n                    // ctx.rect(-x, -y, w, h);\n                    ctx.fillStyle = pattern;\n                    ctx.fillRect(-x, -y, w, h);\n                    ctx.translate(-x, -y);\n                    // ctx.fill();\n                    ctx.restore();\n                }\n                var r = this.pool[key];\n                if (r) {\n                    var img = r.img,\n                        pattern;\n                    if (!img || r.color != color) {\n                        var b = this.buffer.setSize(r.w, r.h);\n                        if (color) {\n                            r.color = color;\n                            b.save();\n                            b.setFill(color);\n                            b.fillRect();\n                            b.ctx.globalCompositeOperation = \"destination-atop\";\n                            b.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n                            b.restore();\n                        } else {\n                            b.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n                        }\n                        img = new Image();\n                        img.onload = function() {\n                            r.img = img;\n                            pattern = target.ctx.createPattern(img, \"repeat\");\n                            drawPattern(pattern);\n                        };\n                        img.src = b.toDataURL();\n                    } else {\n                        pattern = target.ctx.createPattern(img, \"repeat\");\n                        drawPattern(pattern);\n                    }\n                }\n            },\n        };\n        return Palette;\n    }]);\n\n    app.factory('Painter', ['Shape', 'Rect', 'Color', 'PainterColors', function(Shape, Rect, Color, PainterColors) {\n        function Painter(canvas) {\n            canvas = canvas || document.createElement('canvas');\n            this.rect = new Rect();\n            this.drawingRect = new Rect();\n            this.setColors();\n            this.setCanvas(canvas);\n        }\n        Painter.colors = {};\n        angular.forEach(PainterColors, function(value, key) {\n            Painter.colors[key] = new Color(value).makeSet();\n        });\n        var colors = Painter.colors;\n        Painter.prototype = {\n            colors: Painter.colors,\n            setColors: function() {\n                var colors = this.colors;\n                angular.forEach(PainterColors, function(value, key) {\n                    colors[key] = new Color(value).makeSet();\n                });\n            },\n            setCanvas: function(canvas) {\n                this.canvas = canvas;\n                this.setSize(canvas.offsetWidth, canvas.offsetHeight);\n                var ctx = canvas.getContext('2d');\n                ctx.lineCap = 'square';\n                this.ctx = ctx;\n                return this;\n            },\n            setSize: function(w, h) {\n                this.canvas.width = w;\n                this.canvas.height = h;\n                this.rect.w = w;\n                this.rect.h = h;\n                return this;\n            },\n            copy: function(canvas) {\n                this.ctx.drawImage(canvas, 0, 0);\n                return this;\n            },\n            clear: function() {\n                this.resize();\n                // this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n                return this;\n            },\n            resize: function() {\n                this.setSize(this.canvas.offsetWidth, this.canvas.offsetHeight);\n                return this;\n            },\n            setText: function(font, align, verticalAlign, color) {\n                font = font || '11px monospace';\n                align = align || 'center';\n                verticalAlign = verticalAlign || 'middle';\n                color = color || this.colors.black;\n                var ctx = this.ctx;\n                ctx.font = font;\n                ctx.textAlign = align;\n                ctx.textBaseline = verticalAlign;\n                ctx.fillStyle = color.toRgba();\n                return this;\n            },\n            setFill: function(color) {\n                color = color || this.colors.black;\n                var ctx = this.ctx;\n                /*\n                var my_gradient = ctx.createLinearGradient(0, 0, 0, 170);\n                my_gradient.addColorStop(0, \"black\");\n                my_gradient.addColorStop(1, \"white\");\n                ctx.fillStyle = my_gradient;\n                */\n                ctx.fillStyle = color.toRgba();\n                return this;\n            },\n            setStroke: function(color, size) {\n                color = color || this.colors.black;\n                var ctx = this.ctx;\n                size = size || 1;\n                /*            \n                var gradient=ctx.createLinearGradient(0,0,170,0);\n                gradient.addColorStop(\"0\",\"magenta\");\n                gradient.addColorStop(\"0.5\",\"blue\");\n                gradient.addColorStop(\"1.0\",\"red\");\n                ctx.strokeStyle = gradient;\n                */\n                // Fill with gradient\n                ctx.strokeStyle = color.toRgba();\n                ctx.lineWidth = size;\n                return this;\n            },\n            /*\n            drawRoundRect: function (rect, r) {\n                rect = rect || this.rect;\n                Shape.roundRect(this, rect, r);\n                return this;\n            },\n            */\n            fillText: function(text, point, width, post, maxLength) {\n                if (width) {\n                    post = post || '';\n                    maxLength = maxLength || Math.floor(width / 8);\n                    if (text.length > maxLength) {\n                        text = text.substr(0, Math.min(text.length, maxLength)).trim() + post;\n                    }\n                }\n                this.ctx.fillText(text, point.x, point.y);\n                return this;\n            },\n            fillRect: function(rect) {\n                rect = rect || this.rect;\n                var ctx = this.ctx,\n                    x = rect.x,\n                    y = rect.y,\n                    w = rect.w,\n                    h = rect.h;\n                ctx.fillRect(x, y, w, h);\n                return this;\n            },\n            strokeRect: function(rect) {\n                rect = rect || this.rect;\n                var ctx = this.ctx,\n                    x = rect.x,\n                    y = rect.y,\n                    w = rect.w,\n                    h = rect.h;\n                ctx.strokeRect(x, y, w, h);\n                return this;\n            },\n            fill: function() {\n                this.ctx.fill();\n                return this;\n            },\n            stroke: function() {\n                this.ctx.stroke();\n                return this;\n            },\n            begin: function() {\n                this.ctx.beginPath();\n                return this;\n            },\n            close: function() {\n                this.ctx.closePath();\n                return this;\n            },\n            save: function() {\n                this.ctx.save();\n                return this;\n            },\n            restore: function() {\n                this.ctx.restore();\n                return this;\n            },\n            rotate: function(angle) {\n                this.ctx.rotate(angle * Math.PI / 180);\n            },\n            translate: function(xy) {\n                this.ctx.translate(xy.x, xy.y);\n            },\n            toDataURL: function() {\n                return this.canvas.toDataURL();\n            },\n            draw: function(image, t, pre) {\n                if (image) {\n                    t.w = t.w || image.width;\n                    t.h = t.h || image.height;\n                    var ctx = this.ctx,\n                        rect = this.drawingRect,\n                        x = rect.x = t.x - t.w / 2,\n                        y = rect.y = t.y - t.h / 2,\n                        w = rect.w = t.w,\n                        h = rect.h = t.h;\n                    ctx.save();\n                    ctx.translate(x, y);\n                    if (pre) {\n                        pre.call(this);\n                    }\n                    ctx.drawImage(image, 0, 0);\n                    ctx.restore();\n                    // console.log('painter.draw', x, y, w, h);\n                }\n                return this;\n            },\n            drawRect: function(image, s, t, pre) {\n                if (image) {\n                    s.w = s.w || image.width;\n                    s.h = s.h || image.height;\n                    t.w = t.w || image.width;\n                    t.h = t.h || image.height;\n                    var ctx = this.ctx,\n                        rect = this.drawingRect,\n                        x = rect.x = t.x - s.w / 2,\n                        y = rect.y = t.y - s.h / 2,\n                        w = rect.w = t.w,\n                        h = rect.h = t.h;\n                    ctx.save();\n                    ctx.translate(x, y);\n                    if (pre) {\n                        pre.call(this);\n                    }\n                    ctx.drawImage(image, s.x, s.y, s.w, s.h, 0, 0, t.w, t.h);\n                    ctx.restore();\n                    // console.log('painter.drawRect', x, y, w, h);\n                }\n                return this;\n            },\n            flip: function(scale) {\n                scale = scale || { x: 1, y: -1 };\n                var ctx = this.ctx,\n                    rect = this.drawingRect;\n                ctx.translate(scale.x === -1 ? rect.w : 0, scale.y === -1 ? rect.h : 0);\n                ctx.scale(scale.x, scale.y);\n            },\n        };\n        return Painter;\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.directive('controlMessages', [function() {\n        return {\n            restrict: 'E',\n            templateUrl: 'artisan/forms/messages',\n            transclude: {\n                'message': '?messageItems',\n            },\n            link: function(scope, element, attributes, model) {}\n        };\n    }]);\n\n    app.directive('control', ['$parse', function($parse) {\n        function formatLabel(string, prepend, expression) {\n            string = string || '';\n            prepend = prepend || '';\n            var splitted = string.split(',');\n            if (splitted.length > 1) {\n                var formatted = splitted.shift();\n                angular.forEach(splitted, function(value, index) {\n                    if (expression) {\n                        formatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n                    } else {\n                        formatted = formatted.split('{' + index + '}').join(prepend + value);\n                    }\n                });\n                if (expression) {\n                    return '\\'' + formatted + '\\'';\n                } else {\n                    return formatted;\n                }\n            } else {\n                return prepend + string;\n            }\n        }\n        var uniqueId = 0;\n        return {\n            restrict: 'A',\n            templateUrl: function(element, attributes) {\n                var template = 'artisan/forms/text';\n                switch (attributes.control) {\n                    case 'select':\n                        template = 'artisan/forms/select';\n                        break;\n                }\n                return template;\n            },\n            scope: {\n                ngModel: '=',\n                required: '=',\n                form: '@',\n                title: '@',\n                placeholder: '@',\n                source: '=?',\n                key: '@?',\n                label: '@?',\n            },\n            require: 'ngModel',\n            transclude: true,\n            link: {\n                pre: function preLink(scope, element, attributes, controller, transclude) {\n                    var label = scope.label = (scope.label ? scope.label : 'name');\n                    var key = scope.key = (scope.key ? scope.key : 'id');\n                    if (attributes.control === 'select') {\n                        var filter = (attributes.filter ? '| ' + attributes.filter : '');\n                        var optionLabel = formatLabel(label, 'item.', true);\n                        scope.getOptions = function() {\n                            return attributes.number ?\n                                'item.' + key + ' as ' + optionLabel + ' disable when item.disabled for item in source ' + filter :\n                                optionLabel + ' disable when item.disabled for item in source ' + filter + ' track by item.' + key;\n                        };\n                    }\n                    var type = scope.type = attributes.control;\n                    var form = scope.form = scope.form || 'form';\n                    var title = scope.title = scope.title || 'untitled';\n                    var placeholder = scope.placeholder = scope.placeholder || title;\n                    var field = scope.field = title.replace(/[^0-9a-zA-Z]/g, \"\").split(' ').join('') + (++uniqueId);\n                    scope.format = attributes.format || null;\n                    scope.precision = attributes.precision || null;\n                    scope.validate = attributes.validate || attributes.control;\n                    scope.minLength = attributes.minLength || 0;\n                    scope.maxLength = attributes.maxLength || Number.POSITIVE_INFINITY;\n                    scope.min = attributes.min || null;\n                    scope.max = attributes.max || null;\n                    scope.options = $parse(attributes.options)(scope) || {};\n                    scope.focus = false;\n                    scope.visible = false;\n                    scope.onChange = function(model) {\n                        $parse(attributes.onChange)(scope.$parent);\n                    };\n                    scope.onFilter = function(model) {\n                        $parse(attributes.onFilter)(scope.$parent);\n                    };\n                    scope.getType = function() {\n                        var type = 'text';\n                        switch (attributes.control) {\n                            case 'password':\n                                type = scope.visible ? 'text' : 'password';\n                                break;\n                            default:\n                                type = attributes.control;\n                        }\n                        return type;\n                    };\n                    scope.getClasses = function() {\n                        var form = $parse(scope.form)(scope.$parent);\n                        var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                        return {\n                            'control-focus': scope.focus,\n                            'control-success': field.$valid,\n                            'control-error': field.$invalid && (form.$submitted || field.$touched),\n                            'control-empty': !field.$viewValue\n                        };\n                    };\n                    scope.getMessages = function() {\n                        var form = $parse(scope.form)(scope.$parent);\n                        var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                        return (form.$submitted || field.$touched) && field.$error;\n                    };\n                    scope.toggleVisibility = function() {\n                        scope.visible = !scope.visible;\n                    };\n                },\n            },\n        };\n    }]);\n\n    app.directive('_control', ['$http', '$templateCache', '$compile', '$parse', function($http, $templateCache, $compile, $parse) {\n        function formatLabel(string, prepend, expression) {\n            string = string || '';\n            prepend = prepend || '';\n            var splitted = string.split(',');\n            if (splitted.length > 1) {\n                var formatted = splitted.shift();\n                angular.forEach(splitted, function(value, index) {\n                    if (expression) {\n                        formatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n                    } else {\n                        formatted = formatted.split('{' + index + '}').join(prepend + value);\n                    }\n                });\n                if (expression) {\n                    return '\\'' + formatted + '\\'';\n                } else {\n                    return formatted;\n                }\n            } else {\n                return prepend + string;\n            }\n        }\n        var uniqueId = 0;\n        return {\n            restrict: 'A',\n            templateUrl: function(element, attributes) {\n                var template = 'artisan/forms/text';\n                switch (attributes.control) {\n                    case 'select':\n                        template = 'artisan/forms/select';\n                        break;\n                }\n                return template;\n            },\n            scope: {\n                ngModel: '=',\n                required: '=',\n                form: '@',\n                title: '@',\n                placeholder: '@',\n            },\n            require: 'ngModel',\n            /*\n            link: function(scope, element, attributes, model) {\n            },\n            */\n            compile: function(element, attributes) {\n                    return {\n                        pre: function(scope, element, attributes) {\n                            if (attributes.control === 'select') {\n                                var label = (attributes.label ? attributes.label : 'name');\n                                var key = (attributes.key ? attributes.key : 'id');\n                                var filter = (attributes.min ? ' | filter:gte(\\'' + key + '\\', ' + attributes.min + ')' : '');\n                                var optionLabel = formatLabel(label, 'item.', true);\n                                scope.options = attributes.number ?\n                                    'item.' + key + ' as ' + optionLabel + ' disable when item.disabled for item in ' + attributes.source + filter :\n                                    optionLabel + ' disable when item.disabled for item in ' + attributes.source + filter + ' track by item.' + key;\n                                console.log('control.compile.pre', scope.options);\n                            }\n                            var type = scope.type = attributes.control;\n                            var form = scope.form = scope.form || 'form';\n                            var title = scope.title = scope.title || 'untitled';\n                            var placeholder = scope.placeholder = scope.placeholder || title;\n                            var field = scope.field = title.replace(/[^0-9a-zA-Z]/g, \"\").split(' ').join('') + (++uniqueId);\n                            scope.validate = attributes.validate || attributes.control;\n                            scope.format = attributes.format || null;\n                            scope.precision = attributes.precision || null;\n                            scope.validate = attributes.validate || attributes.control;\n                            scope.minLength = attributes.min || 0;\n                            scope.maxLength = attributes.max || Number.POSITIVE_INFINITY;\n                            scope.options = $parse(attributes.options)(scope) || {};\n                            scope.focus = false;\n                            scope.visible = false;\n                            scope.getType = function() {\n                                var type = 'text';\n                                switch (attributes.control) {\n                                    case 'password':\n                                        // var form = $parse(scope.form)(scope.$parent);\n                                        // var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                        type = scope.visible ? 'text' : 'password';\n                                        break;\n                                    default:\n                                        type = attributes.control;\n                                }\n                                // console.log('control.getType', type);\n                                return type;\n                            };\n                            scope.getClasses = function() {\n                                var form = $parse(scope.form)(scope.$parent);\n                                var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                return {\n                                    'control-focus': scope.focus,\n                                    'control-success': field.$valid,\n                                    'control-error': field.$invalid && (form.$submitted || field.$touched),\n                                    'control-empty': !field.$viewValue\n                                };\n                            };\n                            scope.getMessages = function() {\n                                var form = $parse(scope.form)(scope.$parent);\n                                var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                return (form.$submitted || field.$touched) && field.$error;\n                            };\n                        },\n                        // post: function (scope, element, attributes) { }\n                    };\n                }\n                /*\n                compile: function(element, attributes) {\n                    element.removeAttr('my-dir'); \n                    element.attr('ng-hide', 'true');\n                    return function(scope) {\n                        $compile(element)(scope);\n                    };\n                },\n                */\n        };\n    }]);\n\n    app.directive('numberPicker', ['$parse', '$timeout', function($parse, $timeout) {\n        return {\n            restrict: 'A',\n            template: '<div class=\"input-group\">' +\n                '   <span class=\"input-group-btn\"><button class=\"btn btn-outline-primary\" type=\"button\">-</button></span>' +\n                '   <div ng-transclude></div>' +\n                '   <span class=\"input-group-btn\"><button class=\"btn btn-outline-primary\" type=\"button\">+</button></span>' +\n                '</div>',\n            replace: true,\n            transclude: true,\n            link: function(scope, element, attributes, model) {\n                var node = element[0];\n                var nodeRemove = node.querySelectorAll('.input-group-btn > .btn')[0];\n                var nodeAdd = node.querySelectorAll('.input-group-btn > .btn')[1];\n\n                function onRemove(e) {\n                    var min = $parse(attributes.min)(scope);\n                    var getter = $parse(attributes.numberPicker);\n                    var setter = getter.assign;\n                    $timeout(function() {\n                        setter(scope, Math.max(min, getter(scope) - 1));\n                    });\n                    // console.log('numberPicker.onRemove', min);\n                }\n\n                function onAdd(e) {\n                    var max = $parse(attributes.max)(scope);\n                    var getter = $parse(attributes.numberPicker);\n                    var setter = getter.assign;\n                    $timeout(function() {\n                        setter(scope, Math.min(max, getter(scope) + 1));\n                    });\n                    // console.log('numberPicker.onAdd', max);\n                }\n\n                function addListeners() {\n                    angular.element(nodeRemove).on('touchstart mousedown', onRemove);\n                    angular.element(nodeAdd).on('touchstart mousedown', onAdd);\n                }\n\n                function removeListeners() {\n                    angular.element(nodeRemove).off('touchstart mousedown', onRemove);\n                    angular.element(nodeAdd).off('touchstart mousedown', onAdd);\n                }\n                scope.$on('$destroy', function() {\n                    removeListeners();\n                });\n                addListeners();\n            }\n        };\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.directive('validate', ['$filter', function($filter) {\n        return {\n            require: 'ngModel',\n            link: function(scope, element, attributes, model) {\n                var type = attributes.validate;\n                var format = attributes.format || '';\n                var precision = attributes.precision || 2;\n                var focus = false;\n                // console.log('validate', type);\n                switch (type) {\n                    case 'date':\n                    case 'datetime':\n                    case 'datetime-local':\n                        model.$formatters.push(function(value) {\n                            if (value) {\n                                return $filter('date')(value, format);\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                    case 'number':\n                        model.$parsers.unshift(function(value) {\n                            var valid = false;\n                            if (value !== undefined && value !== \"\") {\n                                valid = String(value).indexOf(Number(value).toString()) !== -1; // isFinite(value); // \n                                value = Number(value);\n                                model.$setValidity('number', valid);\n                                if (valid) {\n                                    model.$setValidity('positive', value >= 0.01);\n                                    if (attributes.min !== undefined) {\n                                        model.$setValidity('range', value >= Number(attributes.min));\n                                    }\n                                    if (attributes.max !== undefined) {\n                                        model.$setValidity('range', value <= Number(attributes.max));\n                                    }\n                                }\n                            } else {\n                                valid = true;\n                                value = Number(value);\n                                model.$setValidity('number', true);\n                                model.$setValidity('positive', true);\n                                if (attributes.min !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                                if (attributes.max !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                            }\n                            return value;\n                        });\n                        model.$formatters.push(function(value) {\n                            if (value) {\n                                return $filter('number')(value, precision) + ' ' + format;\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                    case 'anynumber':\n                        model.$parsers.unshift(function(value) {\n                            var valid = false;\n                            if (value !== undefined && value !== \"\") {\n                                valid = String(value).indexOf(Number(value).toString()) !== -1; // isFinite(value); // \n                                value = Number(value);\n                                model.$setValidity('number', valid);\n                                if (valid) {\n                                    if (attributes.min !== undefined) {\n                                        model.$setValidity('range', value >= Number(attributes.min));\n                                    }\n                                    if (attributes.max !== undefined) {\n                                        model.$setValidity('range', value <= Number(attributes.max));\n                                    }\n                                }\n                            } else {\n                                valid = true;\n                                value = Number(value);\n                                model.$setValidity('number', true);\n                                if (attributes.min !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                                if (attributes.max !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                            }\n                            return value;\n                        });\n                        model.$formatters.push(function(value) {\n                            if (value || value === 0) {\n                                return $filter('number')(value, precision) + ' ' + format;\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                }\n\n                function onFocus() {\n                    focus = true;\n                    if (format) {\n                        element[0].value = model.$modelValue || null;\n                        if (!model.$modelValue) {\n                            model.$setViewValue(null);\n                        }\n                    }\n                }\n\n                function doBlur() {\n                    if (format && !model.$invalid) {\n                        switch (type) {\n                            case 'date':\n                            case 'datetime':\n                            case 'datetime-local':\n                                element[0].value = model.$modelValue ? $filter('date')(model.$modelValue, format) : ' ';\n                                break;\n                            default:\n                                element[0].value = model.$modelValue ? $filter('number')(model.$modelValue, precision) + ' ' + format : ' ';\n                                break;\n                        }\n                    }\n                }\n\n                function onBlur() {\n                    focus = false;\n                    doBlur();\n                }\n\n                function addListeners() {\n                    element.on('focus', onFocus);\n                    element.on('blur', onBlur);\n                }\n\n                function removeListeners() {\n                    element.off('focus', onFocus);\n                    element.off('blur', onBlur);\n                }\n                scope.$on('$destroy', function() {\n                    removeListeners();\n                });\n                addListeners();\n            }\n        };\n    }]);\n\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.directive('modalView', ['$parse', '$templateRequest', '$compile', '$controller', 'Utils', function($parse, $templateRequest, $compile, $controller, Utils) {\r\n\r\n        function compileController(scope, element, html, data) {\r\n            // console.log('modalView.compileController', element);\r\n            element.html(html);\r\n            var link = $compile(element.contents());\r\n            if (data.controller) {\r\n                var $scope = scope.$new();\r\n                angular.extend($scope, data);\r\n                var controller = $controller(data.controller, { $scope: $scope });\r\n                if (data.controllerAs) {\r\n                    scope[data.controllerAs] = controller;\r\n                }\r\n                element.data('$ngControllerController', controller);\r\n                element.children().data('$ngControllerController', controller);\r\n                scope = $scope;\r\n            }\r\n            link(scope);\r\n        }\r\n\r\n        return {\r\n            restrict: 'A',\r\n            priority: -400,\r\n            link: function(scope, element, attributes, model) {\r\n                var modal = $parse(attributes.modalView);\r\n                modal = modal(scope);\r\n                modal.templateUrl = modal.templateUrl || 'artisan/modals/modal';\r\n                $templateRequest(modal.templateUrl).then(function(html) {\r\n                    compileController(scope, element, html, modal);\r\n                });\r\n                /*\r\n                // window.scrollTo(0, element[0].offsetTop - 100);\r\n                function onClick(e) {\r\n                    var closest = Utils.getClosestElement(e.target, element[0]);\r\n                    if (closest === null) {\r\n                        modal.reject(null);\r\n                    }\r\n                    // console.log('onClick', closest);\r\n                }\r\n                function addListeners() {\r\n                    angular.element(window).on('click', onClick);\r\n                }\r\n                function removeListeners() {\r\n                    angular.element(window).off('click', onClick);\r\n                }\r\n                scope.$on('destroy', function () {\r\n                    removeListeners();\r\n                });\r\n                setTimeout(function () {\r\n                    addListeners();\r\n                }, 500);\r\n                */\r\n            }\r\n        };\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.provider('$modal', [function $modalProvider() {\r\n\r\n        var modals = [];\r\n        var routes = {};\r\n\r\n        this.modals = modals;\r\n        this.routes = routes;\r\n        this.when = when;\r\n\r\n        function when(path, modal) {\r\n            routes[path] = modal;\r\n            return this;\r\n        }\r\n\r\n        this.$get = ['$q', '$timeout', function modalFactory($q, $timeout) {\r\n\r\n            function popModal(modal) {\r\n                // console.log('modalProvider.popModal', modal);                \r\n                var index = -1;\r\n                angular.forEach(modals, function(m, i) {\r\n                    if (m === modal) {\r\n                        index = i;\r\n                    }\r\n                });\r\n                if (index !== -1) {\r\n                    $timeout(function() {\r\n                        modal.active = false;\r\n                        modals.splice(index, 1);\r\n                        if (modals.length) {\r\n                            modals[modals.length - 1].active = true;\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n\r\n            function closeModal(modal) {\r\n                // console.log('modalProvider.closeModal', modal);                \r\n                var index = -1;\r\n                angular.forEach(modals, function(m, i) {\r\n                    if (m === modal) {\r\n                        index = i;\r\n                    }\r\n                });\r\n                if (index !== -1) {\r\n                    modal.active = false;\r\n                    $timeout(function() {\r\n                        while (modals.length) {\r\n                            modals.splice(modals.length - 1, 1);\r\n                        }\r\n                    }, 500);\r\n                }\r\n            }\r\n\r\n            function addModal(path, params) {\r\n                // console.log('modalProvider.addModal', path, params);\r\n                var deferred = $q.defer();\r\n                params = params || null;\r\n                var modal = {\r\n                    title: 'Untitled',\r\n                    controller: null,\r\n                    templateUrl: null,\r\n                    params: params,\r\n                };\r\n                var current = routes[path];\r\n                if (current) {\r\n                    angular.extend(modal, current);\r\n                }\r\n                modal.deferred = deferred;\r\n                modal.back = function(data) {\r\n                    popModal(this);\r\n                    modal.deferred.resolve(data, modal);\r\n                }\r\n                modal.resolve = function(data) {\r\n                    closeModal(this);\r\n                    modal.deferred.resolve(data, modal);\r\n                }\r\n                modal.reject = function() {\r\n                    closeModal(this);\r\n                    modal.deferred.reject(modal);\r\n                }\r\n                modals.push(modal);\r\n                angular.forEach(modals, function(m, i) {\r\n                    m.active = false;\r\n                });\r\n                if (modals.length) {\r\n                    modal.active = true;\r\n                } else {\r\n                    $timeout(function() {\r\n                        modal.active = true;\r\n                        // window.scrollTo(0, 0);\r\n                    }, 500);\r\n                }\r\n                return deferred.promise;\r\n            }\r\n\r\n            return {\r\n                modals: modals,\r\n                addModal: addModal,\r\n            };\r\n        }];\r\n\r\n    }]);\r\n\r\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.directive('nav', ['$parse', 'Nav', function ($parse, Nav) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\treturn attributes.template || 'artisan/nav/nav';\n\t\t\t},\n\t\t\tscope: {\n\t\t\t\titems: '=nav',\n\t\t\t},\n\t\t\tlink: function (scope, element, attributes, model) {\n\t\t\t\tscope.$watch('items', function (value) {\n\t\t\t\t\t// console.log(value instanceof Nav, value);\n\t\t\t\t\tif (value) {\n\t\t\t\t\t\tif (angular.isArray(value)) {\n\t\t\t\t\t\t\tvar onLink = $parse(attributes.onLink)(scope.$parent);\n\t\t\t\t\t\t\tvar onNav = $parse(attributes.onNav)(scope.$parent);\n\t\t\t\t\t\t\tvar nav = new Nav({\n\t\t\t\t\t\t\t\tonLink: onLink,\n\t\t\t\t\t\t\t\tonNav: onNav\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tnav.setItems(value);\n\t\t\t\t\t\t\tscope.item = nav;\n\n\t\t\t\t\t\t} else if (value instanceof Nav) {\n\t\t\t\t\t\t\tscope.item = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n    }]);\n\n\tapp.directive('navItem', ['$timeout', function ($timeout) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\treturn attributes.template || 'artisan/nav/nav-item';\n\t\t\t},\n\t\t\tscope: {\n\t\t\t\titem: '=navItem',\n\t\t\t},\n\t\t\tlink: function (scope, element, attributes, model) {\n\t\t\t\tvar navItem = angular.element(element[0].querySelector('.nav-link'));\n\n\t\t\t\tvar output;\n\n\t\t\t\tfunction itemOpen(item, immediate) {\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tstate.active = true;\n\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tstate.immediate = immediate;\n\t\t\t\t\t\tstate.closed = state.closing = false;\n\t\t\t\t\t\tstate.opening = true;\n\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\tstate.opening = false;\n\t\t\t\t\t\t\tstate.opened = true;\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction itemClose(item, immediate) {\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tstate.active = false;\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tstate.immediate = immediate;\n\t\t\t\t\t\tstate.opened = state.opening = false;\n\t\t\t\t\t\tstate.closing = true;\n\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\tstate.closing = false;\n\t\t\t\t\t\t\tstate.closed = true;\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tif (item.items) {\n\t\t\t\t\t\tangular.forEach(item.items, function (o) {\n\t\t\t\t\t\t\titemClose(o, true);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction itemToggle(item) {\n\t\t\t\t\t// console.log('itemToggle', item);\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tstate.active = item.items ? !state.active : true;\n\t\t\t\t\tif (state.active) {\n\t\t\t\t\t\tif (item.$nav.parent) {\n\t\t\t\t\t\t\tangular.forEach(item.$nav.parent.items, function (o) {\n\t\t\t\t\t\t\t\tif (o !== item) {\n\t\t\t\t\t\t\t\t\titemClose(o, true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\titemOpen(item);\n\t\t\t\t\t} else {\n\t\t\t\t\t\titemClose(item);\n\t\t\t\t\t}\n\t\t\t\t\t// console.log(state);\n\t\t\t\t}\n\n\t\t\t\tfunction onTap(e) {\n\t\t\t\t\tvar item = scope.item;\n\t\t\t\t\t// console.log('Item.onTap', item);\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tif (state.active) {\n\t\t\t\t\t\toutput = false;\n\t\t\t\t\t\ttrigger();\n\t\t\t\t\t} else if (item.$nav.onNav) {\n\t\t\t\t\t\tvar promise = item.$nav.onNav(item, item.$nav);\n\t\t\t\t\t\tif (promise && typeof promise.then === 'function') {\n\t\t\t\t\t\t\tpromise.then(function (resolved) {\n\t\t\t\t\t\t\t\t// go on\n\t\t\t\t\t\t\t\ttrigger();\n\t\t\t\t\t\t\t}, function (rejected) {\n\t\t\t\t\t\t\t\t// do nothing\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\toutput = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\toutput = promise;\n\t\t\t\t\t\t\ttrigger();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction trigger() {\n\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\titemToggle(item);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onTouchStart(e) {\n\t\t\t\t\t// console.log('Item.onTouchStart', e);\n\t\t\t\t\tonTap(e);\n\t\t\t\t\tnavItem\n\t\t\t\t\t\t.off('mousedown', onMouseDown);\n\t\t\t\t\t// return r || prevent(e);\n\t\t\t\t}\n\n\t\t\t\tfunction onMouseDown(e) {\n\t\t\t\t\t// console.log('Item.onMouseDown', e);\n\t\t\t\t\tonTap(e);\n\t\t\t\t\tnavItem\n\t\t\t\t\t\t.off('touchstart', onTouchStart);\n\t\t\t\t\t// return r || prevent(e);\n\t\t\t\t}\n\n\t\t\t\tfunction onClick(e) {\n\t\t\t\t\t// console.log('Item.onClick', e);\n\t\t\t\t\treturn prevent(e);\n\t\t\t\t}\n\n\t\t\t\tfunction prevent(e) {\n\t\t\t\t\tif (output === false) {\n\t\t\t\t\t\t// console.log('Item.prevent', e);\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t// e.stopPropagation();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction addListeners() {\n\t\t\t\t\tnavItem\n\t\t\t\t\t\t.on('touchstart', onTouchStart)\n\t\t\t\t\t\t.on('mousedown', onMouseDown)\n\t\t\t\t\t\t.on('click', onClick);\n\t\t\t\t}\n\n\t\t\t\tfunction removeListeners() {\n\t\t\t\t\tnavItem\n\t\t\t\t\t\t.off('touchstart', onTouchStart)\n\t\t\t\t\t\t.off('mousedown', onMouseDown)\n\t\t\t\t\t\t.off('click', onClick);\n\t\t\t\t}\n\n\t\t\t\taddListeners();\n\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tremoveListeners();\n\t\t\t\t});\n\t\t\t}\n\t\t};\n    }]);\n\n}());\n\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('Nav', ['$silent', function($silent) {\n        function Nav(options) {\n            var nav = this;\n            var defaults = {\n                items: [],\n            }\n            angular.extend(nav, defaults);\n            if (options) {\n                angular.extend(nav, options);\n            }\n            nav.setNav(nav, null);\n        }\n        Nav.prototype = {\n            setItems: function(items) {\n                var nav = this;\n                nav.path = $silent.path();\n                nav.items = items;\n                nav.setNavs(items, nav);\n            },\n            setNavs: function(items, parent) {\n                var nav = this;\n                if (items) {\n                    angular.forEach(items, function(item) {\n                        nav.setNav(item, parent);\n                        nav.setNavs(item.items, item);\n                    });\n                }\n            },\n            setNav: function(item, parent) {\n                var nav = this;\n                var $nav = {\n                    parent: parent || null,\n                    level: parent ? parent.$nav.level + 1 : 0,\n                    state: {},\n                    addItems: function(x) {\n                        nav.addItems(x, item);\n                    },\n                    onNav: nav.onNav,\n                };\n                item.$nav = $nav;\n                $nav.link = nav.getLink(item);\n                if ($nav.link === nav.path) {\n                    $nav.state.active = true;\n                    $nav.state.opened = true;\n                    while ($nav.parent) {\n                        $nav = $nav.parent.$nav;\n                        $nav.state.active = true;\n                        $nav.state.opened = true;\n                    }\n                }\n            },\n            addItems: function(itemOrItems, parent) {\n                var nav = this;\n                if (angular.isArray(itemOrItems)) {\n                    angular.forEach(itemOrItems, function(item) {\n                        nav.addItem(item, parent);\n                    });\n                } else {\n                    nav.addItem(itemOrItems, parent);\n                }\n            },\n            addItem: function(item, parent) {\n                var nav = this,\n                    onLink = nav.onLink,\n                    onNav = nav.onNav;\n                nav.setNav(item, parent);\n                if (parent) {\n                    parent.items = parent.items || [];\n                    parent.items.push(item);\n                }\n            },\n            getLink: function(item) {\n                var link = null;\n                if (this.onLink) {\n                    link = this.onLink(item, item.$nav);\n                } else {\n                    link = item.link;\n                }\n                return link;\n            },\n        };\n        var statics = {\n            silent: function(path) {\n                $silent.silent(path);\n            },\n            path: function(path) {\n                $silent.path(path);\n            },\n        };\n        angular.extend(Nav, statics);\n        return Nav;\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.directive('scrollableX', ['$parse', '$compile', '$window', '$timeout', 'Scrollable', 'Animate', 'Style', 'Events', 'Utils', function ($parse, $compile, $window, $timeout, Scrollable, Animate, Style, Events, Utils) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplate: '<div class=\"content\" ng-transclude></div>',\n\t\t\ttransclude: true,\n\t\t\tlink: function (scope, element, attributes, model) {\n\n\t\t\t\t$window.ondragstart = function () {\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\n\t\t\t\t// CONSTS;\n\t\t\t\tvar padding = 150;\n\n\t\t\t\t// FLAGS;            \n\t\t\t\tvar dragging, wheeling, busy;\n\n\t\t\t\t// MOUSE;\n\t\t\t\tvar down, move, prev, up;\n\n\t\t\t\t// COORDS;\n\t\t\t\tvar s = {\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: 0\n\t\t\t\t\t},\n\t\t\t\t\te = {\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: 0\n\t\t\t\t\t},\n\t\t\t\t\tc = {\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: 0\n\t\t\t\t\t},\n\t\t\t\t\ti = {\n\t\t\t\t\t\tx: 45,\n\t\t\t\t\t\ty: 0\n\t\t\t\t\t},\n\t\t\t\t\tl = {\n\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\tright: 0,\n\t\t\t\t\t\tbottom: 0,\n\t\t\t\t\t\tleft: 0\n\t\t\t\t\t},\n\t\t\t\t\tspeed = 0;\n\n\t\t\t\tvar scrollable, onLeft, onRight, showIndicatorFor, scrollableWhen;\n\t\t\t\tif (attributes.scrollableX) {\n\t\t\t\t\tscrollable = $parse(attributes.scrollableX)(scope);\n\t\t\t\t} else {\n\t\t\t\t\tscrollable = new Scrollable();\n\t\t\t\t}\n\t\t\t\tscrollable.link({\n\t\t\t\t\treset: function () {\n\t\t\t\t\t\te.x = c.x = 0;\n\t\t\t\t\t\tredraw();\n\t\t\t\t\t},\n\t\t\t\t\tdoLeft: doLeft,\n\t\t\t\t\tdoRight: doRight,\n\t\t\t\t});\n\t\t\t\tif (attributes.onLeft !== undefined) {\n\t\t\t\t\tonLeft = $parse(attributes.onLeft, /* interceptorFn */ null, /* expensiveChecks */ true);\n\t\t\t\t}\n\t\t\t\tif (attributes.onRight !== undefined) {\n\t\t\t\t\tonRight = $parse(attributes.onRight, /* interceptorFn */ null, /* expensiveChecks */ true);\n\t\t\t\t}\n\t\t\t\tif (attributes.showIndicatorFor !== undefined) {\n\t\t\t\t\tshowIndicatorFor = $parse(attributes.showIndicatorFor, /* interceptorFn */ null, /* expensiveChecks */ true);\n\t\t\t\t}\n\t\t\t\tif (attributes.scrollableWhen !== undefined) {\n\t\t\t\t\tscrollableWhen = $parse(attributes.scrollableWhen, /* interceptorFn */ null, /* expensiveChecks */ true);\n\t\t\t\t}\n\n\t\t\t\t// console.log('showIndicatorFor', showIndicatorFor);\n\n\t\t\t\t// ELEMENTS & STYLESHEETS;\n\t\t\t\telement.attr('unselectable', 'on').addClass('unselectable');\n\t\t\t\tvar elementNode = element[0];\n\t\t\t\tvar contentNode = elementNode.querySelector('.content');\n\t\t\t\tvar content = angular.element(content);\n\t\t\t\tvar contentStyle = new Style();\n\t\t\t\tvar indicator = null,\n\t\t\t\t\tindicatorNode = null,\n\t\t\t\t\tindicatorStyle;\n\t\t\t\tshowIndicatorFor = false;\n\t\t\t\tif (showIndicatorFor) {\n\t\t\t\t\tindicator = angular.element('<div class=\"indicator\"></div>');\n\t\t\t\t\tindicatorNode = indicator[0];\n\t\t\t\t\tindicatorStyle = new Style();\n\t\t\t\t\telement.append(indicator);\n\t\t\t\t\t$compile(indicator.contents())(scope);\n\t\t\t\t\tindicatorStyle.transform('translate3d(' + i.x.toFixed(2) + 'px,' + i.y.toFixed(2) + 'px,0)');\n\t\t\t\t\tindicatorStyle.set(indicatorNode);\n\t\t\t\t}\n\n\t\t\t\tvar animate = new Animate(redraw);\n\n\t\t\t\tfunction render(time) {\n\t\t\t\t\tscrollable.renderX(isEnabled(), dragging, wheeling, move, down);\n\t\t\t\t\tcontentStyle.transform('translate3d(' + c.x.toFixed(2) + 'px,0,0)');\n\t\t\t\t\tcontentStyle.set(contentNode);\n\t\t\t\t\t/*\n\t\t\t\t\tif (showIndicatorFor) {\n\t\t\t\t\t    if (dragging || wheeling || speed) {\n\t\t\t\t\t        var percent = c.x / (elementNode.offsetWidth - contentNode.offsetWidth);\n\t\t\t\t\t        percent = Math.max(0, Math.min(1, percent));\n\t\t\t\t\t        i.x = (elementNode.offsetWidth - indicatorNode.offsetWidth) * (percent);\n\t\t\t\t\t        i.y += (0 - i.y) / 4;\n\t\t\t\t\t        // var count = Math.round(contentNode.offsetWidth / 315);\n\t\t\t\t\t        var index = Math.max(1, Math.round(percent * showIndicatorFor.rows.length));\n\t\t\t\t\t        indicator.html(index + '/' + showIndicatorFor.count);\n\t\t\t\t\t        // indicator.html((percent * 100).toFixed(2).toString());\n\t\t\t\t\t    } else {\n\t\t\t\t\t        i.y += (45 - i.y) / 4;\n\t\t\t\t\t    }\n\t\t\t\t\t    indicatorStyle.transform('translate3d(' + i.x.toFixed(2) + 'px,' + i.y.toFixed(2) + 'px,0)');\n\t\t\t\t\t    indicatorStyle.set(indicatorNode);\n\t\t\t\t\t}\n\t\t\t\t\t*/\n\t\t\t\t}\n\n\t\t\t\tfunction redraw(time) {\n\t\t\t\t\tif (isEnabled()) {\n\t\t\t\t\t\t// if (!busy) {\n\t\t\t\t\t\tl.left = 0;\n\t\t\t\t\t\tl.right = elementNode.offsetWidth - contentNode.offsetWidth;\n\t\t\t\t\t\tif (dragging) {\n\t\t\t\t\t\t\te.x = s.x + move.x - down.x;\n\t\t\t\t\t\t\tbounce();\n\t\t\t\t\t\t\t// console.log('dragging', Math.abs(speed));\n\n\t\t\t\t\t\t} else if (speed) {\n\t\t\t\t\t\t\te.x += speed;\n\t\t\t\t\t\t\tspeed *= 0.75;\n\t\t\t\t\t\t\tif (wheeling) {\n\t\t\t\t\t\t\t\tbounce();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// console.log('wheeling', Math.abs(speed));\n\t\t\t\t\t\t\tif (Math.abs(speed) < 0.05) {\n\t\t\t\t\t\t\t\tspeed = 0;\n\t\t\t\t\t\t\t\te.x = s.x = c.x;\n\t\t\t\t\t\t\t\twheeling = false;\n\t\t\t\t\t\t\t\t// animate.pause();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// }\n\t\t\t\t\t\te.x = Math.min(l.left, e.x);\n\t\t\t\t\t\te.x = Math.max(l.right, e.x);\n\t\t\t\t\t\tc.x += (e.x - c.x) / 4;\n\t\t\t\t\t\tcontentStyle.transform('translate3d(' + c.x.toFixed(2) + 'px,0,0)');\n\t\t\t\t\t\tcontentStyle.set(contentNode);\n\t\t\t\t\t\tif (showIndicatorFor) {\n\t\t\t\t\t\t\tif (dragging || wheeling || speed) {\n\t\t\t\t\t\t\t\tvar percent = c.x / (elementNode.offsetWidth - contentNode.offsetWidth);\n\t\t\t\t\t\t\t\tpercent = Math.max(0, Math.min(1, percent));\n\t\t\t\t\t\t\t\ti.x = (elementNode.offsetWidth - indicatorNode.offsetWidth) * (percent);\n\t\t\t\t\t\t\t\ti.y += (0 - i.y) / 4;\n\t\t\t\t\t\t\t\t// var count = Math.round(contentNode.offsetWidth / 315);\n\t\t\t\t\t\t\t\tvar index = Math.max(1, Math.round(percent * showIndicatorFor.rows.length));\n\t\t\t\t\t\t\t\tindicator.html(index + '/' + showIndicatorFor.count);\n\t\t\t\t\t\t\t\t// indicator.html((percent * 100).toFixed(2).toString());\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ti.y += (45 - i.y) / 4;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tindicatorStyle.transform('translate3d(' + i.x.toFixed(2) + 'px,' + i.y.toFixed(2) + 'px,0)');\n\t\t\t\t\t\t\tindicatorStyle.set(indicatorNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// console.log('dragging', dragging, 'wheeling', wheeling, 'speed', speed);\n\t\t\t\t\t\t// console.log('elementNode.offsetWidth', elementNode.offsetWidth, 'contentNode.offsetWidth', contentNode.offsetWidth, 'diff', l.right, 'e.x', e.x);                        \n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontentStyle.transform('translate3d(0,0,0)');\n\t\t\t\t\t\tcontentStyle.set(contentNode);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction bounce() {\n\t\t\t\t\tl.left += padding;\n\t\t\t\t\tl.right -= padding;\n\t\t\t\t\tif (e.x > l.left) {\n\t\t\t\t\t\tdoLeft();\n\t\t\t\t\t} else if (e.x < l.right) {\n\t\t\t\t\t\tdoRight();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction doLeft() {\n\t\t\t\t\tif (busy) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (!onLeft) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbusy = true;\n\t\t\t\t\tonLeft(scope).then().finally(function () {\n\t\t\t\t\t\ts.x = e.x = 0;\n\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\tundrag();\n\t\t\t\t\t\t\tbusy = false;\n\t\t\t\t\t\t}, 500);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction doRight() {\n\t\t\t\t\tif (busy) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (!onRight) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbusy = true;\n\t\t\t\t\tonRight(scope).then().finally(function () {\n\t\t\t\t\t\tvar right = elementNode.offsetWidth - contentNode.offsetWidth;\n\t\t\t\t\t\tif (right > l.right) {\n\t\t\t\t\t\t\ts.x = e.x = l.right;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ts.x = e.x = l.right + padding;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\tundrag();\n\t\t\t\t\t\t\tbusy = false;\n\t\t\t\t\t\t}, 500);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction undrag() {\n\t\t\t\t\t// console.log('undrag');\n\t\t\t\t\tdragging = false;\n\t\t\t\t\twheeling = false;\n\t\t\t\t\tmove = null;\n\t\t\t\t\tdown = null;\n\t\t\t\t\tremoveDragListeners();\n\t\t\t\t}\n\n\t\t\t\tfunction onDown(event) {\n\t\t\t\t\tif (event.type == 'touchstart') {\n\t\t\t\t\t\telement.off('mousedown', onDown);\n\t\t\t\t\t}\n\t\t\t\t\tif (!busy) {\n\t\t\t\t\t\ts.x = e.x = c.x;\n\t\t\t\t\t\tspeed = 0;\n\t\t\t\t\t\tdown = Utils.getTouch(event);\n\t\t\t\t\t\twheeling = false;\n\t\t\t\t\t\t// console.log(down);\n\t\t\t\t\t\taddDragListeners();\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onMove(event) {\n\t\t\t\t\tif (event.type == 'touchmove') {\n\t\t\t\t\t\tangular.element($window).off('mousemove', onMove);\n\t\t\t\t\t}\n\t\t\t\t\tprev = move;\n\t\t\t\t\tmove = Utils.getTouch(event);\n\t\t\t\t\tdragging = true;\n\t\t\t\t\t// console.log(move);\n\t\t\t\t}\n\n\t\t\t\tfunction onUp(event) {\n\t\t\t\t\tif (event.type == 'touchend') {\n\t\t\t\t\t\tangular.element($window).off('mouseup', onUp);\n\t\t\t\t\t}\n\t\t\t\t\tif (move && prev) {\n\t\t\t\t\t\tspeed += (move.x - prev.x) * 4;\n\t\t\t\t\t}\n\t\t\t\t\ts.x = e.x = c.x;\n\t\t\t\t\tdragging = false;\n\t\t\t\t\tmove = null;\n\t\t\t\t\tdown = null;\n\t\t\t\t\tprev = null;\n\t\t\t\t\tup = Utils.getTouch(event);\n\t\t\t\t\t// console.log(up);\n\t\t\t\t\tremoveDragListeners();\n\t\t\t\t}\n\n\t\t\t\tfunction getWheelIncrement() {\n\t\t\t\t\tvar increment = (contentNode.offsetWidth - elementNode.offsetWidth) / 20;\n\t\t\t\t\tincrement = Math.min(10, Math.max(100, increment));\n\t\t\t\t\treturn increment;\n\t\t\t\t}\n\n\t\t\t\tfunction _onWheel(e) {\n\t\t\t\t\tif (!busy && isEnabled()) {\n\t\t\t\t\t\tif (!e) e = $window.event;\n\t\t\t\t\t\te = e.originalEvent ? e.originalEvent : e;\n\t\t\t\t\t\tvar dir = (((e.deltaY < 0 || e.wheelDelta > 0) || e.deltaY < 0) ? 1 : -1);\n\t\t\t\t\t\tspeed += dir * getWheelIncrement();\n\t\t\t\t\t\twheeling = true;\n\t\t\t\t\t\t// console.log('_onWheel.speed', speed);\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar onWheel = Utils.throttle(_onWheel, 25);\n\n\t\t\t\tfunction off() {\n\t\t\t\t\tremoveDragListeners();\n\t\t\t\t\tanimate.pause();\n\t\t\t\t\tundrag();\n\t\t\t\t}\n\n\t\t\t\tfunction isEnabled() {\n\t\t\t\t\tvar enabled = true;\n\t\t\t\t\tif (scrollableWhen) {\n\t\t\t\t\t\tenabled = enabled && scrollableWhen(scope);\n\t\t\t\t\t}\n\t\t\t\t\tenabled = enabled && $window.innerWidth >= 1024;\n\t\t\t\t\tenabled = enabled && (elementNode.offsetWidth < contentNode.offsetWidth);\n\t\t\t\t\treturn enabled;\n\t\t\t\t}\n\n\t\t\t\tfunction onResize() {\n\t\t\t\t\tif (!isEnabled()) {\n\t\t\t\t\t\toff();\n\t\t\t\t\t}\n\t\t\t\t\tredraw();\n\t\t\t\t}\n\n\t\t\t\tscope.$watch(function () {\n\t\t\t\t\treturn contentNode.offsetWidth;\n\t\t\t\t}, function (newValue, oldValue) {\n\t\t\t\t\tonResize();\n\t\t\t\t});\n\n\t\t\t\tfunction addListeners() {\n\t\t\t\t\tangular.element($window).on('resize', onResize);\n\t\t\t\t\telement.on('touchstart mousedown', onDown);\n\t\t\t\t\telement.on('wheel', onWheel);\n\t\t\t\t\t// element.addEventListener('DOMMouseScroll',handleScroll,false); // for Firefox\n\t\t\t\t\t// element.addEventListener('mousewheel',    handleScroll,false); // for everyone else\n\t\t\t\t}\n\n\t\t\t\tfunction removeListeners() {\n\t\t\t\t\tangular.element($window).off('resize', onResize);\n\t\t\t\t\telement.off('touchstart mousedown', onDown);\n\t\t\t\t\telement.off('wheel', onWheel);\n\t\t\t\t}\n\n\t\t\t\tfunction addDragListeners() {\n\t\t\t\t\tangular.element($window).on('touchmove mousemove', onMove);\n\t\t\t\t\tangular.element($window).on('touchend mouseup', onUp);\n\t\t\t\t}\n\n\t\t\t\tfunction removeDragListeners() {\n\t\t\t\t\tangular.element($window).off('touchmove mousemove', onMove);\n\t\t\t\t\tangular.element($window).off('touchend mouseup', onUp);\n\t\t\t\t}\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tremoveListeners();\n\t\t\t\t\tanimate.pause();\n\t\t\t\t});\n\n\t\t\t\taddListeners();\n\n\t\t\t},\n\t\t};\n    }]);\n\n\tapp.directive('scrollableY', ['$parse', '$compile', '$window', '$timeout', 'Scrollable', 'Animate', 'Style', 'Events', 'Utils', function ($parse, $compile, $window, $timeout, Scrollable, Animate, Style, Events, Utils) {\n\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplate: '<div class=\"content\" ng-transclude></div>',\n\t\t\ttransclude: true,\n\t\t\tlink: function (scope, element, attributes, model) {\n\t\t\t\t$window.ondragstart = function () {\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\n\t\t\t\t// CONSTS;\n\t\t\t\tvar padding = 150;\n\n\t\t\t\t// FLAGS;            \n\t\t\t\tvar dragging, wheeling, busy;\n\n\t\t\t\t// MOUSE;\n\t\t\t\tvar down, move, prev, up;\n\n\t\t\t\t// COORDS;\n\t\t\t\tvar s = {\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: 0\n\t\t\t\t\t},\n\t\t\t\t\te = {\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: 0\n\t\t\t\t\t},\n\t\t\t\t\tc = {\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: 0\n\t\t\t\t\t},\n\t\t\t\t\ti = {\n\t\t\t\t\t\tx: 45,\n\t\t\t\t\t\ty: 0\n\t\t\t\t\t},\n\t\t\t\t\tl = {\n\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\tright: 0,\n\t\t\t\t\t\tbottom: 0,\n\t\t\t\t\t\tleft: 0\n\t\t\t\t\t},\n\t\t\t\t\tspeed = 0;\n\n\t\t\t\tvar scrollable, onTop, onBottom, showIndicatorFor, scrollableWhen;\n\t\t\t\tif (attributes.scrollableY) {\n\t\t\t\t\tscrollable = $parse(attributes.scrollableY)(scope);\n\t\t\t\t} else {\n\t\t\t\t\tscrollable = new Scrollable();\n\t\t\t\t}\n\t\t\t\tscrollable.link({\n\t\t\t\t\treset: function () {\n\t\t\t\t\t\te.y = c.y = 0;\n\t\t\t\t\t\tredraw();\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tif (attributes.onTop !== undefined) {\n\t\t\t\t\tonTop = $parse(attributes.onTop, /* interceptorFn */ null, /* expensiveChecks */ true);\n\t\t\t\t}\n\t\t\t\tif (attributes.onBottom !== undefined) {\n\t\t\t\t\tonBottom = $parse(attributes.onBottom, /* interceptorFn */ null, /* expensiveChecks */ true);\n\t\t\t\t}\n\t\t\t\tif (attributes.showIndicatorFor !== undefined) {\n\t\t\t\t\tshowIndicatorFor = $parse(attributes.showIndicatorFor, /* interceptorFn */ null, /* expensiveChecks */ true);\n\t\t\t\t}\n\t\t\t\tif (attributes.scrollableWhen !== undefined) {\n\t\t\t\t\tscrollableWhen = $parse(attributes.scrollableWhen, /* interceptorFn */ null, /* expensiveChecks */ true);\n\t\t\t\t}\n\t\t\t\t// console.log('showIndicatorFor', showIndicatorFor);\n\n\t\t\t\t// ELEMENTS & STYLESHEETS;\n\t\t\t\telement.attr('unselectable', 'on').addClass('unselectable');\n\n\t\t\t\tvar elementNode = element[0];\n\t\t\t\tvar contentNode = elementNode.querySelector('.content');\n\t\t\t\tvar content = angular.element(content);\n\t\t\t\tvar contentStyle = new Style();\n\t\t\t\tvar indicator = null,\n\t\t\t\t\tindicatorNode = null,\n\t\t\t\t\tindicatorStyle;\n\t\t\t\tshowIndicatorFor = false;\n\t\t\t\tif (showIndicatorFor) {\n\t\t\t\t\tindicator = angular.element('<div class=\"indicator\"></div>');\n\t\t\t\t\tindicatorNode = indicator[0];\n\t\t\t\t\tindicatorStyle = new Style();\n\t\t\t\t\telement.append(indicator);\n\t\t\t\t\t$compile(indicator.contents())(scope);\n\t\t\t\t\tindicatorStyle.transform('translate3d(' + i.x.toFixed(2) + 'px,' + i.y.toFixed(2) + 'px,0)');\n\t\t\t\t\tindicatorStyle.set(indicatorNode);\n\t\t\t\t}\n\n\t\t\t\tvar animate = new Animate(redraw);\n\n\t\t\t\tfunction redraw(time) {\n\t\t\t\t\tif (isEnabled()) {\n\t\t\t\t\t\t// if (!busy) {\n\t\t\t\t\t\tl.top = 0;\n\t\t\t\t\t\tl.bottom = elementNode.offsetHeight - contentNode.offsetHeight;\n\t\t\t\t\t\tif (dragging) {\n\t\t\t\t\t\t\te.y = s.y + move.y - down.y;\n\t\t\t\t\t\t\tbounce();\n\t\t\t\t\t\t} else if (speed) {\n\t\t\t\t\t\t\te.y += speed;\n\t\t\t\t\t\t\tspeed *= 0.75;\n\t\t\t\t\t\t\tif (wheeling) {\n\t\t\t\t\t\t\t\tbounce();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (Math.abs(speed) < 0.05) {\n\t\t\t\t\t\t\t\tspeed = 0;\n\t\t\t\t\t\t\t\te.y = s.y = c.y;\n\t\t\t\t\t\t\t\twheeling = false;\n\t\t\t\t\t\t\t\tanimate.pause();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// }\n\t\t\t\t\t\te.y = Math.min(l.top, e.y);\n\t\t\t\t\t\te.y = Math.max(l.bottom, e.y);\n\t\t\t\t\t\tc.y += (e.y - c.y) / 4;\n\t\t\t\t\t\tcontentStyle.transform('translate3d(0,' + c.y.toFixed(2) + 'px,0)');\n\t\t\t\t\t\tcontentStyle.set(contentNode);\n\t\t\t\t\t\tif (showIndicatorFor) {\n\t\t\t\t\t\t\tif (dragging || wheeling || speed) {\n\t\t\t\t\t\t\t\tvar percent = c.y / (elementNode.offsetHeight - contentNode.offsetHeight);\n\t\t\t\t\t\t\t\tpercent = Math.max(0, Math.min(1, percent));\n\t\t\t\t\t\t\t\ti.y = (elementNode.offsetHeight - indicatorNode.offsetHeight) * (percent);\n\t\t\t\t\t\t\t\ti.x += (0 - i.x) / 4;\n\t\t\t\t\t\t\t\t// var count = Math.round(contentNode.offsetHeight / 315);\n\t\t\t\t\t\t\t\tvar index = Math.max(1, Math.round(percent * showIndicatorFor.rows.length));\n\t\t\t\t\t\t\t\tindicator.html(index + '/' + showIndicatorFor.count);\n\t\t\t\t\t\t\t\t// indicator.html((percent * 100).toFixed(2).toString());\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ti.x += (45 - i.x) / 4;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tindicatorStyle.transform('translate3d(' + i.x.toFixed(2) + 'px,' + i.y.toFixed(2) + 'px,0)');\n\t\t\t\t\t\t\tindicatorStyle.set(indicatorNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction doTop() {\n\t\t\t\t\tif (busy) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (!onTop) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbusy = true;\n\t\t\t\t\tonTop(scope).then().finally(function () {\n\t\t\t\t\t\ts.y = e.y = 0;\n\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\tundrag();\n\t\t\t\t\t\t\tbusy = false;\n\t\t\t\t\t\t}, 500);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction doBottom() {\n\t\t\t\t\tif (busy) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (!onBottom) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbusy = true;\n\t\t\t\t\tonBottom(scope).then().finally(function () {\n\t\t\t\t\t\tvar bottom = elementNode.offsetHeight - contentNode.offsetHeight;\n\t\t\t\t\t\tif (bottom > l.bottom) {\n\t\t\t\t\t\t\ts.y = e.y = l.bottom;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ts.y = e.y = l.bottom + padding;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\tundrag();\n\t\t\t\t\t\t\tbusy = false;\n\t\t\t\t\t\t}, 500);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction undrag() {\n\t\t\t\t\t// console.log('undrag');\n\t\t\t\t\tdragging = false;\n\t\t\t\t\twheeling = false;\n\t\t\t\t\tmove = null;\n\t\t\t\t\tdown = null;\n\t\t\t\t\tremoveDragListeners();\n\t\t\t\t}\n\n\t\t\t\tfunction bounce() {\n\t\t\t\t\tl.top += padding;\n\t\t\t\t\tl.bottom -= padding;\n\t\t\t\t\tif (e.y > l.top) {\n\t\t\t\t\t\tdoTop();\n\t\t\t\t\t} else if (e.y < l.bottom) {\n\t\t\t\t\t\tdoBottom();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onDown(event) {\n\t\t\t\t\tif (event.type == 'touchstart') {\n\t\t\t\t\t\telement.off('mousedown', onDown);\n\t\t\t\t\t}\n\t\t\t\t\tif (!busy) {\n\t\t\t\t\t\ts.y = e.y = c.y;\n\t\t\t\t\t\tspeed = 0;\n\t\t\t\t\t\tdown = Utils.getTouch(event);\n\t\t\t\t\t\twheeling = false;\n\t\t\t\t\t\t// console.log(down);\n\t\t\t\t\t\taddDragListeners();\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onMove(event) {\n\t\t\t\t\tif (event.type == 'touchmove') {\n\t\t\t\t\t\tangular.element($window).off('mousemove', onMove);\n\t\t\t\t\t}\n\t\t\t\t\tprev = move;\n\t\t\t\t\tmove = Utils.getTouch(event);\n\t\t\t\t\tdragging = true;\n\t\t\t\t\t// console.log(move);\n\t\t\t\t}\n\n\t\t\t\tfunction onUp(event) {\n\t\t\t\t\tif (event.type == 'touchend') {\n\t\t\t\t\t\tangular.element($window).off('mouseup', onUp);\n\t\t\t\t\t}\n\t\t\t\t\tif (move && prev) {\n\t\t\t\t\t\tspeed += (move.y - prev.y) * 4;\n\t\t\t\t\t}\n\t\t\t\t\ts.y = e.y = c.y;\n\t\t\t\t\tdragging = false;\n\t\t\t\t\tmove = null;\n\t\t\t\t\tdown = null;\n\t\t\t\t\tprev = null;\n\t\t\t\t\tup = Utils.getTouch(event);\n\t\t\t\t\t// console.log(up);\n\t\t\t\t\tremoveDragListeners();\n\t\t\t\t}\n\n\t\t\t\tfunction _onWheel(e) {\n\t\t\t\t\tif (!busy && isEnabled()) {\n\t\t\t\t\t\tif (!e) e = $window.event;\n\t\t\t\t\t\te = e.originalEvent ? e.originalEvent : e;\n\t\t\t\t\t\tvar dir = (((e.deltaY < 0 || e.wheelDelta > 0) || e.deltaY < 0) ? 1 : -1);\n\t\t\t\t\t\tspeed += dir * 5;\n\t\t\t\t\t\twheeling = true;\n\t\t\t\t\t\tanimate.play();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar onWheel = Utils.throttle(_onWheel, 25);\n\n\t\t\t\tfunction off() {\n\t\t\t\t\tremoveDragListeners();\n\t\t\t\t\tanimate.pause();\n\t\t\t\t\tundrag();\n\t\t\t\t}\n\n\t\t\t\tfunction isEnabled() {\n\t\t\t\t\tvar enabled = true;\n\t\t\t\t\tif (scrollableWhen) {\n\t\t\t\t\t\tenabled = enabled && scrollableWhen(scope);\n\t\t\t\t\t}\n\t\t\t\t\tenabled = enabled && $window.innerWidth >= 1024;\n\t\t\t\t\tenabled = enabled && (elementNode.offsetHeight < contentNode.offsetHeight);\n\t\t\t\t\treturn enabled;\n\t\t\t\t}\n\n\t\t\t\tfunction onResize() {\n\t\t\t\t\tif (!isEnabled()) {\n\t\t\t\t\t\toff();\n\t\t\t\t\t}\n\t\t\t\t\tredraw();\n\t\t\t\t}\n\n\t\t\t\tscope.$watch(function () {\n\t\t\t\t\treturn contentNode.offsetWidth;\n\t\t\t\t}, function (newValue, oldValue) {\n\t\t\t\t\tonResize();\n\t\t\t\t});\n\n\t\t\t\tfunction addListeners() {\n\t\t\t\t\tangular.element($window).on('resize', onResize);\n\t\t\t\t\telement.on('touchstart mousedown', onDown);\n\t\t\t\t\telement.on('wheel', onWheel);\n\t\t\t\t\t// element.addEventListener('DOMMouseScroll',handleScroll,false); // for Firefox\n\t\t\t\t\t// element.addEventListener('mousewheel',    handleScroll,false); // for everyone else\n\t\t\t\t}\n\n\t\t\t\tfunction removeListeners() {\n\t\t\t\t\tangular.element($window).off('resize', onResize);\n\t\t\t\t\telement.off('touchstart mousedown', onDown);\n\t\t\t\t\telement.off('wheel', onWheel);\n\t\t\t\t}\n\n\t\t\t\tfunction addDragListeners() {\n\t\t\t\t\tangular.element($window).on('touchmove mousemove', onMove);\n\t\t\t\t\tangular.element($window).on('touchend mouseup', onUp);\n\t\t\t\t}\n\n\t\t\t\tfunction removeDragListeners() {\n\t\t\t\t\tangular.element($window).off('touchmove mousemove', onMove);\n\t\t\t\t\tangular.element($window).off('touchend mouseup', onUp);\n\t\t\t\t}\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tremoveListeners();\n\t\t\t\t\tanimate.pause();\n\t\t\t\t});\n\n\t\t\t\taddListeners();\n\n\t\t\t},\n\t\t};\n    }]);\n\n}());\n\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Scrollable', [function () {\n\t\tfunction Scrollable() {\n\t\t\tvar scrollable = {\n\t\t\t\tstart: {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0\n\t\t\t\t},\n\t\t\t\tend: {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0\n\t\t\t\t},\n\t\t\t\tcurrent: {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0\n\t\t\t\t},\n\t\t\t\tindicator: {\n\t\t\t\t\tx: 45,\n\t\t\t\t\ty: 0\n\t\t\t\t},\n\t\t\t\tspeed: {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0\n\t\t\t\t},\n\t\t\t\trect: {\n\t\t\t\t\ttop: 0,\n\t\t\t\t\tright: 0,\n\t\t\t\t\tbottom: 0,\n\t\t\t\t\tleft: 0\n\t\t\t\t},\n\t\t\t\tcontainer: {\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: 0\n\t\t\t\t},\n\t\t\t\tcontent: {\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: 0\n\t\t\t\t},\n\t\t\t};\n\t\t\tangular.extend(this, scrollable);\n\t\t}\n\t\tScrollable.prototype = {\n\t\t\tbounceX: function () {\n\t\t\t\tvar scrollable = this;\n\t\t\t\tvar end = scrollable.end,\n\t\t\t\t\trect = scrollable.rect;\n\t\t\t\tvar padding = 100;\n\t\t\t\trect.left += padding;\n\t\t\t\trect.right -= padding;\n\t\t\t\tif (end.x > rect.left) {\n\t\t\t\t\tscrollable.doLeft();\n\t\t\t\t} else if (end.x < l.right) {\n\t\t\t\t\tscrollable.doRight();\n\t\t\t\t}\n\t\t\t},\n\t\t\trenderX: function () {\n\t\t\t\tvar scrollable = this,\n\t\t\t\t\tenabled = scrollable.enabled,\n\t\t\t\t\tdragging = scrollable.dragging,\n\t\t\t\t\twheeling = scrollable.wheeling,\n\t\t\t\t\tmove = scrollable.move,\n\t\t\t\t\tdown = scrollable.down;\n\t\t\t\tvar start = scrollable.start,\n\t\t\t\t\tend = scrollable.end,\n\t\t\t\t\tcurrent = scrollable.current,\n\t\t\t\t\tindicator = scrollable.indicator,\n\t\t\t\t\tspeed = scrollable.speed,\n\t\t\t\t\trect = scrollable.rect;\n\t\t\t\tvar container = scrollable.container,\n\t\t\t\t\tcontent = scrollable.content;\n\t\t\t\tif (enabled) {\n\t\t\t\t\trect.left = 0;\n\t\t\t\t\trect.right = container.width - content.width;\n\t\t\t\t\tif (dragging) {\n\t\t\t\t\t\tend.x = start.x + move.x - down.x;\n\t\t\t\t\t\tscrollable.bounceX();\n\t\t\t\t\t} else if (speed.x) {\n\t\t\t\t\t\tend.x += speed.x;\n\t\t\t\t\t\tspeed.x *= 0.75;\n\t\t\t\t\t\tif (wheeling) {\n\t\t\t\t\t\t\tscrollable.bounceX();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (Math.abs(speed.x) < 0.05) {\n\t\t\t\t\t\t\tspeed.x = 0;\n\t\t\t\t\t\t\tend.x = start.x = current.x;\n\t\t\t\t\t\t\tscrollable.wheeling = false;\n\t\t\t\t\t\t\t// animate.pause();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tend.x = Math.min(rect.left, end.x);\n\t\t\t\t\tend.x = Math.max(rect.right, end.x);\n\t\t\t\t\tcurrent.x += (end.x - current.x) / 4;\n\t\t\t\t} else {\n\t\t\t\t\tcurrent.x = end.x = 0;\n\t\t\t\t}\n\t\t\t},\n\t\t\tscrollToX: function (x) {\n\t\t\t\tvar scrollable = this;\n\t\t\t\tscrollable.start.x = scrollable.end.x = 0;\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tscrollable.undrag();\n\t\t\t\t\tscrollable.busy = false;\n\t\t\t\t}, 500);\n\t\t\t},\n\t\t\tdoLeft: function (scope) {\n\t\t\t\tvar scrollable = this;\n\t\t\t\tif (scrollable.busy) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!scrollable.onLeft) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tscrollable.busy = true;\n\t\t\t\tscrollable.onLeft(scope).then().finally(function () {\n\t\t\t\t\tscrollable.scrollToX(0);\n\t\t\t\t});\n\t\t\t},\n\t\t\tdoRight: function (scope) {\n\t\t\t\tvar scrollable = this;\n\t\t\t\tif (scrollable.busy) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!scrollable.onRight) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tscrollable.busy = true;\n\t\t\t\tscrollable.onRight(scope).then().finally(function () {\n\t\t\t\t\tvar right = scope.container.width - scope.content.width;\n\t\t\t\t\tif (right > rect.right) {\n\t\t\t\t\t\tstart.x = end.x = rect.right;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstart.x = end.x = rect.right + padding;\n\t\t\t\t\t}\n\t\t\t\t\tscrollable.scrollToX(0);\n\t\t\t\t});\n\t\t\t},\n\t\t\tundrag: function () {\n\t\t\t\tvar scrollable = this;\n\t\t\t\tscrollable.dragging = false;\n\t\t\t\tscrollable.wheeling = false;\n\t\t\t\tscrollable.move = null;\n\t\t\t\tscrollable.down = null;\n\t\t\t},\n\t\t\tonDown: function (down) {\n\t\t\t\tvar scrollable = this,\n\t\t\t\t\tstart = scrollable.start,\n\t\t\t\t\tend = scrollable.end,\n\t\t\t\t\tcurrent = scrollable.current,\n\t\t\t\t\tspeed = scrollable.speed;\n\t\t\t\tstart.x = end.x = current.x;\n\t\t\t\tspeed.x = 0;\n\t\t\t\tscrollable.down = down;\n\t\t\t\tscrollable.wheeling = false;\n\t\t\t},\n\t\t\tonMove: function (move) {\n\t\t\t\tvar scrollable = this;\n\t\t\t\tscrollable.prev = scrollable.move;\n\t\t\t\tscrollable.move = move;\n\t\t\t\tscrollable.dragging = true;\n\t\t\t},\n\t\t\tonUp: function () {\n\t\t\t\tvar scrollable = this,\n\t\t\t\t\tenabled = scrollable.enabled,\n\t\t\t\t\tdragging = scrollable.dragging,\n\t\t\t\t\twheeling = scrollable.wheeling,\n\t\t\t\t\tmove = scrollable.move,\n\t\t\t\t\tdown = scrollable.down;\n\t\t\t\tvar start = scrollable.start,\n\t\t\t\t\tend = scrollable.end,\n\t\t\t\t\tcurrent = scrollable.current,\n\t\t\t\t\tindicator = scrollable.indicator,\n\t\t\t\t\tspeed = scrollable.speed,\n\t\t\t\t\trect = scrollable.rect;\n\t\t\t\tvar container = scrollable.container,\n\t\t\t\t\tcontent = scrollable.content;\n\t\t\t\tif (move && prev) {\n\t\t\t\t\tspeed.x += (move.x - prev.x) * 4;\n\t\t\t\t}\n\t\t\t\tstart.x = end.x = current.x;\n\t\t\t\tscrollable.dragging = false;\n\t\t\t\tscrollable.move = null;\n\t\t\t\tscrollable.down = null;\n\t\t\t\tscrollable.prev = null;\n\t\t\t},\n\t\t\tgetWheelIncrement: function () {\n\t\t\t\tvar scrollable = this;\n\t\t\t\tvar container = scrollable.container,\n\t\t\t\t\tcontent = scrollable.content;\n\t\t\t\tvar increment = (content.width - container.width) / 20;\n\t\t\t\tincrement = Math.min(10, Math.max(100, increment));\n\t\t\t\treturn increment;\n\t\t\t},\n\t\t\tonWheel: function (e) {\n\t\t\t\tvar scrollable = this,\n\t\t\t\t\tspeed = scrollable.speed;\n\t\t\t\tif (!scrollable.busy && scrollable.enabled) {\n\t\t\t\t\tif (!e) e = $window.event;\n\t\t\t\t\te = e.originalEvent ? e.originalEvent : e;\n\t\t\t\t\tvar dir = (((e.deltaY < 0 || e.wheelDelta > 0) || e.deltaY < 0) ? 1 : -1);\n\t\t\t\t\tspeed.x += dir * scrollable.getWheelIncrement();\n\t\t\t\t\tscrollable.wheeling = true;\n\t\t\t\t\t// animate.play();\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t},\n\t\t\tlink: function (methods) {\n\t\t\t\tangular.extend(this, methods);\n\t\t\t},\n\t\t};\n\t\treturn Scrollable;\n    }]);\n\n}());\n\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Events', [function () {\n\n\t\tfunction Event(e, element) {\n\t\t\tvar documentNode = (document.documentElement || document.body.parentNode || document.body);\n\t\t\tvar scroll = {\n\t\t\t\tx: window.pageXOffset || documentNode.scrollLeft,\n\t\t\t\ty: window.pageYOffset || documentNode.scrollTop\n\t\t\t};\n\t\t\tif (e.type === 'resize') {\n\t\t\t\tvar view = {\n\t\t\t\t\tw: this.getWidth(),\n\t\t\t\t\th: this.getHeight(),\n\t\t\t\t};\n\t\t\t\tthis.view = view;\n\t\t\t}\n\t\t\tvar node = getNode(element);\n\t\t\tvar offset = {\n\t\t\t\tx: node.offsetLeft,\n\t\t\t\ty: node.offsetTop,\n\t\t\t};\n\t\t\tvar rect = node.getBoundingClientRect();\n\t\t\tvar page = this.getPage(e);\n\t\t\tif (page) {\n\t\t\t\tvar relative = {\n\t\t\t\t\tx: page.x - scroll.x - rect.left,\n\t\t\t\t\ty: page.y - scroll.y - rect.top,\n\t\t\t\t};\n\t\t\t\tvar absolute = {\n\t\t\t\t\tx: page.x - scroll.x,\n\t\t\t\t\ty: page.y - scroll.y,\n\t\t\t\t};\n\t\t\t\tthis.relative = relative;\n\t\t\t\tthis.absolute = absolute;\n\t\t\t}\n\t\t\tif (this.type === 'resize') {\n\t\t\t\tconsole.log(this.type);\n\t\t\t}\n\t\t\tthis.originalEvent = e;\n\t\t\tthis.element = element;\n\t\t\tthis.node = node;\n\t\t\tthis.offset = offset;\n\t\t\tthis.rect = rect;\n\t\t\t// console.log('Event', 'page', page, 'scroll', scroll, 'offset', offset, 'rect', rect, 'relative', relative, 'absolute', absolute);\n\t\t\t// console.log('scroll.y', scroll.y, 'page.y', page.y, 'offset.y', offset.y, 'rect.top', rect.top);\n\t\t}\n\t\tEvent.prototype = {\n\t\t\tgetPage: getPage,\n\t\t\tgetWidth: getWidth,\n\t\t\tgetHeight: getHeight,\n\t\t};\n\n\t\tfunction getWidth() {\n\t\t\tif (self.innerWidth) {\n\t\t\t\treturn self.innerWidth;\n\t\t\t}\n\t\t\tif (document.documentElement && document.documentElement.clientWidth) {\n\t\t\t\treturn document.documentElement.clientWidth;\n\t\t\t}\n\t\t\tif (document.body) {\n\t\t\t\treturn document.body.clientWidth;\n\t\t\t}\n\t\t}\n\n\t\tfunction getHeight() {\n\t\t\tif (self.innerHeight) {\n\t\t\t\treturn self.innerHeight;\n\t\t\t}\n\t\t\tif (document.documentElement && document.documentElement.clientHeight) {\n\t\t\t\treturn document.documentElement.clientHeight;\n\t\t\t}\n\t\t\tif (document.body) {\n\t\t\t\treturn document.body.clientHeight;\n\t\t\t}\n\t\t}\n\n\t\tfunction getPage(e) {\n\t\t\tvar standardEvents = ['click', 'mousedown', 'mouseup', 'mousemove', 'mouseover', 'mouseout', 'mouseenter', 'mouseleave', 'contextmenu'];\n\t\t\tvar touchEvents = ['touchstart', 'touchmove', 'touchend', 'touchcancel'];\n\t\t\tvar page = null;\n\t\t\tif (touchEvents.indexOf(e.type) !== -1) {\n\t\t\t\tvar t = null;\n\t\t\t\tvar event = e.originalEvent ? e.originalEvent : e;\n\t\t\t\tvar touches = event.touches.length ? event.touches : event.changedTouches;\n\t\t\t\tif (touches && touches.length) {\n\t\t\t\t\tt = touches[0];\n\t\t\t\t}\n\t\t\t\tif (t) {\n\t\t\t\t\tpage = {\n\t\t\t\t\t\tx: t.pageX,\n\t\t\t\t\t\ty: t.pageY,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t} else if (standardEvents.indexOf(e.type) !== -1) {\n\t\t\t\tpage = {\n\t\t\t\t\tx: e.pageX,\n\t\t\t\t\ty: e.pageY,\n\t\t\t\t};\n\t\t\t}\n\t\t\tthis.type = e.type;\n\t\t\treturn page;\n\t\t}\n\n\t\tfunction Events(element) {\n\t\t\tthis.element = element;\n\t\t\tthis.listeners = {};\n\t\t\tthis.standardEvents = {\n\t\t\t\tclick: {\n\t\t\t\t\tkey: 'click',\n\t\t\t\t\tcallback: onClick\n\t\t\t\t},\n\t\t\t\tdown: {\n\t\t\t\t\tkey: 'mousedown',\n\t\t\t\t\tcallback: onMouseDown\n\t\t\t\t},\n\t\t\t\tmove: {\n\t\t\t\t\tkey: 'mousemove',\n\t\t\t\t\tcallback: onMouseMove\n\t\t\t\t},\n\t\t\t\tup: {\n\t\t\t\t\tkey: 'mouseup',\n\t\t\t\t\tcallback: onMouseUp\n\t\t\t\t},\n\t\t\t\tresize: {\n\t\t\t\t\tkey: 'resize',\n\t\t\t\t\tcallback: onResize\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.touchEvents = {\n\t\t\t\tdown: {\n\t\t\t\t\tkey: 'touchstart',\n\t\t\t\t\tcallback: onTouchStart\n\t\t\t\t},\n\t\t\t\tmove: {\n\t\t\t\t\tkey: 'touchmove',\n\t\t\t\t\tcallback: onTouchMove\n\t\t\t\t},\n\t\t\t\tup: {\n\t\t\t\t\tkey: 'touchend',\n\t\t\t\t\tcallback: onTouchEnd\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tvar events = this;\n\n\t\t\tfunction onClick(e) {\n\t\t\t\t// console.log('onClick', e, events);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.listeners.click.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onMouseDown(e) {\n\t\t\t\t// console.log('onMouseDown', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.listeners.down.apply(this, [event]);\n\t\t\t\tevents.removeTouchEvents();\n\t\t\t}\n\n\t\t\tfunction onMouseMove(e) {\n\t\t\t\t// console.log('onMouseMove', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.listeners.move.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onMouseUp(e) {\n\t\t\t\t// console.log('onMouseUp', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.listeners.up.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onResize(e) {\n\t\t\t\tconsole.log('onResize', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.listeners.resize.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onTouchStart(e) {\n\t\t\t\t// console.log('onTouchStart', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.listeners.down.apply(this, [event]);\n\t\t\t\tevents.removeStandardEvents();\n\t\t\t}\n\n\t\t\tfunction onTouchMove(e) {\n\t\t\t\t// console.log('onTouchMove', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.listeners.move.apply(this, [event]);\n\t\t\t}\n\n\t\t\tfunction onTouchEnd(e) {\n\t\t\t\t// console.log('onTouchEnd', e);\n\t\t\t\tvar event = new Event(e, events.element);\n\t\t\t\tevents.listeners.up.apply(this, [event]);\n\t\t\t}\n\t\t}\n\t\tEvents.prototype = {\n\t\t\tadd: add,\n\t\t\tremove: remove,\n\t\t\tremoveStandardEvents: removeStandardEvents,\n\t\t\tremoveTouchEvents: removeTouchEvents,\n\t\t};\n\t\treturn Events;\n\n\t\tfunction getNode(element) {\n\t\t\treturn element.length ? element[0] : element; // (element.length && (element[0] instanceOf Node || element[0] instanceOf HTMLElement)) ? element[0] : element;\n\t\t}\n\n\t\tfunction getElement(element) {\n\t\t\treturn element.length ? element : angular.element(element); // (element.length && (element[0] instanceOf Node || element[0] instanceOf HTMLElement)) ? element : angular.element(element);\n\t\t}\n\n\t\tfunction add(listeners, scope) {\n\t\t\tvar events = this,\n\t\t\t\tstandard = this.standardEvents,\n\t\t\t\ttouch = this.touchEvents;\n\t\t\tvar element = getElement(this.element),\n\t\t\t\twindowElement = angular.element(window);\n\n\t\t\tangular.forEach(listeners, function (callback, key) {\n\t\t\t\tif (events.listeners[key]) {\n\t\t\t\t\tvar listener = {};\n\t\t\t\t\tlistener[key] = events.listeners[key];\n\t\t\t\t\tremove(listener);\n\t\t\t\t}\n\t\t\t\tevents.listeners[key] = callback;\n\t\t\t\tif (standard[key]) {\n\t\t\t\t\tif (key === 'resize') {\n\t\t\t\t\t\twindowElement.on(standard[key].key, standard[key].callback);\n\t\t\t\t\t} else {\n\t\t\t\t\t\telement.on(standard[key].key, standard[key].callback);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (touch[key]) {\n\t\t\t\t\telement.on(touch[key].key, touch[key].callback);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (scope) {\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tevents.remove(listeners);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn events;\n\t\t}\n\n\t\tfunction remove(listeners) {\n\t\t\tvar events = this,\n\t\t\t\tstandard = this.standardEvents,\n\t\t\t\ttouch = this.touchEvents;\n\t\t\tvar element = getElement(this.element),\n\t\t\t\twindowElement = angular.element(window);\n\t\t\tangular.forEach(listeners, function (callback, key) {\n\t\t\t\tif (standard[key]) {\n\t\t\t\t\tif (key === 'resize') {\n\t\t\t\t\t\twindowElement.off(standard[key].key, standard[key].callback);\n\t\t\t\t\t} else {\n\t\t\t\t\t\telement.off(standard[key].key, standard[key].callback);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (touch[key]) {\n\t\t\t\t\telement.off(touch[key].key, touch[key].callback);\n\t\t\t\t}\n\t\t\t\tevents.listeners[key] = null;\n\t\t\t});\n\t\t\treturn events;\n\t\t}\n\n\t\tfunction removeStandardEvents() {\n\t\t\tvar events = this,\n\t\t\t\tstandard = events.standardEvents,\n\t\t\t\ttouch = events.touchEvents;\n\t\t\tvar element = getElement(events.element);\n\t\t\telement.off('mousedown', standard.down.callback);\n\t\t\telement.off('mousemove', standard.move.callback);\n\t\t\telement.off('mouseup', standard.up.callback);\n\t\t}\n\n\t\tfunction removeTouchEvents() {\n\t\t\tvar events = this,\n\t\t\t\tstandard = events.standardEvents,\n\t\t\t\ttouch = events.touchEvents;\n\t\t\tvar element = getElement(events.element);\n\t\t\telement.off('touchstart', touch.down.callback);\n\t\t\telement.off('touchmove', touch.move.callback);\n\t\t\telement.off('touchend', touch.up.callback);\n\t\t}\n\n    }]);\n\n}());\n\n/* global angular */\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    // micro interactions\n\n    function tap(Events) {\n        return {\n            restrict: 'A',\n            priority: 0,\n            link: link\n        };\n\n        function link(scope, element, attributes, model) {\n            if (attributes.ngBind) {\n                return;\n            }\n            if (attributes.href === '#' && !attributes.ngHref && !attributes.ngClick) {\n                return;\n            }\n\n            element.addClass('interaction-tap');\n            var node = document.createElement('interaction');\n            element[0].appendChild(node);\n\n            function onDown(e) {\n                element.removeClass('interaction-animate');\n                void element.offsetWidth;\n                // node.style.animationPlayState = \"paused\";\n                node.style.left = e.relative.x + 'px';\n                node.style.top = e.relative.y + 'px';\n                setTimeout(function() {\n                    element.addClass('interaction-animate');\n                    setTimeout(function() {\n                        element.removeClass('interaction-animate');\n                    }, 1000);\n                }, 10);\n\n                // console.log('tap.onDown', node, node.parentElement);\n            }\n            var listeners = { // down, move, up, click\n                down: onDown,\n            };\n            var events = new Events(element).add(listeners, scope); // passing scope to add remove listeners automatically on $destroy\n        }\n    }\n    app.directive('href', ['Events', tap]);\n    app.directive('ngClick', ['Events', tap]);\n\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.factory('State', ['$timeout', function($timeout) {\r\n        var DELAY = 2000;\r\n\r\n        function State() {\r\n            this.errors = [];\r\n            this.isReady = false;\r\n            this.idle();\r\n        }\r\n\r\n        State.prototype = {\r\n            idle: function() {\r\n                var state = this;\r\n                state.isBusy = false;\r\n                state.isError = false;\r\n                state.isErroring = false;\r\n                state.isSuccess = false;\r\n                state.isSuccessing = false;\r\n                state.button = null;\r\n                state.errors = [];\r\n            },\r\n            busy: function() {\r\n                var state = this;\r\n                if (!state.isBusy) {\r\n                    state.isBusy = true;\r\n                    state.isError = false;\r\n                    state.isErroring = false;\r\n                    state.isSuccess = false;\r\n                    state.isSuccessing = false;\r\n                    state.errors = [];\r\n                    return true;\r\n                } else {\r\n                    return false;\r\n                }\r\n            },\r\n            error: function error(error) {\r\n                console.log('State.error', error);\r\n                var state = this;\r\n                state.isBusy = false;\r\n                state.isError = true;\r\n                state.isErroring = true;\r\n                state.isSuccess = false;\r\n                state.isSuccessing = false;\r\n                state.errors.push(error);\r\n                $timeout(function() {\r\n                    state.isErroring = false;\r\n                }, DELAY);\r\n            },\r\n            ready: function ready() {\r\n                var state = this;\r\n                state.idle();\r\n                state.isReady = true;\r\n            },\r\n            success: function success() {\r\n                var state = this;\r\n                state.isBusy = false;\r\n                state.isError = false;\r\n                state.isErroring = false;\r\n                state.isSuccess = true;\r\n                state.isSuccessing = true;\r\n                state.errors = [];\r\n                $timeout(function() {\r\n                    state.isSuccessing = false;\r\n                }, DELAY);\r\n            },\r\n            enabled: function enabled() {\r\n                var state = this;\r\n                return !state.isBusy && !state.isErroring && !state.isSuccessing;\r\n            },\r\n            errorMessage: function errorMessage() {\r\n                var state = this;\r\n                return state.isError ? state.errors[state.errors.length - 1] : null;\r\n            },\r\n            submitClass: function submitClass() {\r\n                var state = this;\r\n                return {\r\n                    busy: state.isBusy,\r\n                    ready: state.isReady,\r\n                    successing: state.isSuccessing,\r\n                    success: state.isSuccess,\r\n                    errorring: state.isErroring,\r\n                    error: state.isError,\r\n                };\r\n            },\r\n            labels: function labels(addons) {\r\n                var state = this;\r\n                var defaults = {\r\n                    ready: 'submit',\r\n                    busy: 'sending',\r\n                    error: 'error',\r\n                    success: 'success',\r\n                };\r\n                if (addons) {\r\n                    angular.extend(defaults, addons);\r\n                }\r\n                var label = defaults.ready;\r\n                if (state.isBusy) {\r\n                    label = defaults.busy;\r\n                } else if (state.isSuccess) {\r\n                    label = defaults.success;\r\n                } else if (state.isError) {\r\n                    label = defaults.error;\r\n                }\r\n                return label;\r\n            },\r\n            classes: function classes(addons) {\r\n                var state = this,\r\n                    classes = null;\r\n                classes = {\r\n                    ready: state.isReady,\r\n                    busy: state.isBusy,\r\n                    successing: state.isSuccessing,\r\n                    success: state.isSuccess,\r\n                    errorring: state.isErroring,\r\n                    error: state.isError,\r\n                };\r\n                if (addons) {\r\n                    angular.forEach(addons, function(value, key) {\r\n                        classes[value] = classes[key];\r\n                    });\r\n                }\r\n                return classes;\r\n            }\r\n        };\r\n\r\n        return State;\r\n    }]);\r\n\r\n}());"]}