{"version":3,"sources":["docs/js/artisan.js"],"names":["angular","module","factory","Animate","callback","this","key","ticks","prototype","play","loop","time","_this","window","requestAnimationFrame","pause","cancelAnimationFrame","playpause","doNOTPlay","lastTime","vendors","x","length","element","currTime","Date","getTime","timeToCall","Math","max","id","setTimeout","clearTimeout","app","EventsService","Event","e","documentNode","document","documentElement","body","parentNode","scroll","pageXOffset","scrollLeft","y","pageYOffset","scrollTop","type","view","w","getWidth","h","getHeight","node","getNode","offset","offsetLeft","offsetTop","rect","getBoundingClientRect","page","getPage","relative","left","top","absolute","console","log","originalEvent","self","innerWidth","clientWidth","innerHeight","clientHeight","standardEvents","touchEvents","indexOf","t","event","touches","changedTouches","pageX","pageY","Events","onClick","events","listeners","click","apply","onMouseDown","down","removeTouchEvents","onMouseMove","move","onMouseUp","up","onResize","resize","onTouchStart","removeStandardEvents","onTouchMove","onTouchEnd","getElement","add","scope","standard","touch","windowElement","forEach","listener","remove","on","$on","off","service","$window","Utils","hasPassiveEvents","supported","options","Object","defineProperty","get","addEventListener","defaults","passive","capture","original","EventTarget","usesListenerOptions","undefined","call","onScroll","deltaX","getParents","target","filter","deltaY","preventDefault","navigator","userAgent","match","chrome","safari","firefox","$filter","array","filters","item","i","Point","mult","point","value","setX","setY","setPos","copy","clone","toString","Rect","reduce","size","reduceRect","offsetRect","expandRect","expand","intersect","right","bottom","center","topLeft","topRight","bottomRight","bottomLeft","setW","setH","setSize","Vector","make","a","b","sqrt","normalize","l","incidence","atan2","distance","cross","difference","power","abs","towards","friction","Hash","pool","defineProperties","enumerable","writable","has","getId","hash","set","push","newItem","p","keys","oldItem","index","splice","addMany","items","removeMany","removeAll","shift","each","forward","reverse","sort","c","d","backward","differs","updatePool","pools","Array","$q","$promise","deferred","defer","promise","statics","all","promises","extend","$timeout","State","errors","isReady","idle","state","isBusy","isError","isErroring","isSuccess","isSuccessing","button","busy","error","ready","success","enabled","errorMessage","submitClass","successing","errorring","labels","addons","label","classes","transformProperty","div","createElement","style","every","prefix","Style","props","scale","hoverScale","currentScale","styles","cssText","join","transform","transformOrigin","round","$compile","$controller","toMd5","string","getTouch","previous","s","getRelativeTouch","getClosest","el","selector","matchesFn","parent","some","fn","parentElement","getClosestElement","topParentNode","parents","object","removeValue","throttle","func","wait","context","args","result","timeout","later","leading","getNow","now","remaining","arguments","trailing","where","query","found","compileController","html","data","link","contents","controller","$scope","$new","controllerAs","children","reverseSortOn","format","prepend","expression","splitted","split","formatted","reducer","o","reducerSetter","slice","reducerAdder","downloadFile","content","name","download","createEvent","anchor","href","base64","downloadName","substring","lastIndexOf","initEvent","dispatchEvent","open","blob","Blob","reader","FileReader","readAsDataURL","onloadend","serverDownload","uri","extension","JSON","stringify","form","input","appendChild","action","method","enctype","submit","removeChild","ua","agent","toLowerCase","msie","mobile","mac","getElementsByTagName","addClass","TypeError","len","k","Api","Doc","$location","$routeParams","environment","View","doc","url","path","params","route","current","docs","then","response","resolve","reject","$http","$httpPromise","urls","api","status","$get","$post","$put","$patch","$delete","$fake","post","put","patch","delete","fake","redirect","msecs","doRedirect","$$lastRequestedPath","doRetry","$rootScope","$silent","unlink","$$listeners","$locationChangeSuccess","relink","$path","silent","replace","location","unshift","Cookie","TIMEOUT","_set","days","expires","date","setTime","toGMTString","cookie","exists","cookieName","ca","charAt","model","parse","decodeURIComponent","atob","cache","json","btoa","encodeURIComponent","checkCookie","elapsed","interval","LocalStorage","isSupported","localStorage","setItem","removeItem","storageEvent","newValue","SessionStorage","sessionStorage","Color","r","g","uint","parseInt","componentToHex","hex","luma","color","dot","contrast","darker","pow","min","floor","lighter","toUint","toHex","toRgba","toFixed","alpha","makeSet","foreground","border","light","Shape","shapeCircle","cx","cy","sa","ea","PI","ctx","arc","shapeStar","or","ir","steps","angle","step","moveTo","cos","sin","lineTo","shapeRoundRect","tl","tr","br","bl","defaultRadius","quadraticCurveTo","circle","beginPath","closePath","star","roundRect","constant","black","white","blue","red","lightBlue","lightYellow","greyLighter","greyLight","greyMedium","grey","map","Painter","Palette","painter","buffer","rows","getRect","row","canvas","width","height","setCanvas","drawImage","palette","isString","img","Image","onload","addShape","onerror","src","save","clip","translate","restore","draw","pre","drawRect","tint","setFill","fillRect","globalCompositeOperation","pattern","drawPattern","fillStyle","createPattern","toDataURL","PainterColors","drawingRect","setColors","colors","offsetWidth","offsetHeight","getContext","lineCap","clear","setText","font","align","verticalAlign","textAlign","textBaseline","setStroke","strokeStyle","lineWidth","fillText","text","maxLength","substr","trim","strokeRect","fill","stroke","begin","close","rotate","xy","image","flip","directive","restrict","templateUrl","transclude","message","attributes","$parse","formatLabel","uniqueId","template","control","ngModel","required","title","placeholder","source","require","optionLabel","getOptions","number","field","precision","validate","minLength","Number","POSITIVE_INFINITY","focus","visible","onChange","$parent","onFilter","getType","getClasses","control-focus","control-success","$valid","control-error","$invalid","$submitted","$touched","control-empty","$viewValue","getMessages","$error","toggleVisibility","$templateCache","compile","onRemove","getter","numberPicker","setter","assign","onAdd","removeListeners","nodeRemove","nodeAdd","querySelectorAll","onFocus","$modelValue","$setViewValue","doBlur","onBlur","$formatters","$parsers","valid","String","$setValidity","$templateRequest","priority","modal","modalView","provider","when","routes","modals","popModal","m","active","closeModal","addModal","back","Nav","$watch","isArray","onLink","onNav","nav","setItems","itemOpen","immediate","$nav","closed","closing","opening","opened","itemClose","itemToggle","onTap","trigger","output","resolved","rejected","navItem","prevent","querySelector","setNav","setNavs","level","addItems","getLink","itemOrItems","addItem","ondragstart","Scrollable","render","scrollable","setContainer","containerNode","setContent","contentNode","setEnabled","isEnabled","renderX","getCurrent","contentStyle","onDown","dragStart","dragOn","animate","onMove","dragMove","onUp","dragEnd","dragOff","_onScrollX","dir","trackpad","wheelX","onWheel","wheelDelta","lastime","wheelXCheck","onScrollX","scrollableWhen","removeEventListener","onLeft","onRight","showIndicatorFor","attr","scrollableX","getItems","scrollableItem","prev","scrollPrev","next","scrollNext","reset","doReset","oldValue","renderY","_onScrollY","wheelY","wheelYCheck","onScrollY","stopPropagation","onTop","onBottom","scrollableY","container","flag","getIndicator","indicator","scrollToIndex","currentIndex","getItemAtIndex","start","end","speed","wheeling","dragging","doLeft","finally","scrollToX","doRight","overflow","padding","animating","extendX","snapToNearestX","extending","snappable","wheelXIncrement","increment","doTop","scrollToY","doBottom","extendY","snapToNearestY","wheelYIncrement","methods","tap","removeClass","ngBind","ngHref","ngClick"],"mappings":"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","file":"artisan.min.js","sourcesContent":["/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan', ['ng', 'ngRoute', 'ngMessages']);\r\n\r\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Animate', [function () {\n\n\t\tfunction Animate(callback) {\n\t\t\tthis.callback = callback;\n\t\t\tthis.key = null;\n\t\t\tthis.ticks = 0;\n\t\t}\n\t\tAnimate.prototype = {\n\t\t\tplay: function () {\n\t\t\t\tvar _this = this;\n\n\t\t\t\tfunction loop(time) {\n\t\t\t\t\t_this.ticks++;\n\t\t\t\t\t_this.callback(time, _this.ticks);\n\t\t\t\t\t_this.key = window.requestAnimationFrame(loop);\n\t\t\t\t}\n\t\t\t\tif (!this.key) {\n\t\t\t\t\tloop();\n\t\t\t\t}\n\t\t\t},\n\t\t\tpause: function () {\n\t\t\t\tif (this.key) {\n\t\t\t\t\twindow.cancelAnimationFrame(this.key);\n\t\t\t\t\tthis.key = null;\n\t\t\t\t}\n\t\t\t},\n\t\t\tplaypause: function () {\n\t\t\t\tif (this.key) {\n\t\t\t\t\tthis.pause();\n\t\t\t\t} else {\n\t\t\t\t\tthis.play();\n\t\t\t\t}\n\t\t\t},\n\t\t\tdoNOTPlay: function () {\n\t\t\t\tthis.pause();\n\t\t\t},\n\t\t}\n\t\treturn Animate;\n    }]);\n\n\t(function () {\n\t\tvar lastTime = 0;\n\t\tvar vendors = ['ms', 'moz', 'webkit', 'o'];\n\t\tfor (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n\t\t\twindow.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\n\t\t\twindow.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] ||\n\t\t\t\twindow[vendors[x] + 'CancelRequestAnimationFrame'];\n\t\t}\n\t\tif (!window.requestAnimationFrame) {\n\t\t\twindow.requestAnimationFrame = function (callback, element) {\n\t\t\t\tvar currTime = new Date().getTime();\n\t\t\t\tvar timeToCall = Math.max(0, 16 - (currTime - lastTime));\n\t\t\t\tvar id = window.setTimeout(function () {\n\t\t\t\t\tcallback(currTime + timeToCall);\n\t\t\t\t}, timeToCall);\n\t\t\t\tlastTime = currTime + timeToCall;\n\t\t\t\treturn id;\n\t\t\t};\n\t\t}\n\t\tif (!window.cancelAnimationFrame) {\n\t\t\twindow.cancelAnimationFrame = function (id) {\n\t\t\t\tclearTimeout(id);\n\t\t\t};\n\t\t}\n\t}());\n\n}());\n\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('Events', ['EventsService', function(EventsService) {\n\n        function Event(e, element) {\n            var documentNode = (document.documentElement || document.body.parentNode || document.body);\n            var scroll = {\n                x: window.pageXOffset || documentNode.scrollLeft,\n                y: window.pageYOffset || documentNode.scrollTop\n            };\n            if (e.type === 'resize') {\n                var view = {\n                    w: this.getWidth(),\n                    h: this.getHeight(),\n                };\n                this.view = view;\n            }\n            var node = getNode(element);\n            var offset = {\n                x: node.offsetLeft,\n                y: node.offsetTop,\n            };\n            var rect = node.getBoundingClientRect();\n            var page = this.getPage(e);\n            if (page) {\n                var relative = {\n                    x: page.x - scroll.x - rect.left,\n                    y: page.y - scroll.y - rect.top,\n                };\n                var absolute = {\n                    x: page.x - scroll.x,\n                    y: page.y - scroll.y,\n                };\n                this.relative = relative;\n                this.absolute = absolute;\n            }\n            if (this.type === 'resize') {\n                console.log(this.type);\n            }\n            this.originalEvent = e;\n            this.element = element;\n            this.node = node;\n            this.offset = offset;\n            this.rect = rect;\n            // console.log('Event', 'page', page, 'scroll', scroll, 'offset', offset, 'rect', rect, 'relative', relative, 'absolute', absolute);\n            // console.log('scroll.y', scroll.y, 'page.y', page.y, 'offset.y', offset.y, 'rect.top', rect.top);\n        }\n        Event.prototype = {\n            getPage: getPage,\n            getWidth: getWidth,\n            getHeight: getHeight,\n        };\n\n        function getWidth() {\n            if (self.innerWidth) {\n                return self.innerWidth;\n            }\n            if (document.documentElement && document.documentElement.clientWidth) {\n                return document.documentElement.clientWidth;\n            }\n            if (document.body) {\n                return document.body.clientWidth;\n            }\n        }\n\n        function getHeight() {\n            if (self.innerHeight) {\n                return self.innerHeight;\n            }\n            if (document.documentElement && document.documentElement.clientHeight) {\n                return document.documentElement.clientHeight;\n            }\n            if (document.body) {\n                return document.body.clientHeight;\n            }\n        }\n\n        function getPage(e) {\n            var standardEvents = ['click', 'mousedown', 'mouseup', 'mousemove', 'mouseover', 'mouseout', 'mouseenter', 'mouseleave', 'contextmenu'];\n            var touchEvents = ['touchstart', 'touchmove', 'touchend', 'touchcancel'];\n            var page = null;\n            if (touchEvents.indexOf(e.type) !== -1) {\n                var t = null;\n                var event = e.originalEvent ? e.originalEvent : e;\n                var touches = event.touches.length ? event.touches : event.changedTouches;\n                if (touches && touches.length) {\n                    t = touches[0];\n                }\n                if (t) {\n                    page = {\n                        x: t.pageX,\n                        y: t.pageY,\n                    };\n                }\n            } else if (standardEvents.indexOf(e.type) !== -1) {\n                page = {\n                    x: e.pageX,\n                    y: e.pageY,\n                };\n            }\n            this.type = e.type;\n            return page;\n        }\n\n        function Events(element) {\n            this.element = element;\n            this.listeners = {};\n            this.standardEvents = {\n                click: {\n                    key: 'click',\n                    callback: onClick\n                },\n                down: {\n                    key: 'mousedown',\n                    callback: onMouseDown\n                },\n                move: {\n                    key: 'mousemove',\n                    callback: onMouseMove\n                },\n                up: {\n                    key: 'mouseup',\n                    callback: onMouseUp\n                },\n                resize: {\n                    key: 'resize',\n                    callback: onResize\n                },\n            };\n            this.touchEvents = {\n                down: {\n                    key: 'touchstart',\n                    callback: onTouchStart\n                },\n                move: {\n                    key: 'touchmove',\n                    callback: onTouchMove\n                },\n                up: {\n                    key: 'touchend',\n                    callback: onTouchEnd\n                },\n            };\n\n            var events = this;\n\n            function onClick(e) {\n                // console.log('onClick', e, events);\n                var event = new Event(e, events.element);\n                events.listeners.click.apply(this, [event]);\n            }\n\n            function onMouseDown(e) {\n                // console.log('onMouseDown', e);\n                var event = new Event(e, events.element);\n                events.listeners.down.apply(this, [event]);\n                events.removeTouchEvents();\n            }\n\n            function onMouseMove(e) {\n                // console.log('onMouseMove', e);\n                var event = new Event(e, events.element);\n                events.listeners.move.apply(this, [event]);\n            }\n\n            function onMouseUp(e) {\n                // console.log('onMouseUp', e);\n                var event = new Event(e, events.element);\n                events.listeners.up.apply(this, [event]);\n            }\n\n            function onResize(e) {\n                console.log('onResize', e);\n                var event = new Event(e, events.element);\n                events.listeners.resize.apply(this, [event]);\n            }\n\n            function onTouchStart(e) {\n                // console.log('onTouchStart', e);\n                var event = new Event(e, events.element);\n                events.listeners.down.apply(this, [event]);\n                events.removeStandardEvents();\n            }\n\n            function onTouchMove(e) {\n                // console.log('onTouchMove', e);\n                var event = new Event(e, events.element);\n                events.listeners.move.apply(this, [event]);\n            }\n\n            function onTouchEnd(e) {\n                // console.log('onTouchEnd', e);\n                var event = new Event(e, events.element);\n                events.listeners.up.apply(this, [event]);\n            }\n        }\n        Events.prototype = {\n            add: add,\n            remove: remove,\n            removeStandardEvents: removeStandardEvents,\n            removeTouchEvents: removeTouchEvents,\n        };\n        return Events;\n\n        function getNode(element) {\n            return element.length ? element[0] : element; // (element.length && (element[0] instanceOf Node || element[0] instanceOf HTMLElement)) ? element[0] : element;\n        }\n\n        function getElement(element) {\n            return element.length ? element : angular.element(element); // (element.length && (element[0] instanceOf Node || element[0] instanceOf HTMLElement)) ? element : angular.element(element);\n        }\n\n        function add(listeners, scope) {\n            var events = this,\n                standard = this.standardEvents,\n                touch = this.touchEvents;\n            var element = getElement(this.element),\n                windowElement = angular.element(window);\n\n            angular.forEach(listeners, function(callback, key) {\n                if (events.listeners[key]) {\n                    var listener = {};\n                    listener[key] = events.listeners[key];\n                    remove(listener);\n                }\n                events.listeners[key] = callback;\n                if (standard[key]) {\n                    if (key === 'resize') {\n                        windowElement.on(standard[key].key, standard[key].callback);\n                    } else {\n                        element.on(standard[key].key, standard[key].callback);\n                    }\n                }\n                if (touch[key]) {\n                    element.on(touch[key].key, touch[key].callback);\n                }\n            });\n\n            if (scope) {\n                scope.$on('$destroy', function() {\n                    events.remove(listeners);\n                });\n            }\n\n            return events;\n        }\n\n        function remove(listeners) {\n            var events = this,\n                standard = this.standardEvents,\n                touch = this.touchEvents;\n            var element = getElement(this.element),\n                windowElement = angular.element(window);\n            angular.forEach(listeners, function(callback, key) {\n                if (standard[key]) {\n                    if (key === 'resize') {\n                        windowElement.off(standard[key].key, standard[key].callback);\n                    } else {\n                        element.off(standard[key].key, standard[key].callback);\n                    }\n                }\n                if (touch[key]) {\n                    element.off(touch[key].key, touch[key].callback);\n                }\n                events.listeners[key] = null;\n            });\n            return events;\n        }\n\n        function removeStandardEvents() {\n            var events = this,\n                standard = events.standardEvents,\n                touch = events.touchEvents;\n            var element = getElement(events.element);\n            element.off('mousedown', standard.down.callback);\n            element.off('mousemove', standard.move.callback);\n            element.off('mouseup', standard.up.callback);\n        }\n\n        function removeTouchEvents() {\n            var events = this,\n                standard = events.standardEvents,\n                touch = events.touchEvents;\n            var element = getElement(events.element);\n            element.off('touchstart', touch.down.callback);\n            element.off('touchmove', touch.move.callback);\n            element.off('touchend', touch.up.callback);\n        }\n\n    }]);\n\n    app.service('EventsService', ['$window', 'Utils', function($window, Utils) {\n\n        handlePassiveEvents();\n        preventHistoryNavigation();\n\n        this.hasPassiveEvents = hasPassiveEvents;\n\n        function hasPassiveEvents() {\n            var supported = false;\n            try {\n                var options = Object.defineProperty({}, 'passive', {\n                    get: function() {\n                        supported = true;\n                    },\n                });\n                window.addEventListener(\"test\", null, options);\n            } catch (e) {\n                console.log('handlePassiveEvents.isSupprted', e);\n            }\n            return supported;\n        }\n\n        function handlePassiveEvents() {\n            if (!window.addEventListener) {\n                return;\n            }\n\n            var defaults = {\n                passive: false,\n                capture: false,\n            };\n\n            function overwriteOriginal(original) {\n                EventTarget.prototype.addEventListener = function(type, listener, options) {\n                    var usesListenerOptions = typeof options === 'object';\n                    var capture = usesListenerOptions ? options.capture : options;\n                    options = usesListenerOptions ? options : {};\n                    options.passive = options.passive !== undefined ? options.passive : defaults.passive;\n                    options.capture = capture !== undefined ? capture : defaults.capture;\n                    original.call(this, type, listener, options);\n                };\n            }\n            var supported = hasPassiveEvents();\n            if (supported) {\n                var original = EventTarget.prototype.addEventListener;\n                overwriteOriginal(original);\n            }\n        }\n\n        function preventHistoryNavigation() {\n            // This code is only valid for Mac\n            var mac = navigator.userAgent.match(/Macintosh/);\n            if (!mac) {\n                return;\n            }\n            // detection\n            var chrome = navigator.userAgent.indexOf('Chrome') > -1;\n            var safari = navigator.userAgent.indexOf(\"Safari\") > -1;\n            var firefox = navigator.userAgent.indexOf('Firefox') > -1;\n            // Handle scroll events in Chrome, Safari, and Firefox\n            if (chrome || safari || firefox) {\n                // TODO: This only prevents scroll when reaching the topmost or leftmost\n                // positions of a container. It doesn't handle rightmost or bottom,\n                // and Lion scroll can be triggered by scrolling right (or bottom) and then\n                // scrolling left without raising your fingers from the scroll position.\n                $window.addEventListener('mousewheel', onScroll, {\n                    passive: false\n                });\n            }\n\n            function onScroll(e) {\n                // prevent futile scroll, which would trigger the Back/Next page event\n                if (\n                    // left - if none of the parents can be scrolled left\n                    (e.deltaX < 0 && (Utils.getParents(e.target).filter(function(node) {\n                        return node.scrollLeft > 0;\n                    }).length === 0)) ||\n                    // ip - if none of the parents can be scrolled up\n                    (e.deltaY > 0 && !(Utils.getParents(e.target).filter(function(node) {\n                        return node.scrollTop > 0;\n                    }).length === 0))\n                ) {\n                    e.preventDefault();\n                }\n            }\n        }\n\n    }]);\n\n}());\n/* global angular, app, Autolinker */\r\n(function () {\r\n\r\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('artisan');\r\n\r\n\tapp.filter('notIn', ['$filter', function ($filter) {\r\n\t\treturn function (array, filters, element) {\r\n\t\t\tif (filters) {\r\n\t\t\t\treturn $filter(\"filter\")(array, function (item) {\r\n\t\t\t\t\tfor (var i = 0; i < filters.length; i++) {\r\n\t\t\t\t\t\tif (filters[i][element] === item[element]) return false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n    }]);\r\n\r\n}());\r\n\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Point', [function () {\n\t\tfunction Point(x, y) {\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\t\t}\n\t\tPoint.mult = function (point, value) {\n\t\t\tpoint.x *= value;\n\t\t\tpoint.y *= value;\n\t\t\treturn point;\n\t\t};\n\t\tPoint.prototype = {\n\t\t\tmult: function (value) {\n\t\t\t\treturn Point.mult(this, value);\n\t\t\t},\n\t\t\toffset: function (x, y) {\n\t\t\t\tthis.x += x;\n\t\t\t\tthis.y += y;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetX: function (x) {\n\t\t\t\tthis.x = x;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetY: function (y) {\n\t\t\t\tthis.y = y;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetPos: function (x, y) {\n\t\t\t\tthis.x = x;\n\t\t\t\tthis.y = y;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tcopy: function (point) {\n\t\t\t\tthis.x = point.x;\n\t\t\t\tthis.y = point.y;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tclone: function () {\n\t\t\t\treturn new Point(this.x, this.y);\n\t\t\t},\n\t\t\ttoString: function () {\n\t\t\t\treturn '{' + this.x + ',' + this.y + '}';\n\t\t\t},\n\t\t};\n\t\treturn Point;\n    }]);\n\n}());\n\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Rect', [function () {\n\t\tfunction Rect(x, y, w, h) {\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\t\t\tthis.w = w || 0;\n\t\t\tthis.h = h || 0;\n\t\t}\n\t\tRect.mult = function (rect, value) {\n\t\t\trect.x *= value;\n\t\t\trect.y *= value;\n\t\t\trect.w *= value;\n\t\t\trect.h *= value;\n\t\t\treturn rect;\n\t\t};\n\t\tRect.prototype = {\n\t\t\tmult: function (value) {\n\t\t\t\treturn Rect.mult(this, value);\n\t\t\t},\n\t\t\toffset: function (x, y) {\n\t\t\t\tthis.x += x;\n\t\t\t\tthis.y += y;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\treduce: function (size) {\n\t\t\t\treturn this.offset(-size);\n\t\t\t},\n\t\t\treduceRect: function (rect) {\n\t\t\t\treturn this.offsetRect(Rect.mult(rect, -1));\n\t\t\t},\n\t\t\texpandRect: function (rect) {\n\t\t\t\tthis.x -= rect.x || 0;\n\t\t\t\tthis.y -= rect.y || 0;\n\t\t\t\tthis.w += rect.w || 0;\n\t\t\t\tthis.h += rect.h || 0;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\texpand: function (size) {\n\t\t\t\treturn this.expandRect({\n\t\t\t\t\tx: size,\n\t\t\t\t\ty: size,\n\t\t\t\t\tw: size * 2,\n\t\t\t\t\th: size * 2\n\t\t\t\t});\n\t\t\t},\n\t\t\tintersect: function (rect) {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn !(rect.x > x + w || rect.x + rect.w < x || rect.y > y + h || rect.y + rect.h < y);\n\t\t\t},\n\t\t\ttop: function () {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn {\n\t\t\t\t\tx: x + w / 2,\n\t\t\t\t\ty: y\n\t\t\t\t};\n\t\t\t},\n\t\t\tright: function () {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn {\n\t\t\t\t\tx: x + w,\n\t\t\t\t\ty: y + h / 2\n\t\t\t\t};\n\t\t\t},\n\t\t\tbottom: function () {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn {\n\t\t\t\t\tx: x + w / 2,\n\t\t\t\t\ty: y + h\n\t\t\t\t};\n\t\t\t},\n\t\t\tleft: function () {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn {\n\t\t\t\t\tx: x,\n\t\t\t\t\ty: y + h / 2\n\t\t\t\t};\n\t\t\t},\n\t\t\tcenter: function () {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn {\n\t\t\t\t\tx: x + w / 2,\n\t\t\t\t\ty: y + h / 2\n\t\t\t\t};\n\t\t\t},\n\t\t\ttopLeft: function () {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn {\n\t\t\t\t\tx: x,\n\t\t\t\t\ty: y\n\t\t\t\t};\n\t\t\t},\n\t\t\ttopRight: function () {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn {\n\t\t\t\t\tx: x + w,\n\t\t\t\t\ty: y\n\t\t\t\t};\n\t\t\t},\n\t\t\tbottomRight: function () {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn {\n\t\t\t\t\tx: x + w,\n\t\t\t\t\ty: y + h\n\t\t\t\t};\n\t\t\t},\n\t\t\tbottomLeft: function () {\n\t\t\t\tvar x = this.x,\n\t\t\t\t\ty = this.y,\n\t\t\t\t\tw = this.w,\n\t\t\t\t\th = this.h;\n\t\t\t\treturn {\n\t\t\t\t\tx: x,\n\t\t\t\t\ty: y + h\n\t\t\t\t};\n\t\t\t},\n\t\t\tsetX: function (x) {\n\t\t\t\tthis.x = x;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetY: function (y) {\n\t\t\t\tthis.y = y;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetW: function (w) {\n\t\t\t\tthis.w = w;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetH: function (h) {\n\t\t\t\tthis.h = h;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetPos: function (x, y) {\n\t\t\t\tthis.x = x;\n\t\t\t\tthis.y = y;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetSize: function (w, h) {\n\t\t\t\tthis.w = w;\n\t\t\t\tthis.h = h;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tcopy: function (rect) {\n\t\t\t\tthis.x = rect.x;\n\t\t\t\tthis.y = rect.y;\n\t\t\t\tthis.w = rect.w;\n\t\t\t\tthis.h = rect.h;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tclone: function () {\n\t\t\t\treturn new Rect(this.x, this.y, this.w, this.h);\n\t\t\t},\n\t\t\ttoString: function () {\n\t\t\t\treturn '{' + this.x + ',' + this.y + ',' + this.w + ',' + this.h + '}';\n\t\t\t},\n\t\t};\n\t\treturn Rect;\n    }]);\n\n}());\n\n/* global angular, firebase */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('Vector', function() {\n        function Vector(x, y) {\n            this.x = x || 0;\n            this.y = y || 0;\n        }\n        Vector.make = function(a, b) {\n            return new Vector(b.x - a.x, b.y - a.y);\n        };\n        Vector.size = function(a) {\n            return Math.sqrt(a.x * a.x + a.y * a.y);\n        };\n        Vector.normalize = function(a) {\n            var l = Vector.size(a);\n            a.x /= l;\n            a.y /= l;\n            return a;\n        };\n        Vector.incidence = function(a, b) {\n            var angle = Math.atan2(b.y, b.x) - Math.atan2(a.y, a.x);\n            // if (angle < 0) angle += 2 * Math.PI;\n            // angle = Math.min(angle, (Math.PI * 2 - angle));\n            return angle;\n        };\n        Vector.distance = function(a, b) {\n            return Math.sqrt((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));\n        };\n        Vector.cross = function(a, b) {\n            return (a.x * b.y) - (a.y * b.x);\n        };\n        Vector.difference = function(a, b) {\n            return new Vector(a.x - b.x, a.y - b.y);\n        };\n        Vector.power = function(a, b) {\n            var x = Math.abs(b.x - a.x);\n            var y = Math.abs(b.y - a.y);\n            return (x + y) / 2;\n        };\n        Vector.prototype = {\n            size: function() {\n                return Vector.size(this);\n            },\n            normalize: function() {\n                return Vector.normalize(this);\n            },\n            incidence: function(b) {\n                return Vector.incidence(this, b);\n            },\n            cross: function(b) {\n                return Vector.cross(this, b);\n            },\n            distance: function(b) {\n                return Vector.distance(this, b);\n            },\n            difference: function(b) {\n                return Vector.difference(this, b);\n            },\n            power: function() {\n                return (Math.abs(this.x) + Math.abs(this.y)) / 2;\n            },\n            towards: function(b, friction) {\n                friction = friction || 0.125;\n                this.x += (b.x - this.x) * friction;\n                this.y += (b.y - this.y) * friction;\n                return this;\n            },\n            add: function(b) {\n                this.x += b.x;\n                this.y += b.y;\n                return this;\n            },\n            friction: function(b) {\n                this.x *= b;\n                this.y *= b;\n                return this;\n            },\n            copy: function(b) {\n                return new Vector(this.x, this.y);\n            },\n            toString: function() {\n                return '{' + this.x + ',' + this.y + '}';\n            },\n        };\n        return Vector;\n    });\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('Hash', [function() {\n        var pools = {};\n\n        function Hash(key, pool) {\n            key = key || 'id';\n            pool = pool ? Hash.get(pool) : {};\n            Object.defineProperties(this, {\n                key: {\n                    value: key,\n                    enumerable: false,\n                    writable: false\n                },\n                pool: {\n                    value: pool,\n                    enumerable: false,\n                    writable: false\n                },\n                length: {\n                    value: 0,\n                    enumerable: false,\n                    writable: true\n                }\n            });\n        }\n        Hash.get = function(pool) {\n            return (pools[pool] = pools[pool] || {});\n        };\n        Hash.prototype = new Array;\n        Hash.prototype.has = has;\n        Hash.prototype.getId = getId;\n        Hash.prototype.get = get;\n        Hash.prototype.set = set;\n        Hash.prototype.add = add;\n        Hash.prototype.remove = remove;\n        Hash.prototype.each = each;\n        Hash.prototype.addMany = addMany;\n        Hash.prototype.removeMany = removeMany;\n        Hash.prototype.removeAll = removeAll;\n        Hash.prototype.forward = forward;\n        Hash.prototype.backward = backward;\n        Hash.prototype.differs = differs;\n        Hash.prototype.updatePool = updatePool;\n        return Hash;\n\n        function has(id) {\n            return this.pool[id] !== undefined;\n        }\n\n        function getId(id) {\n            return this.pool[id];\n        }\n\n        function get(item) {\n            var hash = this,\n                key = this.key;\n            return item ? hash.getId(item[key]) : null;\n        }\n\n        function set(item) {\n            var hash = this,\n                pool = this.pool,\n                key = this.key;\n            pool[item[key]] = item;\n            hash.push(item);\n            return item;\n        }\n\n        function add(newItem) {\n            var hash = this;\n            var item = hash.get(newItem);\n            if (item) {\n                for (var i = 0, keys = Object.keys(newItem), p; i < keys.length; i++) {\n                    p = keys[i];\n                    item[p] = newItem[p];\n                }\n            } else {\n                item = hash.set(newItem);\n            }\n            return item;\n        }\n\n        function remove(oldItem) {\n            var hash = this,\n                pool = this.pool,\n                key = this.key;\n            var item = hash.get(oldItem);\n            if (item) {\n                var index = hash.indexOf(item);\n                if (index !== -1) {\n                    hash.splice(index, 1);\n                }\n                delete pool[item[key]];\n            }\n            return hash;\n        }\n\n        function addMany(items) {\n            var hash = this;\n            if (!items) {\n                return hash;\n            }\n            var i = 0;\n            while (i < items.length) {\n                hash.add(items[i]);\n                i++;\n            }\n            return hash;\n        }\n\n        function removeMany(items) {\n            var hash = this;\n            if (!items) {\n                return hash;\n            }\n            var i = 0;\n            while (i < items.length) {\n                hash.remove(items[i]);\n                i++;\n            }\n            return hash;\n        }\n\n        function removeAll() {\n            var hash = this,\n                key = hash.key,\n                pool = hash.pool;\n            var i = 0,\n                t = hash.length,\n                item;\n            while (hash.length) {\n                item = hash.shift();\n                delete pool[item[key]];\n                i++;\n            }\n            return hash;\n        }\n\n        function each(callback) {\n            var hash = this;\n            if (callback) {\n                var i = 0;\n                while (i < hash.length) {\n                    callback(hash[i], i);\n                    i++;\n                }\n            }\n            return hash;\n        }\n\n        function forward(key, reverse) {\n            var hash = this;\n            key = (key || this.key);\n            hash.sort(function(c, d) {\n                var a = reverse ? d : c;\n                var b = reverse ? c : d;\n                return a[key] - b[key];\n            });\n            return hash;\n        }\n\n        function backward(key) {\n            return this.forward(key, true);\n        }\n\n        function differs(hash) {\n            if (hash.key !== this.key || hash.length !== this.length) {\n                return true;\n            } else {\n                var differs = false,\n                    i = 0,\n                    t = this.length,\n                    key = this.key;\n                while (differs && i < t) {\n                    differs = this[i][key] !== hash[i][key];\n                    i++;\n                }\n            }\n        }\n\n        function updatePool() {\n            var hash = this,\n                pool = this.pool,\n                key = this.key;\n            Object.keys(pool).forEach(function(key) {\n                delete pool[key];\n            });\n            angular.forEach(hash, function(item) {\n                pool[item[key]] = item;\n            });\n        }\n\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('$promise', ['$q', function($q) {\n        function $promise(callback) {\n            if (typeof callback !== 'function') {\n                throw ('promise resolve callback missing');\n            }\n            var deferred = $q.defer();\n            callback(deferred);\n            return deferred.promise;\n        }\n        var statics = {\n            all: function(promises) {\n                return $q.all(promises);\n            },\n        };\n        angular.extend($promise, statics);\n        return $promise;\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('State', ['$timeout', function($timeout) {\n        var DELAY = 2000;\n\n        function State() {\n            this.errors = [];\n            this.isReady = false;\n            this.idle();\n        }\n\n        State.prototype = {\n            idle: function() {\n                var state = this;\n                state.isBusy = false;\n                state.isError = false;\n                state.isErroring = false;\n                state.isSuccess = false;\n                state.isSuccessing = false;\n                state.button = null;\n                state.errors = [];\n            },\n            busy: function() {\n                var state = this;\n                if (!state.isBusy) {\n                    state.isBusy = true;\n                    state.isError = false;\n                    state.isErroring = false;\n                    state.isSuccess = false;\n                    state.isSuccessing = false;\n                    state.errors = [];\n                    return true;\n                } else {\n                    return false;\n                }\n            },\n            error: function error(error) {\n                console.log('State.error', error);\n                var state = this;\n                state.isBusy = false;\n                state.isError = true;\n                state.isErroring = true;\n                state.isSuccess = false;\n                state.isSuccessing = false;\n                state.errors.push(error);\n                $timeout(function() {\n                    state.isErroring = false;\n                }, DELAY);\n            },\n            ready: function ready() {\n                var state = this;\n                state.idle();\n                state.isReady = true;\n            },\n            success: function success() {\n                var state = this;\n                state.isBusy = false;\n                state.isError = false;\n                state.isErroring = false;\n                state.isSuccess = true;\n                state.isSuccessing = true;\n                state.errors = [];\n                $timeout(function() {\n                    state.isSuccessing = false;\n                }, DELAY);\n            },\n            enabled: function enabled() {\n                var state = this;\n                return !state.isBusy && !state.isErroring && !state.isSuccessing;\n            },\n            errorMessage: function errorMessage() {\n                var state = this;\n                return state.isError ? state.errors[state.errors.length - 1] : null;\n            },\n            submitClass: function submitClass() {\n                var state = this;\n                return {\n                    busy: state.isBusy,\n                    ready: state.isReady,\n                    successing: state.isSuccessing,\n                    success: state.isSuccess,\n                    errorring: state.isErroring,\n                    error: state.isError,\n                };\n            },\n            labels: function labels(addons) {\n                var state = this;\n                var defaults = {\n                    ready: 'submit',\n                    busy: 'sending',\n                    error: 'error',\n                    success: 'success',\n                };\n                if (addons) {\n                    angular.extend(defaults, addons);\n                }\n                var label = defaults.ready;\n                if (state.isBusy) {\n                    label = defaults.busy;\n                } else if (state.isSuccess) {\n                    label = defaults.success;\n                } else if (state.isError) {\n                    label = defaults.error;\n                }\n                return label;\n            },\n            classes: function classes(addons) {\n                var state = this,\n                    classes = null;\n                classes = {\n                    ready: state.isReady,\n                    busy: state.isBusy,\n                    successing: state.isSuccessing,\n                    success: state.isSuccess,\n                    errorring: state.isErroring,\n                    error: state.isError,\n                };\n                if (addons) {\n                    angular.forEach(addons, function(value, key) {\n                        classes[value] = classes[key];\n                    });\n                }\n                return classes;\n            }\n        };\n\n        return State;\n    }]);\n\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar transformProperty = detectTransformProperty();\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Style', [function () {\n\t\tfunction Style() {\n\t\t\tthis.props = {\n\t\t\t\tscale: 1,\n\t\t\t\thoverScale: 1,\n\t\t\t\tcurrentScale: 1,\n\t\t\t};\n\t\t}\n\n\t\tStyle.prototype = {\n\t\t\tset: function (element) {\n\t\t\t\tvar styles = [];\n\t\t\t\tfor (var key in this) {\n\t\t\t\t\tif (key !== 'props') {\n\t\t\t\t\t\tstyles.push(key + ':' + this[key]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telement.style.cssText = styles.join(';') + ';';\n\t\t\t},\n\t\t\ttransform: function (transform) {\n\t\t\t\tthis[transformProperty] = transform;\n\t\t\t},\n\t\t\ttransformOrigin: function (x, y) {\n\t\t\t\tthis[transformProperty + '-origin-x'] = (Math.round(x * 1000) / 1000) + '%';\n\t\t\t\tthis[transformProperty + '-origin-y'] = (Math.round(y * 1000) / 1000) + '%';\n\t\t\t},\n\t\t};\n\n\t\treturn Style;\n    }]);\n\n\tfunction detectTransformProperty() {\n\t\tvar transformProperty = 'transform',\n\t\t\tsafariPropertyHack = 'webkitTransform';\n\t\tvar div = document.createElement(\"DIV\");\n\t\tif (typeof div.style[transformProperty] !== 'undefined') {\n            ['webkit', 'moz', 'o', 'ms'].every(function (prefix) {\n\t\t\t\tvar e = '-' + prefix + '-transform';\n\t\t\t\tif (typeof div.style[e] !== 'undefined') {\n\t\t\t\t\ttransformProperty = e;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t} else if (typeof div.style[safariPropertyHack] !== 'undefined') {\n\t\t\ttransformProperty = '-webkit-transform';\n\t\t} else {\n\t\t\ttransformProperty = undefined;\n\t\t}\n\t\treturn transformProperty;\n\t}\n\n}());\n\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.service('Utils', ['$compile', '$controller', 'Vector', function($compile, $controller, Vector) {\n\n        this.ua = getUA();\n        this.reverseSortOn = reverseSortOn;\n        this.getTouch = getTouch;\n        this.getRelativeTouch = getRelativeTouch;\n        this.getClosest = getClosest;\n        this.getClosestElement = getClosestElement;\n        this.getParents = getParents;\n        this.indexOf = indexOf;\n        this.removeValue = removeValue;\n        this.throttle = throttle;\n        this.where = where;\n        this.format = format;\n        this.compileController = compileController;\n        this.reducer = reducer;\n        this.reducerSetter = reducerSetter;\n        this.reducerAdder = reducerAdder;\n        this.downloadFile = downloadFile;\n        this.serverDownload = serverDownload;\n        this.toMd5 = toMd5;\n\n        var getNow = Date.now || function() {\n            return new Date().getTime();\n        };\n\n        function getUA() {\n            var agent = window.navigator.userAgent.toLowerCase();\n            var safari = agent.indexOf('safari') !== -1 && agent.indexOf('chrome') === -1;\n            var msie = agent.indexOf('trident') !== -1 || agent.indexOf('edge') !== -1 || agent.indexOf('msie') !== -1;\n            var chrome = !safari && !msie && agent.indexOf('chrome') !== -1;\n            var mobile = agent.indexOf('mobile') !== -1;\n            var mac = agent.indexOf('macintosh') !== -1;\n            var ua = {\n                agent: agent,\n                safari: safari,\n                msie: msie,\n                chrome: chrome,\n                mobile: mobile,\n                mac: mac,\n            };\n            angular.forEach(ua, function(value, key) {\n                if (value) {\n                    angular.element(document.getElementsByTagName('body')).addClass(key);\n                }\n            });\n            return ua;\n        }\n\n        function toMd5(string) {\n            // return Md5.encode(string);\n        }\n\n        var _isTouch;\n\n        function isTouch() {\n            if (!_isTouch) {\n                _isTouch = {\n                    value: ('ontouchstart' in window || 'onmsgesturechange' in window)\n                };\n            }\n            // console.log(_isTouch);\n            return _isTouch.value;\n        }\n\n        function getTouch(e, previous) {\n            var t = new Vector();\n            if (e.type === 'touchstart' || e.type === 'touchmove' || e.type === 'touchend' || e.type === 'touchcancel') {\n                var touch = null;\n                var event = e.originalEvent ? e.originalEvent : e;\n                var touches = event.touches.length ? event.touches : event.changedTouches;\n                if (touches && touches.length) {\n                    touch = touches[0];\n                }\n                if (touch) {\n                    t.x = touch.pageX;\n                    t.y = touch.pageY;\n                }\n            } else if (e.type === 'click' || e.type === 'mousedown' || e.type === 'mouseup' || e.type === 'mousemove' || e.type === 'mouseover' || e.type === 'mouseout' || e.type === 'mouseenter' || e.type === 'mouseleave' || e.type === 'contextmenu') {\n                t.x = e.pageX;\n                t.y = e.pageY;\n            }\n            if (previous) {\n                t.s = Vector.difference(t, previous);\n            }\n            t.type = e.type;\n            return t;\n        }\n\n        function getRelativeTouch(node, point) {\n            var element = angular.element(node); // passing through jqlite for accepting both\n            node = element[0];\n            var rect = node.getBoundingClientRect();\n            // var e = new Vector(rect.left + node.scrollLeft, rect.top + node.scrollTop);\n            var e = new Vector(rect.left, rect.top);\n            return Vector.difference(point, e);\n        }\n\n        function getClosest(el, selector) {\n            var matchesFn, parent;\n            ['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector', 'oMatchesSelector'].some(function(fn) {\n                if (typeof document.body[fn] == 'function') {\n                    matchesFn = fn;\n                    return true;\n                }\n                return false;\n            });\n            if (el[matchesFn](selector)) {\n                return el;\n            }\n            while (el !== null) {\n                parent = el.parentElement;\n                if (parent !== null && parent[matchesFn](selector)) {\n                    return parent;\n                }\n                el = parent;\n            }\n            return null;\n        }\n\n        function getClosestElement(el, target) {\n            var matchesFn, parent;\n            if (el === target) {\n                return el;\n            }\n            while (el !== null) {\n                parent = el.parentElement;\n                if (parent !== null && parent === target) {\n                    return parent;\n                }\n                el = parent;\n            }\n            return null;\n        }\n\n        function getParents(node, topParentNode) {\n            // if no topParentNode defined will bubble up all the way to *document*\n            topParentNode = topParentNode || document;\n            var parents = [];\n            var parentNode = node.parentNode;\n            while (parentNode !== topParentNode) {\n                parents.push(parentNode);\n                parentNode = parentNode.parentNode;\n            }\n            parents.push(topParentNode); // push that topParentNode you wanted to stop at\n            return parents;\n        }\n\n        function indexOf(array, object, key) {\n            key = key || 'id';\n            var index = -1;\n            if (array) {\n                var i = 0,\n                    t = array.length;\n                while (i < t) {\n                    if (array[i] && array[i][key] === object[key]) {\n                        index = i;\n                        break;\n                    }\n                    i++;\n                }\n            }\n            return index;\n        }\n\n        function removeValue(array, value) {\n            var index = -1;\n            if (array) {\n                var i = 0,\n                    t = array.length;\n                while (i < t) {\n                    if (array[i] === value) {\n                        index = i;\n                        break;\n                    }\n                    i++;\n                }\n            }\n            if (index !== -1) {\n                array.splice(index, 1);\n                return value;\n            } else {\n                return null;\n            }\n        }\n\n        function throttle(func, wait, options) {\n            // Returns a function, that, when invoked, will only be triggered at most once\n            // during a given window of time. Normally, the throttled function will run\n            // as much as it can, without ever going more than once per `wait` duration;\n            // but if you'd like to disable the execution on the leading edge, pass\n            // `{leading: false}`. To disable execution on the trailing edge, ditto.\n            var context, args, result;\n            var timeout = null;\n            var previous = 0;\n            if (!options) options = {};\n            var later = function() {\n                previous = options.leading === false ? 0 : getNow();\n                timeout = null;\n                result = func.apply(context, args);\n                if (!timeout) context = args = null;\n            };\n            return function() {\n                var now = getNow();\n                if (!previous && options.leading === false) previous = now;\n                var remaining = wait - (now - previous);\n                context = this;\n                args = arguments;\n                if (remaining <= 0 || remaining > wait) {\n                    if (timeout) {\n                        clearTimeout(timeout);\n                        timeout = null;\n                    }\n                    previous = now;\n                    result = func.apply(context, args);\n                    if (!timeout) context = args = null;\n                } else if (!timeout && options.trailing !== false) {\n                    timeout = setTimeout(later, remaining);\n                }\n                return result;\n            };\n        }\n\n        function where(array, query) {\n            var found = null;\n            if (array) {\n                angular.forEach(array, function(item) {\n                    var has = true;\n                    angular.forEach(query, function(value, key) {\n                        has = has && item[key] === value;\n                    });\n                    if (has) {\n                        found = item;\n                    }\n                });\n            }\n            return found;\n        }\n\n        function compileController(scope, element, html, data) {\n            // console.log('Utils.compileController', element);\n            element.html(html);\n            var link = $compile(element.contents());\n            if (data.controller) {\n                var $scope = scope.$new();\n                angular.extend($scope, data);\n                var controller = $controller(data.controller, {\n                    $scope: $scope\n                });\n                if (data.controllerAs) {\n                    scope[data.controllerAs] = controller;\n                }\n                element.data('$ngControllerController', controller);\n                element.children().data('$ngControllerController', controller);\n                scope = $scope;\n            }\n            link(scope);\n        }\n\n        function reverseSortOn(key) {\n            return function(a, b) {\n                if (a[key] < b[key]) {\n                    return 1;\n                }\n                if (a[key] > b[key]) {\n                    return -1;\n                }\n                // a must be equal to b\n                return 0;\n            };\n        }\n\n        function format(string, prepend, expression) {\n            string = string || '';\n            prepend = prepend || '';\n            var splitted = string.split(',');\n            if (splitted.length > 1) {\n                var formatted = splitted.shift();\n                angular.forEach(splitted, function(value, index) {\n                    if (expression) {\n                        formatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n                    } else {\n                        formatted = formatted.split('{' + index + '}').join(prepend + value);\n                    }\n                });\n                if (expression) {\n                    return '\\'' + formatted + '\\'';\n                } else {\n                    return formatted;\n                }\n            } else {\n                return prepend + string;\n            }\n        }\n\n        function reducer(o, key) {\n            return o[key];\n        }\n\n        function reducerSetter(o, key, value) {\n            if (typeof key == 'string') {\n                return reducerSetter(o, key.split('.'), value);\n            } else if (key.length == 1 && value !== undefined) {\n                return (o[key[0]] = value);\n            } else if (key.length === 0) {\n                return o;\n            } else {\n                return reducerSetter(o[key[0]], key.slice(1), value);\n            }\n        }\n\n        function reducerAdder(o, key, value) {\n            if (typeof key == 'string') {\n                return reducerAdder(o, key.split('.'), value);\n            } else if (key.length == 1 && value !== undefined) {\n                return (o[key[0]] += value);\n            } else if (key.length === 0) {\n                return o;\n            } else {\n                return reducerAdder(o[key[0]], key.slice(1), value);\n            }\n        }\n\n        function downloadFile(content, name, type) {\n            type = type || 'application/octet-stream';\n            var base64 = null;\n            var blob = new Blob([content], {\n                type: type\n            });\n            var reader = new window.FileReader();\n            reader.readAsDataURL(blob);\n            reader.onloadend = function() {\n                base64 = reader.result;\n                download();\n            };\n\n            function download() {\n                // If in Chrome or Safari - download via virtual link click\n                // if (isChrome || isSafari) {\n                //Creating new link node.\n                if (document.createEvent) {\n                    var anchor = document.createElement('a');\n                    anchor.href = base64;\n                    if (anchor.download !== undefined) {\n                        //Set HTML5 download attribute. This will prevent file from opening if supported.\n                        var downloadName = name || base64.substring(base64.lastIndexOf('/') + 1, base64.length);\n                        anchor.download = downloadName;\n                    }\n                    //Dispatching click event.\n                    var event = document.createEvent('MouseEvents');\n                    event.initEvent('click', true, true);\n                    anchor.dispatchEvent(event);\n                    return true;\n                }\n                // }\n                // Force file download (whether supported by server).\n                var query = '?download';\n                window.open(base64.indexOf('?') > -1 ? base64 : base64 + query, '_self');\n            }\n\n            function __download() {\n                var supportsDownloadAttribute = 'download' in document.createElement('a');\n                if (supportsDownloadAttribute) {\n                    var anchor = document.createElement('a');\n                    anchor.href = 'data:attachment/text;base64,' + encodeURI(window.btoa(content));\n                    anchor.target = '_blank';\n                    anchor.download = name;\n                    //Dispatching click event.\n                    if (document.createEvent) {\n                        var event = document.createEvent('MouseEvents');\n                        event.initEvent('click', true, true);\n                        anchor.dispatchEvent(event);\n                        return true;\n                    }\n                } else if (window.Blob !== undefined && window.saveAs !== undefined) {\n                    var blob = new Blob([content], {\n                        type: type\n                    });\n                    saveAs(blob, filename);\n                } else {\n                    window.open('data:attachment/text;charset=utf-8,' + encodeURI(content));\n                }\n            }\n            /*\n            var headers = response.headers();\n            // console.log(response);\n            var blob = new Blob([response.data], { type: \"application/octet-stream\" }); // { type: headers['content-type'] });\n            var windowUrl = (window.URL || window.webkitURL);\n            var downloadUrl = windowUrl.createObjectURL(blob);\n            var anchor = document.createElement(\"a\");\n            anchor.href = downloadUrl;\n            var fileNamePattern = /filename[^;=\\n]*=((['\"]).*?\\2|[^;\\n]*)/;\n            anchor.download = fileNamePattern.exec(headers['content-disposition'])[1];\n            document.body.appendChild(anchor);\n            anchor.click();\n            windowUrl.revokeObjectURL(blob);\n            anchor.remove();\n            */\n            /*\n            //Dispatching click event.\n            if (document.createEvent) {\n                var e = document.createEvent('MouseEvents');\n                e.initEvent('click', true, true);\n                link.dispatchEvent(e);\n                return true;\n            }\n            */\n        }\n\n        function serverDownload(options) {\n            var defaults = {\n                uri: '/api/reports/download',\n                name: 'Filename',\n                extension: 'txt',\n                type: 'text/plain',\n                content: 'Hello!',\n            };\n            options = angular.extend(defaults, options);\n            var content = JSON.stringify(options); // unescape(encodeURIComponent(JSON.stringify(download)));\n            var form = document.createElement('form');\n            var input = document.createElement('input');\n            input.name = 'download';\n            input.value = content;\n            form.appendChild(input);\n            form.action = options.uri;\n            form.method = 'POST';\n            form.target = 'ProjectDownloads';\n            form.enctype = 'application/x-www-form-urlencoded';\n            // form.enctype = 'multipart/form-data';\n            // form.enctype = 'text/plain';\n            document.body.appendChild(form);\n            form.submit();\n            setTimeout(function() {\n                document.body.removeChild(form);\n            }, 100);\n            // angular.element(form).find('button')[0].click();\n            return Utils;\n        }\n    }]);\n\n    (function() {\n        // POLYFILL Array.prototype.reduce\n        // Production steps of ECMA-262, Edition 5, 15.4.4.21\n        // Reference: http://es5.github.io/#x15.4.4.21\n        // https://tc39.github.io/ecma262/#sec-array.prototype.reduce\n        if (!Array.prototype.reduce) {\n            Object.defineProperty(Array.prototype, 'reduce', {\n                value: function(callback) { // , initialvalue\n                    if (this === null) {\n                        throw new TypeError('Array.prototype.reduce called on null or undefined');\n                    }\n                    if (typeof callback !== 'function') {\n                        throw new TypeError(callback + ' is not a function');\n                    }\n                    var o = Object(this);\n                    var len = o.length >>> 0;\n                    var k = 0;\n                    var value;\n                    if (arguments.length == 2) {\n                        value = arguments[1];\n                    } else {\n                        while (k < len && !(k in o)) {\n                            k++;\n                        }\n                        if (k >= len) {\n                            throw new TypeError('Reduce of empty array with no initial value');\n                        }\n                        value = o[k++];\n                    }\n                    while (k < len) {\n                        if (k in o) {\n                            value = callback(value, o[k], k, o);\n                        }\n                        k++;\n                    }\n                    return value;\n                }\n            });\n        }\n    }());\n\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.factory('Doc', ['Api', '$promise', function(Api, $promise) {\r\n        function Doc(item) {\r\n            if (item) {\r\n                angular.extend(this, item);\r\n            }\r\n        }\r\n\r\n        Doc.prototype = {\r\n\r\n        };\r\n\r\n        var statics = {};\r\n\r\n        angular.extend(Doc, statics);\r\n\r\n        return Doc;\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.factory('View', ['Api', '$promise', '$location', '$routeParams', 'environment', 'Doc', function(Api, $promise, $location, $routeParams, environment, Doc) {\r\n        function View(doc) {\r\n            var url = $location.path(),\r\n                params = $routeParams;\r\n            var view = {\r\n                environment: environment,\r\n                route: {\r\n                    url: url,\r\n                    params: params,\r\n                },\r\n                doc: doc,\r\n            };\r\n            angular.extend(this, view);\r\n        }\r\n\r\n        View.prototype = {\r\n\r\n        };\r\n\r\n        var statics = {\r\n            current: function() {\r\n                return $promise(function(promise) {\r\n                    var url = $location.path();\r\n                    console.log('View.current', url);\r\n                    Api.docs.url(url).then(function(response) {\r\n                        var doc = new Doc(response);\r\n                        var view = new View(doc);\r\n                        promise.resolve(view);\r\n\r\n                    }, function(error) {\r\n                        promise.reject(error);\r\n\r\n                    });\r\n                    /*\r\n                    Api.navs.main().then(function(items) {\r\n                        var doc = null,\r\n                            url = $location.path(),\r\n                            pool = getPool(items);\r\n                        var item = pool[url];\r\n                        if (item) {\r\n                            doc = new Doc(item);\r\n                        }\r\n                        promise.resolve(doc);\r\n\r\n                    }, function(error) {\r\n                        promise.reject(error);\r\n\r\n                    });\r\n                    */\r\n                });\r\n            }\r\n        };\r\n\r\n        angular.extend(View, statics);\r\n\r\n        function getPool(items) {\r\n            var pool = {};\r\n\r\n            function _getPool(items) {\r\n                if (items) {\r\n                    angular.forEach(items, function(item) {\r\n                        pool[item.url] = item;\r\n                        _getPool(item.items);\r\n                    });\r\n                }\r\n            }\r\n            _getPool(items);\r\n            return pool;\r\n        }\r\n\r\n        return View;\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.service('WebApi', ['$http', '$promise', '$timeout', 'environment',\r\n        function($http, $promise, $timeout, environment) {\r\n\r\n            function $httpPromise(method, url, data) {\r\n                return $promise(function(promise) {\r\n\r\n                    $http[method](environment.urls.api + url, data).then(function(response) {\r\n                        promise.resolve(response.data);\r\n\r\n                    }, function(e, status) {\r\n                        var error = (e && e.data) ? e.data : {};\r\n                        error.status = e.status;\r\n                        promise.reject(error);\r\n\r\n                    });\r\n                });\r\n            }\r\n\r\n            function $get(url) {\r\n                return $httpPromise('get', url);\r\n            }\r\n\r\n            function $post(url, data) {\r\n                return $httpPromise('post', url, data);\r\n            }\r\n\r\n            function $put(url, data) {\r\n                return $httpPromise('put', url, data);\r\n            }\r\n\r\n            function $patch(url, data) {\r\n                return $httpPromise('patch', url, data);\r\n            }\r\n\r\n            function $delete(url) {\r\n                return $httpPromise('delete', url);\r\n            }\r\n\r\n            function $fake(data) {\r\n                var deferred = $q.defer();\r\n                $timeout(function() {\r\n                    deferred.resolve({ data: data });\r\n                }, 1000);\r\n                return deferred.promise;\r\n            }\r\n\r\n            this.get = $get;\r\n            this.post = $post;\r\n            this.put = $put;\r\n            this.patch = $patch;\r\n            this.delete = $delete;\r\n            this.fake = $fake;\r\n\r\n        }\r\n    ]);\r\n\r\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.service('Router', ['$location', '$timeout', function($location, $timeout) {\n\n        var service = this;\n        service.redirect = redirect;\n        service.path = path;\n        service.apply = apply;\n\n        function redirect(path, msecs) {\n            function doRedirect() {\n                $location.$$lastRequestedPath = $location.path();\n                $location.path(path);\n            }\n            if (msecs) {\n                $timeout(function() {\n                    doRedirect();\n                }, msecs);\n            } else {\n                doRedirect();\n            }\n        }\n\n        function path(path, msecs) {\n            function doRetry() {\n                path = $location.$$lastRequestedPath || path;\n                $location.$$lastRequestedPath = null;\n                $location.path(path);\n            }\n            if (msecs) {\n                $timeout(function() {\n                    doRetry();\n                }, msecs);\n            } else {\n                doRetry();\n            }\n        }\n\n        function apply(path, msecs) {\n            function doRetry() {\n                $location.path(path);\n            }\n            if (msecs) {\n                $timeout(function() {\n                    doRetry();\n                }, msecs);\n            } else {\n                $timeout(function() {\n                    doRetry();\n                });\n            }\n        }\n\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('$silent', ['$rootScope', '$location', function($rootScope, $location) {\n        function $silent() {}\n\n        var $path;\n\n        function unlink() {\n            var listeners = $rootScope.$$listeners.$locationChangeSuccess;\n            angular.forEach(listeners, function(value, name) {\n                if (value === listener) {\n                    return;\n                }\n\n                function relink() {\n                    listeners[name] = value;\n                }\n                listeners[name] = relink; // temporary unlinking\n            });\n        }\n\n        function listener(e) {\n            // console.log('onLocationChangeSuccess', e);\n            if ($path === $location.path()) {\n                unlink();\n            }\n            $path = null;\n        }\n\n        var statics = {\n            silent: function(path, replace) {\n                // this.prev = $location.path(); ???\n                var location = $location.url(path);\n                if (replace) {\n                    location.replace();\n                }\n                $path = $location.path();\n            },\n            path: function(path) {\n                return $location.path(path);\n            },\n        };\n\n        angular.extend($silent, statics);\n        $rootScope.$$listeners.$locationChangeSuccess.unshift(listener);\n        // console.log('$rootScope.$$listeners.$locationChangeSuccess', $rootScope.$$listeners.$locationChangeSuccess);\n        return $silent;\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('Cookie', ['$q', '$window', function($q, $window) {\n        function Cookie() {}\n        Cookie.TIMEOUT = 5 * 60 * 1000; // five minutes\n        Cookie._set = function(name, value, days) {\n            var expires;\n            if (days) {\n                var date = new Date();\n                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n                expires = '; expires=' + date.toGMTString();\n            } else {\n                expires = '';\n            }\n            $window.document.cookie = name + '=' + value + expires + '; path=/';\n        };\n        Cookie.exists = function(name) {\n            return $window.document.cookie.indexOf(';' + name + '=') !== -1 || $window.document.cookie.indexOf(name + '=') === 0;\n        };\n        Cookie.get = function(name) {\n            var cookieName = name + \"=\";\n            var ca = $window.document.cookie.split(';');\n            for (var i = 0; i < ca.length; i++) {\n                var c = ca[i];\n                while (c.charAt(0) == ' ') {\n                    c = c.substring(1, c.length);\n                }\n                if (c.indexOf(cookieName) === 0) {\n                    var value = c.substring(cookieName.length, c.length);\n                    var model = null;\n                    try {\n                        model = JSON.parse(decodeURIComponent(atob(value)));\n                    } catch (e) {\n                        console.log('Cookie.get.error parsing', key, e);\n                    }\n                    return model;\n                }\n            }\n            return null;\n        };\n        Cookie.set = function(name, value, days) {\n            try {\n                var cache = [];\n                var json = JSON.stringify(value, function(key, value) {\n                    if (key === 'pool') {\n                        return;\n                    }\n                    if (typeof value === 'object' && value !== null) {\n                        if (cache.indexOf(value) !== -1) {\n                            // Circular reference found, discard key\n                            return;\n                        }\n                        cache.push(value);\n                    }\n                    return value;\n                });\n                cache = null;\n                Cookie._set(name, btoa(encodeURIComponent(json)), days);\n            } catch (e) {\n                console.log('Cookie.set.error serializing', name, value, e);\n            }\n        };\n        Cookie.delete = function(name) {\n            Cookie._set(name, \"\", -1);\n        };\n        Cookie.on = function(name) {\n            var deferred = $q.defer();\n            var i, interval = 1000,\n                elapsed = 0,\n                timeout = Cookie.TIMEOUT;\n\n            function checkCookie() {\n                if (elapsed > timeout) {\n                    deferred.reject('timeout');\n                } else {\n                    var c = Cookie.get(name);\n                    if (c) {\n                        deferred.resolve(c);\n                    } else {\n                        elapsed += interval;\n                        i = setTimeout(checkCookie, interval);\n                    }\n                }\n            }\n            checkCookie();\n            return deferred.promise;\n        };\n        return Cookie;\n    }]);\n\n    app.factory('LocalStorage', ['$q', '$window', 'Cookie', function($q, $window, Cookie) {\n        function LocalStorage() {}\n\n        function isLocalStorageSupported() {\n            var supported = false;\n            try {\n                supported = 'localStorage' in $window && $window.localStorage !== null;\n                if (supported) {\n                    $window.localStorage.setItem('test', '1');\n                    $window.localStorage.removeItem('test');\n                } else {\n                    supported = false;\n                }\n            } catch (e) {\n                supported = false;\n            }\n            return supported;\n        }\n        LocalStorage.isSupported = isLocalStorageSupported();\n        if (LocalStorage.isSupported) {\n            LocalStorage.exists = function(name) {\n                return $window.localStorage[name] !== undefined;\n            };\n            LocalStorage.get = function(name) {\n                var value = null;\n                if ($window.localStorage[name] !== undefined) {\n                    try {\n                        value = JSON.parse($window.localStorage[name]);\n                    } catch (e) {\n                        console.log('LocalStorage.get.error parsing', name, e);\n                    }\n                }\n                return value;\n            };\n            LocalStorage.set = function(name, value) {\n                try {\n                    var cache = [];\n                    var json = JSON.stringify(value, function(key, value) {\n                        if (key === 'pool') {\n                            return;\n                        }\n                        if (typeof value === 'object' && value !== null) {\n                            if (cache.indexOf(value) !== -1) {\n                                // Circular reference found, discard key\n                                return;\n                            }\n                            cache.push(value);\n                        }\n                        return value;\n                    });\n                    cache = null;\n                    $window.localStorage.setItem(name, json);\n                } catch (e) {\n                    console.log('LocalStorage.set.error serializing', name, value, e);\n                }\n            };\n            LocalStorage.delete = function(name) {\n                $window.localStorage.removeItem(name);\n            };\n            LocalStorage.on = function(name) {\n                var deferred = $q.defer();\n                var i, timeout = Cookie.TIMEOUT;\n\n                function storageEvent(e) {\n                    // console.log('LocalStorage.on', name, e);\n                    clearTimeout(i);\n                    if (e.originalEvent.key == name) {\n                        try {\n                            var value = JSON.parse(e.originalEvent.newValue); // , e.originalEvent.oldValue\n                            deferred.resolve(value);\n                        } catch (error) {\n                            console.log('LocalStorage.on.error parsing', name, error);\n                            deferred.reject('error parsing ' + name);\n                        }\n                    }\n                }\n                angular.element($window).on('storage', storageEvent);\n                i = setTimeout(function() {\n                    deferred.reject('timeout');\n                }, timeout);\n                return deferred.promise;\n            };\n        } else {\n            console.log('LocalStorage.unsupported switching to cookies');\n            LocalStorage.exists = Cookie.exists;\n            LocalStorage.set = Cookie.set;\n            LocalStorage.get = Cookie.get;\n            LocalStorage.delete = Cookie.delete;\n            LocalStorage.on = Cookie.on;\n        }\n        return LocalStorage;\n    }]);\n\n    app.factory('SessionStorage', ['$q', '$window', 'Cookie', function($q, $window, Cookie) {\n        function SessionStorage() {}\n\n        function isSessionStorageSupported() {\n            var supported = false;\n            try {\n                supported = 'sessionStorage' in $window && $window.sessionStorage !== undefined;\n                if (supported) {\n                    $window.sessionStorage.setItem('test', '1');\n                    $window.sessionStorage.removeItem('test');\n                } else {\n                    supported = false;\n                }\n            } catch (e) {\n                supported = false;\n            }\n            return supported;\n        }\n        SessionStorage.isSupported = isSessionStorageSupported();\n        if (SessionStorage.isSupported) {\n            SessionStorage.exists = function(name) {\n                return $window.sessionStorage[name] !== undefined;\n            };\n            SessionStorage.get = function(name) {\n                var value = null;\n                if ($window.sessionStorage[name] !== undefined) {\n                    try {\n                        value = JSON.parse($window.sessionStorage[name]);\n                    } catch (e) {\n                        console.log('SessionStorage.get.error parsing', name, e);\n                    }\n                }\n                return value;\n            };\n            SessionStorage.set = function(name, value) {\n                try {\n                    var cache = [];\n                    var json = JSON.stringify(value, function(key, value) {\n                        if (key === 'pool') {\n                            return;\n                        }\n                        if (typeof value === 'object' && value !== null) {\n                            if (cache.indexOf(value) !== -1) {\n                                // Circular reference found, discard key\n                                return;\n                            }\n                            cache.push(value);\n                        }\n                        return value;\n                    });\n                    cache = null;\n                    $window.sessionStorage.setItem(name, json);\n                } catch (e) {\n                    console.log('SessionStorage.set.error serializing', name, value, e);\n                }\n            };\n            SessionStorage.delete = function(name) {\n                $window.sessionStorage.removeItem(name);\n            };\n            SessionStorage.on = function(name) {\n                var deferred = $q.defer();\n                var i, timeout = Cookie.TIMEOUT;\n\n                function storageEvent(e) {\n                    // console.log('SessionStorage.on', name, e);\n                    clearTimeout(i);\n                    if (e.originalEvent.key === name) {\n                        try {\n                            var value = JSON.parse(e.originalEvent.newValue); // , e.originalEvent.oldValue\n                            deferred.resolve(value);\n                        } catch (error) {\n                            console.log('SessionStorage.on.error parsing', name, error);\n                            deferred.reject('error parsing ' + name);\n                        }\n                    }\n                }\n                angular.element($window).on('storage', storageEvent);\n                i = setTimeout(function() {\n                    deferred.reject('timeout');\n                }, timeout);\n                return deferred.promise;\n            };\n        } else {\n            console.log('SessionStorage.unsupported switching to cookies');\n            SessionStorage.exists = Cookie.exists;\n            SessionStorage.set = Cookie.set;\n            SessionStorage.get = Cookie.get;\n            SessionStorage.delete = Cookie.delete;\n            SessionStorage.on = Cookie.on;\n        }\n        return SessionStorage;\n    }]);\n\n}());\n/* global angular, firebase */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.factory('Color', [function () {\n\t\tfunction Color(r, g, b, a) {\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tthis.r = (r || r === 0) ? r : 0;\n\t\t\t\tthis.g = (g || g === 0) ? g : 0;\n\t\t\t\tthis.b = (b || b === 0) ? b : 0;\n\t\t\t\tthis.a = (a || a === 0) ? a : 255;\n\t\t\t} else {\n\t\t\t\tvar uint = r || '0xffffff';\n\t\t\t\tuint = parseInt(uint);\n\t\t\t\tif (r.length > 8) {\n\t\t\t\t\tthis.r = uint >> 24 & 0xff;\n\t\t\t\t\tthis.g = uint >> 16 & 0xff;\n\t\t\t\t\tthis.b = uint >> 8 & 0xff;\n\t\t\t\t\tthis.a = uint >> 0 & 0xff;\n\t\t\t\t} else {\n\t\t\t\t\tthis.r = uint >> 16 & 0xff;\n\t\t\t\t\tthis.g = uint >> 8 & 0xff;\n\t\t\t\t\tthis.b = uint >> 0 & 0xff;\n\t\t\t\t\tthis.a = 255;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tColor.componentToHex = function (c) {\n\t\t\tvar hex = c.toString(16);\n\t\t\treturn hex.length == 1 ? '0' + hex : hex;\n\t\t};\n\t\tColor.luma = function (color) {\n\t\t\t// var luma = color.dot({ r: 54.213, g: 182.376, b: 18.411 });\n\t\t\tvar luma = color.dot({\n\t\t\t\tr: 95,\n\t\t\t\tg: 100,\n\t\t\t\tb: 60\n\t\t\t});\n\t\t\treturn luma;\n\t\t};\n\t\tColor.contrast = function (color) {\n\t\t\tvar luma = Color.luma(color);\n\t\t\tif (luma > 0.6) {\n\t\t\t\treturn new Color('0x000000');\n\t\t\t} else {\n\t\t\t\treturn new Color('0xffffff');\n\t\t\t}\n\t\t};\n\t\tColor.darker = function (color, pow, min) {\n\t\t\tmin = min || 0;\n\t\t\tvar r = Math.max(Math.floor(color.r * min), Math.floor(color.r - 255 * pow));\n\t\t\tvar g = Math.max(Math.floor(color.g * min), Math.floor(color.g - 255 * pow));\n\t\t\tvar b = Math.max(Math.floor(color.b * min), Math.floor(color.b - 255 * pow));\n\t\t\treturn new Color(r, g, b, color.a);\n\t\t};\n\t\tColor.lighter = function (color, pow, max) {\n\t\t\tmax = max || 1;\n\t\t\tvar r = Math.min(color.r + Math.floor((255 - color.r) * max), Math.floor(color.r + 255 * pow));\n\t\t\tvar g = Math.min(color.g + Math.floor((255 - color.g) * max), Math.floor(color.g + 255 * pow));\n\t\t\tvar b = Math.min(color.b + Math.floor((255 - color.b) * max), Math.floor(color.b + 255 * pow));\n\t\t\treturn new Color(r, g, b, color.a);\n\t\t};\n\t\t/*\n\t\tColor.rgbaToHex = function (rgba) {\n\t\t    rgba = rgba.match(/^rgba?[\\s+]?\\([\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?/i);\n\t\t    return (rgba && rgba.length === 4) ? \"#\" +\n\t\t        (\"0\" + parseInt(rgba[1], 10).toString(16)).slice(-2) +\n\t\t        (\"0\" + parseInt(rgba[2], 10).toString(16)).slice(-2) +\n\t\t        (\"0\" + parseInt(rgba[3], 10).toString(16)).slice(-2) : '';\n\t\t}\n\t\t*/\n\t\tColor.prototype = {\n\t\t\ttoUint: function () {\n\t\t\t\treturn (this.r << 24) + (this.g << 16) + (this.b << 8) + (this.a);\n\t\t\t},\n\t\t\ttoHex: function () {\n\t\t\t\treturn '#' + Color.componentToHex(this.r) + Color.componentToHex(this.g) + Color.componentToHex(this.b) + Color.componentToHex(this.a);\n\t\t\t},\n\t\t\ttoRgba: function () {\n\t\t\t\treturn 'rgba(' + this.r + ',' + this.g + ',' + this.b + ',' + (this.a / 255).toFixed(3) + ')';\n\t\t\t},\n\t\t\tdot: function (color) {\n\t\t\t\treturn ((this.r / 255) * (color.r / 255) + (this.g / 255) * (color.g / 255) + (this.b / 255) * (color.b / 255));\n\t\t\t},\n\t\t\talpha: function (pow, min, max) {\n\t\t\t\tmin = min || 0;\n\t\t\t\tmax = max || 1;\n\t\t\t\tthis.a = Math.floor((min + (pow * (max - min))) * 255);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tmakeSet: function () {\n\t\t\t\tthis.foreground = Color.contrast(this);\n\t\t\t\tthis.border = Color.darker(this, 0.3);\n\t\t\t\tthis.light = Color.lighter(this, 0.3);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t};\n\t\treturn Color;\n    }]);\n\n\tapp.factory('Shape', [function () {\n\t\tfunction Shape() {}\n\t\tShape.shapeCircle = function (p, cx, cy, r, sa, ea) {\n\t\t\tsa = sa || 0;\n\t\t\tea = ea || 2 * Math.PI;\n\t\t\tp.ctx.arc(cx, cy, r, sa, ea, false);\n\t\t};\n\t\tShape.shapeStar = function (p, cx, cy, or, ir, steps) {\n\t\t\tvar x, y;\n\t\t\tvar angle = Math.PI / 2 * 3;\n\t\t\tvar step = Math.PI / steps;\n\t\t\tvar ctx = p.ctx;\n\t\t\tctx.moveTo(cx, cy - or);\n\t\t\tfor (i = 0; i < steps; i++) {\n\t\t\t\tx = cx + Math.cos(angle) * or;\n\t\t\t\ty = cy + Math.sin(angle) * or;\n\t\t\t\tctx.lineTo(x, y);\n\t\t\t\tangle += step;\n\t\t\t\tx = cx + Math.cos(angle) * ir;\n\t\t\t\ty = cy + Math.sin(angle) * ir;\n\t\t\t\tctx.lineTo(x, y);\n\t\t\t\tangle += step;\n\t\t\t}\n\t\t\tctx.lineTo(cx, cy - or);\n\t\t};\n\t\tShape.shapeRoundRect = function (p, rect, r) {\n\t\t\tvar ctx = p.ctx,\n\t\t\t\tx = rect.x,\n\t\t\t\ty = rect.y,\n\t\t\t\tw = rect.w,\n\t\t\t\th = rect.h;\n\t\t\tif (typeof r === undefined) {\n\t\t\t\tr = 4;\n\t\t\t}\n\t\t\tif (typeof r === 'number') {\n\t\t\t\tr = {\n\t\t\t\t\ttl: r,\n\t\t\t\t\ttr: r,\n\t\t\t\t\tbr: r,\n\t\t\t\t\tbl: r\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tvar defaultRadius = {\n\t\t\t\t\ttl: 0,\n\t\t\t\t\ttr: 0,\n\t\t\t\t\tbr: 0,\n\t\t\t\t\tbl: 0\n\t\t\t\t};\n\t\t\t\tfor (var key in defaultRadius) {\n\t\t\t\t\tr[key] = r[key] || defaultRadius[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\tctx.moveTo(x + r.tl, y);\n\t\t\tctx.lineTo(x + w - r.tr, y);\n\t\t\tctx.quadraticCurveTo(x + w, y, x + w, y + r.tr);\n\t\t\tctx.lineTo(x + w, y + h - r.br);\n\t\t\tctx.quadraticCurveTo(x + w, y + h, x + w - r.br, y + h);\n\t\t\tctx.lineTo(x + r.bl, y + h);\n\t\t\tctx.quadraticCurveTo(x, y + h, x, y + h - r.bl);\n\t\t\tctx.lineTo(x, y + r.tl);\n\t\t\tctx.quadraticCurveTo(x, y, x + r.tl, y);\n\t\t};\n\t\tShape.circle = function () {\n\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\tvar ctx = params[0].ctx;\n\t\t\tctx.beginPath();\n\t\t\tShape.shapeCircle.apply(this, params);\n\t\t\tctx.closePath();\n\t\t};\n\t\tShape.star = function () {\n\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\tvar ctx = params[0].ctx;\n\t\t\tctx.beginPath();\n\t\t\tShape.shapeStar.apply(this, params);\n\t\t\tctx.closePath();\n\t\t};\n\t\tShape.roundRect = function () {\n\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\tvar ctx = params[0].ctx;\n\t\t\tctx.beginPath();\n\t\t\tShape.shapeRoundRect.apply(this, params);\n\t\t\tctx.closePath();\n\t\t};\n\t\treturn Shape;\n    }]);\n\n\tapp.constant('PainterColors', {\n\t\t/*\n\t\tblack: new Color('0x111111'),\n\t\twhite: new Color('0xffffff'),\n\t\tred: new Color('0xff0000'),\n\t\tgreen: new Color('0x00ff00'),\n\t\tblue: new Color('0x0000ff'),\n\t\tyellow: new Color('0xffff00'),\n\t\tcyan: new Color('0x00ffff'),\n\t\tpurple: new Color('0xff00ff'),\n\t\t*/\n\t\tblack: '0x14191e',\n\t\twhite: '0xffffff',\n\t\tblue: '0x0023FF',\n\t\tred: '0xF21500',\n\t\tlightBlue: '0x79ccf2',\n\t\tlightYellow: '0xfff79a',\n\t\tgreyLighter: '0xf8f8f8',\n\t\tgreyLight: '0xeeeeee',\n\t\tgreyMedium: '0xcccccc',\n\t\tgrey: '0x90939b',\n\t\tmap: '0x24292e',\n\t});\n\n\tapp.factory('Palette', ['$q', 'Painter', 'Rect', function ($q, Painter, Rect) {\n\t\tfunction Palette() {\n\t\t\tthis.painter = new Painter().setSize(0, 0);\n\t\t\tthis.buffer = new Painter().setSize(0, 0);\n\t\t\tthis.size = {\n\t\t\t\tw: 0,\n\t\t\t\th: 0\n\t\t\t};\n\t\t\tthis.pool = {};\n\t\t\tthis.rows = {};\n\t\t}\n\t\tPalette.prototype = {\n\t\t\tgetRect: function (w, h) {\n\t\t\t\tvar p = this.painter,\n\t\t\t\t\tsize = this.size,\n\t\t\t\t\trows = this.rows,\n\t\t\t\t\tr = new Rect(0, 0, w, h),\n\t\t\t\t\trow = rows[h] || {\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: size.h\n\t\t\t\t\t};\n\t\t\t\tsize.w = Math.max(size.w, row.x + w);\n\t\t\t\tsize.h = Math.max(size.h, row.y + h);\n\t\t\t\tif (!p.canvas.width && !p.canvas.height) {\n\t\t\t\t\tp.setSize(size.w, size.h);\n\t\t\t\t} else if (size.w > p.canvas.width || size.h > p.canvas.height) {\n\t\t\t\t\t// var img = new Image();\n\t\t\t\t\t// img.src = p.toDataURL();\n\t\t\t\t\t// document.body.appendChild(canvas);\n\t\t\t\t\t// console.log(p.canvas.width, p.canvas.height);\n\t\t\t\t\t// var data = p.ctx.getImageData(0, 0, p.canvas.width, p.canvas.height);\n\t\t\t\t\tvar canvas = p.canvas;\n\t\t\t\t\tp.setCanvas(document.createElement('canvas'));\n\t\t\t\t\tp.setSize(size.w, size.h);\n\t\t\t\t\tp.ctx.drawImage(canvas, 0, 0);\n\t\t\t\t\t// p.ctx.putImageData(data, 0, 0);\n\t\t\t\t\t// p.ctx.drawImage(img, 0, 0);\n\t\t\t\t\t// document.body.removeChild(canvas);\n\t\t\t\t}\n\t\t\t\tr.x = row.x;\n\t\t\t\tr.y = row.y;\n\t\t\t\trow.x += w;\n\t\t\t\trows[h] = row;\n\t\t\t\treturn r;\n\t\t\t},\n\t\t\tadd: function (key, path) {\n\t\t\t\tvar palette = this;\n\t\t\t\tif (angular.isString(path)) {\n\t\t\t\t\tvar deferred = $q.defer();\n\t\t\t\t\tvar img = new Image();\n\t\t\t\t\timg.onload = function () {\n\t\t\t\t\t\tpalette.addShape(key, img.width, img.height, function (p, rect) {\n\t\t\t\t\t\t\tp.ctx.drawImage(img, 0, 0);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdeferred.resolve(img);\n\t\t\t\t\t};\n\t\t\t\t\timg.onerror = function () {\n\t\t\t\t\t\tdeferred.reject('connot load ' + path);\n\t\t\t\t\t};\n\t\t\t\t\timg.src = path;\n\t\t\t\t\treturn deferred.promise;\n\t\t\t\t} else {\n\t\t\t\t\tvar params = Array.prototype.slice.call(arguments);\n\t\t\t\t\treturn palette.addShape.apply(palette, params);\n\t\t\t\t}\n\t\t\t},\n\t\t\taddShape: function (key, w, h, callback) {\n\t\t\t\tvar p = this.painter,\n\t\t\t\t\tr = this.getRect(w, h);\n\t\t\t\tp.ctx.save();\n\t\t\t\tp.ctx.rect(r.x, r.y, r.w, r.h);\n\t\t\t\t// p.ctx.stroke();\n\t\t\t\tp.ctx.clip();\n\t\t\t\tp.ctx.translate(r.x, r.y);\n\t\t\t\tcallback.call(p, p, r.clone().setPos(0, 0));\n\t\t\t\tp.ctx.restore();\n\t\t\t\tthis.pool[key] = r;\n\t\t\t\t// console.log('Painter.add', r);\n\t\t\t},\n\t\t\tdraw: function (target, key, x, y, pre) {\n\t\t\t\tvar r = this.pool[key];\n\t\t\t\tif (r) {\n\t\t\t\t\t// var ctx = target.ctx;\n\t\t\t\t\t// ctx.save();\n\t\t\t\t\ttarget.drawRect(this.painter.canvas, r, {\n\t\t\t\t\t\tx: x,\n\t\t\t\t\t\ty: y,\n\t\t\t\t\t\tw: r.w,\n\t\t\t\t\t\th: r.h\n\t\t\t\t\t}, pre);\n\t\t\t\t\t// target.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, x - r.w / 2, y - r.h / 2, r.w, r.h);\n\t\t\t\t\t// ctx.restore();\n\t\t\t\t}\n\t\t\t},\n\t\t\ttint: function (target, key, x, y, color, pre) {\n\t\t\t\tvar r = this.pool[key];\n\t\t\t\tif (r) {\n\t\t\t\t\tvar p = this.painter,\n\t\t\t\t\t\tb = this.buffer.setSize(r.w, r.h);\n\t\t\t\t\tb.save();\n\t\t\t\t\tb.setFill(color);\n\t\t\t\t\tb.fillRect();\n\t\t\t\t\tb.ctx.globalCompositeOperation = \"destination-atop\";\n\t\t\t\t\tb.ctx.drawImage(p.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n\t\t\t\t\tb.restore();\n\t\t\t\t\tconsole.log(x, y, b.canvas, target.canvas);\n\t\t\t\t\ttarget.draw(b.canvas, {\n\t\t\t\t\t\tx: x,\n\t\t\t\t\t\ty: y\n\t\t\t\t\t}, pre);\n\t\t\t\t}\n\t\t\t},\n\t\t\tpattern: function (target, key, x, y, w, h, color) {\n\t\t\t\tfunction drawPattern(pattern) {\n\t\t\t\t\tvar ctx = target.ctx;\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\t// draw\n\t\t\t\t\t// ctx.beginPath();\n\t\t\t\t\t// ctx.rect(-x, -y, w, h);\n\t\t\t\t\tctx.fillStyle = pattern;\n\t\t\t\t\tctx.fillRect(-x, -y, w, h);\n\t\t\t\t\tctx.translate(-x, -y);\n\t\t\t\t\t// ctx.fill();\n\t\t\t\t\tctx.restore();\n\t\t\t\t}\n\t\t\t\tvar r = this.pool[key];\n\t\t\t\tif (r) {\n\t\t\t\t\tvar img = r.img,\n\t\t\t\t\t\tpattern;\n\t\t\t\t\tif (!img || r.color != color) {\n\t\t\t\t\t\tvar b = this.buffer.setSize(r.w, r.h);\n\t\t\t\t\t\tif (color) {\n\t\t\t\t\t\t\tr.color = color;\n\t\t\t\t\t\t\tb.save();\n\t\t\t\t\t\t\tb.setFill(color);\n\t\t\t\t\t\t\tb.fillRect();\n\t\t\t\t\t\t\tb.ctx.globalCompositeOperation = \"destination-atop\";\n\t\t\t\t\t\t\tb.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n\t\t\t\t\t\t\tb.restore();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tb.ctx.drawImage(this.painter.canvas, r.x, r.y, r.w, r.h, 0, 0, r.w, r.h);\n\t\t\t\t\t\t}\n\t\t\t\t\t\timg = new Image();\n\t\t\t\t\t\timg.onload = function () {\n\t\t\t\t\t\t\tr.img = img;\n\t\t\t\t\t\t\tpattern = target.ctx.createPattern(img, \"repeat\");\n\t\t\t\t\t\t\tdrawPattern(pattern);\n\t\t\t\t\t\t};\n\t\t\t\t\t\timg.src = b.toDataURL();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpattern = target.ctx.createPattern(img, \"repeat\");\n\t\t\t\t\t\tdrawPattern(pattern);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t\treturn Palette;\n    }]);\n\n\tapp.factory('Painter', ['Shape', 'Rect', 'Color', 'PainterColors', function (Shape, Rect, Color, PainterColors) {\n\t\tfunction Painter(canvas) {\n\t\t\tcanvas = canvas || document.createElement('canvas');\n\t\t\tthis.rect = new Rect();\n\t\t\tthis.drawingRect = new Rect();\n\t\t\tthis.setColors();\n\t\t\tthis.setCanvas(canvas);\n\t\t}\n\t\tPainter.colors = {};\n\t\tangular.forEach(PainterColors, function (value, key) {\n\t\t\tPainter.colors[key] = new Color(value).makeSet();\n\t\t});\n\t\tvar colors = Painter.colors;\n\t\tPainter.prototype = {\n\t\t\tcolors: Painter.colors,\n\t\t\tsetColors: function () {\n\t\t\t\tvar colors = this.colors;\n\t\t\t\tangular.forEach(PainterColors, function (value, key) {\n\t\t\t\t\tcolors[key] = new Color(value).makeSet();\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCanvas: function (canvas) {\n\t\t\t\tthis.canvas = canvas;\n\t\t\t\tthis.setSize(canvas.offsetWidth, canvas.offsetHeight);\n\t\t\t\tvar ctx = canvas.getContext('2d');\n\t\t\t\tctx.lineCap = 'square';\n\t\t\t\tthis.ctx = ctx;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetSize: function (w, h) {\n\t\t\t\tthis.canvas.width = w;\n\t\t\t\tthis.canvas.height = h;\n\t\t\t\tthis.rect.w = w;\n\t\t\t\tthis.rect.h = h;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tcopy: function (canvas) {\n\t\t\t\tthis.ctx.drawImage(canvas, 0, 0);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tclear: function () {\n\t\t\t\tthis.resize();\n\t\t\t\t// this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tresize: function () {\n\t\t\t\tthis.setSize(this.canvas.offsetWidth, this.canvas.offsetHeight);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetText: function (font, align, verticalAlign, color) {\n\t\t\t\tfont = font || '11px monospace';\n\t\t\t\talign = align || 'center';\n\t\t\t\tverticalAlign = verticalAlign || 'middle';\n\t\t\t\tcolor = color || this.colors.black;\n\t\t\t\tvar ctx = this.ctx;\n\t\t\t\tctx.font = font;\n\t\t\t\tctx.textAlign = align;\n\t\t\t\tctx.textBaseline = verticalAlign;\n\t\t\t\tctx.fillStyle = color.toRgba();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetFill: function (color) {\n\t\t\t\tcolor = color || this.colors.black;\n\t\t\t\tvar ctx = this.ctx;\n\t\t\t\t/*\n\t\t\t\tvar my_gradient = ctx.createLinearGradient(0, 0, 0, 170);\n\t\t\t\tmy_gradient.addColorStop(0, \"black\");\n\t\t\t\tmy_gradient.addColorStop(1, \"white\");\n\t\t\t\tctx.fillStyle = my_gradient;\n\t\t\t\t*/\n\t\t\t\tctx.fillStyle = color.toRgba();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsetStroke: function (color, size) {\n\t\t\t\tcolor = color || this.colors.black;\n\t\t\t\tvar ctx = this.ctx;\n\t\t\t\tsize = size || 1;\n\t\t\t\t/*\n\t\t\t\tvar gradient=ctx.createLinearGradient(0,0,170,0);\n\t\t\t\tgradient.addColorStop(\"0\",\"magenta\");\n\t\t\t\tgradient.addColorStop(\"0.5\",\"blue\");\n\t\t\t\tgradient.addColorStop(\"1.0\",\"red\");\n\t\t\t\tctx.strokeStyle = gradient;\n\t\t\t\t*/\n\t\t\t\t// Fill with gradient\n\t\t\t\tctx.strokeStyle = color.toRgba();\n\t\t\t\tctx.lineWidth = size;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t/*\n\t\t\tdrawRoundRect: function (rect, r) {\n\t\t\t    rect = rect || this.rect;\n\t\t\t    Shape.roundRect(this, rect, r);\n\t\t\t    return this;\n\t\t\t},\n\t\t\t*/\n\t\t\tfillText: function (text, point, width, post, maxLength) {\n\t\t\t\tif (width) {\n\t\t\t\t\tpost = post || '';\n\t\t\t\t\tmaxLength = maxLength || Math.floor(width / 8);\n\t\t\t\t\tif (text.length > maxLength) {\n\t\t\t\t\t\ttext = text.substr(0, Math.min(text.length, maxLength)).trim() + post;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.ctx.fillText(text, point.x, point.y);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tfillRect: function (rect) {\n\t\t\t\trect = rect || this.rect;\n\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\tx = rect.x,\n\t\t\t\t\ty = rect.y,\n\t\t\t\t\tw = rect.w,\n\t\t\t\t\th = rect.h;\n\t\t\t\tctx.fillRect(x, y, w, h);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tstrokeRect: function (rect) {\n\t\t\t\trect = rect || this.rect;\n\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\tx = rect.x,\n\t\t\t\t\ty = rect.y,\n\t\t\t\t\tw = rect.w,\n\t\t\t\t\th = rect.h;\n\t\t\t\tctx.strokeRect(x, y, w, h);\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tfill: function () {\n\t\t\t\tthis.ctx.fill();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tstroke: function () {\n\t\t\t\tthis.ctx.stroke();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tbegin: function () {\n\t\t\t\tthis.ctx.beginPath();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tclose: function () {\n\t\t\t\tthis.ctx.closePath();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tsave: function () {\n\t\t\t\tthis.ctx.save();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\trestore: function () {\n\t\t\t\tthis.ctx.restore();\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\trotate: function (angle) {\n\t\t\t\tthis.ctx.rotate(angle * Math.PI / 180);\n\t\t\t},\n\t\t\ttranslate: function (xy) {\n\t\t\t\tthis.ctx.translate(xy.x, xy.y);\n\t\t\t},\n\t\t\ttoDataURL: function () {\n\t\t\t\treturn this.canvas.toDataURL();\n\t\t\t},\n\t\t\tdraw: function (image, t, pre) {\n\t\t\t\tif (image) {\n\t\t\t\t\tt.w = t.w || image.width;\n\t\t\t\t\tt.h = t.h || image.height;\n\t\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\t\trect = this.drawingRect,\n\t\t\t\t\t\tx = rect.x = t.x - t.w / 2,\n\t\t\t\t\t\ty = rect.y = t.y - t.h / 2,\n\t\t\t\t\t\tw = rect.w = t.w,\n\t\t\t\t\t\th = rect.h = t.h;\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\tif (pre) {\n\t\t\t\t\t\tpre.call(this);\n\t\t\t\t\t}\n\t\t\t\t\tctx.drawImage(image, 0, 0);\n\t\t\t\t\tctx.restore();\n\t\t\t\t\t// console.log('painter.draw', x, y, w, h);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tdrawRect: function (image, s, t, pre) {\n\t\t\t\tif (image) {\n\t\t\t\t\ts.w = s.w || image.width;\n\t\t\t\t\ts.h = s.h || image.height;\n\t\t\t\t\tt.w = t.w || image.width;\n\t\t\t\t\tt.h = t.h || image.height;\n\t\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\t\trect = this.drawingRect,\n\t\t\t\t\t\tx = rect.x = t.x - s.w / 2,\n\t\t\t\t\t\ty = rect.y = t.y - s.h / 2,\n\t\t\t\t\t\tw = rect.w = t.w,\n\t\t\t\t\t\th = rect.h = t.h;\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\tif (pre) {\n\t\t\t\t\t\tpre.call(this);\n\t\t\t\t\t}\n\t\t\t\t\tctx.drawImage(image, s.x, s.y, s.w, s.h, 0, 0, t.w, t.h);\n\t\t\t\t\tctx.restore();\n\t\t\t\t\t// console.log('painter.drawRect', x, y, w, h);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tflip: function (scale) {\n\t\t\t\tscale = scale || {\n\t\t\t\t\tx: 1,\n\t\t\t\t\ty: -1\n\t\t\t\t};\n\t\t\t\tvar ctx = this.ctx,\n\t\t\t\t\trect = this.drawingRect;\n\t\t\t\tctx.translate(scale.x === -1 ? rect.w : 0, scale.y === -1 ? rect.h : 0);\n\t\t\t\tctx.scale(scale.x, scale.y);\n\t\t\t},\n\t\t};\n\t\treturn Painter;\n    }]);\n\n}());\n\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.directive('controlMessages', [function() {\n        return {\n            restrict: 'E',\n            templateUrl: 'artisan/forms/messages',\n            transclude: {\n                'message': '?messageItems',\n            },\n            link: function(scope, element, attributes, model) {}\n        };\n    }]);\n\n    app.directive('control', ['$parse', function($parse) {\n        function formatLabel(string, prepend, expression) {\n            string = string || '';\n            prepend = prepend || '';\n            var splitted = string.split(',');\n            if (splitted.length > 1) {\n                var formatted = splitted.shift();\n                angular.forEach(splitted, function(value, index) {\n                    if (expression) {\n                        formatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n                    } else {\n                        formatted = formatted.split('{' + index + '}').join(prepend + value);\n                    }\n                });\n                if (expression) {\n                    return '\\'' + formatted + '\\'';\n                } else {\n                    return formatted;\n                }\n            } else {\n                return prepend + string;\n            }\n        }\n        var uniqueId = 0;\n        return {\n            restrict: 'A',\n            templateUrl: function(element, attributes) {\n                var template = 'artisan/forms/text';\n                switch (attributes.control) {\n                    case 'select':\n                        template = 'artisan/forms/select';\n                        break;\n                }\n                return template;\n            },\n            scope: {\n                ngModel: '=',\n                required: '=',\n                form: '@',\n                title: '@',\n                placeholder: '@',\n                source: '=?',\n                key: '@?',\n                label: '@?',\n            },\n            require: 'ngModel',\n            transclude: true,\n            link: {\n                pre: function preLink(scope, element, attributes, controller, transclude) {\n                    var label = scope.label = (scope.label ? scope.label : 'name');\n                    var key = scope.key = (scope.key ? scope.key : 'id');\n                    if (attributes.control === 'select') {\n                        var filter = (attributes.filter ? '| ' + attributes.filter : '');\n                        var optionLabel = formatLabel(label, 'item.', true);\n                        scope.getOptions = function() {\n                            return attributes.number ?\n                                'item.' + key + ' as ' + optionLabel + ' disable when item.disabled for item in source ' + filter :\n                                optionLabel + ' disable when item.disabled for item in source ' + filter + ' track by item.' + key;\n                        };\n                    }\n                    var type = scope.type = attributes.control;\n                    var form = scope.form = scope.form || 'form';\n                    var title = scope.title = scope.title || 'untitled';\n                    var placeholder = scope.placeholder = scope.placeholder || title;\n                    var field = scope.field = title.replace(/[^0-9a-zA-Z]/g, \"\").split(' ').join('') + (++uniqueId);\n                    scope.format = attributes.format || null;\n                    scope.precision = attributes.precision || null;\n                    scope.validate = attributes.validate || attributes.control;\n                    scope.minLength = attributes.minLength || 0;\n                    scope.maxLength = attributes.maxLength || Number.POSITIVE_INFINITY;\n                    scope.min = attributes.min || null;\n                    scope.max = attributes.max || null;\n                    scope.options = $parse(attributes.options)(scope) || {};\n                    scope.focus = false;\n                    scope.visible = false;\n                    scope.onChange = function(model) {\n                        $parse(attributes.onChange)(scope.$parent);\n                    };\n                    scope.onFilter = function(model) {\n                        $parse(attributes.onFilter)(scope.$parent);\n                    };\n                    scope.getType = function() {\n                        var type = 'text';\n                        switch (attributes.control) {\n                            case 'password':\n                                type = scope.visible ? 'text' : 'password';\n                                break;\n                            default:\n                                type = attributes.control;\n                        }\n                        return type;\n                    };\n                    scope.getClasses = function() {\n                        var form = $parse(scope.form)(scope.$parent);\n                        var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                        return {\n                            'control-focus': scope.focus,\n                            'control-success': field.$valid,\n                            'control-error': field.$invalid && (form.$submitted || field.$touched),\n                            'control-empty': !field.$viewValue\n                        };\n                    };\n                    scope.getMessages = function() {\n                        var form = $parse(scope.form)(scope.$parent);\n                        var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                        return (form.$submitted || field.$touched) && field.$error;\n                    };\n                    scope.toggleVisibility = function() {\n                        scope.visible = !scope.visible;\n                    };\n                },\n            },\n        };\n    }]);\n\n    app.directive('_control', ['$http', '$templateCache', '$compile', '$parse', function($http, $templateCache, $compile, $parse) {\n        function formatLabel(string, prepend, expression) {\n            string = string || '';\n            prepend = prepend || '';\n            var splitted = string.split(',');\n            if (splitted.length > 1) {\n                var formatted = splitted.shift();\n                angular.forEach(splitted, function(value, index) {\n                    if (expression) {\n                        formatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n                    } else {\n                        formatted = formatted.split('{' + index + '}').join(prepend + value);\n                    }\n                });\n                if (expression) {\n                    return '\\'' + formatted + '\\'';\n                } else {\n                    return formatted;\n                }\n            } else {\n                return prepend + string;\n            }\n        }\n        var uniqueId = 0;\n        return {\n            restrict: 'A',\n            templateUrl: function(element, attributes) {\n                var template = 'artisan/forms/text';\n                switch (attributes.control) {\n                    case 'select':\n                        template = 'artisan/forms/select';\n                        break;\n                }\n                return template;\n            },\n            scope: {\n                ngModel: '=',\n                required: '=',\n                form: '@',\n                title: '@',\n                placeholder: '@',\n            },\n            require: 'ngModel',\n            /*\n            link: function(scope, element, attributes, model) {\n            },\n            */\n            compile: function(element, attributes) {\n                    return {\n                        pre: function(scope, element, attributes) {\n                            if (attributes.control === 'select') {\n                                var label = (attributes.label ? attributes.label : 'name');\n                                var key = (attributes.key ? attributes.key : 'id');\n                                var filter = (attributes.min ? ' | filter:gte(\\'' + key + '\\', ' + attributes.min + ')' : '');\n                                var optionLabel = formatLabel(label, 'item.', true);\n                                scope.options = attributes.number ?\n                                    'item.' + key + ' as ' + optionLabel + ' disable when item.disabled for item in ' + attributes.source + filter :\n                                    optionLabel + ' disable when item.disabled for item in ' + attributes.source + filter + ' track by item.' + key;\n                                console.log('control.compile.pre', scope.options);\n                            }\n                            var type = scope.type = attributes.control;\n                            var form = scope.form = scope.form || 'form';\n                            var title = scope.title = scope.title || 'untitled';\n                            var placeholder = scope.placeholder = scope.placeholder || title;\n                            var field = scope.field = title.replace(/[^0-9a-zA-Z]/g, \"\").split(' ').join('') + (++uniqueId);\n                            scope.validate = attributes.validate || attributes.control;\n                            scope.format = attributes.format || null;\n                            scope.precision = attributes.precision || null;\n                            scope.validate = attributes.validate || attributes.control;\n                            scope.minLength = attributes.min || 0;\n                            scope.maxLength = attributes.max || Number.POSITIVE_INFINITY;\n                            scope.options = $parse(attributes.options)(scope) || {};\n                            scope.focus = false;\n                            scope.visible = false;\n                            scope.getType = function() {\n                                var type = 'text';\n                                switch (attributes.control) {\n                                    case 'password':\n                                        // var form = $parse(scope.form)(scope.$parent);\n                                        // var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                        type = scope.visible ? 'text' : 'password';\n                                        break;\n                                    default:\n                                        type = attributes.control;\n                                }\n                                // console.log('control.getType', type);\n                                return type;\n                            };\n                            scope.getClasses = function() {\n                                var form = $parse(scope.form)(scope.$parent);\n                                var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                return {\n                                    'control-focus': scope.focus,\n                                    'control-success': field.$valid,\n                                    'control-error': field.$invalid && (form.$submitted || field.$touched),\n                                    'control-empty': !field.$viewValue\n                                };\n                            };\n                            scope.getMessages = function() {\n                                var form = $parse(scope.form)(scope.$parent);\n                                var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                return (form.$submitted || field.$touched) && field.$error;\n                            };\n                        },\n                        // post: function (scope, element, attributes) { }\n                    };\n                }\n                /*\n                compile: function(element, attributes) {\n                    element.removeAttr('my-dir'); \n                    element.attr('ng-hide', 'true');\n                    return function(scope) {\n                        $compile(element)(scope);\n                    };\n                },\n                */\n        };\n    }]);\n\n    app.directive('numberPicker', ['$parse', '$timeout', function($parse, $timeout) {\n        return {\n            restrict: 'A',\n            template: '<div class=\"input-group\">' +\n                '   <span class=\"input-group-btn\"><button class=\"btn btn-outline-primary\" type=\"button\">-</button></span>' +\n                '   <div ng-transclude></div>' +\n                '   <span class=\"input-group-btn\"><button class=\"btn btn-outline-primary\" type=\"button\">+</button></span>' +\n                '</div>',\n            replace: true,\n            transclude: true,\n            link: function(scope, element, attributes, model) {\n                var node = element[0];\n                var nodeRemove = node.querySelectorAll('.input-group-btn > .btn')[0];\n                var nodeAdd = node.querySelectorAll('.input-group-btn > .btn')[1];\n\n                function onRemove(e) {\n                    var min = $parse(attributes.min)(scope);\n                    var getter = $parse(attributes.numberPicker);\n                    var setter = getter.assign;\n                    $timeout(function() {\n                        setter(scope, Math.max(min, getter(scope) - 1));\n                    });\n                    // console.log('numberPicker.onRemove', min);\n                }\n\n                function onAdd(e) {\n                    var max = $parse(attributes.max)(scope);\n                    var getter = $parse(attributes.numberPicker);\n                    var setter = getter.assign;\n                    $timeout(function() {\n                        setter(scope, Math.min(max, getter(scope) + 1));\n                    });\n                    // console.log('numberPicker.onAdd', max);\n                }\n\n                function addListeners() {\n                    angular.element(nodeRemove).on('touchstart mousedown', onRemove);\n                    angular.element(nodeAdd).on('touchstart mousedown', onAdd);\n                }\n\n                function removeListeners() {\n                    angular.element(nodeRemove).off('touchstart mousedown', onRemove);\n                    angular.element(nodeAdd).off('touchstart mousedown', onAdd);\n                }\n                scope.$on('$destroy', function() {\n                    removeListeners();\n                });\n                addListeners();\n            }\n        };\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.directive('validate', ['$filter', function($filter) {\n        return {\n            require: 'ngModel',\n            link: function(scope, element, attributes, model) {\n                var type = attributes.validate;\n                var format = attributes.format || '';\n                var precision = attributes.precision || 2;\n                var focus = false;\n                // console.log('validate', type);\n                switch (type) {\n                    case 'date':\n                    case 'datetime':\n                    case 'datetime-local':\n                        model.$formatters.push(function(value) {\n                            if (value) {\n                                return $filter('date')(value, format);\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                    case 'number':\n                        model.$parsers.unshift(function(value) {\n                            var valid = false;\n                            if (value !== undefined && value !== \"\") {\n                                valid = String(value).indexOf(Number(value).toString()) !== -1; // isFinite(value); // \n                                value = Number(value);\n                                model.$setValidity('number', valid);\n                                if (valid) {\n                                    model.$setValidity('positive', value >= 0.01);\n                                    if (attributes.min !== undefined) {\n                                        model.$setValidity('range', value >= Number(attributes.min));\n                                    }\n                                    if (attributes.max !== undefined) {\n                                        model.$setValidity('range', value <= Number(attributes.max));\n                                    }\n                                }\n                            } else {\n                                valid = true;\n                                value = Number(value);\n                                model.$setValidity('number', true);\n                                model.$setValidity('positive', true);\n                                if (attributes.min !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                                if (attributes.max !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                            }\n                            return value;\n                        });\n                        model.$formatters.push(function(value) {\n                            if (value) {\n                                return $filter('number')(value, precision) + ' ' + format;\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                    case 'anynumber':\n                        model.$parsers.unshift(function(value) {\n                            var valid = false;\n                            if (value !== undefined && value !== \"\") {\n                                valid = String(value).indexOf(Number(value).toString()) !== -1; // isFinite(value); // \n                                value = Number(value);\n                                model.$setValidity('number', valid);\n                                if (valid) {\n                                    if (attributes.min !== undefined) {\n                                        model.$setValidity('range', value >= Number(attributes.min));\n                                    }\n                                    if (attributes.max !== undefined) {\n                                        model.$setValidity('range', value <= Number(attributes.max));\n                                    }\n                                }\n                            } else {\n                                valid = true;\n                                value = Number(value);\n                                model.$setValidity('number', true);\n                                if (attributes.min !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                                if (attributes.max !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                            }\n                            return value;\n                        });\n                        model.$formatters.push(function(value) {\n                            if (value || value === 0) {\n                                return $filter('number')(value, precision) + ' ' + format;\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                }\n\n                function onFocus() {\n                    focus = true;\n                    if (format) {\n                        element[0].value = model.$modelValue || null;\n                        if (!model.$modelValue) {\n                            model.$setViewValue(null);\n                        }\n                    }\n                }\n\n                function doBlur() {\n                    if (format && !model.$invalid) {\n                        switch (type) {\n                            case 'date':\n                            case 'datetime':\n                            case 'datetime-local':\n                                element[0].value = model.$modelValue ? $filter('date')(model.$modelValue, format) : ' ';\n                                break;\n                            default:\n                                element[0].value = model.$modelValue ? $filter('number')(model.$modelValue, precision) + ' ' + format : ' ';\n                                break;\n                        }\n                    }\n                }\n\n                function onBlur() {\n                    focus = false;\n                    doBlur();\n                }\n\n                function addListeners() {\n                    element.on('focus', onFocus);\n                    element.on('blur', onBlur);\n                }\n\n                function removeListeners() {\n                    element.off('focus', onFocus);\n                    element.off('blur', onBlur);\n                }\n                scope.$on('$destroy', function() {\n                    removeListeners();\n                });\n                addListeners();\n            }\n        };\n    }]);\n\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.directive('modalView', ['$parse', '$templateRequest', '$compile', '$controller', 'Utils', function($parse, $templateRequest, $compile, $controller, Utils) {\r\n\r\n        function compileController(scope, element, html, data) {\r\n            // console.log('modalView.compileController', element);\r\n            element.html(html);\r\n            var link = $compile(element.contents());\r\n            if (data.controller) {\r\n                var $scope = scope.$new();\r\n                angular.extend($scope, data);\r\n                var controller = $controller(data.controller, { $scope: $scope });\r\n                if (data.controllerAs) {\r\n                    scope[data.controllerAs] = controller;\r\n                }\r\n                element.data('$ngControllerController', controller);\r\n                element.children().data('$ngControllerController', controller);\r\n                scope = $scope;\r\n            }\r\n            link(scope);\r\n        }\r\n\r\n        return {\r\n            restrict: 'A',\r\n            priority: -400,\r\n            link: function(scope, element, attributes, model) {\r\n                var modal = $parse(attributes.modalView);\r\n                modal = modal(scope);\r\n                modal.templateUrl = modal.templateUrl || 'artisan/modals/modal';\r\n                $templateRequest(modal.templateUrl).then(function(html) {\r\n                    compileController(scope, element, html, modal);\r\n                });\r\n                /*\r\n                // window.scrollTo(0, element[0].offsetTop - 100);\r\n                function onClick(e) {\r\n                    var closest = Utils.getClosestElement(e.target, element[0]);\r\n                    if (closest === null) {\r\n                        modal.reject(null);\r\n                    }\r\n                    // console.log('onClick', closest);\r\n                }\r\n                function addListeners() {\r\n                    angular.element(window).on('click', onClick);\r\n                }\r\n                function removeListeners() {\r\n                    angular.element(window).off('click', onClick);\r\n                }\r\n                scope.$on('destroy', function () {\r\n                    removeListeners();\r\n                });\r\n                setTimeout(function () {\r\n                    addListeners();\r\n                }, 500);\r\n                */\r\n            }\r\n        };\r\n    }]);\r\n\r\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('artisan');\r\n\r\n    app.provider('$modal', [function $modalProvider() {\r\n\r\n        var modals = [];\r\n        var routes = {};\r\n\r\n        this.modals = modals;\r\n        this.routes = routes;\r\n        this.when = when;\r\n\r\n        function when(path, modal) {\r\n            routes[path] = modal;\r\n            return this;\r\n        }\r\n\r\n        this.$get = ['$q', '$timeout', function modalFactory($q, $timeout) {\r\n\r\n            function popModal(modal) {\r\n                // console.log('modalProvider.popModal', modal);                \r\n                var index = -1;\r\n                angular.forEach(modals, function(m, i) {\r\n                    if (m === modal) {\r\n                        index = i;\r\n                    }\r\n                });\r\n                if (index !== -1) {\r\n                    $timeout(function() {\r\n                        modal.active = false;\r\n                        modals.splice(index, 1);\r\n                        if (modals.length) {\r\n                            modals[modals.length - 1].active = true;\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n\r\n            function closeModal(modal) {\r\n                // console.log('modalProvider.closeModal', modal);                \r\n                var index = -1;\r\n                angular.forEach(modals, function(m, i) {\r\n                    if (m === modal) {\r\n                        index = i;\r\n                    }\r\n                });\r\n                if (index !== -1) {\r\n                    modal.active = false;\r\n                    $timeout(function() {\r\n                        while (modals.length) {\r\n                            modals.splice(modals.length - 1, 1);\r\n                        }\r\n                    }, 500);\r\n                }\r\n            }\r\n\r\n            function addModal(path, params) {\r\n                // console.log('modalProvider.addModal', path, params);\r\n                var deferred = $q.defer();\r\n                params = params || null;\r\n                var modal = {\r\n                    title: 'Untitled',\r\n                    controller: null,\r\n                    templateUrl: null,\r\n                    params: params,\r\n                };\r\n                var current = routes[path];\r\n                if (current) {\r\n                    angular.extend(modal, current);\r\n                }\r\n                modal.deferred = deferred;\r\n                modal.back = function(data) {\r\n                    popModal(this);\r\n                    modal.deferred.resolve(data, modal);\r\n                }\r\n                modal.resolve = function(data) {\r\n                    closeModal(this);\r\n                    modal.deferred.resolve(data, modal);\r\n                }\r\n                modal.reject = function() {\r\n                    closeModal(this);\r\n                    modal.deferred.reject(modal);\r\n                }\r\n                modals.push(modal);\r\n                angular.forEach(modals, function(m, i) {\r\n                    m.active = false;\r\n                });\r\n                if (modals.length) {\r\n                    modal.active = true;\r\n                } else {\r\n                    $timeout(function() {\r\n                        modal.active = true;\r\n                        // window.scrollTo(0, 0);\r\n                    }, 500);\r\n                }\r\n                return deferred.promise;\r\n            }\r\n\r\n            return {\r\n                modals: modals,\r\n                addModal: addModal,\r\n            };\r\n        }];\r\n\r\n    }]);\r\n\r\n}());\n/* global angular */\n\n(function () {\n\t\"use strict\";\n\n\tvar app = angular.module('artisan');\n\n\tapp.directive('nav', ['$parse', 'Nav', function ($parse, Nav) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\treturn attributes.template || 'artisan/nav/nav';\n\t\t\t},\n\t\t\tscope: {\n\t\t\t\titems: '=nav',\n\t\t\t},\n\t\t\tlink: function (scope, element, attributes, model) {\n\t\t\t\tscope.$watch('items', function (value) {\n\t\t\t\t\t// console.log(value instanceof Nav, value);\n\t\t\t\t\tif (value) {\n\t\t\t\t\t\tif (angular.isArray(value)) {\n\t\t\t\t\t\t\tvar onLink = $parse(attributes.onLink)(scope.$parent);\n\t\t\t\t\t\t\tvar onNav = $parse(attributes.onNav)(scope.$parent);\n\t\t\t\t\t\t\tvar nav = new Nav({\n\t\t\t\t\t\t\t\tonLink: onLink,\n\t\t\t\t\t\t\t\tonNav: onNav\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tnav.setItems(value);\n\t\t\t\t\t\t\tscope.item = nav;\n\n\t\t\t\t\t\t} else if (value instanceof Nav) {\n\t\t\t\t\t\t\tscope.item = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n    }]);\n\n\tapp.directive('navItem', ['$timeout', function ($timeout) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\ttemplateUrl: function (element, attributes) {\n\t\t\t\treturn attributes.template || 'artisan/nav/nav-item';\n\t\t\t},\n\t\t\tscope: {\n\t\t\t\titem: '=navItem',\n\t\t\t},\n\t\t\tlink: function (scope, element, attributes, model) {\n\t\t\t\tvar navItem = angular.element(element[0].querySelector('.nav-link'));\n\n\t\t\t\tvar output;\n\n\t\t\t\tfunction itemOpen(item, immediate) {\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tstate.active = true;\n\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tstate.immediate = immediate;\n\t\t\t\t\t\tstate.closed = state.closing = false;\n\t\t\t\t\t\tstate.opening = true;\n\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\tstate.opening = false;\n\t\t\t\t\t\t\tstate.opened = true;\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction itemClose(item, immediate) {\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tstate.active = false;\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tstate.immediate = immediate;\n\t\t\t\t\t\tstate.opened = state.opening = false;\n\t\t\t\t\t\tstate.closing = true;\n\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\tstate.closing = false;\n\t\t\t\t\t\t\tstate.closed = true;\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tif (item.items) {\n\t\t\t\t\t\tangular.forEach(item.items, function (o) {\n\t\t\t\t\t\t\titemClose(o, true);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction itemToggle(item) {\n\t\t\t\t\t// console.log('itemToggle', item);\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tstate.active = item.items ? !state.active : true;\n\t\t\t\t\tif (state.active) {\n\t\t\t\t\t\tif (item.$nav.parent) {\n\t\t\t\t\t\t\tangular.forEach(item.$nav.parent.items, function (o) {\n\t\t\t\t\t\t\t\tif (o !== item) {\n\t\t\t\t\t\t\t\t\titemClose(o, true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\titemOpen(item);\n\t\t\t\t\t} else {\n\t\t\t\t\t\titemClose(item);\n\t\t\t\t\t}\n\t\t\t\t\t// console.log(state);\n\t\t\t\t}\n\n\t\t\t\tfunction onTap(e) {\n\t\t\t\t\tvar item = scope.item;\n\t\t\t\t\t// console.log('Item.onTap', item);\n\t\t\t\t\tvar state = item.$nav.state;\n\t\t\t\t\tif (state.active) {\n\t\t\t\t\t\toutput = false;\n\t\t\t\t\t\ttrigger();\n\t\t\t\t\t} else if (item.$nav.onNav) {\n\t\t\t\t\t\tvar promise = item.$nav.onNav(item, item.$nav);\n\t\t\t\t\t\tif (promise && typeof promise.then === 'function') {\n\t\t\t\t\t\t\tpromise.then(function (resolved) {\n\t\t\t\t\t\t\t\t// go on\n\t\t\t\t\t\t\t\ttrigger();\n\t\t\t\t\t\t\t}, function (rejected) {\n\t\t\t\t\t\t\t\t// do nothing\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\toutput = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\toutput = promise;\n\t\t\t\t\t\t\ttrigger();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction trigger() {\n\t\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t\titemToggle(item);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction onTouchStart(e) {\n\t\t\t\t\t// console.log('Item.onTouchStart', e);\n\t\t\t\t\tonTap(e);\n\t\t\t\t\tnavItem\n\t\t\t\t\t\t.off('mousedown', onMouseDown);\n\t\t\t\t\t// return r || prevent(e);\n\t\t\t\t}\n\n\t\t\t\tfunction onMouseDown(e) {\n\t\t\t\t\t// console.log('Item.onMouseDown', e);\n\t\t\t\t\tonTap(e);\n\t\t\t\t\tnavItem\n\t\t\t\t\t\t.off('touchstart', onTouchStart);\n\t\t\t\t\t// return r || prevent(e);\n\t\t\t\t}\n\n\t\t\t\tfunction onClick(e) {\n\t\t\t\t\t// console.log('Item.onClick', e);\n\t\t\t\t\treturn prevent(e);\n\t\t\t\t}\n\n\t\t\t\tfunction prevent(e) {\n\t\t\t\t\tif (output === false) {\n\t\t\t\t\t\t// console.log('Item.prevent', e);\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t// e.stopPropagation();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction addListeners() {\n\t\t\t\t\tnavItem\n\t\t\t\t\t\t.on('touchstart', onTouchStart)\n\t\t\t\t\t\t.on('mousedown', onMouseDown)\n\t\t\t\t\t\t.on('click', onClick);\n\t\t\t\t}\n\n\t\t\t\tfunction removeListeners() {\n\t\t\t\t\tnavItem\n\t\t\t\t\t\t.off('touchstart', onTouchStart)\n\t\t\t\t\t\t.off('mousedown', onMouseDown)\n\t\t\t\t\t\t.off('click', onClick);\n\t\t\t\t}\n\n\t\t\t\taddListeners();\n\n\t\t\t\tscope.$on('$destroy', function () {\n\t\t\t\t\tremoveListeners();\n\t\t\t\t});\n\t\t\t}\n\t\t};\n    }]);\n\n}());\n\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('Nav', ['$silent', function($silent) {\n        function Nav(options) {\n            var nav = this;\n            var defaults = {\n                items: [],\n            }\n            angular.extend(nav, defaults);\n            if (options) {\n                angular.extend(nav, options);\n            }\n            nav.setNav(nav, null);\n        }\n        Nav.prototype = {\n            setItems: function(items) {\n                var nav = this;\n                nav.path = $silent.path();\n                nav.items = items;\n                nav.setNavs(items, nav);\n            },\n            setNavs: function(items, parent) {\n                var nav = this;\n                if (items) {\n                    angular.forEach(items, function(item) {\n                        nav.setNav(item, parent);\n                        nav.setNavs(item.items, item);\n                    });\n                }\n            },\n            setNav: function(item, parent) {\n                var nav = this;\n                var $nav = {\n                    parent: parent || null,\n                    level: parent ? parent.$nav.level + 1 : 0,\n                    state: {},\n                    addItems: function(x) {\n                        nav.addItems(x, item);\n                    },\n                    onNav: nav.onNav,\n                };\n                item.$nav = $nav;\n                $nav.link = nav.getLink(item);\n                if ($nav.link === nav.path) {\n                    $nav.state.active = true;\n                    $nav.state.opened = true;\n                    while ($nav.parent) {\n                        $nav = $nav.parent.$nav;\n                        $nav.state.active = true;\n                        $nav.state.opened = true;\n                    }\n                }\n            },\n            addItems: function(itemOrItems, parent) {\n                var nav = this;\n                if (angular.isArray(itemOrItems)) {\n                    angular.forEach(itemOrItems, function(item) {\n                        nav.addItem(item, parent);\n                    });\n                } else {\n                    nav.addItem(itemOrItems, parent);\n                }\n            },\n            addItem: function(item, parent) {\n                var nav = this,\n                    onLink = nav.onLink,\n                    onNav = nav.onNav;\n                nav.setNav(item, parent);\n                if (parent) {\n                    parent.items = parent.items || [];\n                    parent.items.push(item);\n                }\n            },\n            getLink: function(item) {\n                var link = null;\n                if (this.onLink) {\n                    link = this.onLink(item, item.$nav);\n                } else {\n                    link = item.link;\n                }\n                return link;\n            },\n        };\n        var statics = {\n            silent: function(path) {\n                $silent.silent(path);\n            },\n            path: function(path) {\n                $silent.path(path);\n            },\n        };\n        angular.extend(Nav, statics);\n        return Nav;\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    window.ondragstart = function() {\n        return false;\n    };\n\n    var app = angular.module('artisan');\n\n    app.directive('scrollableX', ['$parse', '$compile', '$window', '$timeout', 'Scrollable', 'Animate', 'Style', 'Events', 'Utils', function($parse, $compile, $window, $timeout, Scrollable, Animate, Style, Events, Utils) {\n        return {\n            restrict: 'A',\n            template: '<div class=\"content\" ng-transclude></div>',\n            transclude: true,\n            link: function(scope, element, attributes, model) {\n\n                var onLeft, onRight, showIndicatorFor, scrollableWhen;\n                if (attributes.onLeft) {\n                    onLeft = $parse(attributes.onLeft);\n                }\n                if (attributes.onRight) {\n                    onRight = $parse(attributes.onRight);\n                }\n                if (attributes.showIndicatorFor) {\n                    showIndicatorFor = $parse(attributes.showIndicatorFor);\n                }\n                if (attributes.scrollableWhen) {\n                    scrollableWhen = $parse(attributes.scrollableWhen);\n                }\n\n                // ELEMENTS & STYLESHEETS;\n                element.attr('unselectable', 'on').addClass('unselectable');\n                var containerNode = element[0];\n                var contentNode = containerNode.querySelector('.content');\n                var content = angular.element(content);\n                var contentStyle = new Style();\n\n                var animate = new Animate(render);\n\n                var scrollable = attributes.scrollableX ? $parse(attributes.scrollableX)(scope) : new Scrollable();\n                link(scrollable);\n\n                function link(scrollable) {\n                    scrollable.link({\n                        getItems: function() {\n                            if (attributes.scrollableItem) {\n                                var items = containerNode.querySelectorAll(attributes.scrollableItem);\n                                return items;\n                            }\n                        },\n                        prev: function() {\n                            scrollable.scrollPrev();\n                            animate.play();\n                        },\n                        next: function() {\n                            scrollable.scrollNext();\n                            animate.play();\n                        },\n                        reset: function() {\n                            scrollable.doReset();\n                            animate.play();\n                        },\n                        onLeft: onLeft,\n                        onRight: onRight,\n                    });\n                }\n\n                /*\n                scope.$watch(attributes.scrollableX, function (newValue) {\n                \tconsole.log(newValue);\n                });\n                */\n\n                /*\n                var indicator = null,\n                \tindicatorNode = null,\n                \tindicatorStyle;\n                showIndicatorFor = false;\n                if (showIndicatorFor) {\n                \tindicator = angular.element('<div class=\"indicator\"></div>');\n                \tindicatorNode = indicator[0];\n                \tindicatorStyle = new Style();\n                \telement.append(indicator);\n                \t$compile(indicator.contents())(scope);\n                \tvar i = scrollbar.getIndicator();\n                \tindicatorStyle.transform('translate3d(' + i.x.toFixed(2) + 'px,' + i.y.toFixed(2) + 'px,0)');\n                \tindicatorStyle.set(indicatorNode);\n                }\n                */\n\n                function render(time) {\n                    scrollable.setContainer(containerNode);\n                    scrollable.setContent(contentNode);\n                    scrollable.setEnabled(isEnabled());\n                    var animating = scrollable.renderX();\n                    if (!animating) {\n                        // animate.pause();\n                    }\n                    var current = scrollable.getCurrent();\n                    contentStyle.transform('translate3d(' + current.x.toFixed(2) + 'px,0,0)');\n                    contentStyle.set(contentNode);\n                    /*\n                    if (showIndicatorFor) {\n                    \tif (dragging || wheeling || speed) {\n                    \t\tvar percent = c.x / (containerNode.offsetWidth - contentNode.offsetWidth);\n                    \t\tpercent = Math.max(0, Math.min(1, percent));\n                    \t\ti.x = (containerNode.offsetWidth - indicatorNode.offsetWidth) * (percent);\n                    \t\ti.y += (0 - i.y) / 4;\n                    \t\t// var count = Math.round(contentNode.offsetWidth / 315);\n                    \t\tvar index = Math.max(1, Math.round(percent * showIndicatorFor.rows.length));\n                    \t\tindicator.html(index + '/' + showIndicatorFor.count);\n                    \t\t// indicator.html((percent * 100).toFixed(2).toString());\n                    \t} else {\n                    \t\ti.y += (45 - i.y) / 4;\n                    \t}\n                    \tindicatorStyle.transform('translate3d(' + i.x.toFixed(2) + 'px,' + i.y.toFixed(2) + 'px,0)');\n                    \tindicatorStyle.set(indicatorNode);\n                    }\n                    */\n                }\n\n                function undrag() {\n                    scrollable.off();\n                    dragOff();\n                }\n\n                function onDown(event) {\n                    if (event.type == 'touchstart') {\n                        element.off('mousedown', onDown);\n                    }\n                    if (scrollable.dragStart(Utils.getTouch(event))) {\n                        dragOn();\n                        animate.play();\n                    }\n                }\n\n                function onMove(event) {\n                    if (event.type == 'touchmove') {\n                        angular.element($window).off('mousemove', onMove);\n                    }\n                    scrollable.dragMove(Utils.getTouch(event));\n                }\n\n                function onUp(event) {\n                    if (event.type == 'touchend') {\n                        angular.element($window).off('mouseup', onUp);\n                    }\n                    scrollable.dragEnd();\n                    dragOff();\n                }\n\n                function _onScrollX(dir, trackpad) {\n                    return scrollable.wheelX(dir, trackpad);\n                }\n\n                var onScrollX = _onScrollX;\n                // var onScrollX = Utils.throttle(_onScrollX, 25);\n\n                var trackpad, lastime;\n\n                function onWheel(e) {\n                    if (!e) e = $window.event;\n                    e = e.originalEvent ? e.originalEvent : e;\n                    var dir = (((e.deltaY < 0 || e.wheelDelta > 0) || e.deltaY < 0) ? 1 : -1);\n\n                    if (trackpad === undefined) {\n                        if (lastime) {\n                            trackpad = new Date().getTime() - lastime < 100;\n                        } else {\n                            lastime = new Date().getTime();\n                        }\n                    }\n\n                    if (scrollable.wheelXCheck(dir)) {\n                        onScrollX(dir);\n                        animate.play();\n                        e.preventDefault();\n                    }\n                }\n\n                function off() {\n                    dragOff();\n                    // animate.pause();\n                    scrollable.off();\n                }\n\n                function isEnabled() {\n                    var enabled = true;\n                    if (scrollableWhen) {\n                        enabled = enabled && scrollableWhen(scope);\n                    }\n                    enabled = enabled && $window.innerWidth >= 1024;\n                    enabled = enabled && (containerNode.offsetWidth < contentNode.offsetWidth);\n                    return enabled;\n                }\n\n                function onResize() {\n                    var enabled = isEnabled();\n                    if (!enabled) {\n                        off();\n                    }\n                    render();\n                }\n\n                scope.$watch(function() {\n                    return contentNode.offsetWidth;\n                }, function(newValue, oldValue) {\n                    onResize();\n                });\n\n                function addListeners() {\n                    angular.element($window).on('resize', onResize);\n                    element.on('touchstart mousedown', onDown);\n                    // element.on('wheel', onWheel);\n                    element[0].addEventListener('DOMMouseScroll', onWheel, {\n                        passive: false\n                    }); // for Firefox\n                    element[0].addEventListener('mousewheel', onWheel, {\n                        passive: false\n                    }); // for everyone else\n                }\n\n                function removeListeners() {\n                    angular.element($window).off('resize', onResize);\n                    element.off('touchstart mousedown', onDown);\n                    // element.off('wheel', onWheel);\n                    element[0].removeEventListener('DOMMouseScroll', onWheel); // for Firefox\n                    element[0].removeEventListener('mousewheel', onWheel);\n                }\n\n                function dragOn() {\n                    angular.element($window).on('touchmove mousemove', onMove);\n                    angular.element($window).on('touchend mouseup', onUp);\n                }\n\n                function dragOff() {\n                    angular.element($window).off('touchmove mousemove', onMove);\n                    angular.element($window).off('touchend mouseup', onUp);\n                }\n\n                scope.$on('$destroy', function() {\n                    removeListeners();\n                    animate.pause();\n                });\n\n                addListeners();\n\n                /*\n                var events = new Events(element).add({\n                \tdown: onDown,\n                \twheel: onWheel,\n                }, scope);\n\n                var windowEvents = new Events($window).add({\n                \tresize: onResize,\n                }, scope);\n\n                function dragOn() {\n                \twindowEvents.add({\n                \t\tmove: onMove,\n                \t\tup: onUp,\n                \t});\n                }\n\n                function dragOff() {\n                \twindowEvents.remove({\n                \t\tmove: onMove,\n                \t\tup: onUp,\n                \t});\n                }\n\n                scope.$on('$destroy', function () {\n                \tanimate.pause();\n                });\n                */\n\n            },\n        };\n    }]);\n\n    app.directive('scrollableY', ['$parse', '$compile', '$window', '$timeout', 'Scrollable', 'Animate', 'Style', 'Events', 'Utils', function($parse, $compile, $window, $timeout, Scrollable, Animate, Style, Events, Utils) {\n        return {\n            restrict: 'A',\n            template: '<div class=\"content\" ng-transclude></div>',\n            transclude: true,\n            link: function(scope, element, attributes, model) {\n\n                var onTop, onBottom, showIndicatorFor, scrollableWhen;\n                if (attributes.onTop) {\n                    onTop = $parse(attributes.onTop);\n                }\n                if (attributes.onBottom) {\n                    onBottom = $parse(attributes.onBottom);\n                }\n                if (attributes.showIndicatorFor) {\n                    showIndicatorFor = $parse(attributes.showIndicatorFor);\n                }\n                if (attributes.scrollableWhen) {\n                    scrollableWhen = $parse(attributes.scrollableWhen);\n                }\n\n                // ELEMENTS & STYLESHEETS;\n                element.attr('unselectable', 'on').addClass('unselectable');\n                var containerNode = element[0];\n                var contentNode = containerNode.querySelector('.content');\n                var content = angular.element(content);\n                var contentStyle = new Style();\n\n                var animate = new Animate(render);\n\n                var scrollable = attributes.scrollableY ? $parse(attributes.scrollableY)(scope) : new Scrollable();\n                link(scrollable);\n\n                function link(scrollable) {\n                    scrollable.link({\n                        getItems: function() {\n                            if (attributes.scrollableItem) {\n                                var items = containerNode.querySelectorAll(attributes.scrollableItem);\n                                return items;\n                            }\n                        },\n                        prev: function() {\n                            scrollable.scrollPrev();\n                            animate.play();\n                        },\n                        next: function() {\n                            scrollable.scrollNext();\n                            animate.play();\n                        },\n                        reset: function() {\n                            scrollable.doReset();\n                            animate.play();\n                        },\n                        onTop: onTop,\n                        onBottom: onBottom,\n                    });\n                }\n\n                function render(time) {\n                    scrollable.setContainer(containerNode);\n                    scrollable.setContent(contentNode);\n                    scrollable.setEnabled(isEnabled());\n                    var animating = scrollable.renderY();\n                    if (!animating) {\n                        // animate.pause();\n                    }\n                    var current = scrollable.getCurrent();\n                    contentStyle.transform('translate3d(0,' + current.y.toFixed(2) + 'px,0)');\n                    contentStyle.set(contentNode);\n                }\n\n                function undrag() {\n                    scrollable.off();\n                    dragOff();\n                }\n\n                function onDown(event) {\n                    if (event.type == 'touchstart') {\n                        element.off('mousedown', onDown);\n                    }\n                    if (scrollable.dragStart(Utils.getTouch(event))) {\n                        dragOn();\n                        animate.play();\n                    }\n                }\n\n                function onMove(event) {\n                    if (event.type == 'touchmove') {\n                        angular.element($window).off('mousemove', onMove);\n                    }\n                    scrollable.dragMove(Utils.getTouch(event));\n                }\n\n                function onUp(event) {\n                    if (event.type == 'touchend') {\n                        angular.element($window).off('mouseup', onUp);\n                    }\n                    scrollable.dragEnd();\n                    dragOff();\n                }\n\n                function _onScrollY(dir) {\n                    return scrollable.wheelY(dir);\n                }\n\n                var onScrollY = _onScrollY;\n                // var onScrollY = Utils.throttle(_onScrollY, 25);\n\n                function onWheel(e) {\n                    if (!e) e = $window.event;\n                    e = e.originalEvent ? e.originalEvent : e;\n                    var dir = (((e.deltaY < 0 || e.wheelDelta > 0) || e.deltaY < 0) ? 1 : -1);\n                    // console.log('onWheel', dir, scrollable.wheelYCheck(dir), e);\n                    if (scrollable.wheelYCheck(dir)) {\n                        onScrollY(dir);\n                        animate.play();\n                        e.stopPropagation();\n                        e.preventDefault();\n                    }\n                }\n\n                function off() {\n                    dragOff();\n                    // animate.pause();\n                    scrollable.off();\n                }\n\n                function isEnabled() {\n                    var enabled = true;\n                    if (scrollableWhen) {\n                        enabled = enabled && scrollableWhen(scope);\n                    }\n                    enabled = enabled && $window.innerWidth >= 1024;\n                    enabled = enabled && (containerNode.offsetHeight < contentNode.offsetHeight);\n                    return enabled;\n                }\n\n                function onResize() {\n                    var enabled = isEnabled();\n                    if (!enabled) {\n                        off();\n                    }\n                    render();\n                }\n\n                scope.$watch(function() {\n                    return contentNode.offsetHeight;\n                }, function(newValue, oldValue) {\n                    onResize();\n                });\n\n                function addListeners() {\n                    angular.element($window).on('resize', onResize);\n                    element.on('touchstart mousedown', onDown);\n                    // element.on('wheel', onWheel);\n                    element[0].addEventListener('DOMMouseScroll', onWheel, {\n                        passive: false\n                    }); // for Firefox\n                    element[0].addEventListener('mousewheel', onWheel, {\n                        passive: false\n                    }); // for everyone else\n                }\n\n                function removeListeners() {\n                    angular.element($window).off('resize', onResize);\n                    element.off('touchstart mousedown', onDown);\n                    // element.off('wheel', onWheel);\n                    element[0].removeEventListener('DOMMouseScroll', onWheel); // for Firefox\n                    element[0].removeEventListener('mousewheel', onWheel);\n                }\n\n                function dragOn() {\n                    angular.element($window).on('touchmove mousemove', onMove);\n                    angular.element($window).on('touchend mouseup', onUp);\n                }\n\n                function dragOff() {\n                    angular.element($window).off('touchmove mousemove', onMove);\n                    angular.element($window).off('touchend mouseup', onUp);\n                }\n\n                scope.$on('$destroy', function() {\n                    removeListeners();\n                    animate.pause();\n                });\n\n                addListeners();\n\n            },\n        };\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    app.factory('Scrollable', ['Utils', 'Point', 'Rect', function(Utils, Point, Rect) {\n\n        console.log(Utils.ua);\n\n        function Scrollable() {\n\n            var padding = 150;\n            var enabled, snappable, busy, dragging, wheeling, down, move, prev;\n            var currentIndex = 0;\n\n            snappable = true;\n\n            var start = new Point(),\n                end = new Point(),\n                current = new Point(),\n                indicator = new Point(),\n                offset = new Point(),\n                speed = new Point(),\n                container = new Rect(),\n                content = new Rect(),\n                overflow = new Rect();\n\n            var scrollable = {\n                // properties\n                start: start,\n                end: end,\n                current: current,\n                indicator: indicator,\n                speed: speed,\n                overflow: overflow,\n                container: container,\n                content: content,\n                // methods\n                setContainer: setContainer,\n                setContent: setContent,\n                setEnabled: setEnabled,\n                getCurrent: getCurrent,\n                getIndicator: getIndicator,\n                scrollToIndex: scrollToIndex,\n                scrollPrev: scrollPrev,\n                scrollNext: scrollNext,\n                dragStart: dragStart,\n                dragMove: dragMove,\n                dragEnd: dragEnd,\n                doReset: doReset,\n                off: off,\n                // x direction\n                doLeft: doLeft,\n                doRight: doRight,\n                renderX: renderX,\n                scrollToX: scrollToX,\n                wheelX: wheelX,\n                wheelXCheck: wheelXCheck,\n                // y direction\n                doTop: doTop,\n                doBottom: doBottom,\n                renderY: renderY,\n                scrollToY: scrollToY,\n                wheelY: wheelY,\n                wheelYCheck: wheelYCheck,\n            };\n\n            angular.extend(this, scrollable);\n\n            scrollable = this;\n\n            function setContainer(node) {\n                container.width = node.offsetWidth;\n                container.height = node.offsetHeight;\n            }\n\n            function setContent(node) {\n                content.width = node.offsetWidth;\n                content.height = node.offsetHeight;\n            }\n\n            function setEnabled(flag) {\n                enabled = flag;\n            }\n\n            function getCurrent() {\n                return current;\n            }\n\n            function getIndicator() {\n                return indicator;\n            }\n\n            function scrollToIndex(index) {\n                if (index !== currentIndex) {\n                    currentIndex = index;\n                    var item = getItemAtIndex(index);\n                    // console.log('scrollToIndex', item, index, currentIndex);\n                    if (item) {\n                        offset.x = item.offsetLeft;\n                        offset.y = item.offsetTop;\n                        // console.log('offset', offset);\n                    }\n                    return true;\n                }\n            }\n\n            function dragStart(point) {\n                if (!busy) {\n                    start.x = end.x = current.x;\n                    start.y = end.y = current.y;\n                    speed.x = 0;\n                    speed.y = 0;\n                    down = point;\n                    wheeling = false;\n                    return true;\n                } else {\n                    return false;\n                }\n            }\n\n            function dragMove(point) {\n                prev = move;\n                move = point;\n                dragging = true;\n            }\n\n            function dragEnd() {\n                if (move && prev) {\n                    speed.x += (move.x - prev.x) * 4;\n                    speed.y += (move.y - prev.y) * 4;\n                }\n                start.x = end.x = current.x;\n                start.y = end.y = current.y;\n                dragging = false;\n                move = null;\n                down = null;\n                prev = null;\n            }\n\n            function getItemAtIndex(index) {\n                var item = null;\n                var items = scrollable.getItems();\n                if (items) {\n                    if (index >= 0 && index < items.length) {\n                        item = items[index];\n                    }\n                }\n                // console.log('getItemAtIndex', index, items.length, item);\n                return item;\n            }\n\n            function scrollPrev() {\n                var index = Math.max(0, currentIndex - 1);\n                // console.log('scrollPrev', index);\n                scrollToIndex(index);\n            }\n\n            function scrollNext() {\n                var items = scrollable.getItems();\n                var index = Math.min(items.length - 1, currentIndex + 1);\n                // console.log('scrollNext', index);\n                scrollToIndex(index);\n            }\n\n            function doReset() {\n                end.x = current.x = 0;\n            }\n\n            function off() {\n                dragging = false;\n                wheeling = false;\n                move = null;\n                down = null;\n            }\n\n            // x - direction\n\n            function doLeft(scope) {\n                if (busy) {\n                    return;\n                }\n                if (!scrollable.onLeft) {\n                    return;\n                }\n                busy = true;\n                scrollable.onLeft(scope).then().finally(function() {\n                    scrollToX(0);\n                });\n            }\n\n            function doRight(scope) {\n                if (busy) {\n                    return;\n                }\n                if (!scrollable.onRight) {\n                    return;\n                }\n                busy = true;\n                scrollable.onRight(scope).then().finally(function() {\n                    var right = container.width - content.width;\n                    if (right > overflow.width) {\n                        start.x = end.x = overflow.width;\n                    } else {\n                        start.x = end.x = overflow.width + padding;\n                    }\n                    scrollToX(0);\n                });\n            }\n\n            function renderX() {\n                var animating = true;\n                if (enabled) {\n                    overflow.x = 0;\n                    overflow.width = container.width - content.width;\n                    if (dragging) {\n                        end.x = start.x + move.x - down.x;\n                        if (extendX()) {\n                            start.x = end.x;\n                            down.x = move.x;\n                        }\n                    } else if (speed.x) {\n                        end.x += speed.x;\n                        speed.x *= 0.75;\n                        if (wheeling) {\n                            extendX();\n                        }\n                        if (Math.abs(speed.x) < 0.05) {\n                            speed.x = 0;\n                            scrollable.wheeling = wheeling = false;\n                        }\n                    } else if (offset.x) {\n                        end.x = -offset.x;\n                        offset.x = 0;\n                    }\n                    end.x = Math.round(end.x * 10000) / 10000;\n                    end.x = Math.min(overflow.x, end.x);\n                    end.x = Math.max(overflow.width, end.x);\n                    current.x += (end.x - current.x) / 4;\n                    if (speed.x === 0 && Math.abs(end.x - current.x) < 0.05) {\n                        current.x = end.x;\n                        if (!snapToNearestX()) {\n                            animating = false;\n                        }\n                    }\n                    // console.log(parseFloat(current.x.toFixed(6)), end.x, overflow.x);\n                } else {\n                    current.x = end.x = 0;\n                    animating = false;\n                }\n                return animating;\n            }\n\n            function extendX() {\n                var extending = false;\n                overflow.x += padding;\n                overflow.width -= padding;\n                if (end.x > overflow.x) {\n                    extending = true;\n                    doLeft();\n                } else if (end.x < overflow.width) {\n                    extending = true;\n                    doRight();\n                }\n                return extending;\n            }\n\n            function snapToNearestX() {\n                if (snappable) {\n                    var items = scrollable.getItems();\n                    if (items) {\n                        var index = -1;\n                        var min = Number.POSITIVE_INFINITY;\n                        angular.forEach(items, function(item, i) {\n                            var distance = Math.abs((end.x + speed.x) - (item.offsetLeft * -1));\n                            if (distance < min) {\n                                min = distance;\n                                index = i;\n                            }\n                        });\n                        // console.log('snapToNearestX.index', index, min);\n                        if (index !== -1) {\n                            return scrollToIndex(index);\n                        }\n                    }\n                }\n            }\n\n            function wheelXIncrement(dir) {\n                var increment = 100;\n                if (snappable) {\n                    var items = scrollable.getItems();\n                    if (items) {\n                        var index = Math.max(0, Math.min(items.length - 1, currentIndex + dir));\n                        increment = items[index].offsetWidth;\n                    }\n                }\n                return increment;\n            }\n\n            function wheelX(dir) {\n                end.x += dir * Utils.ua.mac ? 5 : wheelXIncrement(dir);\n                speed.x += dir * 5;\n                wheeling = true;\n            }\n\n            function wheelXCheck(dir) {\n                if (!busy && enabled) {\n                    // var endx = end.x + dir * content.height;\n                    // var speedx = speed.x + dir * 5;\n                    if (dir < 0) {\n                        return (end.x > overflow.width);\n                    } else {\n                        return (end.x < overflow.x);\n                    }\n                } else {\n                    return false;\n                }\n            }\n\n            function scrollToX(value) {\n                start.x = end.x = value;\n                setTimeout(function() {\n                    off();\n                    busy = false;\n                }, 500);\n            }\n\n            // y - direction\n\n            function doTop(scope) {\n                if (busy) {\n                    return;\n                }\n                if (!scrollable.onTop) {\n                    return;\n                }\n                busy = true;\n                scrollable.onTop(scope).then().finally(function() {\n                    scrollToY(0);\n                });\n            }\n\n            function doBottom(scope) {\n                if (busy) {\n                    return;\n                }\n                if (!scrollable.onBottom) {\n                    return;\n                }\n                busy = true;\n                scrollable.onBottom(scope).then().finally(function() {\n                    var bottom = container.height - content.height;\n                    if (bottom > overflow.height) {\n                        start.y = end.y = overflow.height;\n                    } else {\n                        start.y = end.y = overflow.height + padding;\n                    }\n                    scrollToY(0);\n                });\n            }\n\n            function renderY() {\n                var animating = true;\n                if (enabled) {\n                    overflow.y = 0;\n                    overflow.height = container.height - content.height;\n                    if (dragging) {\n                        end.y = start.y + move.y - down.y;\n                        if (extendY()) {\n                            start.y = end.y;\n                            down.y = move.y;\n                        }\n                    } else if (speed.y) {\n                        end.y += speed.y;\n                        speed.y *= 0.75;\n                        if (wheeling) {\n                            extendX();\n                        }\n                        if (Math.abs(speed.y) < 0.05) {\n                            speed.y = 0;\n                            scrollable.wheeling = wheeling = false;\n                        }\n                    } else if (offset.y) {\n                        end.y = -offset.y;\n                        offset.y = 0;\n                    }\n                    end.y = Math.round(end.y * 10000) / 10000;\n                    end.y = Math.min(overflow.y, end.y);\n                    end.y = Math.max(overflow.height, end.y);\n                    current.y += (end.y - current.y) / 4;\n                    if (speed.y === 0 && Math.abs(end.y - current.y) < 0.05) {\n                        current.y = end.y;\n                        if (!snapToNearestY()) {\n                            animating = false;\n                        }\n                    }\n                    // console.log(parseFloat(current.y.toFixed(6)), end.y, overflow.y);\n                } else {\n                    current.y = end.y = 0;\n                    animating = false;\n                }\n                return animating;\n            }\n\n            function extendY() {\n                var extending = false;\n                overflow.y += padding;\n                overflow.height -= padding;\n                if (end.y > overflow.y) {\n                    extending = true;\n                    doTop();\n                } else if (end.y < overflow.height) {\n                    extending = true;\n                    doBottom();\n                }\n                return extending;\n            }\n\n            function snapToNearestY() {\n                if (snappable) {\n                    var items = scrollable.getItems();\n                    if (items) {\n                        var index = -1;\n                        var min = Number.POSITIVE_INFINITY;\n                        angular.forEach(items, function(item, i) {\n                            var distance = Math.abs((end.y + speed.y) - (item.offsetTop * -1));\n                            if (distance < min) {\n                                min = distance;\n                                index = i;\n                            }\n                        });\n                        // console.log('snapToNearestX.index', index, min);\n                        if (index !== -1) {\n                            return scrollToIndex(index);\n                        }\n                    }\n                }\n            }\n\n            function wheelYIncrement(dir) {\n                var increment = 100;\n                if (snappable) {\n                    var items = scrollable.getItems();\n                    if (items) {\n                        var index = Math.max(0, Math.min(items.length - 1, currentIndex + dir));\n                        increment = items[index].offsetHeight;\n                    }\n                }\n                return increment;\n            }\n\n            function wheelY(dir) {\n                end.y += dir * Utils.ua.mac ? 5 : wheelYIncrement(dir);\n                speed.y += dir * 5;\n                wheeling = true;\n            }\n\n            function wheelYCheck(dir) {\n                // console.log('wheelYCheck', busy, enabled, overflow.height, container.height, content.height, end.y);\n                if (!busy && enabled) {\n                    if (dir < 0) {\n                        return (end.y > overflow.height);\n                    } else {\n                        return (end.y < overflow.y);\n                    }\n                } else {\n                    return false;\n                }\n            }\n\n            function scrollToY(value) {\n                start.y = end.y = value;\n                setTimeout(function() {\n                    off();\n                    busy = false;\n                }, 500);\n            }\n\n        }\n\n        function link(methods) {\n            angular.extend(this, methods);\n        }\n\n        Scrollable.prototype = {\n            link: link,\n            getItems: function() {\n                return [content];\n            },\n        };\n        return Scrollable;\n    }]);\n\n}());\n/* global angular */\n(function() {\n    \"use strict\";\n\n    var app = angular.module('artisan');\n\n    // micro interactions\n\n    function tap(Events) {\n        return {\n            restrict: 'A',\n            priority: 0,\n            link: link\n        };\n\n        function link(scope, element, attributes, model) {\n            if (attributes.ngBind) {\n                return;\n            }\n            if (attributes.href === '#' && !attributes.ngHref && !attributes.ngClick) {\n                return;\n            }\n\n            element.addClass('interaction-tap');\n            var node = document.createElement('interaction');\n            element[0].appendChild(node);\n\n            function onDown(e) {\n                element.removeClass('interaction-animate');\n                void element.offsetWidth;\n                // node.style.animationPlayState = \"paused\";\n                node.style.left = e.relative.x + 'px';\n                node.style.top = e.relative.y + 'px';\n                setTimeout(function() {\n                    element.addClass('interaction-animate');\n                    setTimeout(function() {\n                        element.removeClass('interaction-animate');\n                    }, 1000);\n                }, 10);\n\n                // console.log('tap.onDown', node, node.parentElement);\n            }\n            var listeners = { // down, move, up, click\n                down: onDown,\n            };\n            var events = new Events(element).add(listeners, scope); // passing scope to add remove listeners automatically on $destroy\n        }\n    }\n    app.directive('href', ['Events', tap]);\n    app.directive('ngClick', ['Events', tap]);\n\n}());"]}